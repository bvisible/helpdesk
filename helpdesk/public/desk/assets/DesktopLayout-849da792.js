var da=(o,t,l)=>{if(!t.has(o))throw TypeError("Cannot "+l)};var Pt=(o,t,l)=>(da(o,t,"read from private field"),l?l.call(o):t.get(o)),Nl=(o,t,l)=>{if(t.has(o))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(o):t.set(o,l)};import{z as $,ay as Te,d as j,cg as ca,c as N,cl as pa,cm as ma,a7 as Et,cj as fa,aE as va,cf as il,az as pl,aB as Il,aC as ga,cn as ya,ce as ha,aD as Hl,M as be,a5 as nt,ai as _a,ap as Me,co as ba,$ as Ke,cp as ka,cq as Ge,aF as Be,cr as xa,aK as zl,cs as dn,ax as wa,h as e,ct as Ca,cu as $a,cv as Lt,a3 as ve,e as r,f as E,ab as ye,cw as Aa,k as v,x as A,F as O,E as G,cx as dt,w as C,g as d,cy as He,B as ae,cz as Sa,cA as Ft,bi as ml,cB as El,cC as Jt,cD as ll,cE as Va,y as he,aU as Ye,cF as Ia,cG as Tt,cH as Ea,cI as Da,N as ut,cJ as Ba,c0 as La,cK as Fa,cL as Ta,cM as Ma,cN as Oa,v as Oe,cO as Ra,cP as qa,cQ as ja,s as te,C as Dt,t as D,D as rl,cR as Ua,cS as Pa,a8 as ee,l as n,an as Na,cT as kl,J as de,j as Ue,K as Kt,a0 as Q,L as Wt,m as ze,n as De,Q as Ne,be as Ha,aq as Re,ar as lt,H as je,V as me,u as Dl,I as Le,au as za,a_ as Bl,aX as Ll,aY as Fl,aZ as Tl,X as Zt,aT as Qa,r as W,al as Mt,bb as cn,b5 as Ja,G as qe,a as Ot,P as J,ak as pn,bf as Ga,Y as ct,p as Xe,S as Ml,a9 as pe,W as ot,R as mn,U as fn,cU as Ka,cV as nl,aQ as Wa,ba as Z,cW as Gt,at as al,cX as pt,ac as mt,cY as Ql,bg as vn,aW as Yt,b0 as ge,bX as Xt,cZ as Ol,am as ue,b9 as yl,bW as et,bc as Pe,c_ as re,c$ as It,d0 as Za,b6 as gn,b8 as yn,d1 as xl,d2 as Ya,d3 as Xa,as as hn,ae as es,d4 as _n,d5 as ts,d6 as ls,d7 as Fe,ad as ns,b as as,q as ss,Z as Jl,ao as tl}from"./index-3194ec9b.js";import{a as ft,y as Qe,z as Ie,A as tt,i as Rl,r as wl,B as os,C as is,b as ul,q as Rt,_ as rs,p as bn,v as ql,g as us,u as ds,c as cs,E as ps,s as Gl,f as Kl,F as ms}from"./TypingIndicator.vue_vue_type_style_index_0_scoped_3f215bd3_lang-a9d0f8af.js";import{d as kn}from"./dayjs-f66c5460.js";import"./LayoutHeader-3eb7ac7a.js";import{u as xn}from"./notification-c72f179e.js";import{u as wn,e as fs,c as vs,a as gs,_ as ys,H as hs,b as _s,d as wt,L as bs}from"./CallUI.vue_vue_type_script_setup_true_lang-c9731fce.js";import{_ as ks}from"./UserAvatar.vue_vue_type_script_setup_true_lang-95965310.js";import{u as jl}from"./telephony-1c011c0c.js";import{u as xs,a as Cn,g as ws,D as qt}from"./Dropdown-c7dd9c29.js";import{_ as Cs}from"./Section-5334216a.js";import{_ as kt}from"./Avatar.vue_vue_type_script_setup_true_lang-1b98856a.js";import{F as $s}from"./FileUploader-0835fb8b.js";import{a as $n}from"./Link-431cfb69.js";import{l as As}from"./lodash-f704bb91.js";import{_ as at}from"./Switch.vue_vue_type_script_setup_true_lang-ad313234.js";import{_ as An,a as Ss,L as Vs}from"./calendar-2cc31a9f.js";import{_ as Bt,D as Is}from"./DateTimePicker-8cacf145.js";import{_ as Es}from"./DateRangePicker.vue_vue_type_script_setup_true_lang-7827f28c.js";import{_ as Ds}from"./StarRating.vue_vue_type_script_setup_true_lang-0c43ad36.js";import{_ as Bs}from"./NestedPopover-37db8746.js";import{u as Sn}from"./ticketStatus-895288f5.js";import{T as Ls}from"./TabButtons-439c1e4c.js";import{u as Fs}from"./useDatePicker-fa7d5592.js";import{L as Vn}from"./mail-34aba9dd.js";import{P as Ts}from"./PhoneIcon-e1a2cab8.js";import{s as Ms}from"./dialogState-245a3a78.js";import"./description-9202ef38.js";import"./portal-4ee54923.js";let Wl=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function Zl(o){var t,l;let s=(t=o.innerText)!=null?t:"",a=o.cloneNode(!0);if(!(a instanceof HTMLElement))return s;let i=!1;for(let p of a.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))p.remove(),i=!0;let u=i?(l=a.innerText)!=null?l:"":s;return Wl.test(u)&&(u=u.replace(Wl,"")),u}function Os(o){let t=o.getAttribute("aria-label");if(typeof t=="string")return t.trim();let l=o.getAttribute("aria-labelledby");if(l){let s=l.split(" ").map(a=>{let i=document.getElementById(a);if(i){let u=i.getAttribute("aria-label");return typeof u=="string"?u.trim():Zl(i).trim()}return null}).filter(Boolean);if(s.length>0)return s.join(", ")}return Zl(o).trim()}function Rs(o){let t=$(""),l=$("");return()=>{let s=Te(o);if(!s)return"";let a=s.innerText;if(t.value===a)return l.value;let i=Os(s).trim().toLowerCase();return t.value=a,l.value=i,i}}var qs=(o=>(o[o.Open=0]="Open",o[o.Closed=1]="Closed",o))(qs||{}),js=(o=>(o[o.Pointer=0]="Pointer",o[o.Other=1]="Other",o))(js||{});function Us(o){requestAnimationFrame(()=>requestAnimationFrame(o))}let In=Symbol("MenuContext");function fl(o){let t=Ke(In,null);if(t===null){let l=new Error(`<${o} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,fl),l}return t}let Ps=j({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(o,{slots:t,attrs:l}){let s=$(1),a=$(null),i=$(null),u=$([]),p=$(""),m=$(null),c=$(1);function f(y=h=>h){let h=m.value!==null?u.value[m.value]:null,g=wa(y(u.value.slice()),S=>Te(S.dataRef.domRef)),b=h?g.indexOf(h):null;return b===-1&&(b=null),{items:g,activeItemIndex:b}}let k={menuState:s,buttonRef:a,itemsRef:i,items:u,searchQuery:p,activeItemIndex:m,activationTrigger:c,closeMenu:()=>{s.value=1,m.value=null},openMenu:()=>s.value=0,goToItem(y,h,g){let b=f(),S=ka(y===Ge.Specific?{focus:Ge.Specific,id:h}:{focus:y},{resolveItems:()=>b.items,resolveActiveIndex:()=>b.activeItemIndex,resolveId:F=>F.id,resolveDisabled:F=>F.dataRef.disabled});p.value="",m.value=S,c.value=g??1,u.value=b.items},search(y){let h=p.value!==""?0:1;p.value+=y.toLowerCase();let g=(m.value!==null?u.value.slice(m.value+h).concat(u.value.slice(0,m.value+h)):u.value).find(S=>S.dataRef.textValue.startsWith(p.value)&&!S.dataRef.disabled),b=g?u.value.indexOf(g):-1;b===-1||b===m.value||(m.value=b,c.value=1)},clearSearch(){p.value=""},registerItem(y,h){let g=f(b=>[...b,{id:y,dataRef:h}]);u.value=g.items,m.value=g.activeItemIndex,c.value=1},unregisterItem(y){let h=f(g=>{let b=g.findIndex(S=>S.id===y);return b!==-1&&g.splice(b,1),g});u.value=h.items,m.value=h.activeItemIndex,c.value=1}};return ca([a,i],(y,h)=>{var g;k.closeMenu(),pa(h,ma.Loose)||(y.preventDefault(),(g=Te(a))==null||g.focus())},N(()=>s.value===0)),Et(In,k),fa(N(()=>va(s.value,{0:il.Open,1:il.Closed}))),()=>{let y={open:s.value===0,close:k.closeMenu};return pl({ourProps:{},theirProps:o,slot:y,slots:t,attrs:l,name:"Menu"})}}}),Ns=j({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(o,{attrs:t,slots:l,expose:s}){var a;let i=(a=o.id)!=null?a:`headlessui-menu-button-${Il()}`,u=fl("MenuButton");s({el:u.buttonRef,$el:u.buttonRef});function p(k){switch(k.key){case Be.Space:case Be.Enter:case Be.ArrowDown:k.preventDefault(),k.stopPropagation(),u.openMenu(),Me(()=>{var y;(y=Te(u.itemsRef))==null||y.focus({preventScroll:!0}),u.goToItem(Ge.First)});break;case Be.ArrowUp:k.preventDefault(),k.stopPropagation(),u.openMenu(),Me(()=>{var y;(y=Te(u.itemsRef))==null||y.focus({preventScroll:!0}),u.goToItem(Ge.Last)});break}}function m(k){switch(k.key){case Be.Space:k.preventDefault();break}}function c(k){o.disabled||(u.menuState.value===0?(u.closeMenu(),Me(()=>{var y;return(y=Te(u.buttonRef))==null?void 0:y.focus({preventScroll:!0})})):(k.preventDefault(),u.openMenu(),Us(()=>{var y;return(y=Te(u.itemsRef))==null?void 0:y.focus({preventScroll:!0})})))}let f=ga(N(()=>({as:o.as,type:t.type})),u.buttonRef);return()=>{var k;let y={open:u.menuState.value===0},{...h}=o,g={ref:u.buttonRef,id:i,type:f.value,"aria-haspopup":"menu","aria-controls":(k=Te(u.itemsRef))==null?void 0:k.id,"aria-expanded":u.menuState.value===0,onKeydown:p,onKeyup:m,onClick:c};return pl({ourProps:g,theirProps:h,slot:y,attrs:t,slots:l,name:"MenuButton"})}}}),Hs=j({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(o,{attrs:t,slots:l,expose:s}){var a;let i=(a=o.id)!=null?a:`headlessui-menu-items-${Il()}`,u=fl("MenuItems"),p=$(null);s({el:u.itemsRef,$el:u.itemsRef}),ya({container:N(()=>Te(u.itemsRef)),enabled:N(()=>u.menuState.value===0),accept(y){return y.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:y.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(y){y.setAttribute("role","none")}});function m(y){var h;switch(p.value&&clearTimeout(p.value),y.key){case Be.Space:if(u.searchQuery.value!=="")return y.preventDefault(),y.stopPropagation(),u.search(y.key);case Be.Enter:if(y.preventDefault(),y.stopPropagation(),u.activeItemIndex.value!==null){let g=u.items.value[u.activeItemIndex.value];(h=Te(g.dataRef.domRef))==null||h.click()}u.closeMenu(),dn(Te(u.buttonRef));break;case Be.ArrowDown:return y.preventDefault(),y.stopPropagation(),u.goToItem(Ge.Next);case Be.ArrowUp:return y.preventDefault(),y.stopPropagation(),u.goToItem(Ge.Previous);case Be.Home:case Be.PageUp:return y.preventDefault(),y.stopPropagation(),u.goToItem(Ge.First);case Be.End:case Be.PageDown:return y.preventDefault(),y.stopPropagation(),u.goToItem(Ge.Last);case Be.Escape:y.preventDefault(),y.stopPropagation(),u.closeMenu(),Me(()=>{var g;return(g=Te(u.buttonRef))==null?void 0:g.focus({preventScroll:!0})});break;case Be.Tab:y.preventDefault(),y.stopPropagation(),u.closeMenu(),Me(()=>xa(Te(u.buttonRef),y.shiftKey?zl.Previous:zl.Next));break;default:y.key.length===1&&(u.search(y.key),p.value=setTimeout(()=>u.clearSearch(),350));break}}function c(y){switch(y.key){case Be.Space:y.preventDefault();break}}let f=ha(),k=N(()=>f!==null?(f.value&il.Open)===il.Open:u.menuState.value===0);return()=>{var y,h;let g={open:u.menuState.value===0},{...b}=o,S={"aria-activedescendant":u.activeItemIndex.value===null||(y=u.items.value[u.activeItemIndex.value])==null?void 0:y.id,"aria-labelledby":(h=Te(u.buttonRef))==null?void 0:h.id,id:i,onKeydown:m,onKeyup:c,role:"menu",tabIndex:0,ref:u.itemsRef};return pl({ourProps:S,theirProps:b,slot:g,attrs:t,slots:l,features:Hl.RenderStrategy|Hl.Static,visible:k.value,name:"MenuItems"})}}}),zs=j({name:"MenuItem",inheritAttrs:!1,props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(o,{slots:t,attrs:l,expose:s}){var a;let i=(a=o.id)!=null?a:`headlessui-menu-item-${Il()}`,u=fl("MenuItem"),p=$(null);s({el:p,$el:p});let m=N(()=>u.activeItemIndex.value!==null?u.items.value[u.activeItemIndex.value].id===i:!1),c=Rs(p),f=N(()=>({disabled:o.disabled,get textValue(){return c()},domRef:p}));be(()=>u.registerItem(i,f)),nt(()=>u.unregisterItem(i)),_a(()=>{u.menuState.value===0&&m.value&&u.activationTrigger.value!==0&&Me(()=>{var F,I;return(I=(F=Te(p))==null?void 0:F.scrollIntoView)==null?void 0:I.call(F,{block:"nearest"})})});function k(F){if(o.disabled)return F.preventDefault();u.closeMenu(),dn(Te(u.buttonRef))}function y(){if(o.disabled)return u.goToItem(Ge.Nothing);u.goToItem(Ge.Specific,i)}let h=ba();function g(F){h.update(F)}function b(F){h.wasMoved(F)&&(o.disabled||m.value||u.goToItem(Ge.Specific,i,0))}function S(F){h.wasMoved(F)&&(o.disabled||m.value&&u.goToItem(Ge.Nothing))}return()=>{let{disabled:F,...I}=o,L={active:m.value,disabled:F,close:u.closeMenu};return pl({ourProps:{id:i,ref:p,role:"menuitem",tabIndex:F===!0?void 0:-1,"aria-disabled":F===!0?!0:void 0,onClick:k,onFocus:y,onPointerenter:g,onMouseenter:g,onPointermove:b,onMousemove:b,onPointerleave:S,onMouseleave:S},theirProps:{...l,...I},slot:L,attrs:l,slots:t,name:"MenuItem"})}}});function Yl(o){return typeof o=="string"?`'${o}'`:new Qs().serialize(o)}const Qs=function(){var t;class o{constructor(){Nl(this,t,new Map)}compare(s,a){const i=typeof s,u=typeof a;return i==="string"&&u==="string"?s.localeCompare(a):i==="number"&&u==="number"?s-a:String.prototype.localeCompare.call(this.serialize(s,!0),this.serialize(a,!0))}serialize(s,a){if(s===null)return"null";switch(typeof s){case"string":return a?s:`'${s}'`;case"bigint":return`${s}n`;case"object":return this.$object(s);case"function":return this.$function(s)}return String(s)}serializeObject(s){const a=Object.prototype.toString.call(s);if(a!=="[object Object]")return this.serializeBuiltInType(a.length<10?`unknown:${a}`:a.slice(8,-1),s);const i=s.constructor,u=i===Object||i===void 0?"":i.name;if(u!==""&&globalThis[u]===i)return this.serializeBuiltInType(u,s);if(typeof s.toJSON=="function"){const p=s.toJSON();return u+(p!==null&&typeof p=="object"?this.$object(p):`(${this.serialize(p)})`)}return this.serializeObjectEntries(u,Object.entries(s))}serializeBuiltInType(s,a){const i=this["$"+s];if(i)return i.call(this,a);if(typeof(a==null?void 0:a.entries)=="function")return this.serializeObjectEntries(s,a.entries());throw new Error(`Cannot serialize ${s}`)}serializeObjectEntries(s,a){const i=Array.from(a).sort((p,m)=>this.compare(p[0],m[0]));let u=`${s}{`;for(let p=0;p<i.length;p++){const[m,c]=i[p];u+=`${this.serialize(m,!0)}:${this.serialize(c)}`,p<i.length-1&&(u+=",")}return u+"}"}$object(s){let a=Pt(this,t).get(s);return a===void 0&&(Pt(this,t).set(s,`#${Pt(this,t).size}`),a=this.serializeObject(s),Pt(this,t).set(s,a)),a}$function(s){const a=Function.prototype.toString.call(s);return a.slice(-15)==="[native code] }"?`${s.name||""}()[native]`:`${s.name}(${s.length})${a.replace(/\s*\n\s*/g,"")}`}$Array(s){let a="[";for(let i=0;i<s.length;i++)a+=this.serialize(s[i]),i<s.length-1&&(a+=",");return a+"]"}$Date(s){try{return`Date(${s.toISOString()})`}catch{return"Date(null)"}}$ArrayBuffer(s){return`ArrayBuffer[${new Uint8Array(s).join(",")}]`}$Set(s){return`Set${this.$Array(Array.from(s).sort((a,i)=>this.compare(a,i)))}`}$Map(s){return this.serializeObjectEntries("Map",s.entries())}}t=new WeakMap;for(const l of["Error","RegExp","URL"])o.prototype["$"+l]=function(s){return`${l}(${s})`};for(const l of["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"])o.prototype["$"+l]=function(s){return`${l}[${s.join(",")}]`};for(const l of["BigInt64Array","BigUint64Array"])o.prototype["$"+l]=function(s){return`${l}[${s.join("n,")}${s.length>0?"n":""}]`};return o}();function Cl(o,t){return o===t||Yl(o)===Yl(t)}function Js(o,t,l){const s=o.findIndex(p=>Cl(p,t)),a=o.findIndex(p=>Cl(p,l));if(s===-1||a===-1)return[];const[i,u]=[s,a].sort((p,m)=>p-m);return o.slice(i,u+1)}function Gs(o){const t=N(()=>e(o)),l=N(()=>new Intl.Collator("en",{usage:"search",...t.value}));return{startsWith:(u,p)=>p.length===0?!0:(u=u.normalize("NFC"),p=p.normalize("NFC"),l.value.compare(u.slice(0,p.length),p)===0),endsWith:(u,p)=>p.length===0?!0:(u=u.normalize("NFC"),p=p.normalize("NFC"),l.value.compare(u.slice(-p.length),p)===0),contains:(u,p)=>{if(p.length===0)return!0;u=u.normalize("NFC"),p=p.normalize("NFC");let m=0;const c=p.length;for(;m+c<=u.length;m++){const f=u.slice(m,m+c);if(l.value.compare(p,f)===0)return!0}return!1}}}function Ks(o){return N(()=>{var t;return Ca(o)?!!((t=$a(o))!=null&&t.closest("form")):!0})}function Ws(){return{ALT:"Alt",ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",BACKSPACE:"Backspace",CAPS_LOCK:"CapsLock",CONTROL:"Control",DELETE:"Delete",END:"End",ENTER:"Enter",ESCAPE:"Escape",F1:"F1",F10:"F10",F11:"F11",F12:"F12",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",HOME:"Home",META:"Meta",PAGE_DOWN:"PageDown",PAGE_UP:"PageUp",SHIFT:"Shift",SPACE:" ",TAB:"Tab",CTRL:"Control",ASTERISK:"*",SPACE_CODE:"Space"}}var Zs=j({inheritAttrs:!1,__name:"VisuallyHiddenInputBubble",props:{name:{type:String,required:!0},value:{type:null,required:!0},checked:{type:Boolean,required:!1,default:void 0},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},feature:{type:String,required:!1,default:"fully-hidden"}},setup(o){const t=o,{primitiveElement:l,currentElement:s}=Lt(),a=N(()=>t.checked??t.value);return ve(a,(i,u)=>{if(!s.value)return;const p=s.value,m=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(m,"value").set;if(f&&i!==u){const k=new Event("input",{bubbles:!0}),y=new Event("change",{bubbles:!0});f.call(p,i),p.dispatchEvent(k),p.dispatchEvent(y)}}),(i,u)=>(r(),E(Aa,ye({ref_key:"primitiveElement",ref:l},{...t,...i.$attrs},{as:"input"}),null,16))}}),Xl=Zs,Ys=j({inheritAttrs:!1,__name:"VisuallyHiddenInput",props:{name:{type:String,required:!0},value:{type:null,required:!0},checked:{type:Boolean,required:!1,default:void 0},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},feature:{type:String,required:!1,default:"fully-hidden"}},setup(o){const t=o,l=N(()=>typeof t.value=="object"&&Array.isArray(t.value)&&t.value.length===0&&t.required),s=N(()=>typeof t.value=="string"||typeof t.value=="number"||typeof t.value=="boolean"||t.value===null||t.value===void 0?[{name:t.name,value:t.value}]:typeof t.value=="object"&&Array.isArray(t.value)?t.value.flatMap((a,i)=>typeof a=="object"?Object.entries(a).map(([u,p])=>({name:`${t.name}[${i}][${u}]`,value:p})):{name:`${t.name}[${i}]`,value:a}):t.value!==null&&typeof t.value=="object"&&!Array.isArray(t.value)?Object.entries(t.value).map(([a,i])=>({name:`${t.name}[${a}]`,value:i})):[]);return(a,i)=>(r(),v(O,null,[A(" We render single input if it's required "),l.value?(r(),E(Xl,ye({key:a.name},{...t,...a.$attrs},{name:a.name,value:a.value}),null,16,["name","value"])):(r(!0),v(O,{key:1},G(s.value,u=>(r(),E(Xl,ye({key:u.name},{ref_for:!0},{...t,...a.$attrs},{name:u.name,value:u.value}),null,16,["name","value"]))),128))],2112))}}),Xs=Ys,eo=j({__name:"ComboboxAnchor",props:{reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(o){const{forwardRef:t}=dt();return(l,s)=>(r(),E(e(Sa),{"as-child":"",reference:l.reference},{default:C(()=>[d(e(He),ye({ref:e(t),"as-child":l.asChild,as:l.as},l.$attrs),{default:C(()=>[ae(l.$slots,"default")]),_:3},16,["as-child","as"])]),_:3},8,["reference"]))}}),to=eo;function lo(o,t,l){return o===void 0?!1:Array.isArray(o)?o.some(s=>Ht(s,t,l)):Ht(o,t,l)}function Ht(o,t,l){return o===void 0||t===void 0?!1:typeof o=="string"?o===t:typeof l=="function"?l(o,t):typeof l=="string"?(o==null?void 0:o[l])===(t==null?void 0:t[l]):Cl(o,t)}const[vl,no]=Ft("ListboxRoot");var ao=j({__name:"ListboxRoot",props:{modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},multiple:{type:Boolean,required:!1},orientation:{type:String,required:!1,default:"vertical"},dir:{type:String,required:!1},disabled:{type:Boolean,required:!1},selectionBehavior:{type:String,required:!1,default:"toggle"},highlightOnHover:{type:Boolean,required:!1},by:{type:[String,Function],required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue","highlight","entryFocus","leave"],setup(o,{expose:t,emit:l}){const s=o,a=l,{multiple:i,highlightOnHover:u,orientation:p,disabled:m,selectionBehavior:c,dir:f}=ml(s),{getItems:k}=El({isProvider:!0}),{handleTypeaheadSearch:y}=xs(),{primitiveElement:h,currentElement:g}=Lt(),b=Ws(),S=Cn(f),F=Ks(g),I=$(),L=$(!1),_=$(!0),x=Jt(s,"modelValue",a,{defaultValue:s.defaultValue??(i.value?[]:void 0),passive:s.modelValue===void 0,deep:!0});function V(K){if(L.value=!0,s.multiple){const ne=Array.isArray(x.value)?[...x.value]:[],se=ne.findIndex(ke=>Ht(ke,K,s.by));s.selectionBehavior==="toggle"?(se===-1?ne.push(K):ne.splice(se,1),x.value=ne):(x.value=[K],I.value=K)}else s.selectionBehavior==="toggle"&&Ht(x.value,K,s.by)?x.value=void 0:x.value=K;setTimeout(()=>{L.value=!1},1)}const w=$(null),B=$(null),M=$(!1),q=$(!1),U=ll(),P=ll(),T=ll();function Y(){return k().map(K=>K.ref).filter(K=>K.dataset.disabled!=="")}function X(K,ne=!0){if(!K)return;w.value=K,_.value&&w.value.focus(),ne&&w.value.scrollIntoView({block:"nearest"});const se=k().find(ke=>ke.ref===K);a("highlight",se)}function rt(K){if(M.value)T.trigger(K);else{const ne=k().find(se=>Ht(se.value,K,s.by));ne&&(w.value=ne.ref,X(ne.ref))}}function oe(K){w.value&&w.value.isConnected&&(K.preventDefault(),K.stopPropagation(),q.value||w.value.click())}function Se(K){if(_.value){if(L.value=!0,M.value)P.trigger(K);else{const ne=K.altKey||K.ctrlKey||K.metaKey;if(ne&&K.key==="a"&&i.value){const se=k(),ke=se.map(st=>st.value);x.value=[...ke],K.preventDefault(),X(se[se.length-1].ref)}else if(!ne){const se=y(K.key,k());se&&X(se)}}setTimeout(()=>{L.value=!1},1)}}function Ve(){q.value=!0}function xt(){Me(()=>{q.value=!1})}function ce(){Me(()=>{const K=new KeyboardEvent("keydown",{key:"PageUp"});gt(K)})}function le(K){const ne=w.value;ne!=null&&ne.isConnected&&(B.value=ne),w.value=null,a("leave",K)}function Ze(K){var se,ke;const ne=new CustomEvent("listbox.entryFocus",{bubbles:!1,cancelable:!0});if((se=K.currentTarget)==null||se.dispatchEvent(ne),a("entryFocus",ne),!ne.defaultPrevented)if(B.value)X(B.value);else{const st=(ke=Y())==null?void 0:ke[0];X(st)}}function gt(K){const ne=ws(K,p.value,S.value);if(!ne)return;let se=Y();if(w.value){if(ne==="last")se.reverse();else if(ne==="prev"||ne==="next"){ne==="prev"&&se.reverse();const ke=se.indexOf(w.value);se=se.slice(ke+1)}fe(K,se[0])}if(se.length){const ke=!w.value&&ne==="prev"?se.length-1:0;X(se[ke])}if(M.value)return P.trigger(K)}function fe(K,ne){var ke;if(!(M.value||s.selectionBehavior!=="replace"||!i.value||!Array.isArray(x.value)||(K.altKey||K.ctrlKey||K.metaKey)&&!K.shiftKey)&&K.shiftKey){const st=k().filter(Ut=>Ut.ref.dataset.disabled!=="");let el=(ke=st.find(Ut=>Ut.ref===ne))==null?void 0:ke.value;if(K.key===b.END?el=st[st.length-1].value:K.key===b.HOME&&(el=st[0].value),!el||!I.value)return;const ua=Js(st.map(Ut=>Ut.value),I.value,el);x.value=ua}}async function jt(K){if(await Me(),M.value)U.trigger(K);else{const ne=Y(),se=ne.find(ke=>ke.dataset.state==="checked");se?X(se):ne.length&&X(ne[0])}}return ve(x,()=>{L.value||Me(()=>{jt()})},{immediate:!0,deep:!0}),t({highlightedElement:w,highlightItem:rt,highlightFirstItem:ce,highlightSelected:jt,getItems:k}),no({modelValue:x,onValueChange:V,multiple:i,orientation:p,dir:S,disabled:m,highlightOnHover:u,highlightedElement:w,isVirtual:M,virtualFocusHook:U,virtualKeydownHook:P,virtualHighlightHook:T,by:s.by,firstValue:I,selectionBehavior:c,focusable:_,onLeave:le,onEnter:Ze,changeHighlight:X,onKeydownEnter:oe,onKeydownNavigation:gt,onKeydownTypeAhead:Se,onCompositionStart:Ve,onCompositionEnd:xt,highlightFirstItem:ce}),(K,ne)=>(r(),E(e(He),{ref_key:"primitiveElement",ref:h,as:K.as,"as-child":K.asChild,dir:e(S),"data-disabled":e(m)?"":void 0,onPointerleave:le,onFocusout:ne[0]||(ne[0]=async se=>{const ke=se.relatedTarget||se.target;await Me(),w.value&&e(g)&&!e(g).contains(ke)&&le(se)})},{default:C(()=>[ae(K.$slots,"default",{modelValue:e(x)}),e(F)&&K.name?(r(),E(e(Xs),{key:0,name:K.name,value:e(x),disabled:e(m),required:K.required},null,8,["name","value","disabled","required"])):A("v-if",!0)]),_:3},8,["as","as-child","dir","data-disabled"]))}}),so=ao,oo=j({__name:"ListboxContent",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(o){const{CollectionSlot:t}=El(),l=vl(),s=Va(!1,10);return(a,i)=>(r(),E(e(t),null,{default:C(()=>[d(e(He),{role:"listbox",as:a.as,"as-child":a.asChild,tabindex:e(l).focusable.value?e(l).highlightedElement.value?"-1":"0":void 0,"aria-orientation":e(l).orientation.value,"aria-multiselectable":!!e(l).multiple.value,"data-orientation":e(l).orientation.value,onMousedown:i[0]||(i[0]=he(u=>s.value=!0,["left"])),onFocus:i[1]||(i[1]=u=>{e(s)||e(l).onEnter(u)}),onKeydown:[i[2]||(i[2]=Ye(he(u=>{e(l).focusable.value&&e(l).onKeydownNavigation(u)},["prevent"]),["down","up","left","right","home","end"])),Ye(e(l).onKeydownEnter,["enter"]),e(l).onKeydownTypeAhead]},{default:C(()=>[ae(a.$slots,"default")]),_:3},8,["as","as-child","tabindex","aria-orientation","aria-multiselectable","data-orientation","onKeydown"])]),_:3}))}}),io=oo,ro=j({__name:"ListboxFilter",props:{modelValue:{type:String,required:!1},autoFocus:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"input"}},emits:["update:modelValue"],setup(o,{emit:t}){const l=o,a=Jt(l,"modelValue",t,{defaultValue:"",passive:l.modelValue===void 0}),i=vl(),{primitiveElement:u,currentElement:p}=Lt(),m=N(()=>l.disabled||i.disabled.value||!1),c=$();return Ia(()=>{var f;return c.value=(f=i.highlightedElement.value)==null?void 0:f.id}),be(()=>{i.focusable.value=!1,setTimeout(()=>{var f;l.autoFocus&&((f=p.value)==null||f.focus())},1)}),nt(()=>{i.focusable.value=!0}),(f,k)=>(r(),E(e(He),{ref_key:"primitiveElement",ref:u,as:f.as,"as-child":f.asChild,value:e(a),disabled:m.value?"":void 0,"data-disabled":m.value?"":void 0,"aria-disabled":m.value??void 0,"aria-activedescendant":c.value,type:"text",onKeydown:[Ye(he(e(i).onKeydownNavigation,["prevent"]),["down","up","home","end"]),Ye(e(i).onKeydownEnter,["enter"])],onInput:k[0]||(k[0]=y=>{a.value=y.target.value,e(i).highlightFirstItem()}),onCompositionstart:e(i).onCompositionStart,onCompositionend:e(i).onCompositionEnd},{default:C(()=>[ae(f.$slots,"default",{modelValue:e(a)})]),_:3},8,["as","as-child","value","disabled","data-disabled","aria-disabled","aria-activedescendant","onKeydown","onCompositionstart","onCompositionend"]))}}),uo=ro;const[ub,co]=Ft("ListboxGroup");var po=j({__name:"ListboxGroup",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(o){const t=o,l=Tt(void 0,"reka-listbox-group");return co({id:l}),(s,a)=>(r(),E(e(He),ye({role:"group"},t,{"aria-labelledby":e(l)}),{default:C(()=>[ae(s.$slots,"default")]),_:3},16,["aria-labelledby"]))}}),mo=po;const fo="listbox.select",[vo,go]=Ft("ListboxItem");var yo=j({__name:"ListboxItem",props:{value:{type:null,required:!0},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"div"}},emits:["select"],setup(o,{emit:t}){const l=o,s=t,a=Tt(void 0,"reka-listbox-item"),{CollectionItem:i}=El(),{forwardRef:u,currentElement:p}=dt(),m=vl(),c=N(()=>p.value===m.highlightedElement.value),f=N(()=>lo(m.modelValue.value,l.value,m.by)),k=N(()=>m.disabled.value||l.disabled);async function y(g){s("select",g),!(g!=null&&g.defaultPrevented)&&!k.value&&g&&(m.onValueChange(l.value),m.changeHighlight(p.value))}function h(g){const b={originalEvent:g,value:l.value};Da(fo,y,b)}return go({isSelected:f}),(g,b)=>(r(),E(e(i),{value:g.value},{default:C(()=>[Ea([c.value,f.value],()=>d(e(He),ye({id:e(a)},g.$attrs,{ref:e(u),role:"option",tabindex:e(m).focusable.value?c.value?"0":"-1":-1,"aria-selected":f.value,as:g.as,"as-child":g.asChild,disabled:k.value?"":void 0,"data-disabled":k.value?"":void 0,"data-highlighted":c.value?"":void 0,"data-state":f.value?"checked":"unchecked",onClick:h,onKeydown:Ye(he(h,["prevent"]),["space"]),onPointermove:b[0]||(b[0]=S=>{e(m).highlightedElement.value!==e(p)&&(e(m).highlightOnHover.value?e(m).changeHighlight(e(p),!1):e(m).focusable.value||e(m).changeHighlight(e(p),!1))})}),{default:C(()=>[ae(g.$slots,"default")]),_:3},16,["id","tabindex","aria-selected","as","as-child","disabled","data-disabled","data-highlighted","data-state","onKeydown"]),b,1)]),_:3},8,["value"]))}}),ho=yo,_o=j({__name:"ListboxItemIndicator",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(o){const t=o;dt();const l=vo();return(s,a)=>e(l).isSelected.value?(r(),E(e(He),ye({key:0,"aria-hidden":"true"},t),{default:C(()=>[ae(s.$slots,"default")]),_:3},16)):A("v-if",!0)}}),bo=_o;const[vt,ko]=Ft("ComboboxRoot");var xo=j({__name:"ComboboxRoot",props:{open:{type:Boolean,required:!1,default:void 0},defaultOpen:{type:Boolean,required:!1},resetSearchTermOnBlur:{type:Boolean,required:!1,default:!0},resetSearchTermOnSelect:{type:Boolean,required:!1,default:!0},openOnFocus:{type:Boolean,required:!1,default:!1},openOnClick:{type:Boolean,required:!1,default:!1},ignoreFilter:{type:Boolean,required:!1},modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},multiple:{type:Boolean,required:!1},dir:{type:String,required:!1},disabled:{type:Boolean,required:!1},highlightOnHover:{type:Boolean,required:!1},by:{type:[String,Function],required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue","highlight","update:open"],setup(o,{expose:t,emit:l}){var Y,X,rt;const s=o,a=l,{primitiveElement:i,currentElement:u}=Lt(),{multiple:p,disabled:m,ignoreFilter:c,resetSearchTermOnSelect:f,openOnFocus:k,openOnClick:y,dir:h}=ml(s),g=Cn(h),b=Jt(s,"modelValue",a,{defaultValue:s.defaultValue??(p.value?[]:void 0),passive:s.modelValue===void 0,deep:!0}),S=Jt(s,"open",a,{defaultValue:s.defaultOpen,passive:s.open===void 0});async function F(oe){var Se,Ve;S.value=oe,U.value="",oe?(await Me(),(Se=i.value)==null||Se.highlightSelected(),L.value=!0):L.value=!1,(Ve=x.value)==null||Ve.focus(),setTimeout(()=>{!oe&&s.resetSearchTermOnBlur&&I.trigger()},1)}const I=ll(),L=$(!1),_=$(!1),x=$(),V=$(),w=N(()=>{var oe;return((oe=i.value)==null?void 0:oe.highlightedElement)??void 0}),B=$(new Map),M=$(new Map),{contains:q}=Gs({sensitivity:"base"}),U=$(""),P=N(oe=>{if(!U.value||s.ignoreFilter||_.value)return{count:B.value.size,items:(oe==null?void 0:oe.items)??new Map,groups:(oe==null?void 0:oe.groups)??new Set(M.value.keys())};let Se=0;const Ve=new Map,xt=new Set;for(const[ce,le]of B.value){const Ze=q(le,U.value);Ve.set(ce,Ze?1:0),Ze&&Se++}for(const[ce,le]of M.value)for(const Ze of le)if(Ve.get(Ze)>0){xt.add(ce);break}return{count:Se,items:Ve,groups:xt}}),T=La();return be(()=>{var oe,Se,Ve;T!=null&&T.exposed&&(T.exposed.highlightItem=(oe=i.value)==null?void 0:oe.highlightItem,T.exposed.highlightFirstItem=(Se=i.value)==null?void 0:Se.highlightFirstItem,T.exposed.highlightSelected=(Ve=i.value)==null?void 0:Ve.highlightSelected)}),t({filtered:P,highlightedElement:w,highlightItem:(Y=i.value)==null?void 0:Y.highlightItem,highlightFirstItem:(X=i.value)==null?void 0:X.highlightFirstItem,highlightSelected:(rt=i.value)==null?void 0:rt.highlightSelected}),ko({modelValue:b,multiple:p,disabled:m,open:S,onOpenChange:F,contentId:"",isUserInputted:L,isVirtual:_,inputElement:x,highlightedElement:w,onInputElementChange:oe=>x.value=oe,triggerElement:V,onTriggerElementChange:oe=>V.value=oe,parentElement:u,resetSearchTermOnSelect:f,onResetSearchTerm:I.on,allItems:B,allGroups:M,filterSearch:U,filterState:P,ignoreFilter:c,openOnFocus:k,openOnClick:y}),(oe,Se)=>(r(),E(e(Ba),null,{default:C(()=>[d(e(so),ye({ref_key:"primitiveElement",ref:i},oe.$attrs,{modelValue:e(b),"onUpdate:modelValue":Se[0]||(Se[0]=Ve=>ut(b)?b.value=Ve:null),style:{pointerEvents:e(S)?"auto":void 0},as:oe.as,"as-child":oe.asChild,dir:e(g),multiple:e(p),name:oe.name,required:oe.required,disabled:e(m),"highlight-on-hover":!0,by:s.by,onHighlight:Se[1]||(Se[1]=Ve=>a("highlight",Ve))}),{default:C(()=>[ae(oe.$slots,"default",{open:e(S),modelValue:e(b)})]),_:3},16,["modelValue","style","as","as-child","dir","multiple","name","required","disabled","by"])]),_:3}))}}),wo=xo;const[db,Co]=Ft("ComboboxContent");var $o=j({__name:"ComboboxContentImpl",props:{position:{type:String,required:!1,default:"inline"},bodyLock:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside"],setup(o,{emit:t}){const l=o,s=t,{position:a}=ml(l),i=vt(),{forwardRef:u,currentElement:p}=dt();Fa(l.bodyLock),Ta(i.parentElement);const m=N(()=>l.position==="popper"?l:{}),c=Ma(m.value),f={boxSizing:"border-box","--reka-combobox-content-transform-origin":"var(--reka-popper-transform-origin)","--reka-combobox-content-available-width":"var(--reka-popper-available-width)","--reka-combobox-content-available-height":"var(--reka-popper-available-height)","--reka-combobox-trigger-width":"var(--reka-popper-anchor-width)","--reka-combobox-trigger-height":"var(--reka-popper-anchor-height)"};Co({position:a});const k=$(!1);return be(()=>{i.inputElement.value&&(k.value=p.value.contains(i.inputElement.value),k.value&&i.inputElement.value.focus())}),nt(()=>{var y;k.value&&((y=i.triggerElement.value)==null||y.focus())}),(y,h)=>(r(),E(e(io),{"as-child":""},{default:C(()=>[d(e(Oa),{"as-child":"","disable-outside-pointer-events":y.disableOutsidePointerEvents,onDismiss:h[0]||(h[0]=g=>e(i).onOpenChange(!1)),onFocusOutside:h[1]||(h[1]=g=>{var b;(b=e(i).parentElement.value)!=null&&b.contains(g.target)&&g.preventDefault(),s("focusOutside",g)}),onInteractOutside:h[2]||(h[2]=g=>s("interactOutside",g)),onEscapeKeyDown:h[3]||(h[3]=g=>s("escapeKeyDown",g)),onPointerDownOutside:h[4]||(h[4]=g=>{var b;(b=e(i).parentElement.value)!=null&&b.contains(g.target)&&g.preventDefault(),s("pointerDownOutside",g)})},{default:C(()=>[(r(),E(Oe(e(a)==="popper"?e(Ra):e(He)),ye({...y.$attrs,...e(c)},{id:e(i).contentId,ref:e(u),"data-state":e(i).open.value?"open":"closed",style:{display:"flex",flexDirection:"column",outline:"none",...e(a)==="popper"?f:{}}}),{default:C(()=>[ae(y.$slots,"default")]),_:3},16,["id","data-state","style"]))]),_:3},8,["disable-outside-pointer-events"])]),_:3}))}}),Ao=$o,So=j({__name:"ComboboxContent",props:{forceMount:{type:Boolean,required:!1},position:{type:String,required:!1},bodyLock:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside"],setup(o,{emit:t}){const a=qa(o,t),{forwardRef:i}=dt(),u=vt();return u.contentId||(u.contentId=Tt(void 0,"reka-combobox-content")),(p,m)=>(r(),E(e(ja),{present:p.forceMount||e(u).open.value},{default:C(()=>[d(Ao,ye({...e(a),...p.$attrs},{ref:e(i)}),{default:C(()=>[ae(p.$slots,"default")]),_:3},16)]),_:3},8,["present"]))}}),Vo=So,Io=j({__name:"ComboboxEmpty",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(o){const t=o,l=vt(),s=N(()=>l.ignoreFilter.value?l.allItems.value.size===0:l.filterState.value.count===0);return(a,i)=>s.value?(r(),E(e(He),Dt(ye({key:0},t)),{default:C(()=>[ae(a.$slots,"default",{},()=>[i[0]||(i[0]=te("No options"))])]),_:3},16)):A("v-if",!0)}}),Eo=Io;const[En,Do]=Ft("ComboboxGroup");var Bo=j({__name:"ComboboxGroup",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(o){const t=o,l=Tt(void 0,"reka-combobox-group"),s=vt(),a=N(()=>s.ignoreFilter.value?!0:s.filterSearch.value?s.filterState.value.groups.has(l):!0),i=Do({id:l,labelId:""});return be(()=>{s.allGroups.value.has(l)||s.allGroups.value.set(l,new Set)}),nt(()=>{s.allGroups.value.delete(l)}),(u,p)=>(r(),E(e(mo),ye({id:e(l),"aria-labelledby":e(i).labelId},t,{hidden:a.value?void 0:!0}),{default:C(()=>[ae(u.$slots,"default")]),_:3},16,["id","aria-labelledby","hidden"]))}}),Lo=Bo,Fo=j({__name:"ComboboxInput",props:{displayValue:{type:Function,required:!1},modelValue:{type:String,required:!1},autoFocus:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"input"}},emits:["update:modelValue"],setup(o,{emit:t}){const l=o,s=t,a=vt(),i=vl(),{primitiveElement:u,currentElement:p}=Lt(),m=Jt(l,"modelValue",s,{passive:l.modelValue===void 0});be(()=>{p.value&&a.onInputElementChange(p.value)});function c(g){a.open.value||a.onOpenChange(!0)}function f(g){const b=g.target;a.open.value?a.filterSearch.value=b.value:(a.onOpenChange(!0),Me(()=>{b.value&&(a.filterSearch.value=b.value,i.highlightFirstItem())}))}function k(){a.openOnFocus.value&&!a.open.value&&a.onOpenChange(!0)}function y(){a.openOnClick.value&&!a.open.value&&a.onOpenChange(!0)}function h(){const g=a.modelValue.value;l.displayValue?m.value=l.displayValue(g):!a.multiple.value&&g&&!Array.isArray(g)&&typeof g!="object"?m.value=g.toString():m.value="",Me(()=>{m.value=m.value})}return a.onResetSearchTerm(()=>{h()}),ve(a.modelValue,async()=>{!a.isUserInputted.value&&a.resetSearchTermOnSelect.value&&h()},{immediate:!0,deep:!0}),ve(a.filterState,()=>{a.isVirtual.value||i.highlightFirstItem()}),(g,b)=>(r(),E(e(uo),{ref_key:"primitiveElement",ref:u,modelValue:e(m),"onUpdate:modelValue":b[0]||(b[0]=S=>ut(m)?m.value=S:null),as:g.as,"as-child":g.asChild,"auto-focus":g.autoFocus,disabled:g.disabled,"aria-expanded":e(a).open.value,"aria-controls":e(a).contentId,"aria-autocomplete":"list",role:"combobox",autocomplete:"off",onClick:y,onInput:f,onKeydown:Ye(he(c,["prevent"]),["down","up"]),onFocus:k},{default:C(()=>[ae(g.$slots,"default")]),_:3},8,["modelValue","as","as-child","auto-focus","disabled","aria-expanded","aria-controls","onKeydown"]))}}),To=Fo,Mo=j({__name:"ComboboxItem",props:{textValue:{type:String,required:!1},value:{type:null,required:!0},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["select"],setup(o,{emit:t}){const l=o,s=t,a=Tt(void 0,"reka-combobox-item"),i=vt(),u=En(null),{primitiveElement:p,currentElement:m}=Lt();if(l.value==="")throw new Error("A <ComboboxItem /> must have a value prop that is not an empty string. This is because the Combobox value can be set to an empty string to clear the selection and show the placeholder.");const c=N(()=>{if(i.isVirtual.value||i.ignoreFilter.value||!i.filterSearch.value)return!0;{const f=i.filterState.value.items.get(a);return f===void 0?!0:f>0}});return be(()=>{var k;i.allItems.value.set(a,l.textValue||m.value.textContent||m.value.innerText);const f=u==null?void 0:u.id;f&&(i.allGroups.value.has(f)?(k=i.allGroups.value.get(f))==null||k.add(a):i.allGroups.value.set(f,new Set([a])))}),nt(()=>{i.allItems.value.delete(a)}),(f,k)=>c.value?(r(),E(e(ho),ye({key:0},l,{id:e(a),ref_key:"primitiveElement",ref:p,disabled:e(i).disabled.value||f.disabled,onSelect:k[0]||(k[0]=y=>{s("select",y),!y.defaultPrevented&&!e(i).multiple.value&&!f.disabled&&!e(i).disabled.value&&(y.preventDefault(),e(i).onOpenChange(!1),e(i).modelValue.value=l.value)})}),{default:C(()=>[ae(f.$slots,"default",{},()=>[te(D(f.value),1)])]),_:3},16,["id","disabled"])):A("v-if",!0)}}),en=Mo,Oo=j({__name:"ComboboxItemIndicator",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(o){const t=o;return(l,s)=>(r(),E(e(bo),Dt(rl(t)),{default:C(()=>[ae(l.$slots,"default")]),_:3},16))}}),tn=Oo,Ro=j({__name:"ComboboxLabel",props:{for:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"div"}},setup(o){const t=o;dt();const l=En({id:"",labelId:""});return l.labelId||(l.labelId=Tt(void 0,"reka-combobox-group-label")),(s,a)=>(r(),E(e(He),ye(t,{id:e(l).labelId}),{default:C(()=>[ae(s.$slots,"default")]),_:3},16,["id"]))}}),qo=Ro,jo=j({__name:"ComboboxPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(o){const t=o;return(l,s)=>(r(),E(e(Ua),Dt(rl(t)),{default:C(()=>[ae(l.$slots,"default")]),_:3},16))}}),Uo=jo,Po=j({__name:"ComboboxTrigger",props:{disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(o){const t=o,{forwardRef:l,currentElement:s}=dt(),a=vt(),i=N(()=>t.disabled||a.disabled.value||!1);return be(()=>{s.value&&a.onTriggerElementChange(s.value)}),(u,p)=>(r(),E(e(He),ye(t,{ref:e(l),type:u.as==="button"?"button":void 0,tabindex:"-1","aria-label":"Show popup","aria-haspopup":"listbox","aria-expanded":e(a).open.value,"aria-controls":e(a).contentId,"data-state":e(a).open.value?"open":"closed",disabled:i.value,"data-disabled":i.value?"":void 0,"aria-disabled":i.value??void 0,onClick:p[0]||(p[0]=m=>e(a).onOpenChange(!e(a).open.value))}),{default:C(()=>[ae(u.$slots,"default")]),_:3},16,["type","aria-expanded","aria-controls","data-state","disabled","data-disabled","aria-disabled"]))}}),No=Po;function Ho(o){const t=Pa({nonce:$()});return N(()=>{var l;return(o==null?void 0:o.value)||((l=t.nonce)==null?void 0:l.value)})}var zo=j({__name:"ComboboxViewport",props:{nonce:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(o){const t=o,{forwardRef:l}=dt(),{nonce:s}=ml(t),a=Ho(s),i=vt();return(u,p)=>(r(),v(O,null,[d(e(He),ye({...u.$attrs,...t},{ref:e(l),"data-reka-combobox-viewport":"",role:"presentation",style:{position:"relative",flex:e(i).isVirtual.value?void 0:1,overflow:"auto"}}),{default:C(()=>[ae(u.$slots,"default")]),_:3},16,["style"]),d(e(He),{as:"style",nonce:e(a)},{default:C(()=>p[0]||(p[0]=[te(" /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-reka-combobox-viewport] { scrollbar-width:none; -ms-overflow-style: none; -webkit-overflow-scrolling: touch; } [data-reka-combobox-viewport]::-webkit-scrollbar { display: none; } ")])),_:1,__:[0]},8,["nonce"])],64))}}),Qo=zo;const Jo={class:"relative"},Go={class:"flex items-center gap-2 flex-1 overflow-hidden"},Ko={class:"flex items-center gap-2 pr-6 flex-1"},Wo={class:"flex items-center gap-2 pr-6 flex-1"},ln=j({__name:"Combobox",props:{options:{},modelValue:{},placeholder:{},disabled:{type:Boolean}},emits:["update:modelValue","update:selectedOption","focus","blur"],setup(o,{emit:t}){const l=o,s=t,a=$(b(l.modelValue)),i=$(l.modelValue),u=$(!1),p=$(!1);ve(()=>l.modelValue,M=>{i.value=M,a.value=b(M)});const m=M=>{i.value=M,s("update:modelValue",M),a.value=b(M),p.value=!1;const q=M&&g.value.find(U=>k(U)===M)||null;s("update:selectedOption",q)};function c(M){return typeof M=="object"&&"group"in M}function f(M){return typeof M=="string"?M:M.label}function k(M){return typeof M=="string"?M:M.value}function y(M){return typeof M=="object"&&!!M.disabled}function h(M){return typeof M=="object"?M.icon:void 0}const g=N(()=>{const M=[];return l.options.forEach(q=>{c(q)?M.push(...q.options):M.push(q)}),M});function b(M){if(!M)return"";const U=l.options.flatMap(P=>c(P)?P.options:P).find(P=>k(P)===M);return U?f(U):M||""}const S=N(()=>i.value?g.value.find(M=>k(M)===i.value):null),F=N(()=>S.value?h(S.value):void 0),I=M=>{if(!M.icon)return null;const q=typeof M.icon=="string"?de("span",M.icon):de(M.icon,{class:"w-4 h-4"});return de("span",{class:"flex-shrink-0 w-4 h-4 inline-flex items-center justify-center"},[q])},L=(M,q)=>{if(!q)return M;const U=q.toLowerCase(),P=[];return M.forEach(T=>{if(c(T)){const Y=T.options.filter(X=>{const rt=f(X).toLowerCase(),oe=k(X).toLowerCase();return rt.includes(U)||oe.includes(U)});Y.length>0&&P.push({...T,options:Y})}else{const Y=f(T).toLowerCase(),X=k(T).toLowerCase();(Y.includes(U)||X.includes(U))&&P.push(T)}}),P},_=N(()=>u.value&&!p.value&&i.value?l.options:L(l.options,a.value)),x=M=>{const q=M.target;a.value=q.value,p.value=!0,a.value===""&&(i.value=null,s("update:modelValue",null))},V=M=>{u.value=M,M||(a.value=b(i.value)),p.value=!1},w=M=>{s("focus",M)},B=M=>{s("blur",M)};return(M,q)=>(r(),v("div",Jo,[d(e(wo),{"model-value":i.value,"onUpdate:modelValue":m,"onUpdate:open":V,"ignore-filter":!0},{default:C(()=>[d(e(to),{class:ee(["flex h-7 w-full items-center justify-between gap-2 rounded bg-surface-gray-2 px-2 py-1 transition-colors hover:bg-surface-gray-3 border border-transparent focus-within:border-outline-gray-4 focus-within:ring-2 focus-within:ring-outline-gray-3",{"opacity-50 pointer-events-none":M.disabled}])},{default:C(()=>[n("div",Go,[F.value?(r(),E(I,{key:0,icon:F.value},null,8,["icon"])):A("",!0),d(e(To),{value:a.value,onInput:x,onFocus:w,onBlur:B,class:"bg-transparent p-0 focus:outline-0 border-0 focus:border-0 focus:ring-0 text-base text-ink-gray-8 h-full placeholder:text-ink-gray-4 w-full",placeholder:M.placeholder||"",disabled:M.disabled,autocomplete:"off"},null,8,["value","placeholder","disabled"])]),d(e(No),{disabled:M.disabled},{default:C(()=>[d(e(Na),{class:"h-4 w-4 text-ink-gray-5"})]),_:1},8,["disabled"])]),_:1},8,["class"]),d(e(Uo),null,{default:C(()=>[d(e(Vo),{class:"z-10 min-w-[--reka-combobox-trigger-width] mt-1 bg-surface-modal overflow-hidden rounded-lg shadow-2xl",position:"popper",onOpenAutoFocus:q[0]||(q[0]=he(()=>{},["prevent"])),onCloseAutoFocus:q[1]||(q[1]=he(()=>{},["prevent"])),align:"start"},{default:C(()=>[d(e(Qo),{class:ee(["max-h-60 overflow-auto pb-1.5",{"px-1.5 pt-1.5":!c(_.value[0])}])},{default:C(()=>[d(e(Eo),{class:"text-ink-gray-5 text-base text-center py-1.5 px-2.5"},{default:C(()=>[te(' No results found for "'+D(a.value)+'" ',1)]),_:1}),(r(!0),v(O,null,G(_.value,(U,P)=>(r(),v(O,{key:P},[c(U)?(r(),E(e(Lo),{key:0,class:"px-1.5"},{default:C(()=>[d(e(qo),{class:"px-2.5 pt-3 pb-1.5 text-sm font-medium text-ink-gray-5 sticky top-0 bg-surface-modal z-10"},{default:C(()=>[te(D(U.group),1)]),_:2},1024),(r(!0),v(O,null,G(U.options,(T,Y)=>(r(),E(e(en),{key:`${P}-${Y}`,value:k(T),disabled:y(T),class:"text-base leading-none text-ink-gray-7 rounded flex items-center h-7 px-2.5 py-1.5 relative select-none data-[disabled]:opacity-50 data-[disabled]:pointer-events-none data-[highlighted]:outline-none data-[highlighted]:bg-surface-gray-3"},{default:C(()=>[n("span",Ko,[d(I,{icon:h(T)},null,8,["icon"]),te(" "+D(f(T)),1)]),d(e(tn),{class:"inline-flex ml-2 items-center justify-center"},{default:C(()=>[d(e(kl),{class:"size-4"})]),_:1})]),_:2},1032,["value","disabled"]))),128))]),_:2},1024)):(r(),E(e(en),{key:P,value:k(U),disabled:y(U),class:"text-base leading-none text-ink-gray-7 rounded flex items-center h-7 px-2.5 py-1.5 relative select-none data-[disabled]:opacity-50 data-[disabled]:pointer-events-none data-[highlighted]:outline-none data-[highlighted]:bg-surface-gray-3"},{default:C(()=>[n("span",Wo,[h(U)?(r(),E(I,{key:0,icon:h(U)},null,8,["icon"])):A("",!0),te(" "+D(f(U)),1)]),d(e(tn),{class:"absolute right-0 w-6 inline-flex items-center justify-center"},{default:C(()=>[d(e(kl),{class:"h-4 w-4"})]),_:1})]),_:2},1032,["value","disabled"]))],64))),128))]),_:1},8,["class"])]),_:1})]),_:1})]),_:1},8,["model-value"])]))}}),Zo={},Yo={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Xo(o,t){return r(),v("svg",Yo,[...t[0]||(t[0]=[n("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 6.5C9.10457 6.5 10 5.60457 10 4.5C10 3.39543 9.10457 2.5 8 2.5C6.89543 2.5 6 3.39543 6 4.5C6 5.60457 6.89543 6.5 8 6.5ZM8 7.5C9.65685 7.5 11 6.15685 11 4.5C11 2.84315 9.65685 1.5 8 1.5C6.34315 1.5 5 2.84315 5 4.5C5 6.15685 6.34315 7.5 8 7.5ZM12 13.5C13.1046 13.5 14 12.6046 14 11.5C14 10.3954 13.1046 9.5 12 9.5C10.8954 9.5 10 10.3954 10 11.5C10 12.6046 10.8954 13.5 12 13.5ZM12 14.5C13.6569 14.5 15 13.1569 15 11.5C15 9.84315 13.6569 8.5 12 8.5C10.3431 8.5 9 9.84315 9 11.5C9 13.1569 10.3431 14.5 12 14.5ZM6 11.5C6 12.6046 5.10457 13.5 4 13.5C2.89543 13.5 2 12.6046 2 11.5C2 10.3954 2.89543 9.5 4 9.5C5.10457 9.5 6 10.3954 6 11.5ZM7 11.5C7 13.1569 5.65685 14.5 4 14.5C2.34315 14.5 1 13.1569 1 11.5C1 9.84315 2.34315 8.5 4 8.5C5.65685 8.5 7 9.84315 7 11.5Z",fill:"currentColor"},null,-1)])])}const zt=Ue(Zo,[["render",Xo]]),ei={},ti={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-minimize-2"};function li(o,t){return r(),v("svg",ti,[...t[0]||(t[0]=[n("polyline",{points:"4 14 10 14 10 20"},null,-1),n("polyline",{points:"20 10 14 10 14 4"},null,-1),n("line",{x1:"14",y1:"10",x2:"21",y2:"3"},null,-1),n("line",{x1:"3",y1:"21",x2:"10",y2:"14"},null,-1)])])}const ni=Ue(ei,[["render",li]]),ai={},si={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-maximize-2"};function oi(o,t){return r(),v("svg",si,[...t[0]||(t[0]=[n("polyline",{points:"15 3 21 3 21 9"},null,-1),n("polyline",{points:"9 21 3 21 3 15"},null,-1),n("line",{x1:"21",y1:"3",x2:"14",y2:"10"},null,-1),n("line",{x1:"3",y1:"21",x2:"10",y2:"14"},null,-1)])])}const ii=Ue(ai,[["render",oi]]),ri={},ui={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function di(o,t){return r(),v("svg",ui,[...t[0]||(t[0]=[n("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M14.25 8C14.25 11.4518 11.4518 14.25 8 14.25C4.54822 14.25 1.75 11.4518 1.75 8C1.75 4.54822 4.54822 1.75 8 1.75C11.4518 1.75 14.25 4.54822 14.25 8ZM15.25 8C15.25 12.0041 12.0041 15.25 8 15.25C3.99594 15.25 0.75 12.0041 0.75 8C0.75 3.99594 3.99594 0.75 8 0.75C12.0041 0.75 15.25 3.99594 15.25 8ZM7.37988 9.37695V9.44531H8.39062V9.37695C8.39062 9.10352 8.41992 8.88542 8.47852 8.72266C8.53711 8.55664 8.62826 8.41504 8.75195 8.29785C8.87891 8.18066 9.04329 8.06185 9.24512 7.94141C9.56087 7.74609 9.8099 7.51009 9.99219 7.2334C10.1745 6.95345 10.2656 6.61328 10.2656 6.21289C10.2656 5.82878 10.1745 5.49186 9.99219 5.20215C9.81315 4.91244 9.56087 4.6862 9.23535 4.52344C8.90983 4.36068 8.52734 4.2793 8.08789 4.2793C7.69401 4.2793 7.33268 4.35579 7.00391 4.50879C6.67513 4.65853 6.41146 4.88151 6.21289 5.17773C6.01432 5.4707 5.90853 5.82878 5.89551 6.25195H6.96973C6.986 6.0013 7.04948 5.79785 7.16016 5.6416C7.27083 5.4821 7.40755 5.36491 7.57031 5.29004C7.73633 5.21517 7.90885 5.17773 8.08789 5.17773C8.28971 5.17773 8.47363 5.22005 8.63965 5.30469C8.80892 5.38932 8.94075 5.50814 9.03516 5.66113C9.13281 5.81413 9.18164 5.99479 9.18164 6.20312C9.18164 6.47005 9.11003 6.69954 8.9668 6.8916C8.82357 7.0804 8.64453 7.23828 8.42969 7.36523C8.21159 7.50195 8.02279 7.64193 7.86328 7.78516C7.70703 7.92513 7.58659 8.11556 7.50195 8.35645C7.42057 8.59408 7.37988 8.93425 7.37988 9.37695ZM7.37988 11.5205C7.51986 11.654 7.69076 11.7207 7.89258 11.7207C8.09766 11.7207 8.26855 11.654 8.40527 11.5205C8.54525 11.3838 8.61523 11.2161 8.61523 11.0176C8.61523 10.8158 8.54525 10.6481 8.40527 10.5146C8.26855 10.3779 8.09766 10.3096 7.89258 10.3096C7.69076 10.3096 7.51986 10.3779 7.37988 10.5146C7.24316 10.6481 7.1748 10.8158 7.1748 11.0176C7.1748 11.2161 7.24316 11.3838 7.37988 11.5205Z",fill:"currentColor"},null,-1)])])}const Dn=Ue(ri,[["render",di]]),ci={class:"flex flex-col justify-center items-center gap-1 mt-4 mb-7"},pi={class:"text-base font-medium"},mi={class:"text-p-base font-normal"},fi={class:"flex flex-col gap-2.5 overflow-hidden"},vi={class:"flex justify-between items-center py-0.5"},gi={class:"flex"},yi={class:"flex flex-col gap-1.5 overflow-y-auto"},hi=["onClick"],_i={__name:"OnboardingSteps",props:{appName:{type:String,default:"frappecrm"},title:{type:String,default:"Frappe CRM"},logo:{type:Object,required:!0},afterSkip:{type:Function,default:()=>{}},afterSkipAll:{type:Function,default:()=>{}},afterReset:{type:Function,default:()=>{}},afterResetAll:{type:Function,default:()=>{}}},setup(o){const t=o;function l(y){if(y.dependsOn&&!y.completed){const h=a.find(g=>g.name===y.dependsOn);if(h&&!h.completed)return!0}return!1}function s(y){if(y.dependsOn&&!y.completed){const h=a.find(g=>g.name===y.dependsOn);if(h&&!h.completed)return`You need to complete "${h.title}" first.`}return""}const{steps:a,stepsCompleted:i,totalSteps:u,completedPercentage:p,skip:m,skipAll:c,reset:f,resetAll:k}=ft(t.appName);return(y,h)=>(r(),v(O,null,[n("div",ci,[(r(),E(Oe(o.logo),{class:"size-10 shrink-0 rounded mb-4"})),n("div",pi,D("Welcome to "+o.title),1),n("div",mi,D(`${e(i)}/${e(u)} steps completed`),1)]),n("div",fi,[n("div",vi,[d(Kt,{label:`${e(p)}% completed`,theme:e(p)==100?"green":"orange",size:"lg"},null,8,["label","theme"]),n("div",gi,[e(p)!=0?(r(),E(Q,{key:0,variant:"ghost",label:"Reset all",onClick:h[0]||(h[0]=()=>e(k)(o.afterResetAll))})):A("",!0),e(p)!=100?(r(),E(Q,{key:1,variant:"ghost",label:"Skip all",onClick:h[1]||(h[1]=()=>e(c)(o.afterSkipAll))})):A("",!0)])]),n("div",yi,[(r(!0),v(O,null,G(e(a),g=>(r(),v("div",{key:g.title,class:"group w-full flex gap-2 justify-between items-center hover:bg-surface-gray-1 rounded px-2 py-1.5 cursor-pointer",onClick:he(()=>!g.completed&&!l(g)&&g.onClick(),["stop"])},[(r(),E(Oe(l(g)?Wt:"div"),{text:s(g)},{default:C(()=>[n("div",{class:ee(["flex gap-2 items-center",[g.completed?"text-ink-gray-5":l(g)?"text-ink-gray-4":"text-ink-gray-8"]])},[(r(),E(Oe(g.icon),{class:"h-4"})),n("div",{class:ee(["text-base",{"line-through":g.completed}])},D(g.title),3)],2)]),_:2},1032,["text"])),!g.completed&&!l(g)?(r(),E(Q,{key:0,label:"Skip",class:"!h-4 text-xs !text-ink-gray-6 hidden group-hover:flex",onClick:()=>e(m)(g.name,o.afterSkip)},null,8,["onClick"])):l(g)?A("",!0):(r(),E(Q,{key:1,label:"Reset",class:"!h-4 text-xs !text-ink-gray-6 hidden group-hover:flex",onClick:he(()=>e(f)(g.name,o.afterReset),["stop"])},null,8,["onClick"]))],8,hi))),128))])])],64))}},bi={class:"flex flex-col gap-2 overflow-hidden"},ki={class:"m-1"},xi={class:"flex justify-between items-center text-base text-ink-gray-5 mx-2"},wi={class:"flex flex-col gap-1.5 overflow-y-auto"},Ci=["onClick"],$i={class:"flex items-center gap-2"},Ai={class:"text-base text-ink-gray-8"},Si={class:"flex flex-col gap-1.5 ml-5"},Vi=["onClick"],Ii={class:"flex items-center gap-2"},Ei={class:"text-base text-ink-gray-8"},Di={__name:"HelpCenter",props:ze({docsLink:{type:String,default:"https://docs.frappe.io/crm"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const t=o,l=$(null),s=$(""),a=De(o,"modelValue"),i=N(()=>s.value?a.value.filter(m=>{const c=m.subArticles.filter(f=>f.title.toLowerCase().includes(s.value.toLowerCase()));return m.title.toLowerCase().includes(s.value.toLowerCase())||c.length>0?{...m,subArticles:c}:!1}):a.value);function u(){window.open(t.docsLink,"_blank")}function p(m){window.open(`${t.docsLink}/${m}`,"_blank")}return be(()=>{var m,c;(c=(m=l.value)==null?void 0:m.el)==null||c.focus()}),(m,c)=>(r(),v("div",bi,[n("div",ki,[d(Ha,{ref_key:"searchInput",ref:l,placeholder:"Search articles...",modelValue:s.value,"onUpdate:modelValue":c[0]||(c[0]=f=>s.value=f),debounce:300},{prefix:C(()=>[d(Ne,{name:"search",class:"h-4 text-ink-gray-5"})]),_:1},8,["modelValue"])]),n("div",xi,[c[1]||(c[1]=n("div",null,"All articles",-1)),d(Q,{variant:"ghost",onClick:u},{default:C(()=>[d(Ne,{name:"arrow-up-right",class:"h-4 text-ink-gray-5"})]),_:1})]),n("div",wi,[(r(!0),v(O,null,G(i.value,f=>(r(),v("div",{key:f.title,class:"flex flex-col gap-1.5"},[n("div",{class:"flex items-center justify-between p-1.5 hover:bg-surface-gray-1 rounded cursor-pointer",onClick:k=>f.opened=!f.opened},[n("div",$i,[d(Ne,{name:f.opened?"chevron-down":"chevron-right",class:"h-4 text-ink-gray-5"},null,8,["name"]),n("div",Ai,D(f.title),1)])],8,Ci),Re(n("div",Si,[(r(!0),v(O,null,G(f.subArticles,k=>(r(),v("div",{key:k.name,class:"group flex items-center justify-between gap-2 p-1.5 hover:bg-surface-gray-1 rounded cursor-pointer",onClick:()=>p(k.name)},[n("div",Ii,[d(Ne,{name:"file-text",class:"h-4 text-ink-gray-5"}),n("div",Ei,D(k.title),1)]),d(Ne,{name:"arrow-up-right",class:"h-4 hidden group-hover:flex text-ink-gray-5"})],8,Vi))),128))],512),[[lt,f.opened]])]))),128))])]))}},Bi={class:"flex items-center justify-between px-2 py-1.5"},Li={class:"text-base font-medium"},Fi={class:"flex gap-1"},Ti={class:"h-full overflow-hidden flex flex-col"},Mi={class:"flex flex-col gap-1.5"},Oi=["onClick"],Ri={class:"text-base"},qi={__name:"HelpModal",props:ze({appName:{type:String,default:"frappecrm"},title:{type:String,default:"Frappe CRM"},logo:{type:Object,required:!0},afterSkip:{type:Function,default:()=>{}},afterSkipAll:{type:Function,default:()=>{}},afterReset:{type:Function,default:()=>{}},afterResetAll:{type:Function,default:()=>{}},docsLink:{type:String,default:"https://docs.frappe.io/crm"}},{modelValue:{},modelModifiers:{},articles:{},articlesModifiers:{}}),emits:["update:modelValue","update:articles"],setup(o){const t=o,{syncStatus:l,resetAll:s,isOnboardingStepsCompleted:a}=ft(t.appName),i=De(o,"modelValue"),u=De(o,"articles"),p=N(()=>{if(!a.value&&!Qe.value)return"Getting started";if(Qe.value)return"Help center"}),m=N(()=>[{icon:zt,label:"Reset onboarding steps",onClick:f,condition:()=>Qe.value&&a.value}].filter(y=>y.condition())),c=N(()=>[{icon:Dn,label:"Help centre",onClick:()=>{l(),Qe.value=!0},condition:!a.value&&!Qe.value},{icon:zt,label:"Getting started",onClick:()=>Qe.value=!1,condition:Qe.value&&!a.value}].filter(y=>y.condition));function f(){s(),a.value=!1,Qe.value=!1}return be(()=>{a.value&&(Qe.value=!0)}),(k,y)=>Re((r(),v("div",{class:ee(["fixed z-50 right-0 w-80 h-[calc(100%_-_80px)] text-ink-gray-9 m-5 mt-[62px] p-3 flex gap-2 flex-col justify-between rounded-lg bg-surface-modal shadow-2xl",{"top-[calc(100%_-_120px)] border":e(Ie)}]),onClick:y[3]||(y[3]=he(()=>{},["stop"]))},[n("div",Bi,[n("div",Li,D(p.value),1),n("div",Fi,[m.value.length?(r(),E(qt,{key:0,options:m.value},{default:C(()=>[d(Q,{variant:"ghost",icon:"more-horizontal"})]),_:1},8,["options"])):A("",!0),d(Q,{onClick:y[0]||(y[0]=h=>Ie.value=!e(Ie)),variant:"ghost"},{default:C(()=>[(r(),E(Oe(e(Ie)?ii:ni),{class:"h-3.5"}))]),_:1}),d(Q,{variant:"ghost",onClick:y[1]||(y[1]=h=>i.value=!1)},{default:C(()=>[d(Ne,{name:"x",class:"h-3.5"})]),_:1})])]),n("div",Ti,[!e(a)&&!e(Qe)?(r(),E(_i,{key:0,title:o.title,logo:o.logo,afterSkip:o.afterSkip,afterSkipAll:o.afterSkipAll,afterReset:o.afterReset,afterResetAll:o.afterResetAll,appName:o.appName},null,8,["title","logo","afterSkip","afterSkipAll","afterReset","afterResetAll","appName"])):e(Qe)?(r(),E(Di,{key:1,modelValue:u.value,"onUpdate:modelValue":y[2]||(y[2]=h=>u.value=h),docsLink:o.docsLink},null,8,["modelValue","docsLink"])):A("",!0)]),(r(!0),v(O,null,G(c.value,h=>(r(),v("div",Mi,[n("div",{class:"w-full flex gap-2 items-center hover:bg-surface-gray-1 text-ink-gray-8 rounded px-2 py-1.5 cursor-pointer",onClick:h.onClick},[(r(),E(Oe(h.icon),{class:"h-4"})),n("div",Ri,D(h.label),1)],8,Oi)]))),256))],2)),[[lt,i.value]])}},ji={key:0,class:"flex flex-col gap-3 shadow-sm rounded-lg py-2.5 px-3 bg-surface-modal text-base"},Ui={key:0,class:"inline-flex text-ink-gray-9 gap-2"},Pi={class:"flex flex-col text-p-sm gap-0.5"},Ni={class:"text-ink-gray-7"},Hi={key:1,class:"flex flex-col gap-1"},zi={class:"flex items-center justify-between gap-1"},Qi={class:"flex items-center gap-2 shrink-0"},Ji={__name:"GettingStartedBanner",props:{isSidebarCollapsed:{type:Boolean,default:!1},appName:{type:String,default:"frappecrm"}},setup(o){const t=o,{stepsCompleted:l,totalSteps:s,isOnboardingStepsCompleted:a}=ft(t.appName),i=()=>{Ie.value=!1,tt.value=!0};return(u,p)=>o.isSidebarCollapsed?e(l)!=e(s)?(r(),E(Q,{key:1,onClick:i},{default:C(()=>[d(zt,{class:"h-4 my-0.5 shrink-0"})]),_:1})):A("",!0):(r(),v("div",ji,[e(l)!=e(s)?(r(),v("div",Ui,[d(zt,{class:"h-4 my-0.5 shrink-0"}),n("div",Pi,[p[1]||(p[1]=n("div",{class:"font-medium"},D("Getting started"),-1)),n("div",Ni,D(`${e(l)}/${e(s)} steps`),1)])])):(r(),v("div",Hi,[n("div",zi,[n("div",Qi,[d(zt,{class:"h-4 my-0.5"}),p[2]||(p[2]=n("div",{class:"text-ink-gray-9 font-medium"},D("You are all set"),-1))]),d(Ne,{name:"x",class:"h-4 cursor-pointer",onClick:p[0]||(p[0]=()=>{Qe.value=!0,a.value=!0})})]),p[3]||(p[3]=n("div",{class:"text-p-sm text-ink-gray-7"},D("All steps are completed successfully"),-1))])),e(l)!=e(s)?(r(),E(Q,{key:2,label:e(l)==0?"Start now":"Continue",theme:"blue",onClick:i},{prefix:C(()=>[d(Ne,{name:"chevrons-right",class:"size-4"})]),_:1},8,["label"])):A("",!0)]))}},Gi={class:"flex flex-col gap-2 text-ink-gray-9 text-base"},Ki={key:0},Wi={key:1,class:"w-full rounded",controls:"",autoplay:"",muted:""},Zi=["src"],Yi={__name:"IntermediateStepModal",props:ze({currentStep:{type:Object,default:{title:"Title",message:"Message",videoURL:"",buttonLabel:"Button Label",onClick:()=>{}}},dialogOptions:{type:Object,default:()=>({})}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const t=o,l=De(o,"modelValue"),s=N(()=>t.dialogOptions&&Object.keys(t.dialogOptions).length?t.dialogOptions:{title:t.currentStep.title,size:"2xl",actions:[{label:t.currentStep.buttonLabel,variant:"solid",onClick:t.currentStep.onClick}]});return(a,i)=>(r(),E(e(je),{modelValue:l.value,"onUpdate:modelValue":i[0]||(i[0]=u=>l.value=u),options:s.value},{"boday-header":C(()=>[ae(a.$slots,"body-header")]),"body-content":C(()=>[ae(a.$slots,"default",{},()=>[n("div",Gi,[o.currentStep.message?(r(),v("div",Ki,D(o.currentStep.message),1)):A("",!0),o.currentStep.videoURL?(r(),v("video",Wi,[n("source",{src:o.currentStep.videoURL,type:"video/mp4"},null,8,Zi),i[1]||(i[1]=te(" Your browser does not support the video tag. ",-1))])):A("",!0)])])]),actions:C(()=>[ae(a.$slots,"actions")]),_:3},8,["modelValue","options"]))}},Xi={},er={width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function tr(o,t){return r(),v("svg",er,[...t[0]||(t[0]=[n("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.2641 1C5.5758 1 4.97583 1.46845 4.80889 2.1362L3.57555 7.06953C3.33887 8.01625 4.05491 8.93333 5.03077 8.93333H7.50682L6.72168 14.4293C6.68838 14.6624 6.82229 14.8872 7.04319 14.9689C7.26408 15.0507 7.51204 14.9671 7.63849 14.7684L13.2161 6.00354C13.6398 5.33782 13.1616 4.46667 12.3725 4.46667H9.59038L10.3017 1.62127C10.3391 1.4719 10.3055 1.31365 10.2108 1.19229C10.116 1.07094 9.97063 1 9.81666 1H6.2641ZM5.77903 2.37873C5.83468 2.15615 6.03467 2 6.2641 2H9.17627L8.46492 4.8454C8.42758 4.99477 8.46114 5.15302 8.55589 5.27437C8.65064 5.39573 8.79602 5.46667 8.94999 5.46667H12.3725L8.0395 12.2757L8.5783 8.50404C8.5988 8.36056 8.55602 8.21523 8.46105 8.10573C8.36608 7.99623 8.22827 7.93333 8.08332 7.93333H5.03077C4.70548 7.93333 4.4668 7.62764 4.5457 7.31207L5.77903 2.37873Z",fill:"currentColor"},null,-1)])])}const nn=Ue(Xi,[["render",tr]]),lr={key:0,class:"flex flex-col gap-3 shadow-sm rounded-lg py-2.5 px-3 bg-surface-modal text-base"},nr={class:"flex flex-col gap-1"},ar={class:"inline-flex text-ink-gray-9 gap-2 items-center font-medium"},sr="Upgrade to a paid plan for uninterrupted services",an={__name:"TrialBanner",props:{isSidebarCollapsed:{type:Boolean,default:!1},afterUpgrade:{type:Function,default:()=>{}}},setup(o){const t=o,l=$(0),s=$(!1),a=$("https://frappecloud.com"),i=$(""),u=N(()=>l.value>1?"Trial ends in "+l.value+" days":"Trial ends tomorrow");me({url:"frappe.integrations.frappe_providers.frappecloud_billing.current_site_info",cache:"current_site_info_data",auto:!0,onSuccess:c=>{l.value=p(c.trial_end_date),a.value=c.base_url,i.value=c.site_name,s.value=c.plan.is_trial_plan&&l.value>0}});function p(c){if(!c)return 0;c=new Date(c);const k=c-new Date;return Math.ceil(k/(1e3*60*60*24))}function m(){var c;window.open(`${a.value}/dashboard/sites/${i.value}`,"_blank"),(c=t.afterUpgrade)==null||c.call(t)}return(c,f)=>!o.isSidebarCollapsed&&s.value?(r(),v("div",lr,[n("div",nr,[n("div",ar,[d(Ne,{class:"h-4",name:"info"}),te(" "+D(u.value),1)]),n("div",{class:"text-ink-gray-7 text-p-sm"},D(sr))]),d(e(Q),{label:"Upgrade plan",theme:"blue",onClick:m},{prefix:C(()=>[d(nn,{class:"size-4"})]),_:1})])):o.isSidebarCollapsed&&s.value?(r(),E(e(Q),{key:1,onClick:m},{default:C(()=>[d(nn,{class:"h-4 my-0.5 shrink-0"})]),_:1})):A("",!0)}},or={class:"overflow-hidden text-ellipsis whitespace-nowrap"},ir={key:1,class:"ml-auto whitespace-nowrap pl-2 text-gray-600"},sn=j({__name:"CPGroup",props:{item:{type:Object,required:!0},active:{type:Boolean,required:!0}},setup(o){return(t,l)=>(r(),v("div",{class:ee(["flex w-full min-w-0 items-center rounded p-2 text-base font-medium text-gray-800",{"bg-gray-200":o.active}])},[o.item.icon?(r(),E(Oe(o.item.icon),{key:0,class:"mr-3 h-4 w-4 text-gray-700"})):A("",!0),n("span",or,D(o.item.title)+" ",1),o.item.modified?(r(),v("span",ir,D(e(kn)(o.item.modified).fromNow(!0)),1)):A("",!0)],2))}}),rr={class:"relative"},ur={class:"pl-4.5 absolute inset-y-0 left-0 flex items-center"},dr={key:0,class:"px-4.5 mb-2.5 text-base text-gray-600"},Bn={__name:"CP",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o){const t=Dl();Rl();const l=De(o,"modelValue"),s=$(""),a=N(()=>{const y=[];return s.value.startsWith("#")?y.push({title:`Go to Ticket #${s.value.slice(1)}`,icon:()=>de(wl),route:{name:"TicketAgent",params:{ticketId:s.value.slice(1)}}}):y.push({title:"Tickets",icon:()=>de(wl),route:{name:"TicketsAgent"}}),y.push({title:"Knowledge Base",icon:()=>de(os),route:{name:Le.value?"CustomerKnowledgeBase":"AgentKnowledgeBase"}}),{title:"Jump to",component:de(sn),items:y}}),i=N(()=>({title:"Search",hideTitle:!0,component:de(sn),items:[{title:`Search for "${s.value}"`,icon:()=>de(is),route:{name:"SearchAgent",query:{q:s.value}}}]})),u=N(()=>{let y=[a.value];return s.value.length>2&&!Le.value&&y.push(i.value),y}),p=y=>{s.value=y.target.value},m=y=>{y&&(t.push(y.route),f())},c=()=>{ul({key:"k",meta:!0},k)};function f(){l.value=!1}function k(){l.value=!l.value}return ve(l,y=>{y&&(s.value="")}),be(()=>{Le.value||c()}),za(()=>{f()}),(y,h)=>{const g=Rt;return r(),E(e(je),{modelValue:l.value,"onUpdate:modelValue":h[0]||(h[0]=b=>l.value=b),options:{size:"xl",position:"top"}},{body:C(()=>[n("div",null,[d(e(Bl),{nullable:"","onUpdate:modelValue":m},{default:C(()=>[n("div",rr,[n("div",ur,[d(g,{class:"h-4 w-4"})]),d(e(Ll),{placeholder:"Search tickets, emails, comments, or #234 to navigate to ticket",class:"pl-11.5 pr-4.5 w-full border-none bg-transparent py-3 text-base text-gray-800 placeholder:text-gray-500 focus:ring-0",autocomplete:"off",onInput:p})]),d(e(Fl),{class:"max-h-96 overflow-auto border-t border-gray-100",static:"",hold:!0},{default:C(()=>[(r(!0),v(O,null,G(u.value,b=>(r(),v("div",{key:b.title,class:"mt-4.5 mb-2 first:mt-3"},[b.hideTitle?A("",!0):(r(),v("div",dr,D(b.title),1)),(r(!0),v(O,null,G(b.items,S=>(r(),E(e(Tl),{key:`${S.doctype}:${S.name}`,value:S,class:"px-2.5",disabled:S.disabled},{default:C(({active:F})=>[(r(),E(Oe(b.component),{item:S,active:F},null,8,["item","active"]))]),_:2},1032,["value","disabled"]))),128))]))),128))]),_:1})]),_:1})])]),_:1},8,["modelValue"])}}},cr={},pr={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function mr(o,t){return r(),v("svg",pr,[...t[0]||(t[0]=[n("path",{d:"M3 8.5C4.10457 8.5 5 9.39543 5 10.5C5 11.4316 4.3622 12.2113 3.5 12.4336V14C3.5 14.2761 3.27614 14.5 3 14.5C2.72386 14.5 2.5 14.2761 2.5 14V12.4336C1.6378 12.2113 1 11.4316 1 10.5C1 9.39543 1.89543 8.5 3 8.5ZM8 9.5C8.27614 9.5 8.5 9.72386 8.5 10V14C8.5 14.2761 8.27614 14.5 8 14.5C7.72386 14.5 7.5 14.2761 7.5 14V10C7.5 9.72386 7.72386 9.5 8 9.5ZM13 8.5C14.1046 8.5 15 9.39543 15 10.5C15 11.4316 14.3622 12.2113 13.5 12.4336V14C13.5 14.2761 13.2761 14.5 13 14.5C12.7239 14.5 12.5 14.2761 12.5 14V12.4336C11.6378 12.2113 11 11.4316 11 10.5C11 9.39543 11.8954 8.5 13 8.5ZM3 9.5C2.44772 9.5 2 9.94772 2 10.5C2 11.0523 2.44772 11.5 3 11.5C3.55228 11.5 4 11.0523 4 10.5C4 9.94772 3.55228 9.5 3 9.5ZM13 9.5C12.4477 9.5 12 9.94772 12 10.5C12 11.0523 12.4477 11.5 13 11.5C13.5523 11.5 14 11.0523 14 10.5C14 9.94772 13.5523 9.5 13 9.5ZM8 2C8.27614 2 8.5 2.22386 8.5 2.5V4.5C8.5 4.52163 8.49583 4.54257 8.49316 4.56348C9.35898 4.7833 10 5.56581 10 6.5C10 7.60457 9.10457 8.5 8 8.5C6.89543 8.5 6 7.60457 6 6.5C6 5.56614 6.64051 4.78362 7.50586 4.56348C7.50321 4.54261 7.5 4.52158 7.5 4.5V2.5C7.5 2.22386 7.72386 2 8 2ZM8 5.5C7.44772 5.5 7 5.94772 7 6.5C7 7.05228 7.44772 7.5 8 7.5C8.55228 7.5 9 7.05228 9 6.5C9 5.94772 8.55228 5.5 8 5.5ZM3 2C3.27614 2 3.5 2.22386 3.5 2.5V6.5C3.5 6.77614 3.27614 7 3 7C2.72386 7 2.5 6.77614 2.5 6.5V2.5C2.5 2.22386 2.72386 2 3 2ZM13 2C13.2761 2 13.5 2.22386 13.5 2.5V6.5C13.5 6.77614 13.2761 7 13 7C12.7239 7 12.5 6.77614 12.5 6.5V2.5C12.5 2.22386 12.7239 2 13 2Z",fill:"#525252"},null,-1)])])}const fr=Ue(cr,[["render",mr]]),vr={},gr={width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function yr(o,t){return r(),v("svg",gr,[...t[0]||(t[0]=[n("rect",{x:"0.75",y:"0.75",width:"30.5",height:"30.5",rx:"6.25",stroke:"currentColor","stroke-width":"1.5"},null,-1),n("path",{d:"M24.5011 14.1124C23.3954 12.4873 21.532 11.5477 19.594 11.6747C18.7616 10.1384 17.2211 9.12267 15.4198 9.0084C14.1651 8.93222 12.8979 9.3766 11.9165 10.24C11.2456 10.8367 10.7611 11.5223 10.463 12.2968C10.289 12.7539 9.89151 13.0459 9.46912 13.0459H6.5V15.5852H9.46912C10.9226 15.5852 12.2271 14.6584 12.7737 13.2237C12.9227 12.8301 13.1712 12.4873 13.5439 12.1571C14.0284 11.7255 14.662 11.4969 15.2583 11.535C16.1528 11.5985 16.7863 12.0175 17.1839 12.538C17.6063 13.0205 17.8423 13.7696 17.979 14.5187C18.774 14.2902 19.6437 14.0997 20.476 14.2394C21.1593 14.3536 21.7929 14.7218 22.2525 15.2678C22.327 15.3567 22.4016 15.4456 22.4637 15.5471C23.06 16.4232 23.1718 17.5024 22.7743 18.5689C22.414 19.5592 21.0847 20.4607 19.9791 20.4607H11.3326C10.1524 20.4607 9.18339 19.5592 9.03432 18.4038H6.54969C6.71119 20.9686 8.78585 23 11.3326 23H19.9915C22.1283 23 24.3769 21.451 25.1098 19.4704C25.7931 17.6167 25.5695 15.6614 24.5135 14.0997L24.5011 14.1124Z",fill:"currentColor"},null,-1)])])}const hr=Ue(vr,[["render",yr]]),_r={},br={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function kr(o,t){return r(),v("svg",br,[...t[0]||(t[0]=[Zt('<path d="M10 11C12.2091 11 14 9.20914 14 7C14 4.79086 12.2091 3 10 3C7.79086 3 6 4.79086 6 7C6 9.20914 7.79086 11 10 11Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M10.3 15H7C5.93913 15 4.92172 15.4214 4.17157 16.1716C3.42143 16.9217 3 17.9391 3 19V21H11.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M22.166 13.834H14.8327C14.3264 13.834 13.916 14.2444 13.916 14.7507V20.2507C13.916 20.7569 14.3264 21.1673 14.8327 21.1673H22.166C22.6723 21.1673 23.0827 20.7569 23.0827 20.2507V14.7507C23.0827 14.2444 22.6723 13.834 22.166 13.834Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M23.0827 15.209L18.9714 17.8215C18.8299 17.9101 18.6663 17.9572 18.4993 17.9572C18.3324 17.9572 18.1688 17.9101 18.0273 17.8215L13.916 15.209" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><g clip-path="url(#clip0_368_1881)"><path d="M16.667 5H21.3337" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M19 2.66699V7.33366" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></g><defs><clipPath id="clip0_368_1881"><rect width="8" height="8" fill="white" transform="translate(15 1)"></rect></clipPath></defs>',6)])])}const xr=Ue(_r,[["render",kr]]),wr={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-5 py-2.5"},Cr={key:0,class:"divide-y text-base"},$r={class:"mb-2 leading-5"},Ar={class:"space-x-1 text-gray-700"},Sr={class:"font-medium text-gray-900"},Vr={key:0},Ir={key:1},Er={key:2},Dr={class:"font-medium text-gray-900"},Br={class:"flex items-center gap-2"},Lr={class:"text-sm text-gray-600"},Fr={key:0,class:"h-1.5 w-1.5 rounded-full bg-blue-400"},Tr={key:1,class:"p-5 text-center text-gray-500 flex flex-col items-center justify-center gap-2 mt-20"},Mr=j({__name:"Notifications",setup(o){const t=xn(),l=wn(),s=$(null);Qa(s,()=>{t.visible&&t.toggle()},{ignore:["#notifications-btn"]});function a(u){t.toggle(),!u.read&&t.read(u.reference_ticket)}function i(u){switch(u.notification_type){case"Mention":return{name:"TicketAgent",params:{ticketId:u.reference_ticket},hash:"#"+u.reference_comment};case"Assignment":case"Reaction":return{name:"TicketAgent",params:{ticketId:u.reference_ticket}}}}return(u,p)=>{const m=rs,c=W("Button"),f=cn,k=W("RouterLink"),y=bn;return e(t).visible?(r(),v("span",{key:0,ref_key:"target",ref:s,class:"fixed z-10 h-screen overflow-auto bg-white",style:Mt({"box-shadow":"8px 0px 8px rgba(0, 0, 0, 0.1)","max-width":"350px","min-width":"350px",left:e(l).width})},[n("div",wr,[p[2]||(p[2]=n("span",{class:"text-lg font-medium"},"Notifications",-1)),n("div",null,[e(t).data.length?(r(),E(c,{key:0,theme:"blue",variant:"ghost",onClick:p[0]||(p[0]=()=>e(t).clear.submit())},{icon:C(()=>[d(m,{class:"h-4 w-4"})]),_:1})):A("",!0),d(c,{theme:"gray",variant:"ghost",onClick:p[1]||(p[1]=()=>e(t).toggle())},{icon:C(()=>[d(f,{class:"h-4 w-4"})]),_:1})])]),e(t).data.length?(r(),v("div",Cr,[(r(!0),v(O,null,G(e(t).data,h=>(r(),E(k,{key:h.name,class:"flex cursor-pointer items-start gap-3.5 px-5 py-2.5 hover:bg-gray-100",to:i(h),onClick:()=>{a(h)}},{default:C(()=>[d(e(ks),{name:h.user_from},null,8,["name"]),n("span",null,[n("div",$r,[n("span",Ar,[n("span",Sr,D(h.user_from),1),h.notification_type==="Mention"?(r(),v("span",Vr,"mentioned you in ticket")):A("",!0),h.notification_type==="Assignment"?(r(),v("span",Ir,"assigned you a ticket")):A("",!0),h.notification_type==="Reaction"?(r(),v("span",Er,"has reopened the ticket")):A("",!0),n("span",Dr,D(h.reference_ticket),1)])]),n("div",Br,[n("div",Lr,D(e(kn).tz(h.creation).fromNow()),1),h.read?A("",!0):(r(),v("div",Fr))])])]),_:2},1032,["to","onClick"]))),128))])):(r(),v("div",Tr,[d(y,{class:"size-6"}),p[3]||(p[3]=n("p",{class:"text-base text-ink-gray-8"},"You are all caught up!",-1))]))],4)):A("",!0)}}}),Or={key:0,class:"flex h-7 items-center px-2 text-sm font-medium text-ink-gray-4"},Rr=["onClick"],qr={class:"whitespace-nowrap text-ink-gray-7"},jr={key:0,class:"border-t p-1.5"},it={__name:"Dropdown",props:{button:{type:Object,default:null},options:{type:Array,default:()=>[]},placement:{type:String,default:"left"}},setup(o){const t=o,l=Dl(),s=Ja(),a={enterActiveClass:"transition duration-100 ease-out",enterFromClass:"transform scale-95 opacity-0",enterToClass:"transform scale-100 opacity-100",leaveActiveClass:"transition duration-75 ease-in",leaveFromClass:"transform scale-100 opacity-100",leaveToClass:"transform scale-95 opacity-0"},i=N(()=>{var f;return((f=t.options[0])!=null&&f.group?t.options:[{group:"",items:t.options}]).map((k,y)=>({key:y,group:k.group,hideLabel:k.hideLabel||!1,items:m(k.items)}))}),u=N(()=>t.placement==="left"?"bottom-start":t.placement==="right"?"bottom-end":t.placement==="center"?"bottom-center":t.placement==="right-start"?"right-start":"bottom");function p(c){let f=c.onClick||null;return!f&&c.route&&l&&(f=()=>l.push(c.route)),{name:c.name,label:c.label,icon:c.icon,group:c.group,component:c.component,onClick:f}}function m(c){return(c||[]).filter(Boolean).filter(f=>f.condition?f.condition():!0).map(f=>p(f))}return(c,f)=>(r(),E(e(Ps),{as:"div",class:"relative inline-block text-left"},{default:C(({open:k})=>[d(e(qe),{transition:a,show:k,placement:u.value},{target:C(({togglePopover:y})=>[d(e(Ns),{as:"template"},{default:C(()=>[c.$slots.default?ae(c.$slots,"default",Dt(ye({key:0},{open:k,togglePopover:y}))):(r(),E(e(Q),ye({key:1,active:k},o.button),{default:C(()=>{var h;return[te(D(o.button?((h=o.button)==null?void 0:h.label)||null:"Options"),1)]}),_:1},16,["active"]))]),_:2},1024)]),body:C(()=>[n("div",{class:ee(["mt-2 min-w-40 divide-y divide-outline-gray-modals rounded-lg bg-surface-modal shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none",{"mt-2":["bottom","left","right"].includes(o.placement),"ml-2":o.placement=="right-start"}])},[d(e(Hs),{class:ee(["min-w-40 divide-y divide-outline-gray-modals",{"left-0 origin-top-left":o.placement=="left","right-0 origin-top-right":o.placement=="right","inset-x-0 origin-top":o.placement=="center","mt-0 origin-top-right":o.placement=="right-start"}])},{default:C(()=>[(r(!0),v(O,null,G(i.value,y=>(r(),v("div",{key:y.key,class:"p-1.5"},[y.group&&!y.hideLabel?(r(),v("div",Or,D(y.group),1)):A("",!0),(r(!0),v(O,null,G(y.items,h=>(r(),E(e(zs),{key:h.label},{default:C(({active:g})=>[ae(c.$slots,"item",ye({ref_for:!0},{item:h,active:g}),()=>[h.component?(r(),E(Oe(h.component),{key:0,active:g},null,8,["active"])):(r(),v("button",{key:1,class:ee([g?"bg-surface-gray-3":"text-ink-gray-6","group flex h-7 w-full items-center rounded px-2 text-base"]),onClick:h.onClick},[h.icon&&typeof h.icon=="string"?(r(),E(e(Ne),{key:0,name:h.icon,class:"mr-2 h-4 w-4 flex-shrink-0 text-ink-gray-7","aria-hidden":"true"},null,8,["name"])):h.icon?(r(),E(Oe(h.icon),{key:1,class:"mr-2 h-4 w-4 flex-shrink-0 text-ink-gray-7"})):A("",!0),n("span",qr,D(h.label),1)],10,Rr))])]),_:2},1024))),128))]))),128))]),_:3},8,["class"]),e(s).footer?(r(),v("div",jr,[ae(c.$slots,"footer")])):A("",!0)],2)]),_:2},1032,["show","placement"])]),_:3}))}},Ur={class:"flex border-b pr-5"},Pr={class:"flex items-start justify-center"},Nr={__name:"AppHeader",setup(o){const{user:t}=Ot(),l=jl();return be(()=>{l.fetchCallIntegrationStatus()}),(s,a)=>(r(),v("div",Ur,[a[0]||(a[0]=n("div",{id:"app-header",class:"flex-1 w-full"},null,-1)),n("div",Pr,[d(fs,{userEmail:e(t)},null,8,["userEmail"])])]))}},Hr={class:"w-full grid grid-cols-2 gap-10 py-1 shortcutsModal"},zr={class:"text-lg font-semibold text-ink-gray-9 mb-4"},Qr={class:"space-y-2"},Jr={class:"text-ink-gray-7 text-base flex-1"},Gr={class:"flex space-x-1 gap-1 justify-end"},Ct="Shift",Kr=j({__name:"ShortcutsModal",props:ze({modelValue:Boolean},{modelValue:{type:Boolean},modelModifiers:{}}),emits:ze(["update:modelValue"],["update:modelValue"]),setup(o,{emit:t}){const l=De(o,"modelValue"),{metaIcon:s}=Rl(),a=N(()=>[{title:"General",shortcuts:[{keys:[s,"K"],description:"Open command palette"},{keys:[s,","],description:"Open settings"},{keys:[s,"/"],description:"Show keyboard shortcuts"},{keys:[s,"H"],description:"Open help"}]},{title:"Ticket Management",shortcuts:[{keys:["T"],description:"Change ticket type"},{keys:["P"],description:"Change priority"},{keys:[Ct,"T"],description:"Change team"},{keys:["A"],description:"Assign ticket"},{keys:["S"],description:"Change status"},{keys:[s,"."],description:"Copy ticket id"},{keys:[s,Ct,"."],description:"Copy ticket URL"}]},{title:"Communication",shortcuts:[{keys:["R"],description:"Open reply box"},{keys:["C"],description:"Open comment box"}],hideBorder:!0},{title:"Navigation",shortcuts:[{keys:[Ct,">"],description:"Next ticket"},{keys:[Ct,"<"],description:"Previous ticket"}],hideBorder:!0}]);return be(()=>{Le.value||ul({key:"/",meta:!0},()=>{l.value=!l.value})}),(i,u)=>(r(),E(e(je),{modelValue:l.value,"onUpdate:modelValue":u[0]||(u[0]=p=>l.value=p),options:{title:"Keyboard Shortcuts",size:"4xl"}},{"body-content":C(()=>[n("div",Hr,[(r(!0),v(O,null,G(a.value,p=>(r(),v("div",{key:p.title,class:ee(["pb-4",!p.hideBorder&&"border-b border-outline-gray-2"])},[n("h2",zr,D(p.title),1),n("ul",Qr,[(r(!0),v(O,null,G(p.shortcuts,(m,c)=>(r(),v("li",{key:c,class:"flex items-start justify-between gap-4"},[n("div",Jr,D(m.description),1),n("div",Gr,[(r(!0),v(O,null,G(m.keys,(f,k)=>(r(),v("span",{key:k,class:ee(["bg-surface-gray-2 border border-outline-gray-2 text-xs rounded-sm text-ink-gray-8 shadow-sm min-w-5 h-5 flex items-center justify-center",[![e(s),Ct].includes(f)&&"w-5 ",f===Ct&&"!px-2"]])},D(f),3))),128))])]))),128))])],2))),128))])]),_:1},8,["modelValue"]))}});const Wr={name:"ConfirmDialog",props:{title:{type:String},message:{type:String},onConfirm:{type:Function,default:null},onCancel:{type:Function,default:null}},expose:["show","hide"],components:{Dialog:je,Button:Q},data(){return{showDialog:!0,isLoading:!1}},methods:{async handleConfirmation(){if(!this.isLoading){this.isLoading=!0;try{this.onConfirm&&await this.onConfirm({hideDialog:this.hide}),this.hide()}catch(o){console.error("Error in confirmation:",o)}finally{this.isLoading=!1}}},show(){this.showDialog=!0},closeDialog(){var o;this.hide(),(o=this.onCancel)==null||o.call(this)},hide(){this.showDialog=!1}}},Zr={class:"space-y-4"},Yr=["innerHTML"];function Xr(o,t,l,s,a,i){const u=W("Button"),p=W("Dialog");return r(),E(p,{modelValue:a.showDialog,"onUpdate:modelValue":t[0]||(t[0]=m=>a.showDialog=m),options:{title:l.title},onClose:i.closeDialog},{"body-content":C(()=>[n("div",Zr,[l.message?(r(),v("p",{key:0,class:"text-p-base text-gray-800",innerHTML:l.message},null,8,Yr)):A("",!0)])]),actions:C(()=>[d(u,{class:"w-full",label:"Confirm",variant:"solid",loading:a.isLoading,onClick:l.onConfirm},null,8,["loading","onClick"])]),_:1},8,["modelValue","options","onClose"])}const bt=Ue(Wr,[["render",Xr]]),eu={class:"space-y-3"},tu={key:0,class:"flex max-h-[300px] min-h-[100px] flex-col overflow-y-auto rounded border bg-gray-100 px-2"},lu={class:"flex flex-wrap gap-2 py-2"},nu=["title"],au={class:"ml-2 text-base"},su=["onClick"],ou={class:"flex justify-end items-center"},Ln={__name:"AddNewAgentsDialog",props:{show:Boolean,title:String},emits:["close","update:modelValue","onAgentsInvited"],setup(o,{emit:t}){const l=o,s=t,a=$(""),i=$([]),u=$(!1),{updateOnboardingStep:p}=ft("helpdesk"),{isManager:m}=Ot(),c=I=>/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(I),f=I=>{if(I=I.replaceAll(" ",""),I==""){document.getElementById("searchInput").value="";return}const L=I,_=I.split(",");let x=!1;u.value=!1,_.forEach(V=>{c(V)&&(_.length>1||L.includes(",")?(k(V),x=!0):u.value=!0)}),x&&g()},k=I=>{i.value=[...new Set([...i.value,I])]},y=I=>{i.value=i.value.filter(L=>L!==I)},h=()=>{i.value=[]},g=()=>{u.value=!1,a.value="";const I=document.getElementById("searchInput");I.value="",I.focus()},b=()=>{a.value="",i.value=[],s("close")},S=me({url:"helpdesk.api.agent.sent_invites",onSuccess:I=>{s("onAgentsInvited",i.value),u.value=!1,a.value="",i.value=[],m&&p("invite_agents"),J.success("Invites sent successfully!"),b()}}),F=()=>{S.submit({emails:i.value})};return(I,L)=>{const _=W("Button");return r(),E(e(je),{options:{title:l.title},"model-value":o.show,"onUpdate:modelValue":L[4]||(L[4]=x=>I.$emit("update:modelValue",x)),onClose:L[5]||(L[5]=x=>b())},pn({"body-content":C(()=>[n("div",eu,[n("form",{onSubmit:L[3]||(L[3]=he((...x)=>I.onSubmit&&I.onSubmit(...x),["prevent"])),class:"flex flex-row items-center space-x-2"},[d(e(Ga),{id:"searchInput",class:"w-full",type:"text",modelValue:a.value,"onUpdate:modelValue":L[0]||(L[0]=x=>a.value=x),placeholder:"Type emails",onInput:L[1]||(L[1]=x=>f(x))},null,8,["modelValue"]),d(_,{appearance:"primary",type:"submit",disabled:!u.value,onClick:L[2]||(L[2]=()=>{k(a.value),g()})},{default:C(()=>[...L[6]||(L[6]=[te(" Add ",-1)])]),_:1},8,["disabled"])],32),i.value.length?(r(),v("div",tu,[n("ul",lu,[(r(!0),v(O,null,G(i.value.slice().reverse(),x=>(r(),v("li",{class:"flex items-center space-x-2 rounded bg-white p-1 shadow",key:x,title:x},[n("span",au,D(x),1),n("button",{class:"grid h-4 w-4 place-items-center rounded text-gray-700 hover:bg-gray-300",onClick:V=>y(x)},[d(e(Ne),{class:"w-3",name:"x"})],8,su)],8,nu))),128))])])):A("",!0)])]),_:2},[i.value.length?{name:"actions",fn:C(()=>[n("div",ou,[d(_,{disabled:i.value.length==0,appearance:"primary",onClick:F,class:"mr-2",variant:"solid",loading:e(S).loading},{default:C(()=>[...L[7]||(L[7]=[te("Send Invites ",-1)])]),_:1},8,["disabled","loading"]),d(_,{onClick:h},{default:C(()=>[...L[8]||(L[8]=[te(" Clear All ",-1)])]),_:1})])]),key:"0"}:void 0]),1032,["options","model-value"])}}},iu={class:"flex items-start justify-between"},ru={class:"flex flex-col gap-1"},uu={class:"text-lg font-semibold text-ink-gray-8"},du={class:"text-p-sm text-gray-700 max-w-md text-ink-gray-6"},cu={key:0,class:"mt-6"},We=j({__name:"SettingsLayoutHeader",props:{title:{type:String},description:{type:String}},setup(o){return(t,l)=>(r(),v(O,null,[n("div",iu,[n("div",ru,[ae(t.$slots,"title",{},()=>[n("h1",uu,D(o.title),1)]),ae(t.$slots,"description",{},()=>[n("p",du,D(o.description),1)])]),ae(t.$slots,"actions")]),t.$slots["bottom-section"]?(r(),v("div",cu,[ae(t.$slots,"bottom-section")])):A("",!0)],64))}}),pu={class:"flex items-center space-x-3 w-4/5"},mu={class:"flex items-center gap-2"},fu={class:"text-base"},vu={class:"text-base text-ink-gray-6 mt-1"},Fn=j({__name:"AgentCard",props:{agent:{type:Object,required:!0},showStatus:{type:Boolean,default:!1}},setup(o){return(t,l)=>{const s=W("Badge");return r(),v("div",{class:ee(["flex items-center justify-between py-2",t.$attrs])},[n("div",pu,[d(e(kt),{image:o.agent.user_image,label:o.agent.agent_name,size:"xl"},null,8,["image","label"]),n("div",null,[n("div",mu,[n("p",fu,D(o.agent.agent_name),1),o.showStatus?(r(),E(s,{key:0,label:"Inactive",theme:"gray",class:ee(o.showStatus&&!o.agent.is_active?"opacity-100":"opacity-0"),variant:"subtle"},null,8,["class"])):A("",!0)]),n("div",vu,D(o.agent.name),1)])]),ae(t.$slots,"right")],2)}}}),sl=20,xe=ct({doctype:"HD Agent",fields:["name","user_image","agent_name","is_active"],start:0,pageLength:sl,orderBy:"creation desc",auto:!Le.value}),St=$("Active"),$t=$(!1),gu=()=>{const o=$(""),t=Xe({});ve(o,s=>{xe.filters={agent_name:["like",`%${s}%`],...t},s||(xe.filters={...t},xe.start=0,xe.pageLength=sl),xe.reload()}),ve(t,s=>{xe.filters={...xe.filters,...s},xe.start=0,xe.pageLength=sl,xe.reload()},{deep:!0}),ve(St,s=>{s==="Active"?xe.filters={...xe.filters,is_active:1}:s==="Inactive"?xe.filters={...xe.filters,is_active:0}:xe.filters={...xe.filters,is_active:["in",[0,1]]},xe.start=0,xe.pageLength=sl,xe.reload()},{immediate:!0});async function l(s,a){await me({url:"frappe.client.set_value",params:{doctype:"HD Agent",name:s,fieldname:"is_active",value:a}}).submit()}return{search:o,agents:xe,filters:t,updateAgent:l}},yu={class:"flex items-center gap-2 justify-between"},hu=["onClick"],_u={class:"flex items-center justify-between flex-1"},bu={class:"whitespace-nowrap"},ku={key:0,class:"flex mt-28 justify-between w-full h-full"},xu={key:1,class:"flex mt-28 justify-between w-full h-full"},wu={key:2,class:"overflow-y-auto w-full hide-scrollbar mt-4"},Cu={class:"flex justify-center"},$u=j({__name:"Agents",setup(o){const{getUserRole:t,updateUserRoleCache:l}=Ml(),{isManager:s}=Ot(),a=gu(),i=a.search,u=a.agents;function p(y){const h=t(y),g=[{label:"Agent",component:b=>m({role:"Agent",active:b.active,selected:h==="Agent",onClick:()=>{c(y,"Agent")}})}];return s&&g.unshift({label:"Manager",component:b=>m({role:"Manager",active:b.active,selected:h==="Manager",onClick:()=>{c(y,"Manager")}})}),g}function m({active:y,role:h,onClick:g,selected:b}){return de("button",{class:[y?"bg-surface-gray-2":"text-ink-gray-7","group flex w-full justify-between items-center rounded-md px-2 py-2 text-base"],onClick:b?null:g},[de("span",{class:"whitespace-nowrap"},h),b?de(kl,{class:["h-4 w-4 shrink-0 text-ink-gray-7"],"aria-hidden":!0}):null])}function c(y,h){t(y)!==h&&ot("helpdesk.helpdesk.doctype.hd_agent.hd_agent.update_agent_role",{user:y,new_role:h}).then(()=>{l(y,h),J.success(`Role updated to ${h}`)})}function f(y){let h=a.filters;return[{label:"Disable Agent",icon:"x-circle",onClick:async()=>{await a.updateAgent(y.name,0),u.reload({...h,search:i.value})},condition:()=>y.is_active},{label:"Enable Agent",icon:"check-circle",onClick:async()=>{await a.updateAgent(y.name,1),u.reload({...h,search:i.value})},condition:()=>!y.is_active}]}const k=[{label:"All",onClick:()=>{a.filters.is_active=["in",[0,1]],St.value="All"}},{label:"Active",onClick:()=>{a.filters.is_active=["=",1],St.value="Active"}},{label:"Inactive",onClick:()=>{a.filters.is_active=["=",0],St.value="Inactive"}}];return(y,h)=>{var x,V;const g=mn,b=W("Button"),S=Rt,F=W("FeatherIcon"),I=it,L=We,_=Ln;return r(),v(O,null,[n("div",{class:ee([y.$attrs.class,"px-10 py-8"])},[d(L,{title:y.__("Agents"),description:y.__("Add, manage agents and assign roles to them.")},{actions:C(()=>[d(b,{onClick:h[0]||(h[0]=()=>$t.value=!e($t)),label:"New",variant:"solid"},{prefix:C(()=>[d(g,{class:"h-4 w-4 stroke-1.5"})]),_:1})]),"bottom-section":C(()=>[n("div",yu,[d(e(pe),{modelValue:e(i),"onUpdate:modelValue":h[1]||(h[1]=w=>ut(i)?i.value=w:null),placeholder:"Search",type:"text",debounce:300,class:"w-60"},{prefix:C(()=>[d(S,{class:"h-4 w-4 text-gray-500"})]),_:1},8,["modelValue"]),d(I,{options:k,placement:"right"},{default:C(({open:w})=>[d(b,{label:e(St),class:"flex items-center justify-between w-[90px]"},{suffix:C(()=>[d(F,{name:w?"chevron-up":"chevron-down",class:"h-4"},null,8,["name"])]),_:2},1032,["label"])]),item:C(({item:w,active:B})=>[n("button",{class:ee(["group flex text-ink-gray-6 gap-4 h-7 w-full justify-between items-center rounded px-2 text-base",{"bg-surface-gray-3":B}]),onClick:w.onClick},[n("div",_u,[n("span",bu,D(w.label),1),e(St)===w.label?(r(),E(F,{key:0,name:"check",class:"size-4 text-ink-gray-7"})):A("",!0)])],10,hu)]),_:1})])]),_:1},8,["title","description"]),e(u).loading?(r(),v("div",ku,[d(b,{loading:e(u).loading,variant:"ghost",class:"w-full",size:"2xl"},null,8,["loading"])])):A("",!0),!e(u).loading&&!((x=e(u).data)!=null&&x.length)?(r(),v("div",xu,[...h[5]||(h[5]=[n("p",{class:"text-sm text-gray-500 w-full flex justify-center"}," No agents found ",-1)])])):A("",!0),!e(u).loading&&((V=e(u).data)!=null&&V.length)?(r(),v("div",wu,[(r(!0),v(O,null,G(e(u).data,(w,B)=>(r(),v("div",{key:w.agent_name},[d(Fn,{agent:w,"show-status":!0,class:ee(B!==e(u).data.length-1&&"border-b ")},{right:C(()=>[e(s)?(r(),E(I,{key:0,class:"w-1/5 flex justify-end items-center",options:p(w.name),label:e(t)(w.name),button:{label:e(t)(w.name),iconRight:"chevron-down"},placement:"right"},null,8,["options","label","button"])):A("",!0),(r(),E(I,{options:f(w),placement:"right",key:w,class:"ml-2"},{default:C(()=>[d(b,null,{icon:C(()=>[d(e(ql),{class:"h-4 w-4"})]),_:1})]),_:1},8,["options"]))]),_:2},1032,["agent","class"])]))),128)),n("div",Cu,[!e(u).loading&&e(u).hasNextPage?(r(),E(b,{key:0,class:"mt-3.5 p-2",onClick:h[2]||(h[2]=()=>e(u).next()),loading:e(u).loading,label:"Load More","icon-left":"refresh-cw"},null,8,["loading"])):A("",!0)])])):A("",!0)],2),d(_,{title:y.__("Add Agents"),onClose:h[3]||(h[3]=w=>$t.value=!1),modelValue:e($t),show:e($t),"onUpdate:modelValue":h[4]||(h[4]=w=>$t.value=w)},null,8,["title","modelValue","show"])],64)}}}),Au={class:"flex flex-col gap-4 px-10 py-8"},Su={class:"flex flex-col gap-2"},Vu={class:"text-sm text-gray-600"},Iu={class:"flex gap-4 items-center"},Eu={key:2},Du=j({__name:"Branding",setup(o){var f;const t=fn(),l=me({url:"frappe.client.get_value",cache:!0,params:{doctype:"Website Settings",fieldname:"favicon"},onSuccess(k){s.brandFavicon=k.favicon},auto:!0}),s=Xe({brandLogo:t.brandLogo,brandFavicon:((f=l.data)==null?void 0:f.favicon)||""}),a=Xe({logoLoading:!1,faviconLoading:!1}),i=N(()=>[{title:"Brand Logo",image:s.brandLogo,doctype:"HD Settings",fieldname:"brand_logo",loading:a.logoLoading},{title:"Brand Favicon",image:s.brandFavicon,doctype:"Website Settings",fieldname:"favicon",loading:a.faviconLoading}]),u=me({url:"frappe.client.set_value",debounce:1e3,onSuccess(k){k.doctype==="HD Settings"?m(k.brand_logo):c(k.favicon)},onError(){J.error("Failed to update, please try again"),a.logoLoading=!1,a.faviconLoading=!1}});function p(k,y,h){u.submit({doctype:y,name:y,fieldname:h,value:k}),y==="HD Settings"?a.logoLoading=!0:a.faviconLoading=!0}function m(k){s.brandLogo=k,a.logoLoading=!1,J.success("Brand logo updated")}function c(k){s.brandFavicon=k,a.faviconLoading=!1,J.success("Favicon updated, please refresh the page to see the changes")}return(k,y)=>{const h=W("Button");return r(),v("div",Au,[d(We,{title:"Customise your Helpdesk",description:"Customise Helpdesk with your own branding."}),(r(!0),v(O,null,G(i.value,g=>(r(),v("div",Su,[n("p",Vu,D(g.title),1),n("div",Iu,[g.image&&!g.loading?(r(),E(e(kt),{key:0,size:"3xl",image:g.image},null,8,["image"])):A("",!0),g.image?(r(),v("div",Eu,[d(h,{label:"Remove",onClick:b=>p("",g.doctype,g.fieldname),iconLeft:"trash",loading:g.loading},null,8,["onClick","loading"])])):(r(),E(e($s),{key:1,fileTypes:["image/*"],onSuccess:b=>{p(b.file_url,g.doctype,g.fieldname)}},{default:C(({openFileSelector:b})=>[d(h,{onClick:S=>b(),iconLeft:"upload",label:"Upload Image",loading:g.loading},null,8,["onClick","loading"])]),_:2},1032,["onSuccess"]))])]))),256))])}}}),Tn="/assets/helpdesk/desk/assets/gmail-6497f877.png",Mn="/assets/helpdesk/desk/assets/outlook-e028ee9b.png",On="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwMAAALUBAMAAAClQPMzAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAlwSFlzAAAuIwAALiMBeKU/dgAAACRQTFRFR3BMNqzpdMXvXb3tr+f3o+P1AJ/ZGoPjALPjmeH1dc3uBqfjM5e/jQAAAAZ0Uk5TAPVwwVLTgnc47wAABIBJREFUeNrt1rEJwlAYhdEHNpZa2UpwAxewcAXtbdJYpQo4gATsBVdwAOcTd/DyknC+9zY4XPhLkSRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJGmGL/cTazo5gOWR69KFWCBAgQIAAAQIECBAgmArBHYEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAMHfO4U6X9tP4reb9aX77/v9rqtH8Ar1bEOl1oWgNsGAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAjqEfShbu9QTajD/AhS8yqzCwECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIKheE2p3DFUkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZLG2Bet4fvU2eVggAAAAABJRU5ErkJggg==",Rn="/assets/helpdesk/desk/assets/sparkpost-3d6653ba.webp",qn="/assets/helpdesk/desk/assets/yahoo-bf2216d3.png",jn="/assets/helpdesk/desk/assets/yandex-5e1e6be8.png",Un="/assets/helpdesk/desk/assets/frappe-mail-579163d7.svg",Pn=[{label:"Account Name",name:"email_account_name",type:"text",placeholder:"Support / Sales"},{label:"Email ID",name:"email_id",type:"email",placeholder:"johndoe@example.com"}],Nn=[{label:"Enable Incoming",name:"enable_incoming",type:"checkbox",description:"If enabled, tickets can be created from the incoming emails on this account."},{label:"Enable Outgoing",name:"enable_outgoing",type:"checkbox",description:"If enabled, outgoing emails can be sent from this account."},{label:"Default Incoming",name:"default_incoming",type:"checkbox",description:"If enabled, all replies to your company (eg: replies@yourcomany.com) will come to this account. Note: Only one account can be default incoming."},{label:"Default Outgoing",name:"default_outgoing",type:"checkbox",description:"If enabled, all outgoing emails will be sent from this account. Note: Only one account can be default outgoing."}],Hn=[...Pn,{label:"Password",name:"password",type:"password",placeholder:"********"}],zn=[...Pn,{label:"Frappe Mail Site",name:"frappe_mail_site",type:"text",placeholder:"https://frappemail.com"},{label:"API Key",name:"api_key",type:"text",placeholder:"********"},{label:"API Secret",name:"api_secret",type:"password",placeholder:"********"}],Qn=[{name:"GMail",icon:Tn,info:`Setting up GMail requires you to enable two factor authentication
		  and app specific passwords. Read more`,link:"https://support.google.com/accounts/answer/185833",custom:!1},{name:"Outlook",icon:Mn,info:`Setting up Outlook requires you to enable two factor authentication
		  and app specific passwords. Read more`,link:"https://support.microsoft.com/en-us/account-billing/how-to-get-and-use-app-passwords-5896ed9b-4263-e681-128a-a6f2979a7944",custom:!1},{name:"Sendgrid",icon:On,info:`Setting up Sendgrid requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://sendgrid.com/docs/ui/account-and-settings/two-factor-authentication/",custom:!1},{name:"SparkPost",icon:Rn,info:`Setting up SparkPost requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://support.sparkpost.com/docs/my-account-and-profile/enabling-two-factor-authentication",custom:!1},{name:"Yahoo",icon:qn,info:`Setting up Yahoo requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://help.yahoo.com/kb/SLN15241.html",custom:!1},{name:"Yandex",icon:jn,info:`Setting up Yandex requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://yandex.com/support/id/authorization/app-passwords.html",custom:!1},{name:"Frappe Mail",icon:Un,info:"Setting up Frappe Mail requires you to have an API key and API Secret of your email account. Read more ",link:"https://github.com/frappe/mail",custom:!0}],Jn={GMail:Tn,Outlook:Mn,Sendgrid:On,SparkPost:Rn,Yahoo:qn,Yandex:jn,"Frappe Mail":Un};function Gn(o,t){if(!o.email_account_name)return"Account name is required";if(!o.email_id)return"Email ID is required";if(!Ka(o.email_id))return"Invalid email ID";if(!t&&!o.password)return"Password is required";if(t){if(!o.api_key)return"API Key is required";if(!o.api_secret)return}return""}const Bu=["src"],Lu={key:0,class:"text-center text-p-xs text-gray-700"},Ul=j({__name:"EmailProviderIcon",props:{serviceName:{default:""},logo:{default:""},selected:{type:Boolean,default:!1}},setup(o){return(t,l)=>(r(),v(O,null,[n("div",{class:ee(["flex h-10 w-10 cursor-pointer items-center justify-center rounded-xl bg-gray-100 hover:bg-gray-200",{"ring-2 ring-blue-500":t.selected}])},[n("img",{src:t.logo,class:"h-6 w-6"},null,8,Bu)],2),t.serviceName?(r(),v("p",Lu,D(t.serviceName),1)):A("",!0)],64))}}),Fu={class:"flex h-full flex-col gap-4"},Tu={class:"flex flex-wrap items-center gap-4"},Mu=["onClick"],Ou={key:0,class:"flex flex-col gap-4"},Ru={class:"flex items-center gap-2 rounded-md p-2 ring-1 ring-gray-200"},qu={class:"text-wrap text-xs text-gray-700"},ju=["href"],Uu={class:"flex flex-col gap-4"},Pu={class:"grid grid-cols-1 gap-4"},Nu={class:"grid grid-cols-2 gap-4"},Hu={class:"text-gray-500 text-p-sm"},zu={key:1,class:"mt-auto flex justify-between"},Qu=j({__name:"EmailAdd",emits:["update:step"],setup(o,{emit:t}){const l=t,{updateOnboardingStep:s}=ft("helpdesk"),a=Xe({service:"",email_account_name:"",email_id:"",password:"",api_key:"",api_secret:"",frappe_mail_site:"",enable_incoming:!1,enable_outgoing:!1,default_incoming:!1,default_outgoing:!1}),i=$(null),u=N(()=>i.value.custom?zn:Hn);function p(k){i.value=k,a.service=k.name}const m=me({url:"helpdesk.api.settings.email.create_email_account",makeParams:k=>({...k}),onSuccess:()=>{J.success("Email account created"),l("update:step","email-list"),s("setup_email_account")},onError:()=>{c.value="Failed to create email account, Invalid credentials"}}),c=$();function f(){c.value=Gn(a,i.value.custom),!c.value&&m.submit({data:a})}return(k,y)=>{const h=W("FormControl"),g=W("ErrorMessage"),b=W("Button");return r(),v("div",Fu,[y[2]||(y[2]=n("div",{role:"heading","aria-level":"1",class:"flex flex-col gap-1"},[n("h5",{class:"text-lg font-semibold pt-[5px]"},"Setup Email"),n("p",{class:"text-sm text-gray-600"}," Choose the email service provider you want to configure. ")],-1)),n("div",Tu,[(r(!0),v(O,null,G(e(Qn),S=>{var F;return r(),v("div",{key:S.name,class:"min-w-3 flex flex-col items-center gap-1",onClick:I=>p(S)},[d(Ul,{"service-name":S.name,logo:S.icon,selected:((F=i.value)==null?void 0:F.name)===(S==null?void 0:S.name)},null,8,["service-name","logo","selected"])],8,Mu)}),128))]),i.value?(r(),v("div",Ou,[n("div",Ru,[d(e(nl),{class:"h-6 w-5 w-min-5 w-max-5 min-h-5 max-w-5 text-blue-500"}),n("div",qu,[te(D(i.value.info)+" ",1),n("a",{href:i.value.link,target:"_blank",class:"text-blue-500 underline"},"here",8,ju),y[1]||(y[1]=te(" . ",-1))])]),n("div",Uu,[n("div",Pu,[(r(!0),v(O,null,G(u.value,S=>(r(),v("div",{key:S.name,class:"flex flex-col gap-1"},[d(h,{modelValue:a[S.name],"onUpdate:modelValue":F=>a[S.name]=F,label:S.label,name:S.name,type:S.type,placeholder:S.placeholder},null,8,["modelValue","onUpdate:modelValue","label","name","type","placeholder"])]))),128))]),n("div",Nu,[(r(!0),v(O,null,G(e(Nn),S=>(r(),v("div",{key:S.name,class:"flex flex-col gap-1"},[d(h,{modelValue:a[S.name],"onUpdate:modelValue":F=>a[S.name]=F,label:S.label,name:S.name,type:S.type},null,8,["modelValue","onUpdate:modelValue","label","name","type"]),n("p",Hu,D(S.description),1)]))),128))]),c.value?(r(),E(g,{key:0,class:"ml-1",message:c.value},null,8,["message"])):A("",!0)])])):A("",!0),i.value?(r(),v("div",zu,[d(b,{label:"Back",theme:"gray",variant:"outline",disabled:e(m).loading,onClick:y[0]||(y[0]=S=>l("update:step","email-list"))},null,8,["disabled"]),d(b,{label:"Create",variant:"solid",loading:e(m).loading,onClick:f},null,8,["loading"])])):A("",!0)])}}}),Ju={class:"flex justify-between items-center border-gray-200 p-2 pl-0 cursor-pointer"},Gu={class:"flex justify-between items-center gap-2"},Ku={class:"text-gray-700 font-semibold"},Wu={class:"text-sm text-gray-500"},Zu=j({__name:"EmailAccountCard",props:{emailAccount:{}},setup(o){const t=o,l=N(()=>t.emailAccount.default_incoming&&t.emailAccount.default_outgoing?["Default Sending and Inbox",t.emailAccount.enable_incoming&&t.emailAccount.enable_outgoing?"blue":"gray"]:t.emailAccount.default_incoming?["Default Inbox",t.emailAccount.enable_incoming?"blue":"gray"]:t.emailAccount.default_outgoing?["Default Sending",t.emailAccount.enable_outgoing?"blue":"gray"]:["Inbox",t.emailAccount.enable_incoming?"blue":"gray"]);return(s,a)=>{const i=W("Badge");return r(),v("div",Ju,[n("div",Gu,[d(Ul,{logo:e(Jn)[s.emailAccount.service]},null,8,["logo"]),n("div",null,[n("p",Ku,D(s.emailAccount.email_account_name),1),n("div",Wu,D(s.emailAccount.email_id),1)])]),n("div",null,[d(i,{variant:"subtle",label:l.value[0],theme:l.value[1]},null,8,["label","theme"])])])}}}),Yu={key:0,class:"mt-4 divide-y"},Xu={key:1,class:"flex items-center justify-center h-64 text-gray-500"},ed=j({__name:"EmailAccountList",emits:["update:step"],setup(o,{emit:t}){const l=t,s=ct({doctype:"Email Account",cache:["Email Accounts"],fields:["*"],filters:{email_id:["Not Like","%example%"]},pageLength:10,auto:!0,onSuccess:a=>{a.forEach(i=>{i.enable_incoming=!!i.enable_incoming,i.enable_outgoing=!!i.enable_outgoing,i.default_incoming=!!i.default_incoming,i.default_outgoing=!!i.default_outgoing})}});return(a,i)=>{var p;const u=W("Button");return r(),v("div",null,[d(We,{title:"Email Accounts",description:"Manage your email accounts and configure incoming and outgoing settings."},{actions:C(()=>[d(u,{label:"Add Account",theme:"gray",variant:"solid",onClick:i[0]||(i[0]=m=>l("update:step","email-add")),"icon-left":"plus"})]),_:1}),!e(s).loading&&((p=e(s).data)!=null&&p.length)?(r(),v("div",Yu,[(r(!0),v(O,null,G(e(s).data,m=>(r(),v("div",{key:m.name},[d(Zu,{emailAccount:m,onClick:c=>l("update:step","email-edit",m)},null,8,["emailAccount","onClick"])]))),128))])):(r(),v("div",Xu," Please add an email account to continue. "))])}}}),td={class:"flex h-full flex-col gap-4"},ld={class:"w-fit"},nd={class:"flex items-center gap-2 rounded-md p-2 ring-1 ring-gray-200"},ad={class:"text-wrap text-xs text-gray-700"},sd=["href"],od={class:"flex flex-col gap-4"},id={class:"grid grid-cols-1 gap-4"},rd={class:"grid grid-cols-2 gap-4"},ud={class:"text-p-sm text-gray-500"},dd={class:"mt-auto flex justify-between"},cd={class:"flex gap-2"},pd=j({__name:"EmailEdit",props:{accountData:{default:null}},emits:["update:step"],setup(o,{emit:t}){var I,L,_,x;const l=o,s=t,a=Xe({email_account_name:l.accountData.email_account_name||"",service:l.accountData.service||"",email_id:l.accountData.email_id||"",api_key:((I=l.accountData)==null?void 0:I.api_key)||null,api_secret:((L=l.accountData)==null?void 0:L.api_secret)||null,password:((_=l.accountData)==null?void 0:_.password)||null,frappe_mail_site:((x=l.accountData)==null?void 0:x.frappe_mail_site)||"",enable_incoming:l.accountData.enable_incoming||!1,enable_outgoing:l.accountData.enable_outgoing||!1,default_outgoing:l.accountData.default_outgoing||!1,default_incoming:l.accountData.default_incoming||!1}),i={description:"To know more about setting up email accounts, click",link:"https://docs.erpnext.com/docs/user/manual/en/email-account"},u=N(()=>Qn.find(V=>V.name===l.accountData.service).custom),p=N(()=>u.value?zn:Hn),m=$(),c=$(!1),f=Wa(`loading-emails-${a.email_account_name}`,!1);async function k(){if(m.value=Gn(a,u.value),m.value)return;const V={...l.accountData},w={...a},B=V.email_account_name!==w.email_account_name;delete V.email_account_name,delete w.email_account_name;const M=h.value,q=w;if(!B&&!M){J.create({message:"No changes made",icon:de(nl,{class:"text-ink-blue-2"})});return}if(B)try{c.value=!0,await g(),S()}catch{F()}if(M)try{c.value=!0,await b(q),S()}catch{F()}}function y(){f.value=!0,J.create({message:"Pulling emails, this may take a few minutes.",icon:de(nl,{class:"text-blue-500"})}),ot("frappe.email.doctype.email_account.email_account.pull_emails",{email_account:a.email_account_name}).then(()=>{localStorage.removeItem(`loading-emails-${a.email_account_name}`),f.value=null,J.success("Emails pulled successfully")}).catch(()=>{localStorage.removeItem(`loading-emails-${a.email_account_name}`),f.value=null,m.value="Failed to pull emails"})}const h=N(()=>a.email_id!==l.accountData.email_id||a.api_key!==l.accountData.api_key||a.api_secret!==l.accountData.api_secret||a.password!==l.accountData.password||a.enable_incoming!==l.accountData.enable_incoming||a.enable_outgoing!==l.accountData.enable_outgoing||a.default_outgoing!==l.accountData.default_outgoing||a.default_incoming!==l.accountData.default_incoming||a.frappe_mail_site!==l.accountData.frappe_mail_site);async function g(){return await ot("frappe.client.rename_doc",{doctype:"Email Account",old_name:l.accountData.email_account_name,new_name:a.email_account_name})}async function b(V){return(await ot("frappe.client.set_value",{doctype:"Email Account",name:a.email_account_name,fieldname:V})).name}function S(){s("update:step","email-list"),J.success("Email account updated successfully")}function F(){c.value=!1,m.value="Failed to update email account, Invalid credentials"}return(V,w)=>{const B=W("FormControl"),M=W("ErrorMessage"),q=W("Button");return r(),v("div",td,[w[2]||(w[2]=n("div",{role:"heading","aria-level":"1",class:"flex gap-1 justify-between pt-[5px]"},[n("h5",{class:"text-lg font-semibold"},"Edit Email")],-1)),n("div",ld,[d(Ul,{logo:e(Jn)[V.accountData.service],"service-name":V.accountData.service},null,8,["logo","service-name"])]),n("div",nd,[d(e(nl),{class:"h-6 w-5 w-min-5 w-max-5 min-h-5 max-w-5 text-ink-blue-2"}),n("div",ad,[te(D(i.description)+" ",1),n("a",{href:i.link,target:"_blank",class:"text-ink-blue-2 underline"},"here",8,sd),w[1]||(w[1]=te(" . ",-1))])]),n("div",od,[n("div",id,[(r(!0),v(O,null,G(p.value,U=>(r(),v("div",{key:U.name,class:"flex flex-col gap-1"},[d(B,{modelValue:a[U.name],"onUpdate:modelValue":P=>a[U.name]=P,label:U.label,name:U.name,type:U.type,placeholder:U.placeholder},null,8,["modelValue","onUpdate:modelValue","label","name","type","placeholder"])]))),128))]),n("div",rd,[(r(!0),v(O,null,G(e(Nn),U=>(r(),v("div",{key:U.name,class:"flex flex-col gap-1"},[d(B,{modelValue:a[U.name],"onUpdate:modelValue":P=>a[U.name]=P,label:U.label,name:U.name,type:U.type},null,8,["modelValue","onUpdate:modelValue","label","name","type"]),n("p",ud,D(U.description),1)]))),128))]),m.value?(r(),E(M,{key:0,class:"ml-1",message:m.value},null,8,["message"])):A("",!0)]),n("div",dd,[d(q,{label:"Back",theme:"gray",variant:"outline",disabled:c.value,onClick:w[0]||(w[0]=U=>s("update:step","email-list"))},null,8,["disabled"]),n("div",cd,[d(q,{label:"Update Account",variant:"solid",onClick:k,loading:c.value},null,8,["loading"]),V.accountData.enable_incoming?(r(),E(q,{key:0,label:"Pull Emails",variant:"subtle",onClick:y,loading:e(f),disabled:c.value},null,8,["loading","disabled"])):A("",!0)])])])}}}),md={class:"flex-1 px-10 py-8"},fd={key:0,class:"h-full"},vd={key:1,class:"h-full"},gd={key:2,class:"h-full"},yd=j({__name:"EmailConfig",setup(o){const t=$("email-list"),l=$(null);function s(a,i){t.value=a,l.value=i}return(a,i)=>(r(),v("div",md,[t.value==="email-add"?(r(),v("div",fd,[d(Qu,{"onUpdate:step":s})])):t.value==="email-list"?(r(),v("div",vd,[d(ed,{"onUpdate:step":s})])):t.value==="email-edit"?(r(),v("div",gd,[d(pd,{"account-data":l.value,"onUpdate:step":s},null,8,["account-data"])])):A("",!0)]))}}),hd={class:"lucide lucide-lock",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function _d(o,t){return r(),v("svg",hd,[...t[0]||(t[0]=[n("rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"},null,-1),n("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"},null,-1)])])}const bd=Z({name:"lucide-lock",render:_d}),kd={class:"lucide lucide-lock-open",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function xd(o,t){return r(),v("svg",kd,[...t[0]||(t[0]=[n("rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"},null,-1),n("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"},null,-1)])])}const wd=Z({name:"lucide-unlock",render:xd}),Cd={class:"lucide lucide-settings-2",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function $d(o,t){return r(),v("svg",Cd,[...t[0]||(t[0]=[n("path",{d:"M14 17H5"},null,-1),n("path",{d:"M19 7h-9"},null,-1),n("circle",{cx:"17",cy:"17",r:"3"},null,-1),n("circle",{cx:"7",cy:"7",r:"3"},null,-1)])])}const Kn=Z({name:"lucide-settings-2",render:$d}),Wn=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],H=$({assignCondition:"",unassignCondition:"",assignConditionJson:[],unassignConditionJson:[],rule:"Round Robin",priority:1,users:[],disabled:!1,description:"",name:"",assignmentRuleName:"",assignmentDays:Wn}),Zn=()=>{H.value={assignCondition:"",unassignCondition:"",assignConditionJson:[],unassignConditionJson:[],rule:"Round Robin",priority:1,users:[],disabled:!1,description:"",name:"",assignmentRuleName:"",assignmentDays:Wn}},Ee=$({screen:"list",data:null}),ht=(o,t=!1,l=!1)=>{const s=a=>{var i,u,p,m,c,f;if(!(o&&a!==o))switch(a){case"assignmentRuleName":((i=H.value.assignmentRuleName)==null?void 0:i.length)==0?_e.value.assignmentRuleName="Name is required":_e.value.assignmentRuleName="";break;case"description":_e.value.description=((u=H.value.description)==null?void 0:u.length)>0?"":"Description is required";break;case"assignCondition":if(t)break;_e.value.assignCondition=((p=H.value.assignConditionJson)==null?void 0:p.length)>0?"":"Assign condition is required",Gt(H.value.assignConditionJson)?_e.value.assignConditionError="":_e.value.assignConditionError="Assign conditions are invalid";break;case"unassignCondition":if(l)break;((m=H.value.unassignConditionJson)==null?void 0:m.length)>0&&!Gt(H.value.unassignConditionJson)?_e.value.unassignConditionError="Unassign conditions are invalid":_e.value.unassignConditionError="";break;case"users":_e.value.users=((c=H.value.users)==null?void 0:c.length)>0?"":"Users are required";break;case"assignmentDays":_e.value.assignmentDays=((f=H.value.assignmentDays)==null?void 0:f.length)>0?"":"Assignment days are required";break}};return o?s(o):Object.keys(_e.value).forEach(s),_e.value},_e=$({assignmentRuleName:"",assignCondition:"",assignConditionError:"",unassignConditionError:"",users:"",description:"",assignmentDays:""}),Ad=()=>{Object.keys(_e.value).forEach(o=>{_e.value[o]=""})},Sd={class:"w-full h-full flex flex-col"},Vd={class:"flex items-center justify-between mb-4"},Id={class:"flex items-center gap-1 justify-center -ml-[16px]"},Ed={class:"flex flex-col gap-4 h-full"},Dd={class:"flex gap-2 items-end"},Bd={class:"flex items-center justify-between !w-full"},Ld={class:"flex items-center gap-1"},Fd={class:"text-gray-600 text-sm"},Td={key:0,class:"flex flex-col divide-y divide-gray-200 overflow-y-scroll hide-scrollbar h-full"},Md={key:1,class:"flex justify-center h-full"},Od=j({__name:"TeamEdit",props:{teamName:{}},emits:["update:step"],setup(o,{emit:t}){var L;const l=o,s=t,{getUser:a}=Ml(),{teamRestrictionApplied:i}=fn(),u=$(l.teamName),p=al({doctype:"HD Team",name:l.teamName,auto:!0,delete:{onSuccess(){J.success("Team deleted"),s("update:step","team-list")}}}),m=N({get(){var _;return!!((_=p.doc)!=null&&_.ignore_restrictions)},set(_){p.doc&&p.setValue.submit({ignore_restrictions:_})}}),c=$(""),f=N(()=>{var x;return(((x=p.doc)==null?void 0:x.users)||[]).map(V=>{let w=a(V.user);return{name:V.user,user_image:w.user_image,agent_name:w.full_name}})}),k=N(()=>({name:["not in",f.value.map(_=>_.name)]}));function y(_){var V,w;const x=(w=(V=p.doc)==null?void 0:V.users)==null?void 0:w.filter(B=>B.user!==_);p.setValue.submit({users:x})}function h(_){const x=p.doc.users.concat([{user:_}]);p.setValue.submit({users:x}),c.value=""}const g=$(!1),b={title:"Rename team",message:"Enter the new name for the team",actions:[{label:"Confirm",variant:"solid",loading:p.loading,onClick:({close:_})=>{S(_)}}]};function S(_){me({url:"frappe.client.rename_doc",makeParams(){return{doctype:"HD Team",old_name:l.teamName,new_name:u.value}},validate(V){if(!V.new_name)return"New title is required";if(V.new_name===V.old_name)return"New and old title cannot be same"},onSuccess(){J.success("Team renamed"),_(),s("update:step","team-list")}}).submit()}const F=$(!1),I=[{label:"View Assignment rule",icon:Z(de(Kn,{class:"rotate-90"})),onClick:()=>{var _;Ee.value={data:{name:(_=p.doc)==null?void 0:_.assignment_rule},screen:"view"},_t("Assignment Rules")}},{label:"Rename",icon:"edit-3",onClick:()=>g.value=!g.value},{condition:()=>i,label:(L=p.doc)!=null&&L.ignore_restrictions?"Disable Bypass Restrictions":"Enable Bypass Restrictions",component:()=>de(Wt,{text:m.value?"Members of this team will see the tickets assigned to this team only":"Members of this team will be able to see the tickets assigned to all the teams"},{default:()=>{var _,x;return[de("div",{class:"flex items-center gap-2 p-2 cursor-pointer hover:bg-gray-100 rounded",onClick:()=>m.value=!m.value},[de((_=p.doc)!=null&&_.ignore_restrictions?bd:wd,{class:"h-4 w-4 text-gray-700",stroke:"currentColor","aria-hidden":"true"}),de("span",{class:"whitespace-nowrap text-ink-gray-7 text-p-base"},[(x=p.doc)!=null&&x.ignore_restrictions?"Access only this team's tickets":"Access all team tickets"])])]}})},{label:"Delete",component:de(Q,{label:"Delete",variant:"ghost",iconLeft:"trash-2",theme:"red",style:"width: 100%; justify-content: flex-start;",onClick:()=>{F.value=!F.value}})}];return(_,x)=>{const V=ql,w=Rt,B=mn,M=cn,q=W("FormControl");return r(),v(O,null,[n("div",Sd,[n("div",Vd,[n("div",Id,[d(e(Q),{variant:"ghost","icon-left":"chevron-left",label:_.teamName,size:"md",onClick:x[0]||(x[0]=()=>s("update:step","team-list")),class:"cursor-pointer hover:bg-transparent focus:bg-transparent focus:outline-none focus:ring-0 focus:ring-offset-0 focus-visible:none active:bg-transparent active:outline-none active:ring-0 active:ring-offset-0 active:text-ink-gray-5"},null,8,["label"])]),d(e(qt),{placement:"right",options:I},{default:C(()=>[d(e(Q),{variant:"ghost"},{icon:C(()=>[d(V,{class:"h-4 w-4"})]),_:1})]),_:1})]),n("div",Ed,[n("div",Dd,[d($n,{doctype:"HD Agent",class:"form-control flex-1",placeholder:"Search members",modelValue:c.value,"onUpdate:modelValue":x[1]||(x[1]=U=>c.value=U),label:"Members","hide-me":!0,filters:k.value},{prefix:C(()=>[d(w,{class:"h-4 w-4 text-gray-500 mr-2"})]),"item-label":C(({option:U})=>{var P,T;return[n("div",Bd,[n("div",Ld,[d(e(kt),{label:U.label||U.value,image:(P=e(a)(U.label))==null?void 0:P.user_image,size:"sm"},null,8,["label","image"]),n("p",null,D(((T=e(a)(U.label))==null?void 0:T.full_name)||"User"),1)]),n("p",Fd,D(U.label),1)])]}),_:1},8,["modelValue","filters"]),d(e(Q),{label:"Add",variant:"solid",disabled:!c.value,onClick:x[2]||(x[2]=U=>h(c.value))},{prefix:C(()=>[d(B,{class:"h-4 w-4 stroke-1.5"})]),_:1},8,["disabled"])]),f.value.length?(r(),v("div",Td,[(r(!0),v(O,null,G(f.value,(U,P)=>(r(),v("div",{key:U.user,class:ee(["group py-2",P==f.value.length-1&&"mb-12"])},[d(Fn,{agent:U,class:"!py-0"},{right:C(()=>[d(e(Q),{variant:"ghost",onClick:he(()=>y(U.name),["stop"]),theme:"red",class:"opacity-0 group-hover:opacity-100",disabled:e(p).loading},{icon:C(()=>[d(M,{class:"h-4 w-4"})]),_:1},8,["onClick","disabled"])]),_:2},1032,["agent"])],2))),128))])):(r(),v("div",Md,[...x[7]||(x[7]=[n("p",{class:"text-p-base text-gray-500"},"No members found",-1)])]))])]),d(e(je),{modelValue:F.value,"onUpdate:modelValue":x[4]||(x[4]=U=>F.value=U),options:{title:"Delete team"}},{"body-content":C(()=>[x[8]||(x[8]=n("p",{class:"text-p-base text-ink-gray-7"}," Are you sure you want to delete this team? This action cannot be reversed! ",-1)),d(e(Q),{variant:"solid",class:"mt-4 float-right",label:"Confirm",theme:"red",onClick:x[3]||(x[3]=()=>{e(p).delete.submit(),F.value=!1})})]),_:1},8,["modelValue"]),d(e(je),{modelValue:g.value,"onUpdate:modelValue":x[6]||(x[6]=U=>g.value=U),options:b},{"body-content":C(()=>[d(q,{modelValue:u.value,"onUpdate:modelValue":x[5]||(x[5]=U=>u.value=U),label:"Title",placeholder:"Product Experts"},null,8,["modelValue"])]),_:1},8,["modelValue"])],64)}}}),Rd=j({__name:"NewTeamModal",props:{modelValue:{},modelModifiers:{}},emits:ze(["create"],["update:modelValue"]),setup(o,{emit:t}){const l=t,s=De(o,"modelValue"),a=$(null),i=me({url:"frappe.client.insert",makeParams(){return{doc:{doctype:"HD Team",team_name:a.value}}},validate(u){if(As.isEmpty(u.doc.team_name))return"Title is required"},auto:!1,onSuccess(){J.success("Team created"),a.value=null,s.value=!1,l("create")}});return(u,p)=>{const m=W("FormControl"),c=W("Dialog");return r(),E(c,{modelValue:s.value,"onUpdate:modelValue":p[2]||(p[2]=f=>s.value=f),options:{title:"New team",actions:[{label:"Create",variant:"solid",onClick:()=>{e(i).submit()}}]}},{"body-content":C(()=>[n("form",{class:"space-y-2",onSubmit:p[1]||(p[1]=he((...f)=>e(i).submit&&e(i).submit(...f),["prevent"]))},[d(m,{modelValue:a.value,"onUpdate:modelValue":p[0]||(p[0]=f=>a.value=f),label:"Title",placeholder:"Product experts",type:"text"},null,8,["modelValue"])],32)]),_:1},8,["modelValue","options"])}}}),qd={class:"w-full h-full flex flex-col"},jd={key:0,class:"divide-y w-full h-full hide-scrollbar overflow-y-scroll mt-4"},Ud=["onClick"],Pd={class:"flex items-center gap-2"},Nd={key:1,class:"flex mt-28 justify-between w-full h-full"},Hd={key:2,class:"flex mt-28 justify-between w-full h-full"},zd=j({__name:"TeamsList",emits:["update:step"],setup(o,{emit:t}){const l=t,s=ct({doctype:"HD Team",cache:["Teams"],fields:["name"],auto:!0,orderBy:"creation desc"}),a=$(""),i=$(!1);return ve(a,u=>{s.filters={name:["like",`%${u}%`]},u||(s.start=0,s.pageLength=10),s.reload()}),(u,p)=>{var k,y;const m=W("Button"),c=Rt,f=We;return r(),v(O,null,[n("div",qd,[d(f,{title:"Teams",description:"Create and manage teams and assign agents to specific teams."},{actions:C(()=>[d(m,{label:"New",theme:"gray",variant:"solid",onClick:p[0]||(p[0]=()=>i.value=!i.value),"icon-left":"plus"})]),"bottom-section":C(()=>[d(e(pe),{modelValue:a.value,"onUpdate:modelValue":p[1]||(p[1]=h=>a.value=h),placeholder:"Search",type:"text",debounce:300,class:"w-60"},{prefix:C(()=>[d(c,{class:"h-4 w-4 text-gray-500"})]),_:1},8,["modelValue"])]),_:1}),!e(s).loading&&((k=e(s).data)==null?void 0:k.length)>0?(r(),v("div",jd,[(r(!0),v(O,null,G(e(s).data,h=>(r(),v("div",{key:h.name,class:"flex items-center gap-2 py-2 group justify-between cursor-pointer",onClick:()=>l("update:step","team-edit",h.name)},[n("div",Pd,[d(e(kt),{label:h.name,size:"sm"},null,8,["label"]),(r(),v("p",{key:h.name,class:"text-p-base text-gray-700"},D(h.name),1))])],8,Ud))),128))])):A("",!0),e(s).loading?(r(),v("div",Nd,[d(m,{loading:e(s).loading,variant:"ghost",class:"w-full",size:"2xl"},null,8,["loading"])])):A("",!0),(y=e(s).data)!=null&&y.length?A("",!0):(r(),v("div",Hd,[...p[4]||(p[4]=[n("p",{class:"text-sm text-gray-500 w-full flex justify-center"}," No teams found ",-1)])]))]),d(Rd,{modelValue:i.value,"onUpdate:modelValue":p[2]||(p[2]=h=>i.value=h),onCreate:p[3]||(p[3]=()=>{e(s).reload()})},null,8,["modelValue"])],64)}}}),Qd={key:0,class:"h-full px-10 py-8"},Jd={key:1,class:"h-full px-10 py-8"},Gd=j({__name:"TeamsConfig",setup(o){const t=$("team-list"),l=$("");function s(a,i){t.value=a,l.value=i}return(a,i)=>t.value==="team-list"?(r(),v("div",Qd,[d(zd,{"onUpdate:step":s})])):t.value==="team-edit"?(r(),v("div",Jd,[d(Od,{"onUpdate:step":s,"team-name":l.value},null,8,["team-name"])])):A("",!0)}}),Yn=[{workday:"Monday",start_time:"09:00:00",end_time:"17:00:00",id:Math.random().toString(36).substring(2,9)},{workday:"Tuesday",start_time:"09:00:00",end_time:"17:00:00",id:Math.random().toString(36).substring(2,9)},{workday:"Wednesday",start_time:"09:00:00",end_time:"17:00:00",id:Math.random().toString(36).substring(2,9)},{workday:"Thursday",start_time:"09:00:00",end_time:"17:00:00",id:Math.random().toString(36).substring(2,9)},{workday:"Friday",start_time:"09:00:00",end_time:"17:00:00",id:Math.random().toString(36).substring(2,9)}],R=$({name:"",service_level:"",description:"",enabled:!0,default_sla:!1,apply_sla_for_resolution:!0,priorities:[],holiday_list:"Default",default_priority:"",start_date:"",end_date:"",loading:!1,support_and_resolution:Yn,default_ticket_status:"",reopen_ticket_status:"",condition:[],condition_json:[]}),Kd=()=>{R.value={name:"",service_level:"",description:"",enabled:!0,default_sla:!1,apply_sla_for_resolution:!0,priorities:[],holiday_list:"Default",default_priority:"",start_date:"",end_date:"",loading:!1,support_and_resolution:Yn,default_ticket_status:"",reopen_ticket_status:"",condition:[],condition_json:[]}},we=$({screen:"list",data:null,fetchData:!0}),ie=$({service_level:"",description:"",enabled:"",default_sla:"",apply_sla_for_resolution:"",priorities:"",holiday_list:"",default_priority:"",start_date:"",end_date:"",support_and_resolution:"",condition:""}),Xn=()=>{ie.value={service_level:"",description:"",enabled:"",default_sla:"",apply_sla_for_resolution:"",priorities:"",holiday_list:"",default_priority:"",start_date:"",end_date:"",support_and_resolution:"",condition:""}};function yt(o,t=!1){Xn();const l=s=>{var a,i;if(!(o&&s!==o))switch(s){case"service_level":(a=R.value.service_level)!=null&&a.trim()?ie.value.service_level="":ie.value.service_level="SLA policy name is required";break;case"priorities":if(!Array.isArray(R.value.priorities)||R.value.priorities.length===0)ie.value.priorities="At least one priority is required";else{const p=[];R.value.priorities.forEach((k,y)=>{var g;const h=y+1;(g=k.priority)!=null&&g.trim()||p.push(`Priority ${h}: Priority name is required`),(!k.response_time||k.response_time==0)&&p.push(`Priority ${h}: Response time is required`),R.value.apply_sla_for_resolution&&(!k.resolution_time||k.resolution_time==0)&&p.push(`Priority ${h}: Resolution time is required`),k.response_time>k.resolution_time&&R.value.apply_sla_for_resolution&&p.push(`Priority ${h}: Response time cannot be greater than resolution time`)});const m=R.value.priorities.map(k=>{var y;return(y=k.priority)==null?void 0:y.trim().toLowerCase()}).filter(Boolean),c=new Set(m);m.length!==c.size&&p.push("Priorities must be unique"),p.length>0?ie.value.priorities=p.join(", "):ie.value.priorities="",R.value.priorities.some(k=>!!k.default_priority)?ie.value.default_priority="":ie.value.default_priority="Default priority is required"}break;case"holiday_list":R.value.holiday_list?ie.value.holiday_list="":ie.value.holiday_list="Holiday list is required";break;case"start_date":new Date(R.value.end_date)<new Date(R.value.start_date)?ie.value.start_date="Start date cannot be after end date":ie.value.start_date="";break;case"end_date":R.value.end_date&&new Date(R.value.end_date)<new Date(R.value.start_date)?ie.value.end_date="End date cannot be before start date":ie.value.end_date="";break;case"condition":if(t)break;R.value.condition_json.length>0&&!Gt(R.value.condition_json)?ie.value.condition="Valid conditions are required":ie.value.condition="";break;case"support_and_resolution":const u=(i=R.value.support_and_resolution)==null?void 0:i.filter(p=>p.workday&&p.workday.trim()!==""&&p.start_time&&p.end_time&&p.start_time.trim()!==""&&p.end_time.trim()!=="");if(!(u!=null&&u.length))ie.value.support_and_resolution="At least one valid workday with workday, start time, and end time is required";else{const p=new Map,m=[];for(const f of u)p.has(f.workday)?m.push(f.workday):p.set(f.workday,!0);if(m.length>0)return ie.value.support_and_resolution=`Duplicate workday found: ${m.join(", ")}. Each workday should be unique.`,ie.value;ie.value.support_and_resolution="";const c=[];for(const f of u){const k=f.start_time.trim(),y=f.end_time.trim(),h=g=>{const[b,S]=g.split(":").map(Number),F=new Date;return F.setHours(b,S||0,0,0),F};try{const g=h(k),b=h(y);g>=b&&c.push(`${f.workday} (${k} - ${y})`)}catch{c.push(`${f.workday} (Invalid time format)`)}}c.length>0?ie.value.support_and_resolution=`End time must be after start time for: ${c.join(", ")}`:ie.value.support_and_resolution=""}break}};return o?l(o):Object.keys(ie.value).forEach(l),ie.value}const Wd={class:"grid grid-cols-6 items-center gap-4 cursor-pointer hover:bg-gray-50 rounded"},Zd={class:"text-base text-ink-gray-7 font-medium flex items-center gap-2"},Yd={key:0,class:"text-sm w-full text-ink-gray-5 mt-1 whitespace-nowrap overflow-ellipsis overflow-hidden"},Xd={class:"flex justify-between items-center w-full pr-2"},ec={class:"flex flex-col gap-4"},tc={class:"flex gap-2 justify-end"},lc=j({__name:"SlaPolicyListItem",props:{data:{type:Object,required:!0}},setup(o){const t=Ke("slaPolicyList"),l=$({show:!1,name:""}),s=o,a=$(!1),i=[{label:"Duplicate",onClick:()=>{l.value={show:!0,name:s.data.name+" (Copy)"}},icon:"copy"},...pt({onConfirmDelete:()=>p(),isConfirmingDelete:a})],u=()=>{me({url:"helpdesk.api.sla.duplicate_sla",params:{docname:s.data.name,new_name:l.value.name},onSuccess:c=>{t.reload(),J.success("SLA policy duplicated"),l.value={show:!1,name:""},setTimeout(()=>{we.value={screen:"view",data:c,fetchData:!0}},250)},auto:!0})},p=()=>{if(!a.value){a.value=!0;return}t.delete.submit(s.data.name,{onSuccess:()=>{J.success("SLA policy deleted")}})},m=()=>{if(s.data.default_sla){J.error("SLA set as default cannot be disabled");return}t.setValue.submit({name:s.data.name,enabled:!s.data.enabled},{onSuccess:()=>{J.success("SLA policy status updated")}})};return(c,f)=>{const k=it,y=W("FormControl");return r(),v(O,null,[n("div",Wd,[n("div",{onClick:f[0]||(f[0]=h=>we.value={screen:"view",data:o.data,fetchData:!0}),class:"w-full py-3 pl-2 col-span-5"},[n("div",Zd,[te(D(o.data.name)+" ",1),o.data.default_sla?(r(),E(e(Kt),{key:0,color:"gray",size:"sm"},{default:C(()=>[...f[6]||(f[6]=[te("Default",-1)])]),_:1})):A("",!0)]),o.data.description&&o.data.description.length>0?(r(),v("div",Yd,D(o.data.description),1)):A("",!0)]),n("div",Xd,[n("div",null,[d(e(at),{size:"sm",modelValue:o.data.enabled,"onUpdate:modelValue":m},null,8,["modelValue"])]),n("div",null,[d(k,{placement:"right",options:i},{default:C(()=>[d(e(Q),{icon:"more-horizontal",variant:"ghost",onClick:f[1]||(f[1]=h=>a.value=!1)})]),_:1})])])]),d(e(je),{options:{title:"Duplicate SLA Policy"},modelValue:l.value.show,"onUpdate:modelValue":f[5]||(f[5]=h=>l.value.show=h)},{"body-content":C(()=>[n("div",ec,[d(y,{label:"New SLA Policy Name",type:"text",modelValue:l.value.name,"onUpdate:modelValue":f[2]||(f[2]=h=>l.value.name=h)},null,8,["modelValue"])])]),actions:C(()=>[n("div",tc,[d(e(Q),{variant:"subtle",label:"Close",onClick:f[3]||(f[3]=h=>l.value.show=!1)}),d(e(Q),{variant:"solid",label:"Duplicate",onClick:f[4]||(f[4]=h=>u())})])]),_:1},8,["modelValue"])],64)}}}),nc={key:0,class:"flex items-center justify-center mt-12"},ac={key:1},sc={key:0,class:"flex items-center justify-center rounded-md border border-gray-200 p-4"},oc={key:1},ic=j({__name:"SlaPolicyList",setup(o){const t=Ke("slaPolicyList");return(l,s)=>{var a;return e(t).list.loading&&!e(t).list.data?(r(),v("div",nc,[d(e(mt),{class:"w-4"})])):(r(),v("div",ac,[((a=e(t).list.data)==null?void 0:a.length)===0?(r(),v("div",sc,[...s[0]||(s[0]=[n("div",{class:"text-sm text-ink-gray-7"},"No items in the list",-1)])])):(r(),v("div",oc,[s[2]||(s[2]=n("div",{class:"grid grid-cols-6 items-center gap-3 text-sm text-gray-600 ml-2"},[n("div",{class:"col-span-5"},"Policy Name"),n("div",{class:"col-span-1"},"Enabled")],-1)),s[3]||(s[3]=n("hr",{class:"mt-2 mx-2"},null,-1)),(r(!0),v(O,null,G(e(t).list.data,i=>(r(),v("div",{key:i.name},[d(lc,{data:i},null,8,["data"]),s[1]||(s[1]=n("hr",{class:"mx-2"},null,-1))]))),128))]))]))}}}),rc={class:"px-10 py-8"},uc={class:"px-10 pb-8 overflow-y-auto"},dc=j({__name:"SlaPolicies",setup(o){const t=()=>{Kd(),we.value={screen:"view",data:null,fetchData:!0}};return(l,s)=>(r(),v(O,null,[n("div",rc,[d(We,null,{title:C(()=>[...s[1]||(s[1]=[n("h1",{class:"text-lg font-semibold text-ink-gray-8"}," Service Level Agreements (SLAs) ",-1)])]),description:C(()=>[...s[2]||(s[2]=[n("p",{class:"text-p-sm max-w-md text-ink-gray-6"},[te(" SLAs align your team and customers with defined timelines for a reliable experience. "),n("a",{href:"https://docs.frappe.io/helpdesk/service-level-agreement",target:"_blank",class:"underline"},"Learn more about SLA ")],-1)])]),actions:C(()=>[d(e(Q),{label:"New",theme:"gray",variant:"solid",onClick:s[0]||(s[0]=a=>t()),"icon-left":"plus"})]),_:1})]),n("div",uc,[d(ic)])],64))}}),cc={class:"lucide lucide-group",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function pc(o,t){return r(),v("svg",cc,[...t[0]||(t[0]=[Zt('<path d="M3 7V5c0-1.1.9-2 2-2h2"></path><path d="M17 3h2c1.1 0 2 .9 2 2v2"></path><path d="M21 17v2c0 1.1-.9 2-2 2h-2"></path><path d="M7 21H5c-1.1 0-2-.9-2-2v-2"></path><rect width="7" height="5" x="7" y="7" rx="1"></rect><rect width="7" height="5" x="10" y="12" rx="1"></rect>',6)])])}const mc=Z({name:"lucide-group",render:pc}),fc={class:"lucide lucide-ungroup",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function vc(o,t){return r(),v("svg",fc,[...t[0]||(t[0]=[n("rect",{width:"8",height:"6",x:"5",y:"4",rx:"1"},null,-1),n("rect",{width:"8",height:"6",x:"11",y:"14",rx:"1"},null,-1)])])}const gc=Z({name:"lucide-ungroup",render:vc}),Qt=me({url:"helpdesk.api.doc.get_filterable_fields",params:{doctype:"HD Ticket"},transform:o=>(o=o.filter(t=>!t.fieldname.startsWith("_")).map(t=>({label:t.label,value:t.fieldname,...t})),o)}),yc={class:ee("text-end text-base text-gray-600")},hc={key:0,class:"min-w-[66px] text-start"},_c={key:1,class:"min-w-[66px] flex items-start"},bc={key:0,class:"flex items-center gap-2 w-full"},kc={id:"fieldname",class:"w-full"},xc={id:"operator"},wc={id:"value",class:"w-full"},Cc={class:ee("w-max")},$c=j({__name:"CFCondition",props:{condition:{type:Array,required:!0},isChild:{type:Boolean,default:!1},itemIndex:{type:Number},level:{type:Number,default:0},isGroup:{type:Boolean,default:!1},conjunction:{type:String},disableAddCondition:{type:Boolean,default:!1}},emits:["remove","unGroupConditions","toggleConjunction","turnIntoGroup"],setup(o,{emit:t}){const l=$(!1),s=t,a=o,i=N(()=>{const w=[];return!a.isGroup&&a.level<4&&w.push({label:"Turn into a group",icon:()=>de(mc),onClick:()=>{s("turnIntoGroup")}}),a.isGroup&&w.push({label:"Ungroup conditions",icon:()=>de(gc),onClick:()=>{s("unGroupConditions")}}),w.push({label:"Remove",component:B=>Ql({option:"Remove",icon:"trash-2",active:B.active,variant:"danger",onClick:()=>{s("remove")}}),condition:()=>!a.isGroup}),w.push({label:"Remove group",component:B=>Ql({option:"Remove group",icon:"trash-2",active:B.active,variant:"danger",onClick:()=>{s("remove")}}),condition:()=>a.isGroup}),w}),u=["Check"],p=["Link","Dynamic Link"],m=["Float","Int","Currency","Percent"],c=["Select"],f=["Data","Long Text","Small Text","Text Editor","Text"],k=["Date","Datetime"],y=["Rating"];function h(){s("toggleConjunction",a.conjunction)}const g=w=>{a.condition[0]=w==null?void 0:w.fieldname,b()},b=()=>{a.condition[2]=""};function S(){var P;const[w,B]=a.condition;if(!w)return null;const M=(P=Qt.data)==null?void 0:P.find(T=>T.fieldname==w);if(!M)return null;const{fieldtype:q,options:U}=M;if(B=="is")return de(pe,{type:"select",options:[{label:"Set",value:"set"},{label:"Not Set",value:"not set"}]});if(["like","not like","in","not in"].includes(B))return de(pe,{type:"text"});if(c.includes(q)||u.includes(q)){const T=q=="Check"?["Yes","No"]:I(U);return de(pe,{type:"select",options:T.map(Y=>({label:Y,value:Y}))})}else return p.includes(q)?q=="Dynamic Link"?de(pe,{type:"text"}):de($n,{class:"form-control",doctype:U,value:a.condition[2]}):m.includes(q)?de(pe,{type:"number"}):k.includes(q)&&B=="between"?de(Es,{value:a.condition[2],iconLeft:""}):k.includes(q)?de(q=="Date"?Bt:Is,{value:a.condition[2],iconLeft:""}):y.includes(q)?de(Ds,{rating:a.condition[2]||0,static:!1,class:"truncate","onUpdate:modelValue":T=>F(T)}):de(pe,{type:"text"})}function F(w){w=w.target?w.target.value:w,a.condition[1]==="between"?a.condition[2]=[w.split(",")[0],w.split(",")[1]]:a.condition[2]=w+""}function I(w){return w.split(`
`)}function L(w){let B=w.target._value,M=w.target.value;a.condition[1]=w.target.value,V(B,M)||(a.condition[2]=x(a.condition[0])),b()}function _(){var T;let w=[];const B=a.condition[0];if(!B)return w;const M=(T=Qt.data)==null?void 0:T.find(Y=>Y.fieldname==B);if(!M)return w;const{fieldtype:q,fieldname:U}=M;f.includes(q)&&w.push({label:"Equals",value:"=="},{label:"Not Equals",value:"!="},{label:"Like",value:"like"},{label:"Not Like",value:"not like"},{label:"In",value:"in"},{label:"Not In",value:"not in"},{label:"Is",value:"is"}),U==="_assign"&&(w=[{label:"Like",value:"like"},{label:"Not Like",value:"not like"},{label:"Is",value:"is"}]),m.includes(q)&&w.push({label:"Equals",value:"=="},{label:"Not Equals",value:"!="},{label:"Like",value:"like"},{label:"Not Like",value:"not like"},{label:"In",value:"in"},{label:"Not In",value:"not in"},{label:"Is",value:"is"},{label:"<",value:"<"},{label:">",value:">"},{label:"<=",value:"<="},{label:">=",value:">="}),c.includes(q)&&w.push({label:"Equals",value:"=="},{label:"Not Equals",value:"!="},{label:"In",value:"in"},{label:"Not In",value:"not in"},{label:"Is",value:"is"}),p.includes(q)&&w.push({label:"Equals",value:"=="},{label:"Not Equals",value:"!="},{label:"Like",value:"like"},{label:"Not Like",value:"not like"},{label:"In",value:"in"},{label:"Not In",value:"not in"},{label:"Is",value:"is"}),u.includes(q)&&w.push({label:"Equals",value:"=="}),["Duration"].includes(q)&&w.push({label:"Like",value:"like"},{label:"Not Like",value:"not like"},{label:"In",value:"in"},{label:"Not In",value:"not in"},{label:"Is",value:"is"}),k.includes(q)&&w.push({label:"Equals",value:"=="},{label:"Not Equals",value:"!="},{label:"Is",value:"is"},{label:">",value:">"},{label:"<",value:"<"},{label:">=",value:">="},{label:"<=",value:"<="},{label:"Between",value:"between"}),y.includes(q)&&w.push({label:"Equals",value:"=="},{label:"Not Equals",value:"!="},{label:"Is",value:"is"},{label:">",value:">"},{label:"<",value:"<"},{label:">=",value:">="},{label:"<=",value:"<="});const P=w.find(Y=>Y.value==a.condition[1]);return a.condition[1]=(P==null?void 0:P.value)||w[0].value,w}function x(w){return c.includes(w.fieldtype)?I(w.options)[0]:u.includes(w.fieldtype)?"Yes":k.includes(w.fieldtype)?null:y.includes(w.fieldtype)?0:""}function V(w,B){let M=["==","!=","in","not in",">","<",">=","<="];return!!(M.includes(w)&&M.includes(B))}return(w,B)=>(r(),v(O,null,[n("div",{class:ee(["flex gap-2",[{"items-center":!a.isGroup}]])},[n("div",{class:ee(["flex gap-2 w-full",[{"items-center justify-between":!a.isGroup}]])},[n("div",yc,[a.itemIndex==0?(r(),v("div",hc," Where ")):(r(),v("div",_c,[d(e(Q),{variant:"subtle",class:"w-max",onClick:h,"icon-right":"refresh-cw",disabled:a.itemIndex>2,label:o.conjunction},null,8,["disabled","label"])]))]),a.isGroup?A("",!0):(r(),v("div",bc,[n("div",kc,[d(e(vn),{options:e(Qt).data,modelValue:a.condition[0],"onUpdate:modelValue":[B[0]||(B[0]=M=>a.condition[0]=M),g],placeholder:"Field"},null,8,["options","modelValue"])]),n("div",xc,[a.condition[0]?(r(),E(e(pe),{key:1,disabled:!a.condition[0],type:"select",modelValue:a.condition[1],"onUpdate:modelValue":B[1]||(B[1]=M=>a.condition[1]=M),onChange:L,options:_(),class:"w-max min-w-[100px]"},null,8,["disabled","modelValue","options"])):(r(),E(e(pe),{key:0,disabled:"",type:"text",placeholder:"operator",class:"w-[100px]"}))]),n("div",wc,[a.condition[0]?(r(),E(Oe(S()),{key:1,modelValue:a.condition[2],"onUpdate:modelValue":B[2]||(B[2]=M=>a.condition[2]=M),onChange:F,placeholder:"condition"},null,40,["modelValue"])):(r(),E(e(pe),{key:0,disabled:"",type:"text",placeholder:"condition",class:"w-full"}))])])),a.isGroup&&!(a.level==2||a.level==4)?(r(),E(dl,{key:1,conditions:a.condition,isChild:!0,level:a.level,disableAddCondition:a.disableAddCondition},null,8,["conditions","level","disableAddCondition"])):A("",!0),a.isGroup&&(a.level==2||a.level==4)?(r(),E(e(Q),{key:2,variant:"outline",onClick:B[3]||(B[3]=M=>l.value=!0),label:"Open nested conditions"})):A("",!0)],2),n("div",Cc,[d(e(qt),{placement:"right",options:i.value},{default:C(()=>[d(e(Q),{variant:"ghost",icon:"more-horizontal"})]),_:1},8,["options"])])],2),d(e(je),{modelValue:l.value,"onUpdate:modelValue":B[4]||(B[4]=M=>l.value=M),options:{size:"3xl",title:"Nested conditions"}},{"body-content":C(()=>[d(dl,{conditions:a.condition,isChild:!0,level:a.level,disableAddCondition:a.disableAddCondition},null,8,["conditions","level","disableAddCondition"])]),_:1},8,["modelValue"])],64))}}),Ac={class:"rounded-lg border border-gray-300 p-3 flex flex-col gap-4 w-full"},Sc={key:0,class:"flex"},dl=j({__name:"CFConditions",props:{conditions:{type:Array,required:!0},isChild:{type:Boolean,default:!1},level:{type:Number,default:0},disableAddCondition:{type:Boolean,default:!1}},setup(o){const t=o,l=()=>{let c="and";return t.conditions.forEach(f=>{typeof f=="string"&&(c=f)}),c},s=c=>{t.conditions.splice(t.conditions.indexOf(c),1,[c])},a=c=>Array.isArray(c),i=N(()=>{const c=[{label:"Add condition",onClick:()=>{const f=l();t.conditions.push(f,["","",""])}}];return t.level<3&&c.push({label:"Add condition group",onClick:()=>{const f=l();t.conditions.push(f,[[]])}}),c});function u(c){const f=t.conditions.indexOf(c);f==0?t.conditions.splice(f,2):t.conditions.splice(f-1,2)}function p(c){const f=l(),k=c.map(h=>typeof h=="string"?f:h),y=t.conditions.indexOf(c);y!==-1&&t.conditions.splice(y,1,...k)}function m(c){for(let f=0;f<t.conditions.length;f++)typeof t.conditions[f]=="string"&&(t.conditions[f]=c=="and"?"or":"and")}return be(()=>{Qt.fetched||Qt.submit()}),(c,f)=>(r(),v("div",Ac,[(r(!0),v(O,null,G(t.conditions,(k,y)=>(r(),v(O,{key:k.field},[Array.isArray(k)?(r(),E($c,{key:0,condition:k,isChild:t.isChild,itemIndex:y,onRemove:h=>u(k),onUnGroupConditions:h=>p(k),level:t.level+1,onToggleConjunction:m,isGroup:a(k[0]),conjunction:l(),onTurnIntoGroup:h=>s(k),disableAddCondition:t.disableAddCondition},null,8,["condition","isChild","itemIndex","onRemove","onUnGroupConditions","level","isGroup","conjunction","onTurnIntoGroup","disableAddCondition"])):A("",!0)],64))),128)),t.isChild?(r(),v("div",Sc,[d(e(qt),{options:i.value},{default:C(({open:k})=>[d(e(Q),{disabled:t.disableAddCondition,label:"Add condition","icon-left":"plus","icon-right":k?"chevron-up":"chevron-down"},null,8,["disabled","icon-right"])]),_:1},8,["options"])])):A("",!0)]))}}),Vc={class:"flex items-center justify-between mt-2"},Ic=j({__name:"SlaAssignmentConditions",props:{conditions:{type:Array,required:!0}},setup(o){const t=o,l=()=>{let i="and";return t.conditions.forEach(u=>{typeof u=="string"&&(i=u)}),i},s=[{label:"Add condition",onClick:()=>{a()}},{label:"Add condition group",onClick:()=>{const i=l();t.conditions.push(i,[[]])}}],a=()=>{if(!Gt(t.conditions))return;const u=l();t.conditions.push(u,["","",""])};return Yt(()=>[...t.conditions],()=>{yt("condition")},{deep:!0,debounce:100}),(i,u)=>(r(),v(O,null,[t.conditions.length>0?(r(),E(dl,{key:0,conditions:t.conditions,level:0,disableAddCondition:e(ie).condition!=""},null,8,["conditions","disableAddCondition"])):A("",!0),t.conditions.length==0?(r(),v("div",{key:1,class:"flex p-4 items-center cursor-pointer justify-center gap-2 text-sm border border-gray-300 text-gray-600 rounded-md",onClick:u[0]||(u[0]=p=>t.conditions.push(["","",""]))},[d(e(Ne),{name:"plus",class:"h-4"}),te(" "+D(i.__("Add a custom condition")),1)])):A("",!0),n("div",Vc,[t.conditions.length>0?(r(),E(e(qt),{key:0,options:s},{default:C(({open:p})=>[d(e(Q),{disabled:e(ie).condition!="","icon-right":p?"chevron-up":"chevron-down",label:i.__("Add condition")},null,8,["disabled","icon-right","label"])]),_:1})):A("",!0),d(e(ge),{message:e(ie).condition},null,8,["message"])])],64))}}),Ec={class:"flex flex-col gap-4"},Dc={key:0},Bc={class:"flex gap-2"},Lc=j({__name:"WorkDayModal",props:ze({workDaysList:{type:Array,required:!0}},{modelValue:{required:!0,default:()=>({show:!1,isEditing:!1,data:{workday:"",start_time:"",end_time:""}})},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const t=$(!1),l=o,s=De(o,"modelValue"),a=Xe({workday:"",start_time:"",end_time:""}),i=Xe({workday:"",start_time:"",end_time:""}),u=h=>{if(h.preventDefault(),!t.value){t.value=!0;return}const g=l.workDaysList.findIndex(b=>b.workday===a.workday);g!==-1&&l.workDaysList.splice(g,1)};function p(h){if(!h)return"";if(/^\d{1,2}:\d{2}:\d{2}$/.test(h)){const[g,b,S]=h.split(":");return`${g.padStart(2,"0")}:${b.padStart(2,"0")}:${S.padStart(2,"0")}`}if(/^\d{1,2}:\d{2}$/.test(h)){const[g,b]=h.split(":");return`${g.padStart(2,"0")}:${b.padStart(2,"0")}:00`}return""}function m(){a.workday="",a.start_time="",a.end_time="",i.workday="",i.start_time="",i.end_time="",t.value=!1}const c=h=>a[h]?(i[h]="",!0):(i[h]="This field is required",!1),f=()=>{if(!a.start_time||!a.end_time)return a.start_time||(i.start_time="Start time is required"),a.end_time||(i.end_time="End time is required"),!1;const[h,g]=a.start_time.split(":").map(Number),[b,S]=a.end_time.split(":").map(Number);return b<h||b===h&&S<=g?(i.end_time="End time must be after start time",!1):(i.end_time="",!0)},k=()=>{const h=c("workday"),g=c("start_time"),b=c("end_time")&&f();return h&&g&&b},y=()=>{if(!k()){J.error("Please fix the errors in the form");return}try{if(s.value.isEditing){const h=l.workDaysList.findIndex(g=>{var b;return g.workday===((b=s.value.data)==null?void 0:b.workday)});if(h!==-1){const g={...l.workDaysList[h],...a};l.workDaysList.splice(h,1,g),J.success("Workday updated")}}else{if(l.workDaysList.some(b=>b.workday===a.workday)){i.workday="This workday already exists",J.error("A workday with this name already exists");return}const g={...a};l.workDaysList.push(g),J.success("Workday added")}s.value.show=!1}catch(h){J.error(`Failed to save workday: ${h}`)}};return ve(()=>s.value.show,h=>{h&&(s.value.isEditing&&s.value.data?(a.workday=s.value.data.workday,a.start_time=p(s.value.data.start_time),a.end_time=p(s.value.data.end_time)):m())}),(h,g)=>{const b=W("ErrorMessage");return r(),E(e(je),{modelValue:s.value.show,"onUpdate:modelValue":g[6]||(g[6]=S=>s.value.show=S),onAfterLeave:m,options:{title:s.value.isEditing?"Edit workday":"Add workday"}},{"body-content":C(()=>[n("div",Ec,[n("div",null,[d(e(pe),{type:"select",size:"sm",variant:"subtle",placeholder:"Select Workday",label:"Workday",modelValue:a.workday,"onUpdate:modelValue":g[0]||(g[0]=S=>a.workday=S),options:[{label:"Monday",value:"Monday"},{label:"Tuesday",value:"Tuesday"},{label:"Wednesday",value:"Wednesday"},{label:"Thursday",value:"Thursday"},{label:"Friday",value:"Friday"},{label:"Saturday",value:"Saturday"},{label:"Sunday",value:"Sunday"}],class:ee({"border-red-500":i.workday}),onBlur:g[1]||(g[1]=S=>c("workday"))},null,8,["modelValue","class"]),d(b,{message:i.workday,class:"mt-2"},null,8,["message"])]),n("div",null,[d(e(pe),{type:"time",size:"sm",variant:"subtle",placeholder:"Start Time",label:"Start Time",modelValue:a.start_time,"onUpdate:modelValue":g[2]||(g[2]=S=>a.start_time=S),class:ee({"border-red-500":i.start_time}),onBlur:g[3]||(g[3]=S=>c("start_time"))},null,8,["modelValue","class"]),d(b,{message:i.start_time,class:"mt-2"},null,8,["message"])]),n("div",null,[d(e(pe),{type:"time",size:"sm",variant:"subtle",placeholder:"End Time",label:"End Time",modelValue:a.end_time,"onUpdate:modelValue":g[4]||(g[4]=S=>a.end_time=S),class:ee({"border-red-500":i.end_time}),onBlur:f},null,8,["modelValue","class"]),d(b,{message:i.end_time,class:"mt-2"},null,8,["message"])])])]),actions:C(()=>[n("div",{class:ee(["flex",{"justify-between":s.value.isEditing,"justify-end":!s.value.isEditing}])},[s.value.isEditing?(r(),v("div",Dc,[d(e(Q),{variant:"subtle",theme:t.value?"red":"gray",label:t.value?"Confirm Delete":"Delete",onClick:u,"icon-left":"trash-2"},null,8,["theme","label"])])):A("",!0),n("div",Bc,[d(e(Q),{variant:"subtle",theme:"gray",onClick:g[5]||(g[5]=S=>s.value.show=!1),label:"Cancel"}),d(e(Q),{variant:"solid",onClick:y,label:"Save"})])],2)]),_:1},8,["modelValue","options"])}}}),Fc={key:0},Tc={key:1},Mc={class:"flex justify-end"},Oc={key:0},Rc=j({__name:"SlaWorkDaysListItem",props:{columns:{},row:{},isLast:{type:Boolean}},setup(o){const t=o,l=[{label:"Monday",value:"Monday"},{label:"Tuesday",value:"Tuesday"},{label:"Wednesday",value:"Wednesday"},{label:"Thursday",value:"Thursday"},{label:"Friday",value:"Friday"},{label:"Saturday",value:"Saturday"},{label:"Sunday",value:"Sunday"}],s=$({show:!1,isEditing:!1,data:{}}),a=$(!1),i=[{label:"Edit",onClick:()=>p(),icon:"edit"},...pt({onConfirmDelete:()=>u(),isConfirmingDelete:a})],u=()=>{if(!a.value){a.value=!0;return}const c=R.value.support_and_resolution.indexOf(t.row);c!==-1&&R.value.support_and_resolution.splice(c,1)},p=()=>{s.value.show=!0,s.value.isEditing=!0,s.value.data={workday:t.row.workday,start_time:t.row.start_time,end_time:t.row.end_time}},m=c=>{if(!c)return"00:00";const[f,k]=c.split(":"),y=new Date;return y.setHours(parseInt(f)||0,parseInt(k)||0,0),y.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0})};return(c,f)=>{const k=it;return r(),v(O,null,[n("div",{class:"grid gap-2 py-3.5 px-4 items-center",style:Mt({gridTemplateColumns:e(Ol)(t.columns)})},[(r(!0),v(O,null,G(t.columns,y=>(r(),v("div",{key:y.key,class:"w-full overflow-hidden whitespace-nowrap text-ellipsis"},[y.key==="start_time"||y.key==="end_time"?(r(),v("div",Fc,D(m(t.row[y.key])),1)):(r(),v("div",Tc,[d(e(Xt),{class:"bg-transparent cursor-pointer border-0 focus-visible:!ring-0 bg-none",options:l,modelValue:t.row[y.key],"onUpdate:modelValue":h=>t.row[y.key]=h},null,8,["modelValue","onUpdate:modelValue"])]))]))),128)),n("div",Mc,[d(k,{placement:"right",options:i},{default:C(()=>[d(e(Q),{icon:"more-horizontal",variant:"ghost",onClick:f[0]||(f[0]=y=>a.value=!1)})]),_:1})])],4),t.isLast?A("",!0):(r(),v("hr",Oc)),d(Lc,{modelValue:s.value,"onUpdate:modelValue":f[1]||(f[1]=y=>s.value=y),workDaysList:e(R).support_and_resolution},null,8,["modelValue","workDaysList"])],64)}}}),qc={class:"rounded-md border px-2 border-gray-300 text-sm"},jc={key:0,class:"text-red-500"},Uc={key:1},Pc={key:2,class:"text-center p-4 text-gray-600"},Nc={class:"flex items-center justify-between mt-2.5"},Hc=j({__name:"SlaWorkDaysList",setup(o){const t=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],l=()=>{const a=new Set(R.value.support_and_resolution.map(u=>u.workday)),i=t.find(u=>!a.has(u))||t[0];R.value.support_and_resolution.push({workday:i,start_time:"09:00:00",end_time:"17:00:00",id:Math.random().toString(36).substring(2,9)})},s=[{label:"Day",key:"workday",isRequired:!0},{label:"Start time",key:"start_time",isRequired:!0},{label:"End time",key:"end_time",isRequired:!0}];return(a,i)=>{var p,m,c;const u=W("ErrorMessage");return r(),v(O,null,[n("div",qc,[((p=e(R).support_and_resolution)==null?void 0:p.length)!==0?(r(),v("div",{key:0,class:"grid p-2 px-4 items-center",style:Mt({gridTemplateColumns:e(Ol)(s)})},[(r(),v(O,null,G(s,f=>n("div",{key:f.key,class:ee(["text-gray-600 overflow-hidden whitespace-nowrap text-ellipsis",{"ml-2":f.key==="workday"}])},[te(D(f.label)+" ",1),f.isRequired?(r(),v("span",jc,"*")):A("",!0)],2)),64))],4)):A("",!0),((m=e(R).support_and_resolution)==null?void 0:m.length)!==0?(r(),v("hr",Uc)):A("",!0),(r(!0),v(O,null,G(e(R).support_and_resolution,(f,k)=>(r(),E(Rc,{key:k+f.workday+f.id,row:f,columns:s,isLast:k===e(R).support_and_resolution.length-1},null,8,["row","isLast"]))),128)),((c=e(R).support_and_resolution)==null?void 0:c.length)===0?(r(),v("div",Pc," No workdays in the list ")):A("",!0)]),n("div",Nc,[e(R).support_and_resolution.length<7?(r(),E(e(Q),{key:0,variant:"subtle",label:"Add row",onClick:l,"icon-left":"plus"})):A("",!0),d(u,{message:e(ie).support_and_resolution},null,8,["message"])])],64)}}}),Ce=$({screen:"list",data:null}),$e=$({holiday_list_name:"",from_date:"",to_date:""}),z=$({holiday_list_name:"",description:"",associate_holiday_list:!0,loading:!1,total_holidays:0,holidays:[],from_date:null,to_date:null,recurring_holidays:[]}),ea=()=>{z.value={holiday_list_name:"",description:"",associate_holiday_list:!0,loading:!1,total_holidays:0,holidays:[],from_date:null,to_date:null,recurring_holidays:[]}},hl=o=>{const t=l=>{var s;if(!(o&&l!==o))switch(l){case"holiday_list_name":(s=z.value.holiday_list_name)!=null&&s.trim()?$e.value.holiday_list_name="":$e.value.holiday_list_name="Holiday list name is required";break;case"from_date":if(z.value.from_date?$e.value.from_date="":$e.value.from_date="Start date is required",z.value.to_date){const a=new Date(z.value.from_date),i=new Date(z.value.to_date);a>i?$e.value.dateRange="Start date cannot be after end date":$e.value.dateRange=""}break;case"to_date":if(z.value.to_date?$e.value.to_date="":$e.value.to_date="End date is required",z.value.from_date){const a=new Date(z.value.from_date),i=new Date(z.value.to_date);a>i?$e.value.dateRange="Start date cannot be after end date":$e.value.dateRange=""}break}};return o?t(o):Object.keys($e.value).forEach(t),$e.value};function ol(){const o=z.value.holidays.filter(t=>!t.weekly_off);for(const t of z.value.recurring_holidays){const l=Gc(z.value.from_date,z.value.to_date,t.day,o,t.repetition);o.push(...l)}z.value.holidays=o}function zc(o){const l=o.startOf("month").day(),s=(o.date()+l-1)/7;return Math.ceil(s)}function Qc(o,t,l,s=[],a){const i=ue(o),u=ue(t),p=[],c={sunday:0,monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6}[l.toLowerCase()];if(c===void 0)return p;const f=s.map(h=>ue(h.holiday_date).startOf("day").toDate());let k=i.day(c);k.isBefore(i,"day")&&(k=k.add(1,"week"));const y=!a||a.all;for(;k.isSameOrBefore(u,"day");){const h=k.toDate(),g=ue(h).startOf("day");(y||Jc(k,a))&&(f.some(b=>ue(b).startOf("day").isSame(g))||p.push(h)),k=k.add(1,"week")}return p}function Jc(o,t){if(t.all)return!0;switch(zc(o)){case 1:return t.first;case 2:return t.second;case 3:return t.third;case 4:return t.fourth;case 5:return t.fifth;default:return!1}}function Gc(o,t,l,s=[],a={all:!0,first:!1,second:!1,third:!1,fourth:!1,fifth:!1}){return Qc(o,t,l,s,a).map((u,p)=>({description:l.charAt(0).toUpperCase()+l.slice(1),holiday_date:u,weekly_off:1,idx:p+1,repetition:a}))}const Kc={class:"flex items-center justify-between"},Wc={class:"my-2 p-1 min-w-40 rounded-lg bg-surface-modal shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none"},Zc=["onClick"],Yc={class:"flex items-center gap-2 w-full"},Xc=["checked"],ep={class:"select-none"},tp={class:"flex cursor-pointer items-center gap-1"},lp={class:"mt-1.5 flex flex-col gap-1 border-t border-outline-gray-modals pt-1.5"},np={class:"mt-5"},ap=j({__name:"SlaHolidays",setup(o){const t=()=>{_t("Business Holidays"),Ce.value={screen:"view",data:null,previousScreen:{screen:"view",data:R.value.name}},ea()},l=a=>{_t("Business Holidays"),Ce.value={screen:"view",data:a,previousScreen:{screen:"view",data:R.value.name}}},s=ct({doctype:"HD Service Holiday List",fields:["name","holiday_list_name"],auto:!0});return Yt(R.value.support_and_resolution,()=>{yt("support_and_resolution")},{debounce:300}),(a,i)=>(r(),v(O,null,[n("div",Kc,[i[1]||(i[1]=n("div",{class:"flex flex-col gap-1"},[n("div",{class:"text-lg font-semibold text-ink-gray-8"}," Work schedule and holidays "),n("div",{class:"text-p-sm text-ink-gray-6 max-w-lg"}," Set working days, hours, and holidays by selecting a predefined schedule or creating a new one. ")],-1)),d(e(Bs),null,{target:C(({open:u})=>[d(e(Q),{class:"text-sm","icon-right":u?"chevron-up":"chevron-down",label:e(R).holiday_list},null,8,["icon-right","label"])]),body:C(()=>[n("div",Wc,[n("div",null,[(r(!0),v(O,null,G(e(s).data,u=>(r(),v("div",{key:u.name,class:"flex items-center justify-between gap-4 rounded px-2 py-1.5 text-base text-ink-gray-8 cursor-pointer hover:bg-surface-gray-2",onClick:p=>e(R).holiday_list=u.name},[n("div",Yc,[n("input",{name:"holiday_list",checked:u.name===e(R).holiday_list,type:"radio"},null,8,Xc),n("div",ep,D(u.holiday_list_name),1)]),n("div",tp,[d(e(Q),{variant:"ghost",onClick:he(p=>l(u),["stop"]),icon:"edit"},null,8,["onClick"])])],8,Zc))),128)),n("div",lp,[d(e(Q),{class:"w-full !justify-start !text-ink-gray-5",variant:"ghost",label:"Create new business holiday",onClick:i[0]||(i[0]=u=>t()),"icon-left":"plus"})])])])]),_:1})]),n("div",np,[d(Hc)])],64))}});const sp=Ue(ap,[["__scopeId","data-v-97516a07"]]),op={class:"flex gap-2 border border-gray-300 rounded w-fit min-w-max px-4 select-none shadow-sm"},ip={key:0,class:"p-2 flex flex-col items-center group relative"},rp={class:"flex items-center gap-1"},up={class:"flex flex-col group-hover:opacity-100 opacity-0 absolute top-1/2 -translate-y-1/2 -right-3"},dp={key:1,class:"p-2 flex flex-col items-center group relative"},cp={class:"flex items-center gap-1"},pp={class:"flex flex-col group-hover:opacity-100 opacity-0 absolute top-1/2 -translate-y-1/2 -right-3"},mp={key:2,class:"p-2 flex flex-col items-center group relative"},fp={class:"flex items-center gap-1"},vp={class:"flex flex-col group-hover:opacity-100 opacity-0 absolute top-1/2 -translate-y-1/2 -right-3"},gp=300,yp=50,hp=j({__name:"DurationPicker",props:{modelValue:{default:0},min:{default:0},max:{default:Number.MAX_SAFE_INTEGER},options:{default:()=>({})}},emits:["update:modelValue","change"],setup(o,{emit:t}){const l=o,s=N(()=>{var P,T,Y;return{hours:((P=l.options)==null?void 0:P.hours)??!0,minutes:((T=l.options)==null?void 0:T.minutes)??!0,seconds:((Y=l.options)==null?void 0:Y.seconds)??!1}}),a=N(()=>{const{hours:P,minutes:T,seconds:Y}=s.value;return!P&&!T&&!Y?{hours:!0,minutes:!0,seconds:!1}:{hours:P,minutes:T,seconds:Y}}),i=t,u=$(l.modelValue),p=$(null),m=$(null),c=$(null),f=$(null),k=$(null);let y=!1,h=null;const g=N({get:()=>Math.floor(u.value/3600).toString(),set:P=>{if(P==="")return;const T=parseInt(P,10);if(!isNaN(T)&&T>=0){const Y=T*3600+I()*60+L();w(Y)}}}),b=N({get:()=>Math.floor(u.value%3600/60).toString(),set:P=>{if(P==="")return;const T=parseInt(P,10);if(!isNaN(T)&&T>=0&&T<=59){const Y=F()*3600+T*60+L();w(Y)}}}),S=N({get:()=>(u.value%60).toString(),set:P=>{if(P==="")return;const T=parseInt(P,10);if(!isNaN(T)&&T>=0&&T<=59){const Y=F()*3600+I()*60+T;w(Y)}}});function F(){return Math.floor(u.value/3600)}function I(){return Math.floor(u.value%3600/60)}function L(){return u.value%60}nt(()=>{_(),h&&clearTimeout(h)});function _(){f.value!==null&&(clearInterval(f.value),f.value=null),h&&(clearTimeout(h),h=null),y=!1}function x(P){y||(y=!0,P(),h=window.setTimeout(()=>{y&&(k.value=P,f.value=window.setInterval(()=>{k.value&&k.value()},yp))},gp))}function V(){_()}document.addEventListener("mouseup",V),document.addEventListener("touchend",V),nt(()=>{document.removeEventListener("mouseup",V),document.removeEventListener("touchend",V)});function w(P,T=!0){P=Math.max(l.min,Math.min(l.max,P)),P!==u.value&&(u.value=P,T&&(i("update:modelValue",u.value),i("change",u.value)))}function B(P){switch(P){case"hours":g.value=g.value;break;case"minutes":b.value=b.value;break;case"seconds":S.value=S.value;break}}function M(P){P.target.blur()}function q(P){let T=u.value;switch(P){case"hours":T+=3600;break;case"minutes":T+=60;break;case"seconds":T+=1;break}w(T)}function U(P){let T=u.value;switch(P){case"hours":T-=3600;break;case"minutes":T-=60;break;case"seconds":T-=1;break}w(T)}return ve(()=>l.modelValue,P=>{P!==u.value&&(u.value=Math.max(l.min,Math.min(l.max,P)))},{immediate:!0}),(P,T)=>{const Y=W("FeatherIcon");return r(),v("div",op,[a.value.hours?(r(),v("div",ip,[n("div",rp,[Re(n("input",{ref_key:"hoursInput",ref:p,"onUpdate:modelValue":T[0]||(T[0]=X=>g.value=X),type:"number",min:"0",class:"w-8 text-sm bg-transparent border-0 p-0 text-center focus:ring-0 focus:outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",onBlur:T[1]||(T[1]=X=>B("hours")),onKeyup:Ye(M,["enter"])},null,544),[[yl,g.value,void 0,{number:!0}]]),n("div",up,[n("button",{onMousedown:T[2]||(T[2]=X=>x(()=>q("hours"))),onTouchstart:T[3]||(T[3]=X=>x(()=>q("hours"))),onMouseup:_,onMouseleave:_,onTouchend:_,onTouchcancel:_,class:"hover:bg-gray-100 rounded-sm select-none"},[d(Y,{name:"chevron-up",class:"size-3.5"})],32),n("button",{onMousedown:T[4]||(T[4]=X=>x(()=>U("hours"))),onTouchstart:T[5]||(T[5]=X=>x(()=>U("hours"))),onMouseup:_,onMouseleave:_,onTouchend:_,onTouchcancel:_,class:"hover:bg-gray-100 rounded-sm select-none"},[d(Y,{name:"chevron-down",class:"size-3.5"})],32)])]),T[18]||(T[18]=n("div",{class:"text-xs text-gray-600 mt-1"},"Hrs",-1))])):A("",!0),a.value.minutes?(r(),v("div",dp,[n("div",cp,[Re(n("input",{ref_key:"minutesInput",ref:m,"onUpdate:modelValue":T[6]||(T[6]=X=>b.value=X),type:"number",min:"0",max:"59",class:"w-8 text-sm bg-transparent border-0 p-0 text-center focus:ring-0 focus:outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",onBlur:T[7]||(T[7]=X=>B("minutes")),onKeyup:Ye(M,["enter"])},null,544),[[yl,b.value,void 0,{number:!0}]]),n("div",pp,[n("button",{onMousedown:T[8]||(T[8]=X=>x(()=>q("minutes"))),onTouchstart:T[9]||(T[9]=X=>x(()=>q("minutes"))),onMouseup:_,onMouseleave:_,onTouchend:_,onTouchcancel:_,class:"hover:bg-gray-100 rounded-sm select-none"},[d(Y,{name:"chevron-up",class:"size-3.5"})],32),n("button",{onMousedown:T[10]||(T[10]=X=>x(()=>U("minutes"))),onTouchstart:T[11]||(T[11]=X=>x(()=>U("minutes"))),onMouseup:_,onMouseleave:_,onTouchend:_,onTouchcancel:_,class:"hover:bg-gray-100 rounded-sm select-none"},[d(Y,{name:"chevron-down",class:"size-3.5"})],32)])]),T[19]||(T[19]=n("div",{class:"text-xs text-gray-600 mt-1"},"Min",-1))])):A("",!0),a.value.seconds?(r(),v("div",mp,[n("div",fp,[Re(n("input",{ref_key:"secondsInput",ref:c,"onUpdate:modelValue":T[12]||(T[12]=X=>S.value=X),type:"number",min:"0",max:"59",class:"w-8 text-sm bg-transparent border-0 p-0 text-center focus:ring-0 focus:outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",onBlur:T[13]||(T[13]=X=>B("seconds")),onKeyup:Ye(M,["enter"])},null,544),[[yl,S.value,void 0,{number:!0}]]),n("div",vp,[n("button",{onMousedown:T[14]||(T[14]=X=>x(()=>q("seconds"))),onTouchstart:T[15]||(T[15]=X=>x(()=>q("seconds"))),onMouseup:_,onMouseleave:_,onTouchend:_,onTouchcancel:_,class:"hover:bg-gray-100 rounded-sm select-none"},[d(Y,{name:"chevron-up",class:"size-3.5"})],32),n("button",{onMousedown:T[16]||(T[16]=X=>x(()=>U("seconds"))),onTouchstart:T[17]||(T[17]=X=>x(()=>U("seconds"))),onMouseup:_,onMouseleave:_,onTouchend:_,onTouchcancel:_,class:"hover:bg-gray-100 rounded-sm select-none"},[d(Y,{name:"chevron-down",class:"size-3.5"})],32)])]),T[20]||(T[20]=n("div",{class:"text-xs text-gray-600 mt-1"},"Sec",-1))])):A("",!0)])}}});const $l=Ue(hp,[["__scopeId","data-v-d03c027b"]]);function Al(o){const t=Math.floor(o/86400),l=Math.floor(o%(3600*24)/3600),s=Math.floor(o%3600/60),a=Math.floor(o%60);let i="";return t>0&&(i+=`${t} days `),l>0&&(i+=`${l} hours `),s>0&&(i+=`${s} minutes `),a>0&&(i+=`${a} seconds`),i.trim()}const _p={class:"flex flex-col gap-4"},bp=["onClick"],kp={key:0},xp={key:1,class:"text-gray-500"},wp={class:"absolute bg-white top-2"},Cp=["onClick"],$p={key:0},Ap={key:1,class:"text-gray-500"},Sp={class:"absolute bg-white top-2"},Vp={class:"flex justify-between"},Ip={class:"flex gap-2"},Ep=j({__name:"EditResponseResolutionModal",props:ze({row:{type:Object,required:!0}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:ze(["onDefaultPriorityChange"],["update:modelValue"]),setup(o,{emit:t}){const l=De(o,"modelValue"),s=$(!1),a=o,i=Ke("priorityOptions"),u=$({priority:a.row.priority,resolution_time:a.row.resolution_time,response_time:a.row.response_time,default_priority:a.row.default_priority}),p=()=>{if(!u.value.priority)return J.error("Please select a priority"),!1;const f=parseInt(u.value.resolution_time);if(isNaN(f)||f<=0)return J.error("Resolution time must be a positive number"),!1;const k=parseInt(u.value.response_time);return isNaN(k)||k<=0?(J.error("Response time must be a positive number"),!1):(u.value.default_priority&&R.value.priorities.forEach(y=>{y.default_priority=!1}),!0)},m=f=>{if(f.preventDefault(),!s.value){s.value=!0;return}R.value.priorities.splice(R.value.priorities.indexOf(a.row),1)},c=()=>{p()&&(a.row.priority=u.value.priority,a.row.resolution_time=u.value.resolution_time,a.row.response_time=u.value.response_time,a.row.default_priority=u.value.default_priority,l.value=!1)};return(f,k)=>(r(),E(e(je),{modelValue:l.value,"onUpdate:modelValue":k[5]||(k[5]=y=>l.value=y),options:{title:"Edit response and resolution"}},{"body-content":C(()=>[n("div",_p,[d(e(pe),{type:"select",size:"sm",variant:"subtle",placeholder:"Select Priority",label:"Priority",modelValue:u.value.priority,"onUpdate:modelValue":k[0]||(k[0]=y=>u.value.priority=y),options:e(i),required:""},null,8,["modelValue","options"]),n("div",null,[d(e(et),{label:"Response time",required:""}),d(e(qe),{class:"mt-2"},{target:C(({togglePopover:y})=>[n("div",{onClick:h=>y(),class:"w-full bg-gray-100 rounded p-1.5 px-2 text-base text-gray-800"},[u.value.response_time?(r(),v("div",kp,D(e(Al)(u.value.response_time)),1)):(r(),v("div",xp,"Select time"))],8,bp)]),body:C(()=>[n("div",wp,[d($l,{modelValue:u.value.response_time,"onUpdate:modelValue":k[1]||(k[1]=y=>u.value.response_time=y),options:{seconds:!1}},null,8,["modelValue"])])]),_:1})]),n("div",null,[d(e(et),{label:"Resolution time",required:""}),d(e(qe),{class:"mt-2"},{target:C(({togglePopover:y})=>[n("div",{onClick:h=>y(),class:"w-full bg-gray-100 rounded p-1.5 px-2 text-base text-gray-800"},[u.value.resolution_time?(r(),v("div",$p,D(e(Al)(u.value.resolution_time)),1)):(r(),v("div",Ap,"Select time"))],8,Cp)]),body:C(()=>[n("div",Sp,[d($l,{modelValue:u.value.resolution_time,"onUpdate:modelValue":k[2]||(k[2]=y=>u.value.resolution_time=y),options:{seconds:!1}},null,8,["modelValue"])])]),_:1})]),d(e(Pe),{modelValue:u.value.default_priority,"onUpdate:modelValue":k[3]||(k[3]=y=>u.value.default_priority=y),label:"Set default priority"},null,8,["modelValue"])])]),actions:C(()=>[n("div",Vp,[n("div",null,[d(e(Q),{variant:"subtle",theme:s.value?"red":"gray",label:s.value?"Confirm Delete":"Delete",onClick:m,"icon-left":"trash-2"},null,8,["theme","label"])]),n("div",Ip,[d(e(Q),{variant:"subtle",theme:"gray",onClick:k[4]||(k[4]=y=>l.value=!1),label:"Cancel"}),d(e(Q),{variant:"solid",onClick:c,label:"Save"})])])]),_:1},8,["modelValue"]))}}),Dp={key:0},Bp={key:1},Lp=["onClick"],Fp={class:"absolute bg-white top-2"},Tp={key:2},Mp={class:"flex justify-end"},Op={key:0},Rp=j({__name:"SlaPriorityListItem",props:{columns:{type:Array,required:!0},row:{type:Object,required:!0},isLast:{type:Boolean,default:!1}},setup(o){const t=o,l=$(!1),s=$(!1),a=$({priority:t.row.priority,resolution_time:t.row.resolution_time,response_time:t.row.response_time,default_priority:t.row.default_priority}),i=Ke("priorityOptions"),u=[{label:"Edit",onClick:()=>c(),icon:"edit"},...pt({onConfirmDelete:()=>m(),isConfirmingDelete:l})],p=Ke("gridTemplateColumns"),m=()=>{if(!l.value){l.value=!0;return}R.value.priorities.splice(R.value.priorities.indexOf(t.row),1)},c=()=>{s.value=!0,a.value={priority:t.row.priority,resolution_time:t.row.resolution_time,response_time:t.row.response_time,default_priority:t.row.default_priority}},f=k=>{R.value.priorities.forEach(y=>{y.default_priority=!1}),t.row.default_priority=k};return(k,y)=>{const h=it;return r(),v(O,null,[n("div",{class:"grid gap-2 py-3.5 px-4 items-center",style:Mt({gridTemplateColumns:e(p)})},[(r(!0),v(O,null,G(t.columns,g=>(r(),v("div",{key:g.key,class:"w-full overflow-hidden whitespace-nowrap text-ellipsis"},[g.key==="default_priority"?(r(),v("div",Dp,[d(e(Pe),{modelValue:t.row.default_priority,"onUpdate:modelValue":[y[0]||(y[0]=b=>t.row.default_priority=b),y[1]||(y[1]=b=>f(b))]},null,8,["modelValue"])])):g.key==="response_time"||g.key==="resolution_time"?(r(),v("div",Bp,[d(e(qe),null,{target:C(({togglePopover:b})=>[n("div",{onClick:S=>b(),class:"min-h-7 w-full cursor-pointer select-none leading-5 p-1 px-2 hover:bg-gray-200 rounded"},D(e(Al)(t.row[g.key])),9,Lp)]),body:C(()=>[n("div",Fp,[d($l,{modelValue:t.row[g.key],"onUpdate:modelValue":b=>t.row[g.key]=b},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024)])):(r(),v("div",Tp,[d(e(Xt),{class:"w-full bg-transparent cursor-pointer border-0 focus-visible:!ring-0 bg-none",options:e(i),modelValue:t.row[g.key],"onUpdate:modelValue":b=>t.row[g.key]=b},null,8,["options","modelValue","onUpdate:modelValue"])]))]))),128)),n("div",Mp,[d(h,{placement:"right",options:u},{default:C(()=>[d(e(Q),{icon:"more-horizontal",variant:"ghost",onClick:y[2]||(y[2]=g=>l.value=!1)})]),_:1})])],4),t.isLast?A("",!0):(r(),v("hr",Op)),d(Ep,{modelValue:s.value,"onUpdate:modelValue":y[3]||(y[3]=g=>s.value=g),row:t.row},null,8,["modelValue","row"])],64)}}}),qp={class:"rounded-md border px-2 border-gray-300 text-sm"},jp={key:0,class:"text-red-500"},Up={key:1},Pp={key:2,class:"text-center p-4 text-gray-600"},Np={key:0,class:"flex items-center justify-between mt-2.5"},Hp=j({__name:"SlaPriorityList",setup(o){me({url:"frappe.client.get_list",params:{doctype:"HD Ticket Priority",fields:["name"],order_by:"integer_value desc"},auto:!0,onSuccess(i){t.push(...i.map(u=>({label:u.name,value:u.name}))),we.value.data||(R.value.priorities=t.map((u,p)=>({priority:u.value,resolution_time:60*60,response_time:60*60,default_priority:p===0})))}});const t=Xe([]);Et("priorityOptions",t);const l=()=>{const i=R.value.priorities.map(m=>m.priority),u=t.filter(m=>!i.includes(m.value));if(u.length===0){J.error("All available priorities have already been added");return}const p=u[0].value;R.value.priorities.push({priority:p,resolution_time:60*60,response_time:60*60,default_priority:R.value.priorities.length===0})},s=N(()=>[{label:"Priority",key:"priority",isRequired:!0},{label:"Default priority",key:"default_priority",isRequired:!0},{label:"First response time",key:"response_time",isRequired:!0},{label:"Resolution time",key:"resolution_time",isRequired:!0}]),a=N(()=>Ol(s.value));return Et("gridTemplateColumns",a),Yt(()=>[...R.value.priorities],()=>{yt("priorities")},{deep:!0,debounce:300}),(i,u)=>{var m,c,f;const p=W("ErrorMessage");return r(),v(O,null,[n("div",qp,[((m=e(R).priorities)==null?void 0:m.length)!==0?(r(),v("div",{key:0,class:"grid p-2 px-4 items-center",style:Mt({gridTemplateColumns:a.value})},[(r(!0),v(O,null,G(s.value,k=>(r(),v("div",{key:k.key,class:ee(["text-gray-600 overflow-hidden whitespace-nowrap text-ellipsis",{"ml-2":k.key==="priority"||k.key==="response_time"||k.key==="resolution_time"}])},[te(D(k.label)+" ",1),k.isRequired?(r(),v("span",jp,"*")):A("",!0)],2))),128))],4)):A("",!0),((c=e(R).priorities)==null?void 0:c.length)!==0?(r(),v("hr",Up)):A("",!0),(r(!0),v(O,null,G(e(R).priorities,(k,y)=>(r(),E(Rp,{key:k.priority,row:k,columns:s.value,isLast:y===e(R).priorities.length-1},null,8,["row","columns","isLast"]))),128)),((f=e(R).priorities)==null?void 0:f.length)===0?(r(),v("div",Pp," No priorities in the list ")):A("",!0)]),e(R).priorities.length!==t.length||e(ie).default_priority||e(ie).priorities?(r(),v("div",Np,[n("div",null,[e(R).priorities.length!==t.length?(r(),E(e(Q),{key:0,variant:"subtle",label:"Add row",onClick:l,"icon-left":"plus"})):A("",!0)]),d(p,{message:e(ie).default_priority||e(ie).priorities},null,8,["message"])])):A("",!0)],64)}}}),zp={class:"flex gap-5 w-full"},Qp=j({__name:"SlaStatusList",setup(o){const{statuses:t}=Sn(),l=N(()=>t.data.filter(s=>s.category==="Open").map(s=>({label:s.label_agent,value:s.label_agent})));return(s,a)=>{const i=W("FormControl");return r(),v("div",zp,[d(i,{type:"autocomplete",label:"Default ticket status",options:l.value,class:"flex-1",modelValue:e(R).default_ticket_status,"onUpdate:modelValue":a[0]||(a[0]=u=>e(R).default_ticket_status=u)},null,8,["options","modelValue"]),d(i,{type:"autocomplete",label:"Ticket reopen status",options:l.value,class:"flex-1",modelValue:e(R).reopen_ticket_status,"onUpdate:modelValue":a[1]||(a[1]=u=>e(R).reopen_ticket_status=u)},null,8,["options","modelValue"])])}}}),Jp={key:0,class:"flex items-center h-full justify-center"},Gp={key:1,class:"sticky top-0 z-10 bg-white px-10 pt-8 pb-6"},Kp={class:"flex items-center justify-between w-full"},Wp={class:"flex items-center gap-2"},Zp={class:"flex gap-4 items-center"},Yp={key:2,class:"overflow-y-auto px-10 pb-10"},Xp={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},em={class:"mt-3"},tm={class:"flex items-center justify-between"},lm={key:0},nm={class:"text-sm text-ink-gray-6 flex gap-1 cursor-default"},am={class:"text-sm text-ink-gray-6 p-2 bg-white rounded-md max-w-96 text-wrap whitespace-pre-wrap leading-5"},sm={key:0,class:"mt-5"},om={key:0,class:"flex flex-col gap-3 items-center text-center text-ink-gray-7 text-sm mb-2 border border-gray-300 rounded-md p-3 py-4"},im={class:"mt-3.5 flex gap-5 flex-col md:flex-row"},rm={class:"w-full space-y-1.5"},um={class:"w-full space-y-1.5"},dm={class:"mt-5"},cm={class:"mt-5"},pm={class:"mt-5"},mm=j({__name:"SlaPolicyView",setup(o){var F,I;const{updateOnboardingStep:t}=ft("helpdesk"),l=$({show:!1,title:"",message:"",onConfirm:()=>{}}),s=$(!1),a=$(null),i=$(!0),u=$(!1),p=Ke("slaPolicyList"),m=`${window.location.origin}/app/hd-service-level-agreement/${(F=we.value.data)==null?void 0:F.name}`,c=me({url:"helpdesk.api.sla.get_sla",params:{docname:(I=we.value.data)==null?void 0:I.name},onSuccess(L){var B,M;let _;try{_=JSON.parse(L.condition_json||"[]")}catch{J.error("Assignment conditions are invalid or corrupt, recreate the conditions."),_=[]}const x={...L,loading:!1,condition_json:_};R.value=x,R.value.apply_sla_for_resolution=!0,a.value=JSON.stringify(x);const V=((B=R.value.condition)==null?void 0:B.length)>0,w=((M=R.value.condition_json)==null?void 0:M.length)>0;V&&!w?(i.value=!1,u.value=!0):(i.value=!0,u.value=!1)}});we.value.data&&we.value.fetchData?(R.value.loading=!0,c.submit()):Ae.value=!0;const f=()=>{const L={show:!0,title:"Unsaved changes",message:"Are you sure you want to go back? Unsaved changes will be lost.",onConfirm:f};if(s.value&&!l.value.show){l.value=L;return}if(!we.value.data&&!l.value.show){l.value=L;return}setTimeout(()=>{we.value={screen:"list",data:null,fetchData:!0}},250),l.value.show=!1},k=()=>{const L=yt(void 0,!i.value);if(Object.values(L).some(_=>_)){J.error("Invalid fields, check if all are filled in and values are correct.");return}if(we.value.data){if(u.value&&i.value){l.value={show:!0,title:"Confirm overwrite",message:"Your old conditions will be overwritten. Are you sure you want to save?",onConfirm:()=>{h(),l.value.show=!1}};return}h()}else y()},y=()=>{var x,V;const L=R.value.default_ticket_status?(x=R.value.default_ticket_status)==null?void 0:x.value:null,_=R.value.reopen_ticket_status?(V=R.value.reopen_ticket_status)==null?void 0:V.value:null;p.insert.submit({...R.value,default_ticket_status:L,ticket_reopen_status:_,condition:It({conditions:R.value.condition_json,fieldPrefix:"doc"}),condition_json:JSON.stringify(R.value.condition_json)},{onSuccess(w){J.success("SLA policy created"),we.value.data=w,we.value.screen="view",c.submit({docname:w.name}),t("setup_sla",!0)}})},h=()=>{var x,V;const L=R.value.default_ticket_status?(x=R.value.default_ticket_status)==null?void 0:x.value:null,_=R.value.reopen_ticket_status?(V=R.value.reopen_ticket_status)==null?void 0:V.value:null;p.setValue.submit({...R.value,name:we.value.data.name,default_ticket_status:L,ticket_reopen_status:_,condition:i.value?It({conditions:R.value.condition_json,fieldPrefix:"doc"}):R.value.condition,condition_json:i.value?JSON.stringify(R.value.condition_json):null},{onSuccess(){c.submit(),J.success("SLA policy updated"),p.reload()}})},g=()=>{if(R.value.default_sla){J.error("SLA set as default cannot be disabled");return}R.value.enabled=!R.value.enabled},b=()=>{R.value.default_sla=!R.value.default_sla,R.value.default_sla&&(R.value.enabled=!0)};ve(R,L=>{a.value&&(s.value=JSON.stringify(L)!=a.value,s.value?Ae.value=!0:Ae.value=!1)},{deep:!0});const S=L=>{s.value&&(L.preventDefault(),L.returnValue=!0)};return be(()=>{addEventListener("beforeunload",S)}),nt(()=>{removeEventListener("beforeunload",S),Xn(),Ae.value=!1}),(L,_)=>{const x=W("FormControl"),V=W("FeatherIcon"),w=An;return r(),v(O,null,[e(R).loading?(r(),v("div",Jp,[d(e(mt),{class:"w-4"})])):A("",!0),e(R).loading?A("",!0):(r(),v("div",Gp,[n("div",Kp,[n("div",null,[n("div",Wp,[d(e(Q),{variant:"ghost","icon-left":"chevron-left",label:e(R).service_level||"New SLA Policy",size:"md",onClick:_[0]||(_[0]=B=>f()),class:"cursor-pointer -ml-4 hover:bg-transparent focus:bg-transparent focus:outline-none focus:ring-0 focus:ring-offset-0 focus-visible:none active:bg-transparent active:outline-none active:ring-0 active:ring-offset-0 active:text-ink-gray-5 font-semibold text-ink-gray-7 text-xl hover:opacity-70 !pr-0"},null,8,["label"]),s.value?(r(),E(e(Kt),{key:0,variant:"subtle",theme:"orange",size:"sm",label:"Unsaved changes"})):A("",!0)])]),n("div",Zp,[n("div",{class:"flex items-center justify-between gap-2 cursor-pointer",onClick:g},[d(e(at),{size:"sm",modelValue:e(R).enabled,"onUpdate:modelValue":_[1]||(_[1]=B=>e(R).enabled=B)},null,8,["modelValue"]),_[12]||(_[12]=n("span",{class:"text-sm text-ink-gray-7 font-medium"},"Enabled",-1))]),d(e(Q),{label:"Save",theme:"gray",variant:"solid",onClick:_[2]||(_[2]=B=>k()),disabled:!!(!s.value&&e(we).data),loading:e(R).loading||e(p).setValue.loading},null,8,["disabled","loading"])])])])),e(R).loading?A("",!0):(r(),v("div",Yp,[n("div",Xp,[n("div",null,[d(x,{type:"text",size:"sm",variant:"subtle",placeholder:"Name",label:"Name",modelValue:e(R).service_level,"onUpdate:modelValue":_[3]||(_[3]=B=>e(R).service_level=B),required:"",onChange:_[4]||(_[4]=B=>e(yt)("service_level")),disabled:!!e(we).data},null,8,["modelValue","disabled"]),d(e(ge),{message:e(ie).service_level,class:"mt-2"},null,8,["message"])]),d(x,{type:"textarea",size:"sm",variant:"subtle",placeholder:"Description",label:"Description",modelValue:e(R).description,"onUpdate:modelValue":_[5]||(_[5]=B=>e(R).description=B)},null,8,["modelValue"])]),_[20]||(_[20]=n("hr",{class:"my-8"},null,-1)),n("div",null,[_[16]||(_[16]=n("div",{class:"flex flex-col gap-1"},[n("span",{class:"text-lg font-semibold text-ink-gray-8"},"Assignment conditions"),n("span",{class:"text-p-sm text-ink-gray-6"}," Choose which tickets are affected by this policy. ")],-1)),n("div",em,[n("div",tm,[d(e(Pe),{label:"Set as default SLA","model-value":e(R).default_sla,"onUpdate:modelValue":b,class:"text-ink-gray-6 text-base font-medium"},null,8,["model-value"]),u.value&&e(we).data&&!e(R).default_sla?(r(),v("div",lm,[d(e(qe),{trigger:"hover",hoverDelay:"0.25",placement:"top-end"},{target:C(()=>[n("div",nm,[_[13]||(_[13]=te(" Old Conditions ",-1)),d(V,{name:"info",class:"size-4"})])]),"body-main":C(()=>[n("div",am,[n("code",null,D(e(R).condition),1)])]),_:1})])):A("",!0)]),e(R).default_sla?A("",!0):(r(),v("div",sm,[i.value?A("",!0):(r(),v("div",om,[n("span",{class:"text-p-sm"},[_[14]||(_[14]=te(" Conditions for this SLA were created from ",-1)),n("a",{href:m,target:"_blank",class:"underline"},"desk"),_[15]||(_[15]=te(" which are not compatible with this UI, you will need to recreate the conditions here if you want to manage and add new conditions from this UI. ",-1))]),d(e(Q),{label:"I understand, add conditions",variant:"subtle",theme:"gray",onClick:_[6]||(_[6]=B=>i.value=!0)})])),i.value?(r(),E(Ic,{key:1,conditions:e(R).condition_json},null,8,["conditions"])):A("",!0)]))])]),_[21]||(_[21]=n("hr",{class:"my-8"},null,-1)),n("div",null,[_[17]||(_[17]=n("div",{class:"flex flex-col gap-1"},[n("span",{class:"text-lg font-semibold text-ink-gray-8"},"Valid from"),n("span",{class:"text-p-sm text-ink-gray-6"}," Choose how long this SLA policy will be active. ")],-1)),n("div",im,[n("div",rm,[d(e(et),{label:"From date",for:"from_date"}),d(e(Bt),{modelValue:e(R).start_date,"onUpdate:modelValue":_[7]||(_[7]=B=>e(R).start_date=B),variant:"subtle",placeholder:"11/01/2025",class:"w-full",id:"from_date",onChange:_[8]||(_[8]=B=>e(yt)("start_date")),formatter:B=>e(re)(B)},{prefix:C(()=>[d(w,{class:"size-4"})]),_:1},8,["modelValue","formatter"]),d(e(ge),{message:e(ie).start_date},null,8,["message"])]),n("div",um,[d(e(et),{label:"To date",for:"to_date"}),d(e(Bt),{modelValue:e(R).end_date,"onUpdate:modelValue":_[9]||(_[9]=B=>e(R).end_date=B),variant:"subtle",placeholder:"25/12/2025",class:"w-full",id:"to_date",onChange:_[10]||(_[10]=B=>e(yt)("end_date")),formatter:B=>e(re)(B)},{prefix:C(()=>[d(w,{class:"size-4"})]),_:1},8,["modelValue","formatter"]),d(e(ge),{message:e(ie).end_date},null,8,["message"])])])]),_[22]||(_[22]=n("hr",{class:"my-8"},null,-1)),n("div",null,[_[18]||(_[18]=n("div",{class:"flex flex-col gap-1"},[n("span",{class:"text-lg font-semibold text-ink-gray-8"},"Response and resolution"),n("span",{class:"text-p-sm text-ink-gray-6"}," Add time targets around support milestones like first reply and resolution times ")],-1)),n("div",dm,[n("div",cm,[d(Hp)])])]),_[23]||(_[23]=n("hr",{class:"my-8"},null,-1)),n("div",null,[_[19]||(_[19]=n("div",{class:"flex flex-col gap-1"},[n("span",{class:"text-lg font-semibold text-ink-gray-8"},"Status details"),n("span",{class:"text-p-sm text-ink-gray-6"}," Set the default status assigned when a ticket is created, and the status to apply when a ticket is reopened. If not specified, the default status from HD Settings will be used. ")],-1)),n("div",pm,[d(Qp)])]),_[24]||(_[24]=n("hr",{class:"my-8"},null,-1)),d(sp)])),d(bt,{modelValue:l.value.show,"onUpdate:modelValue":_[11]||(_[11]=B=>l.value.show=B),title:l.value.title,message:l.value.message,onConfirm:l.value.onConfirm,onCancel:()=>l.value.show=!1},null,8,["modelValue","title","message","onConfirm","onCancel"])],64)}}});const fm=Ue(mm,[["__scopeId","data-v-7e37c1e0"]]),vm={class:"pb-8"},gm=j({__name:"Sla",setup(o){const t=ct({doctype:"HD Service Level Agreement",fields:["name","default_sla","enabled","description"],orderBy:"creation desc",start:0,pageLength:999,auto:!0});return Et("slaPolicyList",t),(l,s)=>(r(),v("div",vm,[e(we).screen=="list"?(r(),E(dc,{key:0})):e(we).screen=="view"?(r(),E(fm,{key:1})):A("",!0)]))}}),ym={class:"flex items-center cursor-pointer hover:bg-gray-50 rounded"},hm={class:"text-base text-ink-gray-7 font-medium"},_m={key:0,class:"text-sm text-ink-gray-5 mt-1 whitespace-nowrap overflow-ellipsis overflow-hidden"},bm={class:"flex justify-between items-center pr-2"},km={class:"flex flex-col gap-4"},xm={class:"flex gap-2 justify-end"},wm=j({__name:"HolidayListItem",props:{data:{type:Object,required:!0}},setup(o){const t=o,l=Ke("holidayList"),s=$({show:!1,name:""}),a=$(!1),i=[{label:"Duplicate",onClick:()=>{s.value.show=!0,s.value.name=t.data.name+" (Copy)"},icon:"copy"},...pt({onConfirmDelete:()=>p(),isConfirmingDelete:a})],u=()=>{me({url:"helpdesk.api.holiday_list.duplicate_holiday_list",params:{docname:t.data.name,new_name:s.value.name},onSuccess:m=>{l.reload(),J.success("Holiday list duplicated"),s.value={show:!1,name:""},setTimeout(()=>{Ce.value={screen:"view",data:m}},250)},auto:!0})},p=()=>{if(!a.value){a.value=!0;return}l.delete.submit(t.data.name,{onSuccess:()=>{J.success("Holiday list deleted")}})};return(m,c)=>{const f=it,k=W("FormControl"),y=W("Dialog");return r(),v(O,null,[n("div",ym,[n("div",{class:"w-full py-3 pl-2",onClick:c[0]||(c[0]=h=>Ce.value={screen:"view",data:o.data})},[n("div",hm,D(o.data.name),1),o.data.description&&o.data.description.length>0?(r(),v("div",_m,D(o.data.description),1)):A("",!0)]),n("div",bm,[n("div",null,[d(f,{placement:"right",options:i},{default:C(()=>[d(e(Q),{icon:"more-horizontal",variant:"ghost",onClick:c[1]||(c[1]=h=>a.value=!1)})]),_:1})])])]),d(y,{options:{title:"Duplicate Holiday List"},modelValue:s.value.show,"onUpdate:modelValue":c[5]||(c[5]=h=>s.value.show=h)},{"body-content":C(()=>[n("div",km,[d(k,{label:"New Holiday List Name",type:"text",modelValue:s.value.name,"onUpdate:modelValue":c[2]||(c[2]=h=>s.value.name=h)},null,8,["modelValue"])])]),actions:C(()=>[n("div",xm,[d(e(Q),{variant:"subtle",label:"Close",onClick:c[3]||(c[3]=h=>s.value.show=!1)}),d(e(Q),{variant:"solid",label:"Duplicate",onClick:c[4]||(c[4]=h=>u())})])]),_:1},8,["modelValue"])],64)}}}),Cm={key:0,class:"flex items-center justify-center mt-12"},$m={key:1},Am={key:0,class:"flex items-center justify-center rounded-md border border-gray-200 p-4"},Sm={key:1},Vm=j({__name:"HolidayList",setup(o){const t=Ke("holidayList");return(l,s)=>{var a;return e(t).list.loading&&!e(t).list.data?(r(),v("div",Cm,[d(e(mt),{class:"w-4"})])):(r(),v("div",$m,[((a=e(t).list.data)==null?void 0:a.length)===0?(r(),v("div",Am,[...s[0]||(s[0]=[n("div",{class:"text-sm text-ink-gray-7"},"No items in the list",-1)])])):(r(),v("div",Sm,[s[2]||(s[2]=n("div",{class:"flex text-sm text-gray-600"},[n("div",{class:"ml-2"},"Schedule name")],-1)),s[3]||(s[3]=n("hr",{class:"mx-2 mt-2"},null,-1)),n("div",null,[(r(!0),v(O,null,G(e(t).list.data,i=>(r(),v("div",{key:i.name},[d(wm,{data:i},null,8,["data"]),s[1]||(s[1]=n("hr",{class:"mx-2"},null,-1))]))),128))])]))]))}}}),Im={class:"px-10 py-8"},Em={class:"overflow-y-auto pb-8 px-10"},Dm=j({__name:"Holidays",setup(o){const t=()=>{ea(),Ce.value={screen:"view",data:null}};return(l,s)=>{const a=W("Button");return r(),v(O,null,[n("div",Im,[d(We,{title:"Business Holidays",description:"Set your teams working days, hours, and holidays using a template or custom schedule."},{actions:C(()=>[d(a,{label:"New",theme:"gray",variant:"solid",onClick:s[0]||(s[0]=i=>t()),"icon-left":"plus"})]),_:1})]),n("div",Em,[d(Vm)])],64)}}}),Bm={class:"flex flex-col gap-4 mt-4"},Lm={class:"flex flex-col gap-1.5"},Fm={class:"flex flex-col gap-1.5"},Tm={class:"flex justify-end gap-2"},Pl=j({__name:"AddHolidayModal",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o){const t=De(o,"modelValue"),l=$({holiday_date:"",description:""}),s=()=>{t.value.holiday_date=new Date,t.value.description="",l.value={holiday_date:"",description:""}},a=()=>{var m;if(((m=t.value.description)==null?void 0:m.trim())===""&&(l.value.description="Please enter a description"),t.value.holiday_date||(l.value.holiday_date="Please enter a valid date"),l.value.holiday_date||l.value.description)return;const i=ue(t.value.holiday_date).startOf("day"),u=ue(z.value.from_date).startOf("day"),p=ue(z.value.to_date).startOf("day");if(i.isBefore(u)||i.isAfter(p)){J.error(`Holiday date must be between ${re(z.value.from_date)} and ${re(z.value.to_date)}`);return}if(t.value.editing){const c=z.value.holidays.find(k=>re(k.holiday_date)===re(t.value.holiday_date));if(c&&re(c.holiday_date)!==re(t.value.editing.holiday_date)){J.error("Holiday already exists");return}const f=z.value.holidays.indexOf(t.value.editing);z.value.holidays.splice(f,1,{...t.value,weekly_off:0})}else{if(z.value.holidays.findIndex(f=>re(f.holiday_date)===re(t.value.holiday_date))!==-1){J.error("Holiday already exists");return}z.value.holidays.push({...t.value,weekly_off:0})}t.value={show:!1,holiday_date:null,description:"",editing:null}};return(i,u)=>(r(),E(e(je),{modelValue:t.value.show,"onUpdate:modelValue":u[5]||(u[5]=p=>t.value.show=p),options:{size:"sm",title:t.value.editing?"Edit Holiday":"Add Holiday"},onAfterLeave:s},{"body-content":C(()=>[n("div",Bm,[n("div",Lm,[d(e(et),{label:"Date",required:""}),d(e(Bt),{value:e(ue)(t.value.holiday_date).format("MM-DD-YYYY"),"onUpdate:modelValue":u[0]||(u[0]=p=>t.value.holiday_date=p),formatter:p=>e(re)(p),variant:"subtle",placeholder:"Date",class:"w-full",id:"holiday_date",required:"",onChange:u[1]||(u[1]=p=>l.value.holiday_date="")},null,8,["value","formatter"]),d(e(ge),{message:l.value.holiday_date},null,8,["message"])]),n("div",Fm,[d(e(pe),{type:"textarea",size:"sm",variant:"subtle",placeholder:"National holiday, etc.",label:"Description",modelValue:t.value.description,"onUpdate:modelValue":u[2]||(u[2]=p=>t.value.description=p),required:"",onChange:u[3]||(u[3]=p=>l.value.description="")},null,8,["modelValue"]),d(e(ge),{message:l.value.description},null,8,["message"])])])]),actions:C(()=>[n("div",Tm,[d(e(Q),{variant:"subtle",theme:"gray",label:"Cancel",onClick:u[4]||(u[4]=p=>t.value.show=!1)}),d(e(Q),{variant:"solid","icon-left":"plus",label:"Add Holiday",onClick:a})])]),_:1},8,["modelValue","options"]))}}),Mm={class:"rounded-md border px-2 border-gray-300 text-sm"},Om={class:"grid p-2 px-4 items-center gap-2",style:{gridTemplateColumns:"1fr 4fr 22px"}},Rm={class:"grid gap-2 py-3.5 px-4 items-center",style:{gridTemplateColumns:"1fr 4fr 22px"}},qm=["onUpdate:modelValue"],jm={key:1},Um={class:"flex justify-end"},Pm={key:0},Nm={key:0,class:"text-center p-4 text-gray-600"},Hm=j({__name:"HolidaysTableView",setup(o){const t=$(!1),l=m=>[{label:"Edit",onClick:()=>u(m),icon:"edit"},...pt({onConfirmDelete:()=>p(m),isConfirmingDelete:t})],s=$({show:!1,holiday_date:null,description:"",editing:null}),a=N(()=>z.value.holidays.filter(m=>m.weekly_off==0)),i=[{label:"Date",key:"holiday_date"},{label:"Description",key:"description"}],u=m=>{s.value={show:!0,holiday_date:m.holiday_date,description:m.description,editing:m}},p=m=>{if(!t.value){t.value=!0;return}const c=z.value.holidays.findIndex(f=>{const k=re(f.holiday_date),y=re(m==null?void 0:m.holiday_date);return k===y});z.value.holidays.splice(c,1),t.value=!1};return(m,c)=>{var y;const f=W("Button"),k=it;return r(),v(O,null,[n("div",Mm,[n("div",Om,[(r(),v(O,null,G(i,h=>n("div",{key:h.key,class:"text-gray-600 overflow-hidden whitespace-nowrap text-ellipsis"},D(h.label),1)),64))]),c[2]||(c[2]=n("hr",null,null,-1)),(r(!0),v(O,null,G(a.value,(h,g)=>(r(),v("div",{key:h.name},[n("div",Rm,[(r(),v(O,null,G(i,b=>n("div",{key:b.key,class:"w-full overflow-hidden whitespace-nowrap text-ellipsis"},[b.key==="description"?Re((r(),v("input",{key:0,type:"text",placeholder:"Description","onUpdate:modelValue":S=>h[b.key]=S,class:"!bg-white w-full text-base px-0 focus:!ring-0 border-none hover:bg-white outline-none no-underline focus:!outline-none"},null,8,qm)),[[Za,h[b.key]]]):(r(),v("div",jm,D(e(ue)(h[b.key]).format("DD MMM YYYY")),1))])),64)),n("div",Um,[d(k,{placement:"right",options:l(h)},{default:C(()=>[d(f,{icon:"more-horizontal",variant:"ghost",onClick:c[0]||(c[0]=b=>t.value=!1)})]),_:1},8,["options"])])]),g!==a.value.length-1?(r(),v("hr",Pm)):A("",!0)]))),128)),((y=a.value)==null?void 0:y.length)===0?(r(),v("div",Nm," No items in the list ")):A("",!0)]),d(Pl,{modelValue:s.value,"onUpdate:modelValue":c[1]||(c[1]=h=>s.value=h)},null,8,["modelValue"])],64)}}});var ta={exports:{}};(function(o,t){(function(l,s){o.exports=s()})(gn,function(){return function(l,s){s.prototype.isSameOrBefore=function(a,i){return this.isSame(a,i)||this.isBefore(a,i)}}})})(ta);var zm=ta.exports;const Qm=yn(zm);var la={exports:{}};(function(o,t){(function(l,s){o.exports=s()})(gn,function(){return function(l,s){s.prototype.weekday=function(a){var i=this.$locale().weekStart||0,u=this.$W,p=(u<i?u+7:u)-i;return this.$utils().u(a)?p:this.subtract(p,"day").add(a,"day")}}})})(la);var Jm=la.exports;const Gm=yn(Jm),Km=o=>{const t=[];if(o.all)t.push("week");else{if(o.first&&t.push("first"),o.second&&t.push("second"),o.third&&t.push("third"),o.fourth&&t.push("fourth"),o.fifth&&t.push("fifth"),t.length===0)return"";if(t.length>1){const l=t.pop();t[t.length-1]=`${t[t.length-1]} and ${l}`}return t[0]=t[0].charAt(0)+t[0].slice(1),`Every ${t.join(", ")} week`}return t[0]?`Every ${t[0]}`:""},Wm={class:"rounded-md border p-1 border-gray-300 text-sm"},Zm={key:0,class:"grid p-2 items-center",style:{gridTemplateColumns:"1fr 4fr 22px"}},Ym={key:1,class:"my-0.5"},Xm={class:"grid gap-2 px-2 py-2 items-center",style:{gridTemplateColumns:"1fr 4fr 22px"}},ef={key:0},tf={key:1},lf={class:"flex justify-end"},nf={key:0,class:"my-0.5"},af={key:2,class:"text-center p-4 text-gray-600"},sf={key:0},of={key:1,class:"flex flex-col gap-4"},rf={class:"flex flex-col gap-1.5"},uf={class:"flex flex-col gap-1.5"},df={class:"grid grid-cols-2 gap-2 mt-2"},cf=j({__name:"RecurringHolidaysList",props:{holidays:{type:Array,default:()=>[],required:!0},holidayData:{type:Object,default:()=>{},required:!0}},setup(o){ue.extend(Gm),ue.extend(Qm);const t=$(!1),l=$({day:null,repetition:{all:!1,first:!1,second:!1,third:!1,fourth:!1,fifth:!1},isEditing:!1,editIndex:-1}),s=o,a=[{label:"Day",key:"day"},{label:"Repetition",key:"repetition"}],i=$([{label:"Monday",value:"Monday"},{label:"Tuesday",value:"Tuesday"},{label:"Wednesday",value:"Wednesday"},{label:"Thursday",value:"Thursday"},{label:"Friday",value:"Friday"},{label:"Saturday",value:"Saturday"},{label:"Sunday",value:"Sunday"}]),u=h=>[{label:"Edit",onClick:()=>f(h),icon:"edit"},...pt({onConfirmDelete:()=>y(h),isConfirmingDelete:m})],p=N(()=>{const h=new Set(s.holidays.filter((g,b)=>!l.value.isEditing||b!==l.value.editIndex).map(g=>g.day));return l.value.isEditing&&l.value.day&&h.delete(l.value.day),i.value.filter(g=>!h.has(g.value))}),m=$(!1),c=()=>{l.value={day:null,repetition:{all:!1,first:!1,second:!1,third:!1,fourth:!1,fifth:!1},isEditing:!1,editIndex:-1},t.value=!0},f=h=>{const g=s.holidays.findIndex(b=>b.day===h.day);l.value={...JSON.parse(JSON.stringify(h)),isEditing:!0,editIndex:g},t.value=!0},k=()=>{if(!l.value.day){J.error("Please select a day of the week");return}const{all:h,first:g,second:b,third:S,fourth:F,fifth:I}=l.value.repetition;if(!h&&!g&&!b&&!S&&!F&&!I){J.error("Please select at least one repetition option");return}const L={...l.value};if(L.isEditing)if(L.editIndex!==void 0&&L.editIndex>=0)s.holidays[L.editIndex]={...L},ol();else{J.error("Error: Unable to find the holiday to update");return}else{if(s.holidays.some(x=>x.day===L.day&&JSON.stringify(x.repetition)===JSON.stringify(L.repetition))){J.error("Holiday with the same day and repetition already exists");return}s.holidays.push({...L,isEditing:!1}),ol()}t.value=!1},y=h=>{if(!m.value){m.value=!0;return}const g=s.holidays.findIndex(b=>b.day===h.day);s.holidays.splice(g,1),ol(),t.value=!1,m.value=!1};return(h,g)=>{var I,L,_;const b=W("Button"),S=it,F=W("Dialog");return r(),v(O,null,[n("div",Wm,[((I=o.holidays)==null?void 0:I.length)!==0?(r(),v("div",Zm,[(r(),v(O,null,G(a,x=>n("div",{key:x.key,class:"text-gray-600 overflow-hidden whitespace-nowrap text-ellipsis"},D(x.label),1)),64))])):A("",!0),((L=o.holidays)==null?void 0:L.length)!==0?(r(),v("hr",Ym)):A("",!0),(r(!0),v(O,null,G(o.holidays,(x,V)=>(r(),v("div",{key:x.day},[n("div",Xm,[(r(),v(O,null,G(a,w=>n("div",{key:w.key,class:"w-full py-2 overflow-hidden whitespace-nowrap text-ellipsis"},[w.key==="repetition"?(r(),v("div",ef,D(e(Km)(x[w.key])),1)):(r(),v("div",tf,D(x[w.key]),1))])),64)),n("div",lf,[d(S,{placement:"right",options:u(x)},{default:C(()=>[d(b,{icon:"more-horizontal",variant:"ghost",onClick:g[0]||(g[0]=w=>m.value=!1)})]),_:1},8,["options"])])]),V!==o.holidays.length-1?(r(),v("hr",nf)):A("",!0)]))),128)),((_=o.holidays)==null?void 0:_.length)===0?(r(),v("div",af," No items in the list ")):A("",!0)]),d(b,{variant:"subtle",onClick:c,class:"mt-2.5",label:"Add Recurring Holiday","icon-left":"plus"}),d(F,{modelValue:t.value,"onUpdate:modelValue":g[8]||(g[8]=x=>t.value=x),options:{size:"md",title:l.value.isEditing?"Edit Recurring Holiday":"Add Recurring Holiday"}},{"body-content":C(()=>[!s.holidayData.from_date||!s.holidayData.to_date?(r(),v("div",sf,[...g[9]||(g[9]=[n("div",{class:"text-center p-4 text-gray-600"}," Please select start and end date first ",-1)])])):(r(),v("div",of,[n("div",rf,[d(e(et),{label:"Day",required:""}),d(e(Xt),{options:p.value,modelValue:l.value.day,"onUpdate:modelValue":g[1]||(g[1]=x=>l.value.day=x),disabled:p.value.length===0},null,8,["options","modelValue","disabled"])]),n("div",uf,[d(e(et),{label:"Repetition",required:""}),n("div",df,[d(e(Pe),{modelValue:l.value.repetition.all,"onUpdate:modelValue":g[2]||(g[2]=x=>l.value.repetition.all=x),label:"Every week",disabled:l.value.repetition.first||l.value.repetition.second||l.value.repetition.third||l.value.repetition.fourth},null,8,["modelValue","disabled"]),d(e(Pe),{modelValue:l.value.repetition.first,"onUpdate:modelValue":g[3]||(g[3]=x=>l.value.repetition.first=x),label:"Every first week",disabled:l.value.repetition.all},null,8,["modelValue","disabled"]),d(e(Pe),{modelValue:l.value.repetition.second,"onUpdate:modelValue":g[4]||(g[4]=x=>l.value.repetition.second=x),label:"Every second week",disabled:l.value.repetition.all},null,8,["modelValue","disabled"]),d(e(Pe),{modelValue:l.value.repetition.third,"onUpdate:modelValue":g[5]||(g[5]=x=>l.value.repetition.third=x),label:"Every third week",disabled:l.value.repetition.all},null,8,["modelValue","disabled"]),d(e(Pe),{modelValue:l.value.repetition.fourth,"onUpdate:modelValue":g[6]||(g[6]=x=>l.value.repetition.fourth=x),label:"Every fourth week",disabled:l.value.repetition.all},null,8,["modelValue","disabled"]),d(e(Pe),{modelValue:l.value.repetition.fifth,"onUpdate:modelValue":g[7]||(g[7]=x=>l.value.repetition.fifth=x),label:"Every fifth week",disabled:l.value.repetition.all},null,8,["modelValue","disabled"])])])]))]),actions:C(()=>[s.holidayData.from_date&&s.holidayData.to_date?(r(),E(b,{key:0,variant:"solid",onClick:k,class:"w-full",label:l.value.isEditing?"Update Holiday":"Add Holiday","icon-left":l.value.isEditing?"edit-2":"plus"},null,8,["label","icon-left"])):A("",!0)]),_:1},8,["modelValue","options"])],64)}}}),pf={class:"w-max mx-auto"},mf={class:"text-base font-medium mb-2 text-gray-800 ml-2.5"},ff={class:"rounded-md text-sm"},vf={class:"flex items-center text-xs uppercase"},gf=["onMouseover","onMouseleave","onClick"],yf=["onMouseover","onMouseleave"],hf={class:"grow"},_f={class:"text-sm font-semibold"},bf={class:"text-xs mt-1"},kf=["onMouseover","onMouseleave"],xf=["onClick"],on=j({__name:"HLCalender",props:{year:{type:Number,required:!0},month:{type:Number,required:!0},holidays:{type:Array,required:!0}},setup(o){const t=$({show:!1,holiday_date:null,description:"",editing:null}),{currentYear:l,currentMonth:s,today:a,datesAsWeeks:i,formattedMonth:u}=Fs(),p=i,m=$(!1),c=$({}),f=o,k=$(re(a.value)),y=(x,V)=>{c.value[x]&&clearTimeout(c.value[x]),c.value[x]=setTimeout(()=>{V()},350)},h=(x,V)=>{c.value[x]&&clearTimeout(c.value[x]),c.value[x]=setTimeout(()=>{V()},350)},g=x=>{t.value={holiday_date:x,description:"",show:!0,editing:null}},b=x=>{if(!z.value.from_date||!z.value.to_date)return!1;const V=ue(x).startOf("day"),w=ue(z.value.from_date).startOf("day"),B=ue(z.value.to_date).endOf("day");return(V.isAfter(w)||V.isSame(w,"day"))&&(V.isBefore(B)||V.isSame(B,"day"))},S=x=>{var w;if(!((w=f.holidays)!=null&&w.length))return!1;const V=ue(x).startOf("day");return f.holidays.some(B=>ue(B.holiday_date).startOf("day").isSame(V))},F=x=>{var w;if(!((w=f.holidays)!=null&&w.length))return!1;const V=ue(x).startOf("day");return f.holidays.some(B=>ue(B.holiday_date).startOf("day").isSame(V)&&B.weekly_off==1)},I=x=>{const V=f.holidays.find(w=>{const B=re(w.holiday_date),M=re(x);return B===M});t.value={show:!0,holiday_date:V.holiday_date,description:V.description,editing:V}},L=(x,V,w)=>{if(x.stopPropagation(),x.preventDefault(),!m.value){m.value=!0;return}const B=f.holidays.find(q=>{const U=re(q.holiday_date),P=re(V);return U===P}),M=f.holidays.findIndex(q=>{const U=re(q.holiday_date),P=re(B.holiday_date);return U===P});f.holidays.splice(M,1),t.value={show:!1,holiday_date:null,description:"",editing:null},m.value=!1,w()},_=x=>{const V=f.holidays.find(B=>{const M=re(B.holiday_date),q=re(x);return M===q});return V!=null&&V.weekly_off?`${xl((V==null?void 0:V.description)||"")}: Recurring holiday`:xl((V==null?void 0:V.description)||"")};return ve(()=>[f.year,f.month],([x,V])=>{l.value=x,s.value=V},{immediate:!0}),(x,V)=>{const w=W("Button");return r(),v(O,null,[n("div",pf,[n("div",mf,D(e(u)),1),n("div",ff,[n("div",vf,[(r(),v(O,null,G(["s","m","t","w","t","f","s"],(B,M)=>n("div",{class:"flex size-7.5 items-center justify-center text-center text-gray-600",key:M},D(B),1)),64))]),(r(!0),v(O,null,G(e(p),(B,M)=>(r(),v("div",{class:"flex items-center",key:M},[(r(!0),v(O,null,G(B,q=>(r(),v("div",{key:e(re)(q)},[S(q)?(r(),E(e(qe),{key:0},{target:C(({open:U,close:P})=>[n("div",{class:ee(["flex size-7 cursor-pointer text-orange-700 bg-yellow-100 items-center justify-center rounded hover:bg-yellow-100 select-none m-[1px]",{"!text-ink-gray-4 !bg-gray-100":F(q)}]),onMouseover:T=>y(e(re)(q),U),onMouseleave:T=>h(e(re)(q),P),onClick:()=>{F(q)||(P(),I(q))}},D(q.getDate()),43,gf)]),"body-main":C(({close:U,open:P})=>[n("div",{class:"p-3 flex gap-2.5 text-ink-gray-9 w-80 border border-gray-100 rounded-md",onMouseover:T=>y(e(re)(q),P),onMouseleave:T=>h(e(re)(q),U)},[V[2]||(V[2]=n("div",{class:"w-[5%]"},[n("div",{class:"size-3.5 bg-orange-500 rounded-sm mt-1"})],-1)),n("div",hf,[n("div",_f,D(_(q)),1),n("div",bf,D(q.toLocaleDateString()),1)]),F(q)?A("",!0):(r(),E(e(qe),{key:0,onClose:V[0]||(V[0]=T=>m.value=!1)},{target:C(({open:T,close:Y})=>[d(w,{icon:"more-horizontal",variant:"ghost",onClick:T,onMouseleave:X=>h(e(re)(q)+"dropdown",Y)},null,8,["onClick","onMouseleave"])]),"body-main":C(({close:T,open:Y})=>[n("div",{class:"p-2 flex flex-col gap-1 w-40 text-ink-gray-9 border border-gray-100 rounded-md",onMouseover:X=>{y(e(re)(q),P),y(e(re)(q)+"dropdown",Y)},onMouseleave:X=>{h(e(re)(q),U),h(e(re)(q)+"dropdown",T)}},[d(w,{class:"w-full flex !justify-start","icon-left":"edit",variant:"ghost",label:"Edit",onClick:()=>{U(),T(),I(q)}},null,8,["onClick"]),d(w,{class:"w-full flex !justify-start","icon-left":"trash-2",variant:"ghost",label:m.value?"Confirm Delete":"Delete",theme:m.value?"red":"gray",onClick:X=>{L(X,q,()=>{U(),T()})}},null,8,["label","theme","onClick"])],40,kf)]),_:2},1024))],40,yf)]),_:2},1024)):(r(),v("div",{key:1,class:ee(["flex size-7 items-center justify-center rounded m-[1px] select-none",{"cursor-pointer hover:bg-surface-gray-2":b(q),"text-ink-gray-3":q.getMonth()!==e(s)-1||!b(q),"bg-black text-ink-white hover:!bg-black/80 hover:text-ink-white":e(re)(q)===k.value&&b(q),"opacity-50 cursor-not-allowed":!b(q)}]),onClick:U=>b(q)?g(q):null},D(q.getDate()),11,xf))]))),128))]))),128))])]),d(Pl,{modelValue:t.value,"onUpdate:modelValue":V[1]||(V[1]=B=>t.value=B)},null,8,["modelValue"])],64)}}}),wf={class:"p-6.5 px-5 rounded-xl border border-gray-300"},Cf={class:"mb-6.5 flex justify-between items-center"},$f={class:"ml-1"},Af={class:"w-24"},Sf={ref:"yearsContainer",class:"max-h-60 overflow-y-auto py-1"},Vf=["onClick"],If={key:1,class:"flex items-center gap-2 px-2 font-semibold text-xl select-none"},Ef={class:"flex gap-2 items-center"},Df={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5"},Bf={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 justify-between gap-5"},Lf={class:"flex gap-2 items-center w-full justify-center mt-8"},Ff=j({__name:"HolidaysCalendarView",setup(o){const t=$("first-half"),l=$([1,2,3,4,5,6,7,8,9,10,11,12]),s=$(ue().year()),a=$(ue(z.value.from_date||ue()).year()),i=$(ue(z.value.to_date||ue()).year()),u=N(()=>{const c=[];for(let f=a.value;f<=i.value;f++)c.push(f);return c}),p=(c,f)=>{s.value=f,f===ue(z.value.from_date).year()?ue(z.value.from_date).month()>=6&&(t.value="second-half"):f===ue(z.value.to_date).year()?ue(z.value.to_date).month()>=6&&(t.value="first-half"):t.value="first-half",c()},m=()=>{const c=ue();s.value=c.year(),t.value=c.month()>=6?"second-half":"first-half"};return ve(()=>[z.value.from_date,z.value.to_date],([c,f])=>{c=ue(c),f=ue(f),a.value=c.year(),i.value=f.year(),s.value=c.year(),t.value=c.month()>=6?"second-half":"first-half"}),be(()=>{const c=ue(z.value.from_date||ue());t.value=c.month()>=6?"second-half":"first-half"}),(c,f)=>{const k=W("FeatherIcon");return r(),v("div",wf,[n("div",Cf,[n("div",$f,[a.value!==i.value?(r(),E(e(qe),{key:0},{target:C(({togglePopover:y})=>[d(e(Q),{class:"flex items-center gap-2 font-semibold text-xl cursor-pointer select-none",variant:"ghost",onClick:y,label:s.value+"","icon-right":"chevron-down"},null,8,["onClick","label"])]),"body-main":C(({togglePopover:y})=>[n("div",Af,[n("div",Sf,[(r(!0),v(O,null,G(u.value,h=>(r(),v("div",{key:h,ref_for:!0,ref:"yearItems",class:"cursor-pointer px-3 py-1.5 text-sm hover:bg-gray-100 flex items-center justify-between",onClick:g=>p(y,h)},[te(D(h)+" ",1),h===s.value?(r(),E(k,{key:0,name:"check",class:"size-4"})):A("",!0)],8,Vf))),128))],512)])]),_:1})):(r(),v("div",If,D(a.value),1))]),n("div",Ef,[d(e(Q),{variant:"ghost",icon:"chevron-left",disabled:t.value==="first-half",onClick:f[0]||(f[0]=y=>t.value="first-half")},null,8,["disabled"]),d(e(Q),{variant:"ghost",label:"Today",onClick:f[1]||(f[1]=y=>m())}),d(e(Q),{variant:"ghost",icon:"chevron-right",disabled:t.value==="second-half",onClick:f[2]||(f[2]=y=>t.value="second-half")},null,8,["disabled"])])]),t.value==="first-half"?(r(),v("div",Df,[(r(!0),v(O,null,G(l.value.slice(0,6),y=>(r(),E(on,{key:y,year:s.value,month:y,holidays:e(z).holidays},null,8,["year","month","holidays"]))),128))])):(r(),v("div",Bf,[(r(!0),v(O,null,G(l.value.slice(6,12),y=>(r(),E(on,{key:y,year:s.value,month:y,holidays:e(z).holidays},null,8,["year","month","holidays"]))),128))])),n("div",Lf,[n("div",{class:ee(["size-1.5 rounded-full cursor-pointer",{"bg-black":t.value==="first-half","bg-gray-400":t.value==="second-half"}]),onClick:f[3]||(f[3]=y=>t.value="first-half")},null,2),n("div",{class:ee(["size-1.5 rounded-full cursor-pointer",{"bg-black":t.value==="second-half","bg-gray-400":t.value==="first-half"}]),onClick:f[4]||(f[4]=y=>t.value="second-half")},null,2)])])}}}),Tf={key:0,class:"flex items-center h-full justify-center"},Mf={key:1,class:"flex items-center justify-between sticky top-0 z-10 bg-white px-10 pt-8 pb-4"},Of={class:"flex items-center gap-2"},Rf={class:"flex gap-2 items-center"},qf={key:2,class:"px-10 pb-8 overflow-y-scroll h-full"},jf={class:"flex items-center gap-2 mt-2"},Uf={class:"text-sm"},Pf={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},Nf={class:"mt-3.5 flex gap-5 flex-col md:flex-row"},Hf={class:"w-full space-y-1.5"},zf={class:"w-full space-y-1.5"},Qf={class:"mt-5"},Jf={class:"flex justify-between items-center"},Gf={class:"mt-5"},Kf={class:"mt-2.5 flex justify-between items-center"},Wf={key:0,class:"flex gap-4"},Zf=j({__name:"HolidayView",setup(o){var b,S;const t=$({show:!1,holiday_date:new Date,description:"",editing:null}),l=$(!1),s=$(null),a=$("calendar"),i=$(!1),u=Ke("holidayList"),p=me({url:"helpdesk.api.holiday_list.get_holiday_list",params:{docname:(b=Ce.value.data)==null?void 0:b.name},onSuccess(F){z.value=F,s.value=JSON.stringify(F)},transform(F){for(let I of F.holidays)I.description=xl(I.description);return F.recurring_holidays=JSON.parse(F.recurring_holidays||"[]"),F}});(S=Ce.value.data)!=null&&S.name?(z.value.loading=!0,p.fetch()):Ae.value=!0;const m=F=>{hl(F),(!$e.value.dateRange||$e.value.dateRange==="")&&ol()},c=()=>{if(l.value&&!i.value){i.value=!0;return}if(!Ce.value.data&&!i.value){i.value=!0;return}Ce.value.previousScreen&&(_t("SLA Policies"),we.value={screen:"view",data:{name:Ce.value.previousScreen.data},fetchData:!1}),i.value=!1,setTimeout(()=>{Ce.value={screen:"list",data:null}},250)},f=()=>{const F=hl();if(Object.values(F).some(I=>I)){J.error("Invalid fields, check if all are filled in and values are correct.");return}Ce.value.data?h():k()},k=()=>{const F=z.value.holidays.map(I=>({...I,holiday_date:ue(I.holiday_date).format("YYYY-MM-DD")}));u.insert.submit({holiday_list_name:z.value.holiday_list_name,description:z.value.description,from_date:z.value.from_date,to_date:z.value.to_date,holidays:F,recurring_holidays:JSON.stringify(z.value.recurring_holidays)},{onSuccess(I){J.success("Holiday list created"),Ce.value.data=I,Ce.value.screen="view",p.submit({docname:I.name})}})},y=me({url:"helpdesk.api.holiday_list.update_holiday_list",onSuccess(F){Ce.value.data=F,p.submit({docname:F.name}),J.success("Holiday list updated")}}),h=()=>{const F=z.value.holidays.map(I=>({...I,holiday_date:ue(I.holiday_date).format("YYYY-MM-DD")}));y.submit({docname:Ce.value.data.name,doc:{holiday_list_name:z.value.holiday_list_name,description:z.value.description,from_date:z.value.from_date,to_date:z.value.to_date,holidays:F,recurring_holidays:JSON.stringify(z.value.recurring_holidays)}})};ve(z,F=>{s.value&&(l.value=JSON.stringify(F)!=s.value,l.value?Ae.value=!0:Ae.value=!1)},{deep:!0});const g=F=>{l.value&&(F.preventDefault(),F.returnValue=!0)};return be(()=>{addEventListener("beforeunload",g)}),nt(()=>{removeEventListener("beforeunload",g),$e.value={holiday_list_name:"",from_date:"",to_date:""},Ae.value=!1}),(F,I)=>{var V;const L=W("Badge"),_=W("ErrorMessage"),x=An;return r(),v(O,null,[e(z).loading?(r(),v("div",Tf,[d(e(mt),{class:"w-4"})])):A("",!0),e(z).loading?A("",!0):(r(),v("div",Mf,[n("div",null,[n("div",Of,[d(e(Q),{variant:"ghost","icon-left":"chevron-left",label:((V=e(z))==null?void 0:V.holiday_list_name)||"New Business Holiday",size:"md",onClick:I[0]||(I[0]=w=>c()),class:"cursor-pointer -ml-4 hover:bg-transparent focus:bg-transparent focus:outline-none focus:ring-0 focus:ring-offset-0 focus-visible:none active:bg-transparent active:outline-none active:ring-0 active:ring-offset-0 active:text-ink-gray-5 font-semibold text-ink-gray-7 text-xl hover:opacity-70 !pr-0"},null,8,["label"]),l.value?(r(),E(L,{key:0,variant:"subtle",theme:"orange",size:"sm",label:"Unsaved changes"})):A("",!0)])]),n("div",Rf,[d(e(Q),{label:"Save",theme:"gray",variant:"solid",onClick:I[1]||(I[1]=w=>f()),disabled:!!(!l.value&&e(Ce).data),loading:e(u).loading||e(y).loading||e(p).loading},null,8,["disabled","loading"])])])),e(z).loading?A("",!0):(r(),v("div",qf,[n("div",jf,[n("span",Uf,[I[13]||(I[13]=te(" There are in total ",-1)),n("b",null,D(e(z).holidays.length),1),I[14]||(I[14]=te(" holidays in this list",-1))])]),I[19]||(I[19]=n("hr",{class:"mb-8 mt-2"},null,-1)),n("div",Pf,[n("div",null,[d(e(pe),{type:"text",size:"sm",variant:"subtle",placeholder:"Name",label:"Name",modelValue:e(z).holiday_list_name,"onUpdate:modelValue":I[2]||(I[2]=w=>e(z).holiday_list_name=w),required:"",onChange:I[3]||(I[3]=w=>e(hl)("holiday_list_name"))},null,8,["modelValue"]),d(_,{message:e($e).holiday_list_name,class:"mt-2"},null,8,["message"])]),d(e(pe),{type:"textarea",size:"sm",variant:"subtle",placeholder:"Description",label:"Description",modelValue:e(z).description,"onUpdate:modelValue":I[4]||(I[4]=w=>e(z).description=w)},null,8,["modelValue"])]),I[20]||(I[20]=n("hr",{class:"my-8"},null,-1)),n("div",null,[I[15]||(I[15]=n("div",{class:"flex flex-col gap-1"},[n("span",{class:"text-lg font-semibold text-ink-gray-8"},"Valid from"),n("span",{class:"text-p-sm text-ink-gray-6"}," Choose the duration of this holiday list. ")],-1)),n("div",Nf,[n("div",Hf,[d(et,{label:"From date",for:"from_date",required:""}),d(e(Bt),{modelValue:e(z).from_date,"onUpdate:modelValue":[I[5]||(I[5]=w=>e(z).from_date=w),I[6]||(I[6]=w=>m("from_date"))],variant:"subtle",placeholder:"11/01/2025",class:"w-full",id:"from_date",formatter:w=>e(re)(w),debounce:300},{prefix:C(()=>[d(x,{class:"size-4"})]),_:1},8,["modelValue","formatter"]),d(_,{message:e($e).from_date||e($e).dateRange},null,8,["message"])]),n("div",zf,[d(et,{label:"To date",for:"to_date",required:""}),d(e(Bt),{modelValue:e(z).to_date,"onUpdate:modelValue":[I[7]||(I[7]=w=>e(z).to_date=w),I[8]||(I[8]=w=>m("to_date"))],variant:"subtle",placeholder:"25/12/2025",class:"w-full",id:"to_date",formatter:w=>e(re)(w),debounce:300},{prefix:C(()=>[d(x,{class:"size-4"})]),_:1},8,["modelValue","formatter"]),d(_,{message:e($e).to_date},null,8,["message"])])])]),I[21]||(I[21]=n("hr",{class:"my-8"},null,-1)),n("div",null,[I[16]||(I[16]=n("div",{class:"flex flex-col gap-1"},[n("div",{class:"text-lg font-semibold text-ink-gray-8"}," Recurring holidays "),n("div",{class:"text-p-sm text-ink-gray-6"}," Add recurring holidays such as weekends. ")],-1)),n("div",Qf,[d(cf,{holidayData:e(z),holidays:e(z).recurring_holidays},null,8,["holidayData","holidays"])])]),I[22]||(I[22]=n("hr",{class:"my-8"},null,-1)),n("div",null,[n("div",Jf,[I[17]||(I[17]=n("div",{class:"flex justify-between flex-col gap-1"},[n("span",{class:"text-lg font-semibold text-ink-gray-8"},"Holidays"),n("div",{class:"text-p-sm text-ink-gray-6"}," Add holidays here to make sure theyre excluded from SLA calculations. ")],-1)),d(e(Ls),{buttons:[{value:"calendar",icon:"calendar"},{value:"list",icon:"list"}],modelValue:a.value,"onUpdate:modelValue":I[9]||(I[9]=w=>a.value=w)},null,8,["modelValue"])]),n("div",Gf,[a.value==="list"?(r(),E(Hm,{key:0})):(r(),E(Ff,{key:1}))]),n("div",Kf,[d(e(Q),{variant:"subtle",label:"Add Holiday",onClick:I[10]||(I[10]=w=>t.value.show=!0),"icon-left":"plus"}),a.value==="calendar"?(r(),v("div",Wf,[...I[18]||(I[18]=[Zt('<div class="gap-1 flex items-center" data-v-abd92486><span class="bg-yellow-100 size-4 rounded-sm" data-v-abd92486></span><span class="text-sm text-ink-gray-6" data-v-abd92486>Holidays</span></div><div class="gap-1 flex items-center" data-v-abd92486><span class="bg-gray-100 size-4 rounded-sm" data-v-abd92486></span><span class="text-sm text-ink-gray-6" data-v-abd92486>Recurring holidays</span></div>',2)])])):A("",!0)])])])),d(Pl,{modelValue:t.value,"onUpdate:modelValue":I[11]||(I[11]=w=>t.value=w)},null,8,["modelValue"]),d(bt,{modelValue:i.value,"onUpdate:modelValue":I[12]||(I[12]=w=>i.value=w),title:"Unsaved changes",message:"Are you sure you want to go back? Unsaved changes will be lost.",onConfirm:c,onCancel:()=>i.value=!1},null,8,["modelValue","onCancel"])],64)}}});const Yf=Ue(Zf,[["__scopeId","data-v-abd92486"]]),Xf={class:"pb-8"},ev=j({__name:"Holiday",setup(o){const t=ct({doctype:"HD Service Holiday List",fields:["name","description"],orderBy:"creation desc",start:0,pageLength:999,auto:!0});return Et("holidayList",t),(l,s)=>(r(),v("div",Xf,[e(Ce).screen=="list"?(r(),E(Dm,{key:0})):e(Ce).screen=="view"?(r(),E(Yf,{key:1})):A("",!0)]))}}),Je=ct({doctype:"HD Form Script",filters:{is_standard:1,name:["like","%Field Dependency%"]},fields:["name","enabled","owner"],auto:!0,cache:["FD","List"],orderBy:"modified desc"}),tv=N(()=>{var t;let o=[];return(t=Je.data)==null||t.forEach(l=>{let[s,a,i]=l.name.split("-");a&&i&&(o.push(i),o.push(a))}),o}),At=Xe({});async function lv(o){if(At[o.value])return At[o.value];if(o.type==="Select")return At[o.value]=o.options.split(`
`),At[o.value];if(o.type==="Link"){let t=await ot("frappe.client.get_list",{doctype:o.options,fields:["name"],limit_page_length:999});return At[o.value]=t.map(l=>l.name),At[o.value]}}const nv=["href"],Sl=j({__name:"DocumentationButton",props:{url:{},color:{}},setup(o){return(t,l)=>{const s=Ya,a=W("Tooltip");return r(),E(a,{text:"View documentation"},{default:C(()=>[n("a",{href:t.url,target:"_blank"},[d(s,{class:ee(["h-4 w-4 text-ink-gray-6",t.color])},null,8,["class"])],8,nv)]),_:1})}}}),av={class:"lucide lucide-square-check-big",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function sv(o,t){return r(),v("svg",av,[...t[0]||(t[0]=[n("path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344"},null,-1),n("path",{d:"m9 11 3 3L22 4"},null,-1)])])}const na=Z({name:"lucide-check-square",render:sv}),ov={class:"lucide lucide-square",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function iv(o,t){return r(),v("svg",ov,[...t[0]||(t[0]=[n("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"},null,-1)])])}const aa=Z({name:"lucide-square",render:iv}),rv={name:"Autocomplete",props:["label","modelValue","options","placeholder","bodyClasses","multiple","loading","hideSearch","autoFocus","placement","showFooter","buttonClasses","disabled"],emits:["update:modelValue","update:query","change"],components:{Popover:qe,Combobox:Bl,ComboboxInput:Ll,ComboboxOptions:Fl,ComboboxOption:Tl,ComboboxButton:Xa,LucideCheckSquare:na,LucideSquare:aa},expose:["togglePopover"],data(){return{query:"",showOptions:!1}},computed:{selectedValue:{get(){var t;let o;return this.multiple?(o=(t=this.modelValue)==null?void 0:t.map(l=>{const s=this.findOption(l);return s||this.sanitizeOption(l)}),this.modelValue&&!o.length&&(o=this.sanitizeOptions(this.modelValue)),o):(o=this.findOption(this.modelValue),this.modelValue&&!o&&(o=this.sanitizeOption(this.modelValue)),o)},set(o){this.query="",o&&!this.multiple&&(this.showOptions=!1),this.$emit("update:modelValue",o)}},groups(){var t;return!this.options||this.options.length==0?[]:((t=this.options[0])!=null&&t.group?this.options:[{group:"",items:this.sanitizeOptions(this.options)}]).map((l,s)=>({key:s,group:l.group,hideLabel:l.hideLabel||!1,items:this.filterOptions(this.sanitizeOptions(l.items))})).filter(l=>l.items.length>0)},allOptions(){return this.groups.flatMap(o=>o.items)},areAllOptionsSelected(){var o;return this.multiple?this.allOptions.length===((o=this.selectedValue)==null?void 0:o.length):!1}},watch:{query(o){this.$emit("update:query",o)},showOptions(o){o&&Me(()=>{var t,l;return(l=(t=this.$refs.searchInput)==null?void 0:t.$el)==null?void 0:l.focus()})}},methods:{togglePopover(o){this.showOptions=o??!this.showOptions},findOption(o){return o&&this.allOptions.find(t=>t.value===(o.value||o))},filterOptions(o){return this.query?fuzzySearch(o,{term:this.query,keys:["label","value"]}):o},displayValue(o){if(!o)return"";if(!this.multiple){if(typeof o=="object")return this.getLabel(o);let t=this.allOptions.find(l=>l.value===o);return this.getLabel(t)}return!Array.isArray(o)||o.length===0?"":o.length===1?this.getLabel(o[0]):`${o.length} values`},getLabel(o){return typeof o!="object"?o:(o==null?void 0:o.label)||(o==null?void 0:o.value)||"No label"},sanitizeOptions(o){return o?o.map(t=>this.sanitizeOption(t)):[]},sanitizeOption(o){return typeof o=="string"?{label:o,value:o}:o},isOptionSelected(o){var t,l;return this.multiple?(l=this.selectedValue)==null?void 0:l.find(s=>s&&s.value===o.value):((t=this.selectedValue)==null?void 0:t.value)===o.value},selectAll(){this.selectedValue=this.allOptions},fuzzySearch(o,{term:t,keys:l}){const s=t.toLowerCase();return o.reduce((i,u)=>{const p=l.reduce((m,c)=>{const f=u[c];if(f){const k=f.toLowerCase().indexOf(s);if(k!==-1)return m+k+1}return m},0);return p&&i.push({item:u,score:p}),i},[]).sort((i,u)=>i.score-u.score).map(i=>i.item)}}},uv={class:"w-full space-y-1.5"},dv={key:0,class:"block text-xs text-gray-600"},cv=["onClick"],pv={class:"flex flex-1 items-center gap-2 overflow-hidden"},mv={key:0,class:"flex-1 truncate text-left text-base leading-5"},fv={key:1,class:"text-base leading-5 text-gray-600"},vv={key:0,class:"relative mb-1 w-full flex-shrink-0"},gv={class:"w-full flex-1 overflow-y-auto"},yv={key:0,class:"sticky top-0 truncate bg-white px-2.5 py-1.5 text-sm font-medium text-gray-600"},hv={class:"flex flex-1 items-center gap-2 overflow-hidden"},_v={key:0,class:"flex-shrink-0"},bv={class:"flex-1 truncate"},kv={key:0,class:"ml-2 flex-shrink-0"},xv={key:0,class:"text-sm text-gray-600"},wv={key:1,class:"rounded-md px-2.5 py-1.5 text-base text-gray-600"},Cv={key:0,class:"border-t p-1"},$v={key:0,class:"flex items-center justify-end gap-1"},Av={key:1,class:"flex items-center justify-end"};function Sv(o,t,l,s,a,i){const u=W("FeatherIcon"),p=W("LoadingIndicator"),m=W("ComboboxInput"),c=aa,f=na,k=W("ComboboxOption"),y=W("ComboboxOptions"),h=W("Button"),g=W("Popover"),b=W("Combobox");return r(),E(b,{modelValue:i.selectedValue,"onUpdate:modelValue":t[4]||(t[4]=S=>i.selectedValue=S),multiple:l.multiple,nullable:""},{default:C(({open:S})=>[d(g,{class:"w-full",show:a.showOptions,"onUpdate:show":t[3]||(t[3]=F=>a.showOptions=F),placement:l.placement},{target:C(({open:F,togglePopover:I,close:L})=>[ae(o.$slots,"target",Dt(rl({open:F,close:L,togglePopover:I,isOpen:S})),()=>[n("div",uv,[o.$props.label?(r(),v("label",dv,D(o.$props.label),1)):A("",!0),n("button",{class:ee(["flex h-7 w-full items-center justify-between gap-2 rounded bg-gray-100 py-1 px-2 transition-colors hover:bg-gray-200 focus:ring-2 focus:ring-gray-400",[S?"bg-gray-200":"",o.$props.buttonClasses,l.disabled?"cursor-not-allowed opacity-50":""]]),onClick:()=>{!l.disabled&&I()}},[n("div",pv,[ae(o.$slots,"prefix"),i.selectedValue?(r(),v("span",mv,D(i.displayValue(i.selectedValue)),1)):(r(),v("span",fv,D(l.placeholder||""),1)),ae(o.$slots,"suffix")]),Re(d(u,{name:"chevron-down",class:"h-4 w-4 text-gray-600","aria-hidden":"true"},null,512),[[lt,!l.loading]]),Re(d(p,{class:"h-4 w-4 text-gray-600"},null,512),[[lt,l.loading]])],10,cv)])])]),body:C(({isOpen:F,togglePopover:I})=>[Re(n("div",null,[n("div",{class:ee(["relative mt-1 overflow-hidden rounded-lg bg-white text-base shadow-2xl",l.bodyClasses])},[d(y,{class:"flex max-h-[15rem] flex-col overflow-hidden p-1.5",static:""},{default:C(()=>[l.hideSearch?A("",!0):(r(),v("div",vv,[d(m,{ref:"searchInput",class:"form-input w-full",type:"text",value:a.query,onChange:t[0]||(t[0]=L=>a.query=L.target.value),autocomplete:"off",placeholder:"Search"},null,8,["value"]),n("button",{class:"absolute right-0 inline-flex h-7 w-7 items-center justify-center",onClick:t[1]||(t[1]=L=>i.selectedValue=null)},[d(u,{name:"x",class:"w-4"})])])),n("div",gv,[(r(!0),v(O,null,G(i.groups,L=>Re((r(),v("div",{key:L.key},[L.group&&!L.hideLabel?(r(),v("div",yv,D(L.group),1)):A("",!0),(r(!0),v(O,null,G(L.items.slice(0,50),(_,x)=>(r(),E(k,{as:"template",key:(_==null?void 0:_.value)||x,value:_},{default:C(({active:V,selected:w})=>[n("li",{class:ee(["flex h-7 cursor-pointer items-center justify-between rounded px-2.5 text-base",{"bg-gray-100":V}])},[n("div",hv,[o.$slots["item-prefix"]||o.$props.multiple?(r(),v("div",_v,[ae(o.$slots,"item-prefix",ye({ref_for:!0},{active:V,selected:w,option:_}),()=>[Re(d(c,{class:"h-4 w-4 text-gray-700"},null,512),[[lt,!i.isOptionSelected(_)]]),Re(d(f,{class:"h-4 w-4 text-gray-700"},null,512),[[lt,i.isOptionSelected(_)]])])])):A("",!0),n("span",bv,D(i.getLabel(_)),1)]),o.$slots["item-suffix"]||_!=null&&_.description?(r(),v("div",kv,[ae(o.$slots,"item-suffix",ye({ref_for:!0},{active:V,selected:w,option:_}),()=>[_!=null&&_.description?(r(),v("div",xv,D(_.description),1)):A("",!0)])])):A("",!0)],2)]),_:2},1032,["value"]))),128))])),[[lt,L.items.length>0]])),128))]),i.groups.length==0?(r(),v("li",wv," No results found ")):A("",!0)]),_:3}),o.$slots.footer||l.showFooter||l.multiple?(r(),v("div",Cv,[ae(o.$slots,"footer",Dt(rl({togglePopover:I})),()=>[l.multiple?(r(),v("div",$v,[i.areAllOptionsSelected?A("",!0):(r(),E(h,{key:0,label:"Select All",onClick:he(i.selectAll,["stop"])},null,8,["onClick"]))])):(r(),v("div",Av,[d(h,{label:"Clear",onClick:t[2]||(t[2]=he(L=>i.selectedValue=null,["stop"]))})]))])])):A("",!0)],2)],512),[[lt,F]])]),_:2},1032,["show","placement"])]),_:3},8,["modelValue","multiple"])}const rn=Ue(rv,[["render",Sv]]),Vv={class:"flex justify-between items-start flex-col gap-6"},Iv={class:"text-sm text-ink-gray-5 pt-4 w-full"},Ev={class:"flex flex-col gap-4 w-full pb-2"},Dv={class:"flex items-center gap-3 justify-between"},Bv={class:"flex gap-3 items-center"},Lv={class:"flex items-center gap-1"},Fv={class:"text-sm text-ink-gray-5"},Tv={class:"flex items-center gap-3 justify-between w-full"},Mv={class:"flex gap-3 items-center"},Ov={class:"flex items-center gap-1"},Rv={class:"text-sm text-ink-gray-5"},qv=j({__name:"FieldDependencyCriteria",props:ze({parentFieldValues:{}},{modelValue:{},modelModifiers:{},selections:{},selectionsModifiers:{}}),emits:["update:modelValue","update:selections"],setup(o){const t=o,l=De(o,"modelValue"),s=De(o,"selections"),{getField:a}=hn("HD Ticket"),i=N(()=>{var f,k;let m=s.value.selectedChildField,c=s.value.selectedParentField;return m=(f=a(m))==null?void 0:f.label,c=(k=a(c))==null?void 0:k.label,{childField:m,parentField:c}}),u=N(()=>{const m=[{label:"Any",value:"Any"}];return t.parentFieldValues.forEach(c=>{m.some(f=>f.value===c)||m.push({label:c,value:c})}),m});function p(m,c){const f=m.map(k=>k.value);l.value[c].value=m,f.length===0?l.value[c].value=[{label:"Any",value:"Any"}]:f[0]==="Any"&&f.length>1?l.value[c].value=f.filter(k=>k!=="Any").map(k=>({label:k,value:k})):f.at(-1)==="Any"&&f.length>1&&(l.value[c].value=[{label:"Any",value:"Any"}])}return(m,c)=>(r(),v("div",Vv,[n("span",Iv,"Set visibility and mandatory criteria for "+D(i.value.childField||"child")+" field:",1),n("div",Ev,[n("div",Dv,[n("div",Bv,[d(e(at),{modelValue:l.value.display.enabled,"onUpdate:modelValue":c[0]||(c[0]=f=>l.value.display.enabled=f)},null,8,["modelValue"]),n("div",Lv,[n("span",Fv,"Show "+D(i.value.childField)+" if "+D(i.value.parentField)+" is set to",1),d(Sl,{url:"https://docs.frappe.io/helpdesk/field-dependency#handling-visibility-of-child-field",color:"!text-ink-gray-6"})])]),d(rn,{disabled:!l.value.display.enabled,class:"min-w-[120px] max-w-[120px]",options:u.value,"model-value":l.value.display.value,"onUpdate:modelValue":c[1]||(c[1]=f=>p(f,"display")),multiple:!0,placeholder:"Select Child Field values",placement:"top"},null,8,["disabled","options","model-value"])]),n("div",Tv,[n("div",Mv,[d(e(at),{modelValue:l.value.mandatory.enabled,"onUpdate:modelValue":c[2]||(c[2]=f=>l.value.mandatory.enabled=f)},null,8,["modelValue"]),n("div",Ov,[n("span",Rv,"Make "+D(i.value.childField)+" mandatory if "+D(i.value.parentField)+" is set to",1),d(Sl,{url:"https://docs.frappe.io/helpdesk/field-dependency#handling-if-the-child-field-is-mandatory",color:"!text-ink-gray-6"})])]),d(rn,{disabled:!l.value.mandatory.enabled,class:"min-w-[120px] max-w-[120px]",options:u.value,"model-value":l.value.mandatory.value,"onUpdate:modelValue":c[3]||(c[3]=f=>p(f,"mandatory")),multiple:!0,placeholder:"Select Child Field values",placement:"top"},null,8,["disabled","options","model-value"])])])]))}}),jv={class:"flex gap-3 w-full justify-between flex-1"},Uv={class:"flex-1 flex flex-col gap-1.5"},Pv={class:"flex-1 flex flex-col gap-1.5"},Nv=j({__name:"FieldDependencyFieldsSelection",props:ze({isNew:{type:Boolean},parentFields:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const t=De(o,"modelValue");return(l,s)=>(r(),v("div",jv,[n("div",Uv,[s[2]||(s[2]=n("span",{class:"block text-xs text-ink-gray-5"},[te("Parent Field "),n("span",{class:"text-ink-red-3 select-none"},"*")],-1)),d(e(ln),{modelValue:t.value.selectedParentField,"onUpdate:modelValue":s[0]||(s[0]=a=>t.value.selectedParentField=a),options:l.parentFields,disabled:!l.isNew},null,8,["modelValue","options","disabled"])]),n("div",Pv,[s[3]||(s[3]=n("span",{class:"block text-xs text-ink-gray-5"},[te("Child Field "),n("span",{class:"text-ink-red-3 select-none"},"*")],-1)),d(e(ln),{modelValue:t.value.selectedChildField,"onUpdate:modelValue":s[1]||(s[1]=a=>t.value.selectedChildField=a),options:t.value.childFields,disabled:!t.value.selectedParentField||!l.isNew},null,8,["modelValue","options","disabled"])])]))}}),Hv={class:"flex w-full flex-1 justify-between h-full h-[420px] max-h-[420px] min-h-[420px]"},zv={class:"flex-1 flex flex-col gap-1.5"},Qv={class:"border flex-1 border-r-0 rounded-l p-2 flex flex-col gap-2"},Jv={class:"flex-1 overflow-y-auto hide-scrollbar basis-0"},Gv={class:"max-w-[350px] overflow-y-auto"},Kv=["onClick"],Wv={class:"text-base text-ink-gray-6 max-w-[90%] truncate"},Zv={key:1,class:"flex flex-col items-center mt-20 h-full text-ink-gray-4 text-sm"},Yv={class:"flex-1 flex flex-col gap-1.5"},Xv={class:"border flex-1 rounded-r p-2 flex flex-col gap-2"},eg={class:"flex-1 overflow-y-auto hide-scrollbar basis-0"},tg={class:"text-base text-ink-gray-8 font-medium"},lg={class:"max-w-[350px] overflow-y-auto"},ng=["onClick"],ag={class:"text-base text-ink-gray-6"},sg={key:1,class:"flex flex-col items-center mt-20 h-full text-ink-gray-4 text-sm"},og={key:2,class:"flex flex-col items-center mt-20 h-full text-ink-gray-4 text-sm"},ig=j({__name:"FieldDependencyValueSelection",props:ze({isNew:{type:Boolean},parentFields:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const t=o,l=De(o,"modelValue"),s=N(()=>l.value.parentSearch?l.value.parentFieldValues.filter(g=>g.toLowerCase().includes(l.value.parentSearch.toLowerCase())):l.value.parentFieldValues),a=N(()=>l.value.childSearch?l.value.childFieldValues.filter(g=>g.toLowerCase().includes(l.value.childSearch.toLowerCase())):l.value.childFieldValues),i=N(()=>{var b;return l.value.selectedParentField?`Search ${(b=t.parentFields.find(S=>S.value===l.value.selectedParentField))==null?void 0:b.label} values`:"Search values"}),u=N(()=>l.value.currentParentSelection?`Search ${l.value.currentParentSelection} values`:"Search values");function p(g){l.value.currentParentSelection=g}function m(g){const b=l.value.currentParentSelection;b&&(l.value.childSelections[b]instanceof Set||(l.value.childSelections[b]=new Set),l.value.childSelections[b].has(g)?l.value.childSelections[b].delete(g):l.value.childSelections[b].add(g))}function c(g){return l.value.childSelections[g]instanceof Set?l.value.childSelections[g].size:0}const f=N({get(){const g=l.value.currentParentSelection;return!g||!(l.value.childSelections[g]instanceof Set)?!1:l.value.childSelections[g].size===a.value.length},set(g){y(g)}}),k=N(()=>{const g=l.value.currentParentSelection;if(!g)return"Select All";const b=c(g);return b===0?"Select All":`${b} ${b===1?"value":"values"} selected`});function y(g){const b=l.value.currentParentSelection;b&&(l.value.childSelections[b]instanceof Set||(l.value.childSelections[b]=new Set),g?a.value.forEach(S=>{l.value.childSelections[b].add(S)}):l.value.childSelections[b].clear())}function h(g){const b=l.value.currentParentSelection;return l.value.childSelections[b]instanceof Set&&l.value.childSelections[b].has(g)}return(g,b)=>{const S=Rt,F=W("FormControl"),I=es,L=W("Badge");return r(),v("div",Hv,[n("div",zv,[b[3]||(b[3]=n("span",{class:"block text-xs text-ink-gray-5"}," Select parent field value ",-1)),n("div",Qv,[l.value.selectedParentField?(r(),v(O,{key:0},[d(F,{modelValue:l.value.parentSearch,"onUpdate:modelValue":b[0]||(b[0]=_=>l.value.parentSearch=_),placeholder:i.value,type:"text",class:"w-full"},{prefix:C(()=>[d(S,{class:"h-4 w-4 text-gray-500"})]),_:1},8,["modelValue","placeholder"]),n("div",Jv,[n("ul",Gv,[(r(!0),v(O,null,G(s.value,_=>(r(),v("li",{key:_,class:ee(["py-2 mb-1 px-2.5 cursor-pointer rounded flex justify-between items-center hover:bg-surface-gray-1 overflow-hidden max-w-full",{"bg-surface-gray-2 hover:bg-surface-gray-3":l.value.currentParentSelection===_}]),onClick:x=>p(_)},[n("span",Wv,D(_),1),c(_)===0||l.value.currentParentSelection===_?(r(),E(I,{key:0,class:"h-4 w-4 text-ink-gray-6"})):(r(),E(L,{key:1,label:c(_),theme:"gray",variant:"subtle",class:"!h-4"},null,8,["label"]))],10,Kv))),128))])])],64)):(r(),v("div",Zv," Please select a parent field first "))])]),n("div",Yv,[b[4]||(b[4]=n("span",{class:"block text-xs text-ink-gray-5 pl-1.5"}," Select child field value ",-1)),n("div",Xv,[l.value.selectedChildField&&l.value.currentParentSelection?(r(),v(O,{key:0},[d(F,{modelValue:l.value.childSearch,"onUpdate:modelValue":b[1]||(b[1]=_=>l.value.childSearch=_),placeholder:u.value,type:"text",class:"w-full"},{prefix:C(()=>[d(S,{class:"h-4 w-4 text-gray-500"})]),_:1},8,["modelValue","placeholder"]),n("div",eg,[n("li",{class:"py-2 mb-1 px-2.5 cursor-pointer rounded flex items-center bg-surface-gray-1 hover:bg-surface-gray-2",onClick:b[2]||(b[2]=_=>y(!f.value))},[d(F,{type:"checkbox","model-value":f.value,class:"mr-2"},null,8,["model-value"]),n("span",tg,D(k.value),1)]),n("ul",lg,[(r(!0),v(O,null,G(a.value,_=>(r(),v("li",{key:_,class:"py-2 mb-1 px-2.5 cursor-pointer rounded flex items-center hover:bg-surface-gray-1 max-w-full truncate",onClick:x=>m(_)},[d(F,{type:"checkbox","model-value":h(_),class:"mr-2"},null,8,["model-value"]),n("span",ag,D(_),1)],8,ng))),128))])])],64)):l.value.selectedChildField?(r(),v("div",og," Please select a parent value first ")):(r(),v("div",sg," Please select a child field first "))])])])}}}),rg={class:"flex flex-col py-8 gap-8 overflow-y-hidden"},ug={class:"flex items-center gap-2 pl-10"},dg={class:"flex gap-4 pr-10"},cg={class:"flex gap-2 items-center"},pg={class:"flex gap-1"},mg={class:"w-full flex-1 flex flex-col gap-8 overflow-y-hidden px-10"},fg={class:"flex flex-col gap-8 overflow-y-scroll"},vg=j({__name:"FieldDependency",props:{fieldDependencyName:{type:String,default:""}},emits:["update:step"],setup(o,{emit:t}){const l=o,s=t,a=N(()=>!l.fieldDependencyName),i=N(()=>a.value?"New Field Dependency":_n(l.fieldDependencyName)),{getFields:u}=hn("HD Ticket"),p=N(()=>{let _=u();if(!_||_.length===0)return[];const x=["status","agreement_status"];return _=_.filter(V=>(V.fieldtype==="Select"||V.fieldtype==="Link")&&!x.includes(V.fieldname)),_.map(V=>({label:V.label,value:V.fieldname,options:V.options||[],type:V.fieldtype}))});let m=Xe({selectedParentField:"",selectedChildField:"",childFields:[],parentFieldValues:[],childFieldValues:[],currentParentSelection:"",childSelections:{},initialChildSelections:{},parentSearch:"",childSearch:"",enabled:!0}),c=Xe({display:{enabled:!0,value:[{label:"Any",value:"Any"}]},mandatory:{enabled:!0,value:[{label:"Any",value:"Any"}]}});const f=me({url:"helpdesk.api.settings.field_dependency.create_update_field_dependency",auto:!1,makeParams:()=>({parent_field:m.selectedParentField,child_field:m.selectedChildField,parent_child_mapping:b(),enabled:m.enabled,fields_criteria:JSON.stringify(c)}),onSuccess:()=>{if(!a.value){k.reload();return}s("update:step","fd-list")}}),k=me({url:"helpdesk.api.settings.field_dependency.get_field_dependency",params:{name:l.fieldDependencyName},auto:!a.value,onSuccess:_=>{m.selectedParentField=_.parent_field,m.selectedChildField=_.child_field,m.enabled=_.enabled,y(_.parent_child_mapping),h(_.fields_criteria)}});function y(_){const x=JSON.parse(_||"{}");let V={};Object.keys(x).forEach(w=>{V[w]=new Set(x[w])}),m.childSelections=V,m.initialChildSelections=structuredClone(V),m.currentParentSelection||(m.currentParentSelection=Object.keys(x)[0]||"")}function h(_){const x=JSON.parse(_||"{}");c.display=x.display||{enabled:!0,value:[{label:"Any",value:"Any"}]},c.mandatory=x.mandatory||{enabled:!0,value:[{label:"Any",value:"Any"}]}}const g=N(()=>{var _,x;return a.value?m.enabled!==!0||m.selectedParentField!=="":k.loading?!1:!!((_=k.data)!=null&&_.enabled)!=!!m.enabled||b(m.childSelections)!==b(m.initialChildSelections)||JSON.stringify(c)!==((x=k.data)==null?void 0:x.fields_criteria)});ve(()=>g.value,_=>{Ae.value=_});function b(_=null){const x=_&&Object.keys(_).length>0?_:m.childSelections,V={};return Object.keys(x).forEach(w=>{Array.from(x[w]).length&&(V[w]=Array.from(x[w]))}),JSON.stringify(V)}async function S(_,x){if(!_)return[];if(x)if(a.value){m.selectedChildField="",m.childFieldValues=[],m.currentParentSelection="",m.childSelections={};let B=[_,...tv.value];m.childFields=p.value.filter(M=>!B.includes(M.value))}else m.childFields=p.value.filter(B=>B.value===m.selectedChildField);const V=x?p.value.find(B=>B.value===_):m.childFields.find(B=>B.value===_);return V?await lv(V):[]}const F=$(!1);function I(){if(!f.loading){if(g.value){F.value=!0;return}s("update:step","fd-list")}}function L(){if(!g.value)return;f.submit();let _=a.value?"Field Dependency created successfully":"Field Dependency updated successfully";J.success(_)}return ve(()=>m.selectedParentField,async _=>{m.parentFieldValues=await S(_,!0)}),ve(()=>m.selectedChildField,async _=>{m.childFieldValues=await S(_,!1),a.value&&(m.childSelections={}),m.currentParentSelection=m.parentFieldValues[0]||""}),ve(()=>m.currentParentSelection,()=>{m.childSearch=""}),(_,x)=>{const V=W("Button"),w=W("Badge");return r(),v(O,null,[n("div",rg,[d(We,null,{title:C(()=>[n("div",ug,[d(V,{variant:"ghost","icon-left":"chevron-left",label:i.value,size:"md",onClick:I,class:"cursor-pointer hover:bg-transparent focus:bg-transparent focus:outline-none focus:ring-0 focus:ring-offset-0 focus-visible:none active:bg-transparent active:outline-none active:ring-0 active:ring-offset-0 active:text-ink-gray-5 pl-0 -ml-[5px] pr-0"},null,8,["label"]),g.value?(r(),E(w,{key:0,theme:"orange"},{default:C(()=>[...x[6]||(x[6]=[te(" Unsaved ",-1)])]),_:1})):A("",!0)])]),actions:C(()=>[n("div",dg,[n("div",cg,[d(e(at),{modelValue:e(m).enabled,"onUpdate:modelValue":x[0]||(x[0]=B=>e(m).enabled=B),class:"!w-fit"},null,8,["modelValue"]),x[7]||(x[7]=n("span",{class:"text-p-base text-ink-gray-6"},"Enabled",-1))]),n("div",pg,[d(V,{label:"Save",variant:"solid",size:"sm",disabled:!e(m).selectedParentField||!e(m).selectedChildField||Object.keys(e(m).childSelections).length===0,loading:e(f).loading,onClick:L},null,8,["disabled","loading"])])])]),_:1}),n("div",mg,[d(Nv,{modelValue:e(m),"onUpdate:modelValue":x[1]||(x[1]=B=>ut(m)?m.value=B:m=B),"is-new":a.value,"parent-fields":p.value},null,8,["modelValue","is-new","parent-fields"]),n("div",fg,[d(ig,{modelValue:e(m),"onUpdate:modelValue":x[2]||(x[2]=B=>ut(m)?m.value=B:m=B),"is-new":a.value,"parent-fields":p.value},null,8,["modelValue","is-new","parent-fields"]),d(qv,{"parent-field-values":e(m).parentFieldValues,modelValue:e(c),"onUpdate:modelValue":x[3]||(x[3]=B=>ut(c)?c.value=B:c=B),selections:e(m),"onUpdate:selections":x[4]||(x[4]=B=>ut(m)?m.value=B:m=B)},null,8,["parent-field-values","modelValue","selections"])])])]),d(bt,{modelValue:F.value,"onUpdate:modelValue":x[5]||(x[5]=B=>F.value=B),title:"Unsaved changes",message:"Are you sure you want to go back? Unsaved changes will be lost.",onConfirm:()=>_.$emit("update:step","fd-list"),onCancel:()=>F.value=!1},null,8,["modelValue","onConfirm","onCancel"])],64)}}}),gg={class:"px-10 py-8"},yg={class:"flex items-center gap-2"},hg={class:"px-10 pb-8"},_g={key:0,class:"flex items-center justify-center py-4"},bg={key:1,class:"flex mt-28 justify-between w-full h-full"},kg={key:2,class:"w-full"},xg=["onClick"],wg={class:"w-full flex items-center p-2"},Cg={class:"flex gap-2 w-7/12 text-base text-ink-gray-7 pr-3"},$g={class:"w-3/12 flex items-center gap-2 pr-3"},Ag={class:"text-base text-ink-gray-7 truncate"},Sg={class:"w-1/12 flex items-center"},Vg={class:"w-1/12 flex items-center justify-end"},Ig={key:0,class:"h-px border-b mx-1 border-outline-gray-modals w-[99%]"},Eg=j({__name:"FieldDependencyList",setup(o){be(()=>{Je.reload()});const t=$(!1);function l(a){return pt({isConfirmingDelete:t,onConfirmDelete:()=>{Je.delete.submit(a,{onSuccess:()=>{J.success("Field dependency deleted successfully"),Je.reload()}})}})}function s(a,i){Je.setValue.submit({name:a,enabled:i},{onSuccess:()=>{J.success("Field dependency updated successfully.")}})}return(a,i)=>{var c,f;const u=W("Button"),p=ql,m=it;return r(),v(O,null,[n("div",gg,[d(We,null,{title:C(()=>[n("div",yg,[i[3]||(i[3]=n("h1",{class:"text-lg font-semibold text-ink-gray-8"}," Field Dependencies ",-1)),d(Sl,{url:"https://docs.frappe.io/helpdesk/field-dependency",color:"!text-ink-gray-6"})])]),description:C(()=>[...i[4]||(i[4]=[n("p",{class:"text-p-sm max-w-md text-ink-gray-6"}," Create dependencies between fields to dynamically control options based on user selections. ",-1)])]),actions:C(()=>[d(u,{label:"New",theme:"gray",variant:"solid",onClick:i[0]||(i[0]=k=>a.$emit("update:step","fd")),"icon-left":"plus"})]),_:1})]),n("div",hg,[e(Je).loading?(r(),v("div",_g,[d(e(mt),{scale:5})])):A("",!0),!e(Je).loading&&((c=e(Je).data)==null?void 0:c.length)===0?(r(),v("div",bg,[...i[5]||(i[5]=[n("p",{class:"text-sm text-gray-500 w-full flex justify-center"}," No field dependencies found. ",-1)])])):A("",!0),!e(Je).loading&&((f=e(Je).data)==null?void 0:f.length)>0?(r(),v("div",kg,[i[6]||(i[6]=Zt('<div class="flex w-full p-2"><p class="w-7/12 text-p-sm text-ink-gray-5">Name</p><p class="w-3/12 text-p-sm text-ink-gray-5">Created By</p><p class="w-1/12 text-p-sm text-ink-gray-5">Enabled</p><p class="w-1/12 text-p-sm text-ink-gray-5"></p></div><div class="h-px border-t mx-1 border-outline-gray-modals"></div>',2)),n("ul",null,[(r(!0),v(O,null,G(e(Je).data,(k,y)=>{var h;return r(),v("li",{class:"w-full flex flex-col items-center cursor-pointer hover:bg-surface-menu-bar rounded",onClick:he(g=>a.$emit("update:step","fd",k.name),["stop"]),key:k.name},[n("div",wg,[n("div",Cg,[n("span",null,D(e(_n)(k.name)),1)]),n("p",$g,[d(e(kt),{size:"sm",image:k.owner,label:k.owner},null,8,["image","label"]),n("span",Ag,D(k.owner),1)]),n("p",Sg,[d(e(at),{"model-value":k.enabled,"onUpdate:modelValue":g=>s(k.name,g),onClick:i[1]||(i[1]=he(()=>{},["stop"]))},null,8,["model-value","onUpdate:modelValue"])]),n("p",Vg,[d(m,{placement:"right",options:l(k.name)},{default:C(()=>[d(u,{variant:"ghost",onClick:i[2]||(i[2]=he(()=>{t.value=!1},["stop"]))},{icon:C(()=>[d(p,{class:"h-4 w-4"})]),_:1})]),_:1},8,["options"])])]),y<((h=e(Je).data)==null?void 0:h.length)-1?(r(),v("div",Ig)):A("",!0)],8,xg)}),128))])])):A("",!0)])],64)}}}),Dg={key:0,class:"h-full"},Bg={key:1,class:"h-full"},Lg=j({__name:"FieldDependencyConfig",setup(o){const t=$("fd-list"),l=$("");function s(a,i){t.value=a,l.value=i}return(a,i)=>t.value==="fd-list"?(r(),v("div",Dg,[d(Eg,{"onUpdate:step":s})])):t.value==="fd"?(r(),v("div",Bg,[d(vg,{"onUpdate:step":s,"field-dependency-name":l.value},null,8,["field-dependency-name"])])):A("",!0)}}),Fg={class:"px-10 pb-8 h-full overflow-y-auto"},Tg={class:"sticky top-0 z-10 bg-white pt-8 pb-1"},Mg={class:"flex flex-col gap-[0.375rem] mt-3"},Og={class:"text-base"},Rg={class:"text-ink-gray-8"},qg={class:"text-ink-gray-5"},jg=j({__name:"InviteAgents",setup(o){const t=Ot(),{isAdmin:l,isManager:s}=t,{updateOnboardingStep:a}=ft("helpdesk"),i=$(""),u=L=>{switch(L){case"Agent":return"Agent";case"Agent Manager":return"Manager";case"System Manager":return"Admin";default:const _=L;throw new Error(`Invalid role: ${_}`)}},p=[{label:u("Agent"),value:"Agent",description:"Can work on tickets, create custom views and manage private views."}],m={label:u("Agent Manager"),value:"Agent Manager",description:"Can invite new agents, manage tickets, create custom views and manage public views."};l?p.push(m,{label:u("System Manager"),value:"System Manager",description:"Can manage all aspects of Helpdesk."}):s&&p.push(m);const c=$(p[0].value),f=N(()=>p.find(L=>L.value===c.value).description),k=async()=>{i.value.trim()===""&&J.error("At least one email required"),await g.submit({emails:i.value,roles:I(c.value),redirect_to_path:"/helpdesk",app_name:"helpdesk"}),y()},y=()=>{i.value="",c.value=p[0].value},h=L=>L.join(", "),g=me({url:"frappe.core.api.user_invitation.invite_by_email",onSuccess(L){y();let _=h(L.invited_emails);_.trim()!==""&&J.success(`${_} invited successfully`),_=h(L.disabled_user_emails),_.trim()!==""&&J.info(`${_} already present and disabled`),_=h(L.pending_invite_emails),_.trim()!==""&&J.info(`${_} already invited`),_=h(L.accepted_invite_emails),_.trim()!==""&&J.info(`${_} already present`),b.reload(),a("invite_your_team")}}),b=me({url:"frappe.core.api.user_invitation.get_pending_invitations",params:{app_name:"helpdesk"},auto:!0,method:"GET"}),S=me({url:"frappe.core.api.user_invitation.cancel_invitation",method:"PATCH",onSuccess(){J.success("Invitation cancelled successfully"),b.fetch()}}),F=L=>{const _=new Set(L);if(_.has("System Manager"))return u("System Manager");if(_.has("Agent Manager"))return u("Agent Manager");if(_.has("Agent"))return u("Agent");throw new Error(`Invalid roles: ${L.join(", ")}`)},I=L=>{const _=[];switch(L){case"System Manager":_.push("Agent","Agent Manager");break;case"Agent Manager":_.push("Agent");break;case"Agent":break;default:const x=L;throw new Error(`Invalid selected role: ${x}`)}return _.push(L),_};return(L,_)=>{var x;return r(),v("div",Fg,[n("form",{onSubmit:he(k,["prevent"]),class:"flex flex-col gap-5"},[n("div",Tg,[d(We,{title:"Invite Agents",description:"Easily invite new agents, managers, or admins"})]),d(e(pe),{type:"textarea",required:!0,label:"Invite by email",placeholder:"user1@example.com, user2@example.com, ...",modelValue:i.value,"onUpdate:modelValue":_[0]||(_[0]=V=>i.value=V),debounce:100,description:"Comma separated emails to invite"},null,8,["modelValue"]),d(e(pe),{label:"Role",type:"select",required:!0,options:p,modelValue:c.value,"onUpdate:modelValue":_[1]||(_[1]=V=>c.value=V),description:f.value},null,8,["modelValue","description"]),d(e(Q),{type:"submit",variant:"solid",class:"w-fit mt-1",disabled:e(S).loading,loading:e(g).loading},{default:C(()=>[..._[2]||(_[2]=[te("Send Invites",-1)])]),_:1},8,["disabled","loading"])],32),(x=e(b).data)!=null&&x.length?(r(),v(O,{key:0},[_[3]||(_[3]=n("h2",{class:"mt-8 text-base font-semibold"},"Pending Invites",-1)),n("ul",Mg,[(r(!0),v(O,null,G(e(b).data,V=>(r(),v("li",{key:V.name,class:"flex items-center justify-between px-3 py-1 rounded-lg bg-surface-gray-2"},[n("div",Og,[n("span",Rg,D(V.email),1),n("span",qg," ("+D(F(V.roles))+") ",1)]),n("div",null,[d(e(Wt),{disabled:e(g).loading||e(S).loading,text:"Cancel Invitation"},{default:C(()=>[n("div",null,[d(e(Q),ye({icon:"x",variant:"ghost",loading:e(S).loading&&V.name===e(S).params.name,onClick:()=>{e(g).loading||e(S).loading||e(S).submit({name:V.name,app_name:"helpdesk"})}},{ref_for:!0},{...e(S).loading&&e(S).params.name!==V.name||e(g).loading?{"aria-disabled":!0,class:"opacity-25"}:{}}),null,16,["loading","onClick"])])]),_:2},1032,["disabled"])])]))),128))])],64)):A("",!0)])}}}),Ug={class:"lucide lucide-image-up",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Pg(o,t){return r(),v("svg",Ug,[...t[0]||(t[0]=[n("path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10l-3.1-3.1a2 2 0 0 0-2.814.014L6 21"},null,-1),n("path",{d:"m14 19.5 3-3 3 3"},null,-1),n("path",{d:"M17 22v-5.5"},null,-1),n("circle",{cx:"9",cy:"9",r:"2"},null,-1)])])}const Ng=Z({name:"lucide-image-up",render:Pg}),Hg={class:"lucide lucide-mail-open",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function zg(o,t){return r(),v("svg",Hg,[...t[0]||(t[0]=[n("path",{d:"M21.2 8.4c.5.38.8.97.8 1.6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V10a2 2 0 0 1 .8-1.6l8-6a2 2 0 0 1 2.4 0l8 6Z"},null,-1),n("path",{d:"m22 10-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 10"},null,-1)])])}const sa=Z({name:"lucide-mail-open",render:zg}),Qg={class:"lucide lucide-user-plus",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Jg(o,t){return r(),v("svg",Qg,[...t[0]||(t[0]=[n("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"},null,-1),n("circle",{cx:"9",cy:"7",r:"4"},null,-1),n("line",{x1:"19",x2:"19",y1:"8",y2:"14"},null,-1),n("line",{x1:"22",x2:"16",y1:"11",y2:"11"},null,-1)])])}const oa=Z({name:"lucide-user-plus",render:Jg}),Gg={class:"lucide lucide-shield-check",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Kg(o,t){return r(),v("svg",Gg,[...t[0]||(t[0]=[n("path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"},null,-1),n("path",{d:"m9 12 2 2 4-4"},null,-1)])])}const Wg=Z({name:"lucide-shield-check",render:Kg}),Zg={class:"lucide lucide-briefcase",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Yg(o,t){return r(),v("svg",Zg,[...t[0]||(t[0]=[n("path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"},null,-1),n("rect",{width:"20",height:"14",x:"2",y:"6",rx:"2"},null,-1)])])}const Xg=Z({name:"lucide-briefcase",render:Yg}),ey={class:"grid grid-cols-11 items-center gap-4 cursor-pointer hover:bg-gray-50 rounded"},ty={class:"text-base text-ink-gray-7 font-medium"},ly={key:0,class:"text-sm w-full text-ink-gray-5 mt-1 whitespace-nowrap overflow-ellipsis overflow-hidden"},ny={class:"col-span-2"},ay={class:"flex justify-between items-center w-full pr-2 col-span-2"},sy={class:"flex flex-col gap-4"},oy={class:"flex gap-2 justify-end"},iy=j({__name:"AssignmentRuleListItem",props:{data:{type:Object,required:!0}},setup(o){const t=Ke("assignmentRulesList"),l=o,s=[{label:"Low",value:"0"},{label:"Low-Medium",value:"1"},{label:"Medium",value:"2"},{label:"Medium-High",value:"3"},{label:"High",value:"4"}],a=$({show:!1,name:""}),i=$(!1),u=()=>{me({url:"frappe.client.delete",params:{doctype:"Assignment Rule",name:l.data.name},onSuccess:()=>{t.reload(),i.value=!1,J.success("Assignment rule deleted")},auto:!0})},p=[{label:"Duplicate",onClick:()=>{a.value={show:!0,name:l.data.name+" (Copy)"}},icon:"copy"},...pt({onConfirmDelete:()=>u(),isConfirmingDelete:i})],m=()=>{me({url:"helpdesk.api.assignment_rule.duplicate_assignment_rule",params:{docname:l.data.name,new_name:a.value.name},onSuccess:y=>{t.reload(),J.success("Assignment rule duplicated"),a.value.show=!1,a.value.name="",Ee.value={screen:"view",data:{name:y.name}}},auto:!0})},c=()=>{k("priority",l.data.priority)},f=()=>{if(!l.data.users_exists&&l.data.disabled){J.error("Cannot enable rule without adding users in it");return}k("disabled",!l.data.disabled,"status")},k=(y,h,g=void 0)=>{me({url:"frappe.client.set_value",params:{doctype:"Assignment Rule",name:l.data.name,fieldname:y,value:h},onSuccess:()=>{t.reload(),J.success(`Assignment rule ${g||y} updated`)},auto:!0})};return(y,h)=>{const g=it;return r(),v(O,null,[n("div",ey,[n("div",{onClick:h[0]||(h[0]=b=>Ee.value={screen:"view",data:o.data}),class:"w-full py-3 pl-2 col-span-7"},[n("div",ty,D(o.data.name),1),o.data.description&&o.data.description.length>0?(r(),v("div",ly,D(o.data.description),1)):A("",!0)]),n("div",ny,[d(e(Xt),{class:"w-max bg-transparent -ml-2 border-0 text-ink-gray-6 focus-visible:!ring-0 bg-none",options:s,modelValue:o.data.priority,"onUpdate:modelValue":[h[1]||(h[1]=b=>o.data.priority=b),c]},null,8,["modelValue"])]),n("div",ay,[n("div",null,[d(e(at),{size:"sm",modelValue:!o.data.disabled,"onUpdate:modelValue":f},null,8,["modelValue"])]),n("div",null,[d(g,{placement:"right",options:p},{default:C(()=>[d(e(Q),{icon:"more-horizontal",variant:"ghost",onClick:h[2]||(h[2]=b=>i.value=!1)})]),_:1})])])]),d(e(je),{options:{title:y.__("Duplicate Assignment Rule")},modelValue:a.value.show,"onUpdate:modelValue":h[6]||(h[6]=b=>a.value.show=b)},{"body-content":C(()=>[n("div",sy,[d(e(pe),{label:y.__("New Assignment Rule Name"),type:"text",modelValue:a.value.name,"onUpdate:modelValue":h[3]||(h[3]=b=>a.value.name=b)},null,8,["label","modelValue"])])]),actions:C(()=>[n("div",oy,[d(e(Q),{variant:"subtle",label:y.__("Close"),onClick:h[4]||(h[4]=b=>a.value.show=!1)},null,8,["label"]),d(e(Q),{variant:"solid",label:y.__("Duplicate"),onClick:h[5]||(h[5]=b=>m())},null,8,["label"])])]),_:1},8,["options","modelValue"])],64)}}}),ry={key:0,class:"flex items-center justify-center mt-12"},uy={key:1},dy={key:0,class:"flex items-center justify-center rounded-md border border-gray-200 p-4"},cy={class:"text-sm text-ink-gray-7"},py={key:1},my={class:"grid grid-cols-11 items-center gap-4 text-sm text-gray-600"},fy={class:"col-span-7 ml-2"},vy={class:"col-span-2"},gy={class:"col-span-2"},yy=j({__name:"AssignmentRulesListView",setup(o){const t=Ke("assignmentRulesList");return(l,s)=>{var a;return e(t).loading&&!e(t).data?(r(),v("div",ry,[d(e(mt),{class:"w-4"})])):(r(),v("div",uy,[((a=e(t).data)==null?void 0:a.length)===0?(r(),v("div",dy,[n("div",cy,D(l.__("No items in the list")),1)])):(r(),v("div",py,[n("div",my,[n("div",fy,D(l.__("Assignment rule")),1),n("div",vy,D(l.__("Priority")),1),n("div",gy,D(l.__("Enabled")),1)]),s[1]||(s[1]=n("hr",{class:"mt-2 mx-2"},null,-1)),(r(!0),v(O,null,G(e(t).data,i=>(r(),v("div",{key:i.name},[d(iy,{data:i},null,8,["data"]),s[0]||(s[0]=n("hr",{class:"mx-2"},null,-1))]))),128))]))]))}}}),hy={class:"px-10 py-8 sticky top-0"},_y={class:"flex items-start justify-between"},by={class:"flex flex-col gap-1"},ky={class:"text-lg font-semibold text-ink-gray-8"},xy={class:"text-p-sm text-ink-gray-6 max-w-md"},wy={class:"overflow-y-auto px-10 pb-8"},Cy=j({__name:"AssignmentRulesList",setup(o){const t=me({url:"helpdesk.api.assignment_rule.get_assignment_rules_list",cache:["assignmentRules","get_assignment_rules_list"],auto:!0});Et("assignmentRulesList",t);const l=()=>{Zn(),Ee.value={screen:"view",data:null}};return(s,a)=>(r(),v(O,null,[n("div",hy,[n("div",_y,[n("div",by,[n("h1",ky,D(s.__("Assignment rules")),1),n("p",xy,D(s.__("Assignment Rules automatically route tickets to the right team members based on predefined conditions.")),1)]),d(e(Q),{label:s.__("Create new"),theme:"gray",variant:"solid",onClick:a[0]||(a[0]=i=>l()),"icon-left":"plus"},null,8,["label"])])]),n("div",wy,[d(yy)])],64))}}),$y={class:"mt-1 rounded-lg bg-white py-1 text-base shadow-2xl w-60"},Ay={class:"relative px-1.5 pt-0.5"},Sy={class:"flex gap-2 items-center w-full select-none"},Vy={class:"flex flex-col gap-1 truncate"},Iy={class:"font-semibold text-ink-gray-7 truncate"},Ey={class:"text-ink-gray-6 truncate"},Dy={key:0,class:"mt-1.5 rounded-md p-1.5 text-base text-gray-600"},By={class:"border-t p-1.5 pb-0.5"},Ly=j({__name:"AssigneeSearch",emits:["addAssignee"],setup(o,{emit:t}){const l=t,s=$(""),a=$(!1);Yt(()=>s.value,c=>{const f={full_name:void 0,email:void 0};c.includes("@")||c.includes(".")?f.email=["like",`%${c}%`]:f.full_name=["like",`%${c}%`],i.update({filters:f}),i.reload()},{debounce:500});const i=ct({doctype:"User",fields:["name","email","full_name","user_image"],start:0,pageLength:5,auto:!0,transform:c=>c.map(f=>f.full_name=="Administrator"?{...f,email:"Administrator",user:"Administrator"}:{...f,user:f.email}).filter(f=>f.full_name!="Guest")}),u=N(()=>{var c;return((c=i.data)==null?void 0:c.filter(f=>!H.value.users.some(k=>k.user===f.email)))||[]}),p=c=>{c.forEach(f=>{m({user:f})})},m=c=>{H.value.users.some(k=>k.user===c.user)||(H.value.users.push({full_name:c.full_name,email:c.email,user_image:c.user_image,user:c.email}),l("addAssignee",c))};return(c,f)=>{const k=W("Button"),y=W("FeatherIcon");return r(),v(O,null,[d(e(Bl),{multiple:!0},{default:C(()=>[d(e(qe),{placement:"bottom-end"},{target:C(({togglePopover:h})=>[d(k,{variant:"subtle","icon-left":"plus",onClick:g=>h(),label:c.__("Add Assignee")},null,8,["onClick","label"])]),body:C(({togglePopover:h})=>[n("div",$y,[n("div",Ay,[d(e(Ll),{ref:"search",class:"form-input w-full",type:"text",onChange:f[0]||(f[0]=g=>{s.value=g.target.value}),value:s.value,autocomplete:"off",placeholder:c.__("Search")},null,8,["value","placeholder"]),n("button",{class:"absolute right-1.5 inline-flex h-7 w-7 items-center justify-center",onClick:f[1]||(f[1]=g=>s.value="")},[d(y,{name:"x",class:"w-4"})])]),d(e(Fl),{class:"my-2 max-h-64 overflow-y-auto px-1.5",static:""},{default:C(()=>[(r(!0),v(O,null,G(u.value,g=>Re((r(),E(e(Tl),{key:g.username,value:g,as:"template",onClick:b=>{b.stopPropagation(),m(g)}},{default:C(({active:b})=>[n("li",{class:ee(["flex items-center rounded p-1.5 w-full text-base",{"bg-gray-100":b}])},[n("div",Sy,[d(e(kt),{shape:"circle",image:g.user_image,label:g.full_name,size:"lg"},null,8,["image","label"]),n("div",Vy,[n("div",Iy,D(g.full_name),1),n("div",Ey,D(g.email),1)])])],2)]),_:2},1032,["value","onClick"])),[[lt,u.value.length>0]])),128)),u.value.length==0?(r(),v("li",Dy,D(c.__("No results found")),1)):A("",!0)]),_:1}),n("div",By,[d(k,{variant:"ghost",class:"w-full","icon-left":"plus",label:c.__("Invite agent"),onClick:()=>{a.value=!0,h()}},null,8,["label","onClick"])])])]),_:1})]),_:1}),d(Ln,{title:c.__("Add Agents"),onClose:f[2]||(f[2]=h=>a.value=!1),modelValue:a.value,show:a.value,"onUpdate:modelValue":f[3]||(f[3]=h=>a.value=h),onOnAgentsInvited:p},null,8,["title","modelValue","show"])],64)}}}),Fy={class:"flex flex-col gap-1"},Ty={class:"text-lg font-semibold text-ink-gray-8"},My={class:"text-p-sm text-ink-gray-6"},Oy={class:"mt-8 flex items-center justify-between gap-2"},Ry={class:"text-base font-medium text-ink-gray-8"},qy={class:"text-p-sm text-ink-gray-6 mt-1"},jy=["onClick"],Uy={class:"p-1 text-ink-gray-7 mt-1 w-48 bg-white shadow-xl rounded"},Py=["onClick"],Ny={class:"mt-7 flex items-center justify-between gap-2"},Hy={class:"text-base font-medium text-ink-gray-8"},zy={class:"text-p-sm text-ink-gray-6 mt-1"},Qy={class:"mt-4 flex flex-wrap gap-2"},Jy={class:"text-ink-gray-7"},Gy={class:"text-xs rounded-full select-none bg-blue-600 text-white p-0.5 px-2"},Ky=j({__name:"AssigneeRules",setup(o){const{getUser:t}=Ml(),l=[{label:"Auto-rotate",value:"Round Robin"},{label:"Assign by workload",value:"Load Balancing"}],s=i=>{H.value.users=H.value.users.filter(u=>u.user!==i.name),ht("users")},a=N(()=>{const i=[];return H.value.users.forEach(u=>{i.push(t(u.user))}),i});return(i,u)=>{const p=W("FeatherIcon");return r(),v("div",null,[n("div",Fy,[n("span",Ty,D(i.__("Assignee Rules")),1),n("span",My,D(i.__("Define who receives the tickets and how theyre distributed among agents.")),1)]),n("div",Oy,[n("div",null,[n("div",Ry,D(i.__("Ticket Routing")),1),n("div",qy,D(i.__("Choose how tickets are distributed among selected assignees.")),1)]),n("div",null,[d(e(qe),{placement:"bottom-end"},{target:C(({togglePopover:m})=>{var c;return[n("div",{class:"flex items-center justify-between text-base rounded h-7 py-1.5 pl-2 pr-2 border border-[--surface-gray-2] bg-surface-gray-2 placeholder-ink-gray-4 hover:border-outline-gray-modals hover:bg-surface-gray-3 focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3 text-ink-gray-8 transition-colors w-full dark:[color-scheme:dark] select-none min-w-40",onClick:f=>m()},[n("div",null,D((c=l.find(f=>f.value==e(H).rule))==null?void 0:c.label),1),d(p,{name:"chevron-down",class:"size-4"})],8,jy)]}),body:C(({togglePopover:m})=>[n("div",Uy,[(r(),v(O,null,G(l,c=>n("div",{key:c.value,class:"p-2 cursor-pointer hover:bg-gray-50 text-sm flex items-center justify-between rounded",onClick:()=>{e(H).rule=c.value,m()}},[n("span",null,D(c.label),1),e(H).rule==c.value?(r(),E(p,{key:0,name:"check",class:"size-4"})):A("",!0)],8,Py)),64))])]),_:1})])]),n("div",Ny,[n("div",null,[n("div",Hy,D(i.__("Assignees")),1),n("div",zy,D(i.__("Choose who receives the tickets.")),1)]),d(Ly,{onAddAssignee:u[0]||(u[0]=m=>e(ht)("users"))})]),n("div",Qy,[(r(!0),v(O,null,G(a.value,m=>(r(),v("div",{key:m.name,class:"flex items-center gap-2 text-sm bg-surface-gray-2 rounded-md p-1 w-max px-2 select-none"},[d(e(kt),{image:m.user_image,label:m.full_name,size:"sm"},null,8,["image","label"]),n("div",Jy,D(m.full_name),1),m.email==e(H).lastUser?(r(),E(e(Wt),{key:0,text:i.__("Last user assigned by this rule"),"hover-delay":.35,placement:"top"},{default:C(()=>[n("div",Gy,D(i.__("Last")),1)]),_:1},8,["text"])):A("",!0),d(e(Q),{variant:"ghost",icon:"x",onClick:c=>s(m)},null,8,["onClick"])]))),128))]),d(e(ge),{message:e(_e).users},null,8,["message"])])}}}),Wy={class:"flex items-center justify-between mt-2"},un=j({__name:"AssignmentRulesSection",props:{conditions:Array,name:String,errors:String},setup(o){const t=o,l=()=>{let i="and";return t.conditions.forEach(u=>{typeof u=="string"&&(i=u)}),i},s=[{label:"Add condition",onClick:()=>{a()}},{label:"Add condition group",onClick:()=>{const i=l();t.conditions.push(i,[[]])}}],a=()=>{if(!Gt(t.conditions))return;const u=l();t.conditions.push(u,["","",""])};return Yt(()=>[...t.conditions],()=>{ht(t.name)},{deep:!0,debounce:300}),(i,u)=>(r(),v(O,null,[t.conditions.length>0?(r(),E(dl,{key:0,conditions:t.conditions,level:0,disableAddCondition:t.errors!==""},null,8,["conditions","disableAddCondition"])):A("",!0),t.conditions.length==0?(r(),v("div",{key:1,class:"flex p-4 items-center cursor-pointer justify-center gap-2 text-sm border border-gray-300 text-gray-600 rounded-md",onClick:u[0]||(u[0]=p=>{t.conditions.push(["","",""]),e(ht)(t.name)})},[d(e(Ne),{name:"plus",class:"h-4"}),te(" "+D(i.__("Add a condition")),1)])):A("",!0),n("div",Wy,[t.conditions.length>0?(r(),E(e(qt),{key:0,class:"mt-2",options:s},{default:C(({open:p})=>[d(e(Q),{disabled:t.errors!=="","icon-right":p?"chevron-up":"chevron-down",label:i.__("Add condition")},null,8,["disabled","icon-right","label"])]),_:1})):A("",!0),t.conditions.length>0?(r(),E(e(ge),{key:1,message:t.errors,class:"mt-2"},null,8,["message"])):A("",!0)])],64))}}),Zy={class:"grid py-3.5 px-4 items-center",style:{"grid-template-columns":"3fr 1fr"}},Yy={class:"text-ink-gray-7 font-medium"},Xy={class:"flex justify-start"},e1={key:0},t1=j({__name:"AssignmentScheduleItem",props:{data:{type:Object,required:!0},isLast:{type:Boolean,default:!1}},setup(o){const t=o,l=s=>{const a=H.value.assignmentDays.findIndex(i=>i===t.data.day);s&&a===-1?H.value.assignmentDays.push(t.data.day):H.value.assignmentDays.splice(a,1)};return(s,a)=>(r(),v(O,null,[n("div",Zy,[n("div",Yy,D(o.data.day),1),n("div",Xy,[d(e(at),{modelValue:o.data.active,"onUpdate:modelValue":[a[0]||(a[0]=i=>o.data.active=i),l]},null,8,["modelValue"])])]),o.isLast?A("",!0):(r(),v("hr",e1))],64))}}),l1={class:"rounded-md border px-2 border-gray-300 text-sm"},n1={class:"grid p-2 px-4 items-center",style:{"grid-template-columns":"3fr 1fr"}},a1=j({__name:"AssignmentSchedule",setup(o){const t=[{label:"Days",key:"day"},{label:"Active",key:"active"}],l=$([{day:"Monday",active:!1},{day:"Tuesday",active:!1},{day:"Wednesday",active:!1},{day:"Thursday",active:!1},{day:"Friday",active:!1},{day:"Saturday",active:!1},{day:"Sunday",active:!1}]);return be(()=>{H.value.assignmentDays.forEach(s=>{const a=l.value.find(i=>i.day===s);a&&(a.active=!0)})}),(s,a)=>(r(),v(O,null,[n("div",l1,[n("div",n1,[(r(),v(O,null,G(t,i=>n("div",{key:i.key,class:"text-gray-600 overflow-hidden whitespace-nowrap text-ellipsis"},D(i.label),1)),64))]),a[0]||(a[0]=n("hr",null,null,-1)),(r(!0),v(O,null,G(l.value,(i,u)=>(r(),E(t1,{key:i.day,data:i,isLast:u===l.value.length-1},null,8,["data","isLast"]))),128))]),d(e(ge),{message:e(_e).assignmentDays,class:"mt-2"},null,8,["message"])],64))}}),s1={key:0,class:"flex items-center h-full justify-center"},o1={key:1,class:"sticky top-0 z-10 bg-white pb-6 px-10 py-8"},i1={class:"flex items-center justify-between w-full"},r1={class:"flex items-center gap-2"},u1={class:"flex items-center gap-4"},d1={class:"text-sm text-ink-gray-7"},c1={key:2,class:"overflow-y-auto px-10 pb-8"},p1={class:"grid grid-cols-2 gap-5"},m1={class:"flex flex-col gap-1.5"},f1=["onClick"],v1={class:"p-1 text-ink-gray-6 top-1 absolute w-full bg-white shadow-2xl rounded"},g1=["onClick"],y1={class:"flex flex-col gap-1"},h1={class:"text-lg font-semibold text-ink-gray-8"},_1={class:"flex items-center justify-between gap-6"},b1={class:"text-p-sm text-ink-gray-6"},k1={class:"font-medium underline",href:"https://docs.frappe.io/helpdesk/assignment-rule",target:"_blank"},x1={key:0},w1={class:"text-sm text-ink-gray-6 flex gap-1 cursor-default text-nowrap flex items-center"},C1={class:"text-sm text-ink-gray-6 p-2 bg-white rounded-md max-w-96 text-wrap whitespace-pre-wrap leading-5"},$1={class:"mt-5"},A1={key:0,class:"flex flex-col gap-3 items-center text-center text-ink-gray-7 text-sm mb-2 border border-gray-300 rounded-md p-3 py-4"},S1={class:"flex flex-col gap-1"},V1={class:"text-lg font-semibold text-ink-gray-8"},I1={class:"flex items-center justify-between gap-6"},E1={class:"text-p-sm text-ink-gray-6"},D1={class:"font-medium underline",href:"https://docs.frappe.io/helpdesk/assignment-rule",target:"_blank"},B1={key:0},L1={class:"text-sm text-ink-gray-6 flex gap-1 cursor-default text-nowrap flex items-center"},F1={class:"text-sm text-ink-gray-6 p-2 bg-white rounded-md max-w-96 text-wrap whitespace-pre-wrap leading-5"},T1={class:"mt-5"},M1={key:0,class:"flex flex-col gap-3 items-center text-center text-ink-gray-7 text-sm mb-2 border border-gray-300 rounded-md p-3 py-4"},O1={class:"flex flex-col gap-1"},R1={class:"text-lg font-semibold text-ink-gray-8"},q1={class:"text-p-sm text-ink-gray-6"},j1={class:"mt-6"},U1=j({__name:"AssignmentRuleView",setup(o){var I,L;const t=$(!1),l=$(null),s=$(!1),a=$({show:!1,title:"",message:"",onConfirm:()=>{}}),i=$(!0),u=$(!0),p=$(!1),m=$(!1),c=`${window.location.origin}/app/assignment-rule/${(I=Ee.value.data)==null?void 0:I.name}`,f=me({url:"frappe.client.get",params:{doctype:"Assignment Rule",name:(L=Ee.value.data)==null?void 0:L.name},auto:!!Ee.value.data,onSuccess(_){var U,P,T,Y;let x,V;try{x=JSON.parse(_.assign_condition_json||"[]")}catch{J.error("Assignment conditions are invalid or corrupt, recreate the conditions."),x=[]}try{V=JSON.parse(_.unassign_condition_json||"[]")}catch{J.error("Unassignment conditions are invalid or corrupt, recreate the conditions."),V=[]}H.value={loading:!1,assignCondition:_.assign_condition,unassignCondition:_.unassign_condition,assignConditionJson:x,unassignConditionJson:V,rule:_.rule,priority:_.priority,users:_.users,disabled:_.disabled,description:_.description,name:_.name,assignmentRuleName:_.name,assignmentDays:_.assignment_days.map(X=>X.day)},l.value=JSON.stringify(H.value);const w=((U=H.value.assignCondition)==null?void 0:U.length)>0,B=((P=H.value.assignConditionJson)==null?void 0:P.length)>0;w&&!B?(i.value=!1,p.value=!0):(i.value=!0,p.value=!1);const M=((T=H.value.unassignCondition)==null?void 0:T.length)>0,q=((Y=H.value.unassignConditionJson)==null?void 0:Y.length)>0;M&&!q?(u.value=!1,m.value=!0):(u.value=!0,m.value=!1)}});Ee.value.data||(Ae.value=!0);const k=()=>{const _={show:!0,title:"Unsaved changes",message:"Are you sure you want to go back? Unsaved changes will be lost.",onConfirm:k};if(t.value&&!a.value.show){a.value=_;return}if(!Ee.value.data&&!a.value.show){a.value=_;return}setTimeout(()=>{Ee.value={screen:"list",data:null}},250),a.value.show=!1},y=()=>{const _=ht(void 0,!i.value,!u.value);if(Object.values(_).some(x=>x)){J.error("Invalid fields, check if all are filled in and values are correct.");return}if(Ee.value.data){if(p.value&&i.value){h();return}if(m.value&&u.value){h();return}S()}else g()},h=()=>{a.value={show:!0,title:"Confirm overwrite",message:"Your old condition will be overwritten. Are you sure you want to save?",onConfirm:()=>{S(),a.value.show=!1}}},g=()=>{s.value=!0,me({url:"frappe.client.insert",params:{doc:{doctype:"Assignment Rule",document_type:"HD Ticket",rule:H.value.rule,priority:H.value.priority,users:H.value.users,disabled:H.value.disabled,description:H.value.description,assignment_days:H.value.assignmentDays.map(_=>({day:_})),name:H.value.assignmentRuleName,assignment_rule_name:H.value.assignmentRuleName,assign_condition:It({conditions:H.value.assignConditionJson}),unassign_condition:It({conditions:H.value.unassignConditionJson}),assign_condition_json:JSON.stringify(H.value.assignConditionJson),unassign_condition_json:JSON.stringify(H.value.unassignConditionJson)}},auto:!0,onSuccess(_){f.submit({doctype:"Assignment Rule",name:_.name}).then(()=>{s.value=!1,J.success("Assignment rule created")}),Ee.value={screen:"view",data:_}},onError:()=>{s.value=!1}})},b=[{label:"Low",value:"0"},{label:"Low-Medium",value:"1"},{label:"Medium",value:"2"},{label:"Medium-High",value:"3"},{label:"High",value:"4"}],S=async()=>{s.value=!0,await ot("frappe.client.set_value",{doctype:"Assignment Rule",document_type:"HD Ticket",name:H.value.name,fieldname:{rule:H.value.rule,priority:H.value.priority,users:H.value.users,disabled:H.value.disabled,description:H.value.description,assignment_days:H.value.assignmentDays.map(_=>({day:_})),assign_condition:i.value?It({conditions:H.value.assignConditionJson}):H.value.assignCondition,unassign_condition:u.value?It({conditions:H.value.unassignConditionJson}):H.value.unassignCondition,assign_condition_json:i.value?JSON.stringify(H.value.assignConditionJson):null,unassign_condition_json:u.value?JSON.stringify(H.value.unassignConditionJson):null}}).catch(_=>{var V;const x=((V=_==null?void 0:_.messages)==null?void 0:V[0])||"Some error occurred while updating assignment rule";J.error(x),s.value=!1}),H.value.name!==H.value.assignmentRuleName?(await ot("frappe.client.rename_doc",{doctype:"Assignment Rule",old_name:H.value.name,new_name:H.value.assignmentRuleName}).catch(async _=>{var V;const x=((V=_==null?void 0:_.messages)==null?void 0:V[0])||"Some error occurred while renaming assignment rule";J.error(x),await f.reload(),s.value=!1}),await f.submit({doctype:"Assignment Rule",name:H.value.assignmentRuleName})):f.reload(),s.value=!1,J.success("Assignment rule updated")};ve(H,_=>{l.value&&(t.value=JSON.stringify(_)!=l.value,t.value?Ae.value=!0:Ae.value=!1)},{deep:!0});const F=_=>{t.value&&(_.preventDefault(),_.returnValue=!0)};return be(()=>{addEventListener("beforeunload",F)}),nt(()=>{Ad(),Zn(),removeEventListener("beforeunload",F),Ae.value=!1}),(_,x)=>{const V=W("FeatherIcon");return r(),v(O,null,[e(f).loading?(r(),v("div",s1,[d(e(mt),{class:"w-4"})])):A("",!0),e(f).loading?A("",!0):(r(),v("div",o1,[n("div",i1,[n("div",r1,[d(e(Q),{variant:"ghost","icon-left":"chevron-left",label:e(H).assignmentRuleName||"New Assignment Rule",size:"md",onClick:x[0]||(x[0]=w=>k()),class:"cursor-pointer -ml-4 hover:bg-transparent focus:bg-transparent focus:outline-none focus:ring-0 focus:ring-offset-0 focus-visible:none active:bg-transparent active:outline-none active:ring-0 active:ring-offset-0 active:text-ink-gray-5 font-semibold text-xl hover:opacity-70 !pr-0 !max-w-96 !justify-start"},null,8,["label"]),t.value?(r(),E(e(Kt),{key:0,variant:"subtle",theme:"orange",size:"sm",label:_.__("Unsaved")},null,8,["label"])):A("",!0)]),n("div",u1,[n("div",{class:"flex items-center justify-between gap-2",onClick:x[1]||(x[1]=w=>e(H).disabled=!e(H).disabled)},[d(e(at),{size:"sm","model-value":!e(H).disabled},null,8,["model-value"]),n("span",d1,D(_.__("Enabled")),1)]),d(e(Q),{disabled:!!(!t.value&&e(Ee).data),label:_.__("Save"),theme:"gray",variant:"solid",onClick:x[2]||(x[2]=w=>y()),loading:s.value||e(f).loading},null,8,["disabled","label","loading"])])])])),e(f).loading?A("",!0):(r(),v("div",c1,[n("div",p1,[n("div",null,[d(e(pe),{type:"text",size:"sm",variant:"subtle",placeholder:"Name",label:"Name",modelValue:e(H).assignmentRuleName,"onUpdate:modelValue":x[3]||(x[3]=w=>e(H).assignmentRuleName=w),required:"",maxlength:"50",onChange:x[4]||(x[4]=w=>e(ht)("assignmentRuleName"))},null,8,["modelValue"]),d(e(ge),{message:e(_e).assignmentRuleName,class:"mt-2"},null,8,["message"])]),n("div",m1,[d(e(et),{label:"Priority"}),d(e(qe),null,{target:C(({togglePopover:w})=>{var B;return[n("div",{class:"flex items-center justify-between text-base rounded h-7 py-1.5 pl-2 pr-2 border border-[--surface-gray-2] bg-surface-gray-2 placeholder-ink-gray-4 hover:border-outline-gray-modals hover:bg-surface-gray-3 focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3 text-ink-gray-8 transition-colors w-full dark:[color-scheme:dark] cursor-default",onClick:M=>w()},[n("div",null,D((B=b.find(M=>M.value==e(H).priority))==null?void 0:B.label),1),d(V,{name:"chevron-down",class:"size-4"})],8,f1)]}),body:C(({togglePopover:w})=>[n("div",v1,[(r(),v(O,null,G(b,B=>n("div",{key:B.value,class:"p-2 cursor-pointer hover:bg-gray-50 text-base flex items-center justify-between rounded",onClick:M=>{e(H).priority=B.value,w()}},[te(D(B.label)+" ",1),e(H).priority==B.value?(r(),E(V,{key:0,name:"check",class:"size-4"})):A("",!0)],8,g1)),64))])]),_:1})]),n("div",null,[d(e(pe),{type:"textarea",size:"sm",variant:"subtle",placeholder:"Description",label:"Description",required:"",maxlength:"250",onChange:x[5]||(x[5]=w=>e(ht)("description")),modelValue:e(H).description,"onUpdate:modelValue":x[6]||(x[6]=w=>e(H).description=w)},null,8,["modelValue"]),d(e(ge),{message:e(_e).description,class:"mt-2"},null,8,["message"])])]),x[14]||(x[14]=n("hr",{class:"my-8"},null,-1)),n("div",null,[n("div",y1,[n("span",h1,D(_.__("Assignment condition")),1),n("div",_1,[n("span",b1,[te(D(_.__("Choose which tickets are affected by this assignment rule."))+" ",1),n("a",k1,D(_.__("Learn about conditions")),1)]),p.value&&e(Ee).data?(r(),v("div",x1,[d(e(qe),{trigger:"hover",hoverDelay:.25,placement:"top-end"},{target:C(()=>[n("div",w1,[n("span",null,D(_.__("Old Condition")),1),d(V,{name:"info",class:"size-4"})])]),"body-main":C(()=>[n("div",C1,[n("code",null,D(e(H).assignCondition),1)])]),_:1})])):A("",!0)])]),n("div",$1,[!i.value&&e(H).assignCondition?(r(),v("div",A1,[n("span",{class:"text-p-sm"},[x[10]||(x[10]=te(" Conditions for this rule were created from ",-1)),n("a",{href:c,target:"_blank",class:"underline"},"desk"),x[11]||(x[11]=te(" which are not compatible with this UI, you will need to recreate the conditions here if you want to manage and add new conditions from this UI. ",-1))]),d(e(Q),{label:"I understand, add conditions",variant:"subtle",theme:"gray",onClick:x[7]||(x[7]=w=>i.value=!0)})])):(r(),E(un,{key:1,conditions:e(H).assignConditionJson,name:"assignCondition",errors:e(_e).assignConditionError},null,8,["conditions","errors"])),d(e(ge),{message:e(_e).assignCondition,class:"mt-2"},null,8,["message"])])]),x[15]||(x[15]=n("hr",{class:"my-8"},null,-1)),n("div",null,[n("div",S1,[n("span",V1,D(_.__("Unassignment condition")),1),n("div",I1,[n("span",E1,[te(D(_.__("Choose which tickets are affected by this un-assignment rule."))+" ",1),n("a",D1,D(_.__("Learn about conditions")),1)]),m.value&&e(Ee).data&&e(H).unassignCondition?(r(),v("div",B1,[d(e(qe),{trigger:"hover",hoverDelay:.25,placement:"top-end"},{target:C(()=>[n("div",L1,[n("span",null,D(_.__("Old Condition")),1),d(V,{name:"info",class:"size-4"})])]),"body-main":C(()=>[n("div",F1,[n("code",null,D(e(H).unassignCondition),1)])]),_:1})])):A("",!0)])]),n("div",T1,[!u.value&&e(H).unassignCondition?(r(),v("div",M1,[n("span",{class:"text-p-sm"},[x[12]||(x[12]=te(" Conditions for this rule were created from ",-1)),n("a",{href:c,target:"_blank",class:"underline"},"desk"),x[13]||(x[13]=te(" which are not compatible with this UI, you will need to recreate the conditions here if you want to manage and add new conditions from this UI. ",-1))]),d(e(Q),{label:"I understand, add conditions",variant:"subtle",theme:"gray",onClick:x[8]||(x[8]=w=>u.value=!0)})])):(r(),E(un,{key:1,conditions:e(H).unassignConditionJson,name:"unassignCondition",errors:e(_e).unassignConditionError},null,8,["conditions","errors"]))])]),x[16]||(x[16]=n("hr",{class:"my-8"},null,-1)),n("div",null,[n("div",O1,[n("span",R1,D(_.__("Assignment Schedule")),1),n("span",q1,D(_.__("Choose the days of the week when this rule should be active.")),1)]),n("div",j1,[d(a1)])]),x[17]||(x[17]=n("hr",{class:"my-8"},null,-1)),d(Ky)])),d(bt,{modelValue:a.value.show,"onUpdate:modelValue":x[9]||(x[9]=w=>a.value.show=w),title:a.value.title,message:a.value.message,onConfirm:a.value.onConfirm,onCancel:()=>a.value.show=!1},null,8,["modelValue","title","message","onConfirm","onCancel"])],64)}}}),P1={class:"pb-8"},N1=j({__name:"AssignmentRules",setup(o){return(t,l)=>(r(),v("div",P1,[e(Ee).screen==="list"?(r(),E(Cy,{key:0})):A("",!0),e(Ee).screen==="view"?(r(),E(U1,{key:1})):A("",!0)]))}}),H1={class:"rounded bg-surface-gray-7 py-1.5 px-2 text-xs text-ink-white shadow-xl"},z1={class:"flex items-center gap-1"},_l=j({__name:"Password",props:{value:{type:String,default:""},modelValue:{type:String,default:""}},setup(o){const t=o,l=$(!1),s=N(()=>{let a=t.modelValue||t.value;return!(a!=null&&a.includes("*"))});return(a,i)=>(r(),E(e(pe),ye({type:l.value?"text":"password",value:o.modelValue||o.value},a.$attrs,{onKeydown:[i[1]||(i[1]=Ye(he(u=>l.value=!l.value,["meta","prevent"]),["i"])),i[2]||(i[2]=Ye(he(u=>l.value=!l.value,["ctrl","prevent"]),["i"]))]}),pn({suffix:C(()=>[d(e(Wt),null,{body:C(()=>[n("div",H1,[n("span",z1,D(l.value?"Hide Password":"Show Password"),1)])]),default:C(()=>[n("div",null,[Re((r(),E(Oe(l.value?e(ts):e(ls)),{class:"h-3 cursor-pointer mr-1",onClick:i[0]||(i[0]=u=>l.value=!l.value)},null,512)),[[lt,s.value]])])]),_:1})]),_:2},[a.$slots.prefix?{name:"prefix",fn:C(()=>[ae(a.$slots,"prefix")]),key:"0"}:void 0]),1040,["type","value"]))}}),bl=(o,t)=>JSON.stringify(o)!==JSON.stringify(t),Q1=(o,t,l)=>{t.default_medium==="Twilio"&&!o.enabled?l.value.default_medium="Enable Twilio to set it as default medium":l.value.default_medium="",o.enabled&&(o.account_sid?l.value.accountSid="":l.value.accountSid="Account SID is required",o.auth_token?l.value.authToken="":l.value.authToken="Auth Token is required",t.twilio_number?Vl(t.twilio_number)?l.value.number="":l.value.number="Please enter a valid phone number":l.value.number="Number is required")},J1=(o,t,l)=>{t.default_medium==="Exotel"&&!o.enabled?l.value.default_medium="Enable Exotel to set it as default medium":l.value.default_medium="",o.enabled&&(o.account_sid?l.value.accountSid="":l.value.accountSid="Account SID is required",o.webhook_verify_token?l.value.webhookVerifyToken="":l.value.webhookVerifyToken="Webhook Verify Token is required",o.subdomain?l.value.subdomain="":l.value.subdomain="Subdomain is required",o.api_key?l.value.apiKey="":l.value.apiKey="API Key is required",o.api_token?l.value.apiToken="":l.value.apiToken="API Token is required",t.exotel_number?Vl(t.exotel_number)?l.value.number="":l.value.number="Please enter a valid phone number":l.value.number="Number is required",t.mobile_no?Vl(t.mobile_no)?l.value.mobileNo="":l.value.mobileNo="Please enter a valid phone number":l.value.mobileNo="Personal number is required")},Vl=o=>/^\+?\d{8,15}$/.test(o),G1={class:"px-10 py-8"},K1={class:"flex items-center gap-2"},W1={class:"px-10 pb-8 overflow-y-auto"},Z1={class:"text-base font-semibold text-ink-gray-8"},Y1={class:"text-p-xs text-ink-gray-6 mt-1"},X1={class:"grid grid-cols-2 gap-4 mt-4"},eh={class:"flex flex-col gap-1.5"},th={key:0,class:"flex flex-col gap-1.5"},lh={key:1,class:"flex flex-col gap-1.5"},nh={key:2,class:"flex flex-col gap-1.5"},ah={key:0,class:"mt-6"},sh={class:"mt-4"},oh={class:"grid grid-cols-2 gap-4"},ih={key:0,class:"grid grid-cols-2 gap-4 mt-4"},rh={class:"flex flex-col gap-2"},uh={class:"flex flex-col gap-2"},dh={key:1,class:"mt-6"},ch={class:"mt-4"},ph={class:"grid grid-cols-2 gap-4"},mh={key:0,class:"grid grid-cols-2 gap-4 mt-4"},fh={class:"flex flex-col gap-2"},vh={class:"flex flex-col gap-2"},gh={class:"flex flex-col gap-2"},yh={class:"flex flex-col gap-2"},hh={class:"flex flex-col gap-2"},_h=j({__name:"Telephony",setup(o){const t=Ot(),l=jl(),s=$({twilio:!1,exotel:!1,telephonyAgent:!1}),a=$([]),i=$({accountSid:"",authToken:"",number:"",default_medium:""}),u=$({accountSid:"",webhookVerifyToken:"",subdomain:"",apiKey:"",apiToken:"",number:"",mobileNo:"",default_medium:""}),p=al({doctype:"TP Twilio Settings",name:"TP Twilio Settings",cache:["tp_twilio_settings"],fields:["*"],auto:!0}),m=al({doctype:"TP Exotel Settings",name:"TP Exotel Settings",cache:["tp_exotel_settings"],fields:["*"],auto:!0}),c=al({doctype:"TP Telephony Agent",name:t.user,cache:["tp_telephony_agent"],fields:["*"],auto:!1}),f=me({url:"telephony.twilio.api.fetch_applications",onSuccess(){p.reload()}}),k=[{label:"",value:""},{label:"Twilio",value:"Twilio"},{label:"Exotel",value:"Exotel"}];async function y(){if(Q1(p.doc,c.doc,i),J1(m.doc,c.doc,u),Object.values(i.value).some(S=>S)){J.error("Please fill all required fields for Twilio");return}if(Object.values(u.value).some(S=>S)){J.error("Please fill all required fields for Exotel");return}const g=[];s.value.twilio&&g.push(p.save.submit().catch(S=>{var I;const F=`Twilio error: ${(I=S==null?void 0:S.messages)==null?void 0:I[0]}`;J.error(F||"Failed to save Twilio settings")})),s.value.exotel&&g.push(m.save.submit().catch(S=>{var I;const F=`Exotel error: ${(I=S==null?void 0:S.messages)==null?void 0:I[0]}`;J.error(F||"Failed to save Exotel settings")})),s.value.telephonyAgent&&(c.doc.twilio_number?c.doc.twilio=!0:c.doc.twilio=!1,c.doc.exotel_number?c.doc.exotel=!0:c.doc.exotel=!1,g.push(c.save.submit())),(await Promise.all(g)).some(S=>S==null)||J.success("Telephony settings updated!"),await p.reload(),l.fetchCallIntegrationStatus()}function h(g){f.submit().then(()=>{g(),Me(()=>{g()})})}return me({url:"telephony.api.create_telephony_agent",auto:!0,onSuccess(){c.get.submit()}}),ve(()=>c.doc,g=>{s.value.telephonyAgent=bl(g,c.originalDoc)},{deep:!0}),ve(()=>p.doc,g=>{var b;s.value.twilio=bl(g,p.originalDoc),a.value=((b=g.twilio_apps)==null?void 0:b.split(",").map(S=>({label:S,value:S})))||[]},{deep:!0}),ve(()=>m.doc,g=>{s.value.exotel=bl(g,m.originalDoc)},{deep:!0}),(g,b)=>{var S,F,I,L,_,x,V;return r(),v(O,null,[n("div",G1,[d(We,{description:"Configure your telephony settings."},{title:C(()=>[n("div",K1,[b[23]||(b[23]=n("h1",{class:"text-lg font-semibold text-ink-gray-8"},"Telephony",-1)),d(e(Kt),{class:ee([s.value.twilio||s.value.exotel||s.value.telephonyAgent?"opacity-100":"opacity-0"]),label:"Unsaved",theme:"orange",variant:"subtle"},null,8,["class"])])]),actions:C(()=>[d(e(Q),{label:"Save",theme:"gray",variant:"solid",onClick:y,disabled:!s.value.twilio&&!s.value.exotel&&!s.value.telephonyAgent,loading:e(p).save.loading||e(m).save.loading||e(c).save.loading},null,8,["disabled","loading"])]),_:1})]),n("div",W1,[n("div",Z1,D(g.__("Agent settings")),1),n("div",Y1,D(g.__("Configure your agents telephony details.")),1),n("div",X1,[n("div",eh,[d(e(et),{label:"Default medium"}),e(c).doc?(r(),E(e(Xt),{key:0,options:k,modelValue:(S=e(c).doc)==null?void 0:S.default_medium,"onUpdate:modelValue":b[0]||(b[0]=w=>e(c).doc.default_medium=w)},null,8,["modelValue"])):A("",!0),d(e(ge),{message:i.value.default_medium||u.value.default_medium},null,8,["message"])]),e(c).doc&&((F=e(p).doc)!=null&&F.enabled)?(r(),v("div",th,[d(e(pe),{label:"Twilio number",type:"text",required:"",modelValue:e(c).doc.twilio_number,"onUpdate:modelValue":b[1]||(b[1]=w=>e(c).doc.twilio_number=w)},null,8,["modelValue"]),d(e(ge),{message:i.value.number},null,8,["message"])])):A("",!0),e(c).doc&&((I=e(m).doc)!=null&&I.enabled)?(r(),v("div",lh,[d(e(pe),{label:"Exotel number",type:"text",required:"",modelValue:e(c).doc.exotel_number,"onUpdate:modelValue":b[2]||(b[2]=w=>e(c).doc.exotel_number=w)},null,8,["modelValue"]),d(e(ge),{message:u.value.number},null,8,["message"])])):A("",!0),e(c).doc&&((L=e(m).doc)!=null&&L.enabled)?(r(),v("div",nh,[d(e(pe),{label:"Personal mobile no",type:"text",required:"",modelValue:e(c).doc.mobile_no,"onUpdate:modelValue":b[3]||(b[3]=w=>e(c).doc.mobile_no=w),description:g.__("Required for exotel integration")},null,8,["modelValue","description"]),d(e(ge),{message:u.value.mobileNo},null,8,["message"])])):A("",!0)]),(_=e(p))!=null&&_.doc?(r(),v("div",ah,[b[24]||(b[24]=n("div",{class:"text-base font-semibold text-ink-gray-8"},"Twilio",-1)),n("div",sh,[n("div",oh,[d(e(Pe),{label:"Enabled",modelValue:e(p).doc.enabled,"onUpdate:modelValue":[b[4]||(b[4]=w=>e(p).doc.enabled=w),b[5]||(b[5]=w=>e(p).doc.enabled=w?1:0)]},null,8,["modelValue"]),e(p).doc.enabled?(r(),E(e(Pe),{key:0,label:"Record Calls",modelValue:e(p).doc.record_calls,"onUpdate:modelValue":[b[6]||(b[6]=w=>e(p).doc.record_calls=w),b[7]||(b[7]=w=>e(p).doc.record_calls=w?1:0)]},null,8,["modelValue"])):A("",!0)]),e(p).doc.enabled?(r(),v("div",ih,[n("div",rh,[d(e(pe),{label:"Account SID",required:"",modelValue:e(p).doc.account_sid,"onUpdate:modelValue":b[8]||(b[8]=w=>e(p).doc.account_sid=w),placeholder:"Account SID"},null,8,["modelValue"]),d(e(ge),{message:i.value.accountSid},null,8,["message"])]),n("div",uh,[d(_l,{label:"Auth Token",required:"",modelValue:e(p).doc.auth_token,"onUpdate:modelValue":b[9]||(b[9]=w=>e(p).doc.auth_token=w),placeholder:"Auth Token"},null,8,["modelValue"]),d(e(ge),{message:i.value.authToken},null,8,["message"])]),e(p).doc.api_key?(r(),E(e(pe),{key:0,label:"API Key",modelValue:e(p).doc.api_key,"onUpdate:modelValue":b[10]||(b[10]=w=>e(p).doc.api_key=w),disabled:""},null,8,["modelValue"])):A("",!0),e(p).doc.api_secret?(r(),E(_l,{key:1,label:"API Secret",modelValue:e(p).doc.api_secret,"onUpdate:modelValue":b[11]||(b[11]=w=>e(p).doc.api_secret=w),disabled:""},null,8,["modelValue"])):A("",!0),(x=e(p).originalDoc)!=null&&x.account_sid&&a.value.length>0?(r(),E(e(vn),{key:2,label:"TwiML App Name","model-value":e(p).doc.app_name,"onUpdate:modelValue":b[12]||(b[12]=w=>e(p).doc.app_name=w.value),options:a.value},{footer:C(({togglePopover:w})=>[d(e(Q),{label:"Refresh Apps",theme:"gray",variant:"subtle",class:"w-full","icon-left":"refresh-cw",onClick:B=>h(w),loading:e(f).loading},null,8,["onClick","loading"])]),_:1},8,["model-value","options"])):A("",!0),e(p).doc.twiml_sid?(r(),E(e(pe),{key:3,label:"TwiML App SID",modelValue:e(p).doc.twiml_sid,"onUpdate:modelValue":b[13]||(b[13]=w=>e(p).doc.twiml_sid=w),disabled:""},null,8,["modelValue"])):A("",!0)])):A("",!0)])])):A("",!0),(V=e(m))!=null&&V.doc?(r(),v("div",dh,[b[25]||(b[25]=n("div",{class:"text-base font-semibold text-ink-gray-8"},"Exotel",-1)),n("div",ch,[n("div",ph,[d(e(Pe),{label:"Enabled",modelValue:e(m).doc.enabled,"onUpdate:modelValue":[b[14]||(b[14]=w=>e(m).doc.enabled=w),b[15]||(b[15]=w=>e(m).doc.enabled=w?1:0)]},null,8,["modelValue"]),e(m).doc.enabled?(r(),E(e(Pe),{key:0,label:"Record Calls",modelValue:e(m).doc.record_call,"onUpdate:modelValue":[b[16]||(b[16]=w=>e(m).doc.record_call=w),b[17]||(b[17]=w=>e(m).doc.record_call=w?1:0)]},null,8,["modelValue"])):A("",!0)]),e(m).doc.enabled?(r(),v("div",mh,[n("div",fh,[d(e(pe),{label:"Account SID",required:"",modelValue:e(m).doc.account_sid,"onUpdate:modelValue":b[18]||(b[18]=w=>e(m).doc.account_sid=w),placeholder:"Account SID"},null,8,["modelValue"]),d(e(ge),{message:u.value.accountSid},null,8,["message"])]),n("div",vh,[d(e(pe),{label:"Webhook Verify Token",required:"",modelValue:e(m).doc.webhook_verify_token,"onUpdate:modelValue":b[19]||(b[19]=w=>e(m).doc.webhook_verify_token=w),placeholder:"Webhook Verify Token"},null,8,["modelValue"]),d(e(ge),{message:u.value.webhookVerifyToken},null,8,["message"])]),n("div",gh,[d(e(pe),{label:"API Key",required:"",modelValue:e(m).doc.api_key,"onUpdate:modelValue":b[20]||(b[20]=w=>e(m).doc.api_key=w),placeholder:"API Key"},null,8,["modelValue"]),d(e(ge),{message:u.value.apiKey},null,8,["message"])]),n("div",yh,[d(_l,{label:"API Token",required:"",modelValue:e(m).doc.api_token,"onUpdate:modelValue":b[21]||(b[21]=w=>e(m).doc.api_token=w),placeholder:"API Token"},null,8,["modelValue"]),d(e(ge),{message:u.value.apiToken},null,8,["message"])]),n("div",hh,[d(e(pe),{label:"Subdomain",required:"",modelValue:e(m).doc.subdomain,"onUpdate:modelValue":b[22]||(b[22]=w=>e(m).doc.subdomain=w),placeholder:"Subdomain"},null,8,["modelValue"]),d(e(ge),{message:u.value.subdomain},null,8,["message"])])])):A("",!0)])])):A("",!0)])],64)}}}),bh={class:"pt-8 pb-2 bg-white sticky top-0 z-10"},kh={class:"mt-4 pb-8 isolate"},xh={class:"flex flex-col gap-1"},wh={class:"text-base font-medium text-ink-gray-7 relative z-10 pointer-events-none"},Ch={class:"text-sm text-ink-gray-5 truncate relative z-10 pointer-events-none"},$h=["onClick"],Ah={class:"sr-only"},Sh=j({__name:"NotificationList",props:{onSelect:{type:Function}},setup(o){const t=o,l=[{name:"share_feedback",label:Fe("Share Feedback"),description:Fe("Sent to the user who has raised the ticket after the ticket is closed or resolved")},{name:"acknowledgement",label:Fe("Acknowledgement"),description:Fe("Sent to the user right after creating an email ticket")},{name:"reply_to_agents",label:Fe("Reply From Contact"),description:Fe("Sent to all of the assigned agents after a reply from one of the contacts")},{name:"reply_via_agent",label:Fe("Reply From Agent"),description:Fe("Sent to all of the recipients associated with an agent's reply")}];return(s,a)=>{const i=W("FeatherIcon");return r(),v(O,null,[n("div",bh,[d(We,{title:e(Fe)("Email Notifications"),description:e(Fe)("Customize your email notification preferences to stay informed about important updates and activities.")},null,8,["title","description"])]),n("ul",kh,[(r(),v(O,null,G(l,u=>n("li",{key:u.name,class:"flex items-center justify-between p-3 rounded relative"},[n("div",xh,[n("h2",wh,D(u.label),1),n("p",Ch,D(u.description),1)]),d(i,{name:"chevron-right",class:"text-ink-gray-7 size-4 relative z-10 pointer-events-none"}),n("button",{type:"button",class:"w-full h-full absolute top-0 left-0 hover:bg-gray-50 rounded-[inherit]",onClick:()=>{t.onSelect(u)}},[n("span",Ah,D(e(Fe)("customize {0}",u.name)),1)],8,$h)])),64))])],64)}}}),Vh={class:"flex-grow flex flex-col isolate"},Ih={class:"sticky top-0 z-10 bg-white py-8"},Eh={class:"flex items-center"},Dh={class:"pl-5 pr-2 relative text-ink-gray-7 hover:opacity-70 min-h-8 flex items-center"},Bh={class:"sr-only"},Lh={class:"font-semibold text-xl"},Fh=["inert"],Th={class:"flex flex-col gap-2"},Mh={class:"flex gap-x-1 items-start justify-between"},Oh={class:"text-sm text-gray-700 leading-5"},Rh=["href"],gl=j({__name:"Notification",props:ze({title:{},description:{},documentationLink:{},defaultContent:{},onBack:{type:Function},onSubmit:{type:Function},onGetDataSuccess:{type:Function},submitting:{type:Boolean},name:{}},{content:{required:!0},contentModifiers:{},enabled:{type:Boolean,required:!0},enabledModifiers:{}}),emits:["update:content","update:enabled"],setup(o,{expose:t}){const l=o,s=De(o,"content"),a=De(o,"enabled"),i=$(!1),u=$(!1),p=$(!1),m=me({url:"helpdesk.api.settings.email_notifications.get_data",method:"GET",params:{notification:l.name},auto:!0,onSuccess:l.onGetDataSuccess});function c(){i.value=!0}function f(){i.value=!1}function k(){s.value=l.defaultContent,c()}function y(){s.value!==l.defaultContent&&(p.value=!0)}function h(){if(i.value){u.value=!0;return}Ae.value=!1,l.onBack()}return ve(()=>i.value,g=>{Ae.value=g}),t({setUnsavedChanges:c,resetUnsavedChanges:f}),(g,b)=>{const S=ns,F=W("Badge"),I=W("Button"),L=W("FormControl");return r(),v(O,null,[n("div",Vh,[n("div",Ih,[d(We,{description:l.description},{title:C(()=>[n("div",Eh,[n("div",Dh,[n("button",{type:"button",onClick:h,class:"absolute top-0 -left-[0.375rem] w-full h-full"},[n("span",Bh,D(g.__("back to email event list")),1),d(S,{class:"w-4.5 h-4.5"})]),n("h1",Lh,D(l.title),1)]),i.value?(r(),E(F,{key:0,variant:"subtle",theme:"orange",size:"sm",label:g.__("Unsaved")},null,8,["label"])):A("",!0)])]),actions:C(()=>[n("div",{inert:e(m).loading,class:ee(["flex items-center gap-x-4 pt-[0.125rem]",{invisible:e(m).loading}])},[d(e(at),{size:"sm",label:g.__("Enabled"),modelValue:a.value,"onUpdate:modelValue":[b[0]||(b[0]=_=>a.value=_),c],style:{background:"transparent",padding:"0px"},class:"flex-row-reverse gap-x-2 pl-0"},null,8,["label","modelValue"]),d(I,{type:"button",label:g.__("Save"),theme:"gray",variant:"solid",disabled:!i.value,loading:l.submitting,onClick:l.onSubmit},null,8,["label","disabled","loading","onClick"])],10,Fh)]),_:1},8,["description"])]),n("div",{class:ee(["flex flex-col gap-8 flex-grow pb-8",{"items-center justify-center":e(m).loading}])},[e(m).loading?(r(),E(e(mt),{key:1,class:"w-4"})):(r(),v(O,{key:0},[ae(g.$slots,"formFields"),n("div",Th,[d(L,{type:"textarea",size:"sm",label:g.__("Email Content"),required:!0,rows:10,modelValue:s.value,"onUpdate:modelValue":b[1]||(b[1]=_=>s.value=_),oninput:c},null,8,["label","modelValue"]),n("div",Mh,[n("p",Oh,[te(D(g.__("Find out all of the variables that can be used in the content"))+" ",1),n("a",{href:l.documentationLink,target:"_blank",class:"underline font-semibold"},D(g.__("here")),9,Rh)]),d(I,{disabled:s.value===g.defaultContent,type:"button",size:"sm",variant:"subtle",onClick:y,class:"w-fit"},{default:C(()=>[te(D(g.__("Reset Content")),1)]),_:1},8,["disabled"])])])],64))],2)]),d(bt,{modelValue:u.value,"onUpdate:modelValue":b[2]||(b[2]=_=>u.value=_),title:g.__("Unsaved changes"),message:g.__("Are you sure you want to go back? Unsaved changes will be lost."),onConfirm:()=>{Ae.value=!1,l.onBack()}},null,8,["modelValue","title","message","onConfirm"]),d(bt,{modelValue:p.value,"onUpdate:modelValue":b[3]||(b[3]=_=>p.value=_),title:g.__("Reset content"),message:g.__("Are you sure you want to reset the content? Current content will be overridden."),onConfirm:()=>{k(),p.value=!1}},null,8,["modelValue","title","message","onConfirm"])],64)}}}),qh=j({__name:"Acknowledgement",props:{onBack:{type:Function},notification:{}},setup(o){const t=o,l=$(""),s=$(""),a=$(!1),i=$(),u=me({url:"helpdesk.api.settings.email_notifications.update_acknowledgement",method:"PUT",auto:!1,onSuccess(c){a.value=c.enabled,l.value=c.content,i.value.resetUnsavedChanges()}});function p(){return u.submit({enabled:a.value,content:l.value})}function m(c){a.value=c.enabled,l.value=c.content,s.value=c.default_content}return(c,f)=>(r(),E(gl,{content:l.value,"onUpdate:content":f[0]||(f[0]=k=>l.value=k),defaultContent:s.value,enabled:a.value,"onUpdate:enabled":f[1]||(f[1]=k=>a.value=k),documentationLink:"https://docs.frappe.io/helpdesk/email-notifications#available-variables-acknowledgement",ref_key:"compRef",ref:i,name:"acknowledgement",title:t.notification.label,description:t.notification.description,submitting:e(u).loading,onBack:t.onBack,onSubmit:p,onGetDataSuccess:m},null,8,["content","defaultContent","enabled","title","description","submitting","onBack"]))}}),jh=j({__name:"ReplyViaAgent",props:{onBack:{type:Function},notification:{}},setup(o){const t=o,l=$(""),s=$(""),a=$(!1),i=$(),u=me({url:"helpdesk.api.settings.email_notifications.update_reply_via_agent",method:"PUT",auto:!1,onSuccess(c){a.value=c.enabled,l.value=c.content,i.value.resetUnsavedChanges()}});function p(){return u.submit({enabled:a.value,content:l.value})}function m(c){a.value=c.enabled,l.value=c.content,s.value=c.default_content}return(c,f)=>(r(),E(gl,{content:l.value,"onUpdate:content":f[0]||(f[0]=k=>l.value=k),defaultContent:s.value,enabled:a.value,"onUpdate:enabled":f[1]||(f[1]=k=>a.value=k),documentationLink:"https://docs.frappe.io/helpdesk/email-notifications#available-variables-reply-from-agent",ref_key:"compRef",ref:i,name:"reply_via_agent",title:t.notification.label,description:t.notification.description,submitting:e(u).loading,onBack:t.onBack,onSubmit:p,onGetDataSuccess:m},null,8,["content","defaultContent","enabled","title","description","submitting","onBack"]))}}),Uh=j({__name:"ShareFeedback",props:{onBack:{type:Function},notification:{}},setup(o){const t=o,l=$(""),s=$(""),a=$(!1),i=$(),{statuses:u}=Sn(),p=N(()=>u.data.filter(y=>y.category==="Resolved").map(y=>({label:Fe(y.label_agent),value:y.label_agent}))),m=$(null),c=me({url:"helpdesk.api.settings.email_notifications.update_share_feedback",method:"PUT",auto:!1,onSuccess(y){i.value.resetUnsavedChanges()}});function f(){return c.submit({ticket_status:m.value,enabled:a.value,content:l.value})}function k(y){m.value={label:Fe(y.ticket_status.label),value:y.ticket_status.value},a.value=y.enabled,l.value=y.content,s.value=y.default_content}return(y,h)=>{const g=W("FormControl");return r(),E(gl,{ref_key:"compRef",ref:i,name:"share_feedback",title:t.notification.label,description:t.notification.description,content:l.value,"onUpdate:content":h[1]||(h[1]=b=>l.value=b),defaultContent:s.value,enabled:a.value,"onUpdate:enabled":h[2]||(h[2]=b=>a.value=b),documentationLink:"https://docs.frappe.io/helpdesk/email-notifications#available-variables-share-feedback",onBack:t.onBack,onSubmit:f,onGetDataSuccess:k,submitting:e(c).loading},{formFields:C(()=>[d(g,{type:"autocomplete",size:"sm",label:e(Fe)("On Ticket Status"),options:p.value,required:!0,"model-value":m.value,"onUpdate:modelValue":h[0]||(h[0]=b=>{m.value=b,i.value.setUnsavedChanges()})},null,8,["label","options","model-value"])]),_:1},8,["title","description","content","defaultContent","enabled","onBack","submitting"])}}}),Ph=j({__name:"ReplyToAgents",props:{onBack:{type:Function},notification:{}},setup(o){const t=o,l=$(""),s=$(""),a=$(!1),i=$(),u=me({url:"helpdesk.api.settings.email_notifications.update_reply_to_agents",method:"PUT",auto:!1,onSuccess(c){a.value=c.enabled,l.value=c.content,i.value.resetUnsavedChanges()}});function p(){return u.submit({enabled:a.value,content:l.value})}function m(c){a.value=c.enabled,l.value=c.content,s.value=c.default_content}return(c,f)=>(r(),E(gl,{content:l.value,"onUpdate:content":f[0]||(f[0]=k=>l.value=k),defaultContent:s.value,enabled:a.value,"onUpdate:enabled":f[1]||(f[1]=k=>a.value=k),documentationLink:"https://docs.frappe.io/helpdesk/email-notifications#available-variables-reply-from-contact",ref_key:"compRef",ref:i,name:"reply_to_agents",title:t.notification.label,description:t.notification.description,submitting:e(u).loading,onBack:t.onBack,onSubmit:p,onGetDataSuccess:m},null,8,["content","defaultContent","enabled","title","description","submitting","onBack"]))}}),Nh={class:"px-10 h-full overflow-y-auto flex flex-col isolate"},Hh=j({__name:"EmailNotifications",setup(o){const t=$(null),l={share_feedback:Z(Uh),acknowledgement:Z(qh),reply_to_agents:Z(Ph),reply_via_agent:Z(jh)};function s(){t.value=null}function a(i){t.value=i}return(i,u)=>(r(),v("div",Nh,[t.value===null?(r(),E(Sh,{key:0,onSelect:a})):(r(),E(Oe(l[t.value.name]),{key:1,onBack:s,notification:t.value},null,40,["notification"]))]))}}),cl=[{label:Fe("Settings"),hideLabel:!0,items:[{label:"Email Accounts",icon:Z(Vn),component:Z(yd)},{label:"Email Notifications",icon:Z(sa),component:Z(Hh)},{label:"Branding",icon:Z(Ng),component:Z(Du)},{label:"Agents",icon:Z(Ss),component:Z($u)},{label:"Invite Agents",icon:Z(oa),component:Z(jg)},{label:"Teams",icon:Z(Vs),component:Z(Gd)},{label:"SLA Policies",icon:Z(Wg),component:Z(gm)},{label:"Business Holidays",icon:Z(Xg),component:Z(ev)},{label:"Assignment Rules",icon:Z(de(Kn,{class:"rotate-90"})),component:Z(N1)},{label:"Field Dependencies",icon:Z(fr),component:Z(Lg)}]},{label:Fe("Integrations"),items:[{label:"Telephony",icon:Z(Ts),component:Z(_h)}]}],Vt=$(cl[0].items[0]),Nt=$(null),Ae=$(!1),_t=o=>{Vt.value=o&&cl.map(t=>t.items).flat().find(t=>t.label==o)||cl[0].items[0]},zh={class:"flex",style:{height:"calc(100vh - 8rem)"}},Qh={class:"flex w-52 shrink-0 flex-col bg-gray-50 p-2"},Jh={key:0,class:"mb-2 mt-3 flex gap-1.5 px-1 text-base font-medium text-ink-gray-5"},Gh={class:"space-y-1"},Kh=["onClick"],Wh={class:"text-base text-gray-800"},Zh={class:"flex flex-1 flex-col bg-surface-modal"},Yh=j({__name:"SettingsModal",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o){const t=De(o,"modelValue"),l=$(!1);function s(a){if(!Ae.value){Vt.value=a;return}Nt.value=a,l.value=!0}return(a,i)=>(r(),v(O,null,[d(e(je),{modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=u=>t.value=u),options:{size:"5xl"},disableOutsideClickToClose:e(Ae)},{body:C(()=>[n("div",zh,[n("div",Qh,[i[2]||(i[2]=n("h1",{class:"px-2 pt-2 text-lg font-semibold mb-3"},"Settings",-1)),(r(!0),v(O,null,G(e(cl),u=>(r(),v("div",null,[u.hideLabel?A("",!0):(r(),v("div",Jh,[n("span",null,D(a.__(u.label)),1)])),n("nav",Gh,[(r(!0),v(O,null,G(u.items,p=>{var m;return r(),v("button",{key:p.label,class:ee(["flex h-7 w-full items-center gap-2 rounded px-2 py-1",[((m=e(Vt))==null?void 0:m.label)==p.label?"bg-white shadow-sm":"hover:bg-gray-100"]]),onClick:()=>s(p)},[(r(),E(Oe(p.icon),{class:"h-4 w-4 text-gray-700"})),n("span",Wh,D(p.label),1)],10,Kh)}),128))])]))),256))]),n("div",Zh,[e(Vt)?(r(),E(Oe(e(Vt).component),{key:0,class:"h-full flex flex-col w-full"})):A("",!0)])])]),_:1},8,["modelValue","disableOutsideClickToClose"]),d(bt,{modelValue:l.value,"onUpdate:modelValue":i[1]||(i[1]=u=>l.value=u),title:a.__("Unsaved changes"),message:a.__("Are you sure you want to change tabs? Unsaved changes will be lost."),onConfirm:()=>{e(Nt)!==null&&(Vt.value=e(Nt)),Nt.value=null,l.value=!1,Ae.value=!1},onCancel:()=>{Nt.value=null}},null,8,["modelValue","title","message","onConfirm","onCancel"])],64))}}),ia=$("https://frappecloud.com"),ra=$(""),Xh=me({url:"frappe.integrations.frappe_providers.frappecloud_billing.current_site_info",cache:"currentSiteInfo",onSuccess:o=>{ia.value=o.base_url,ra.value=o.site_name}}),e_=()=>{Xh.fetch();const{$dialog:o}=us();o({title:"Login to Frappe Cloud?",message:"Are you sure you want to login to your Frappe Cloud dashboard?",actions:[{label:"Confirm",variant:"solid",onClick(t){t_(),t()}}]})},t_=()=>{window.open(`${ia.value}/dashboard/sites/${ra.value}`,"_blank")},l_={class:"lucide lucide-arrow-left-from-line",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function n_(o,t){return r(),v("svg",l_,[...t[0]||(t[0]=[n("path",{d:"m9 6-6 6 6 6"},null,-1),n("path",{d:"M3 12h14"},null,-1),n("path",{d:"M21 19V5"},null,-1)])])}const a_=Z({name:"lucide-arrow-left-from-line",render:n_}),s_={class:"lucide lucide-arrow-right-from-line",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function o_(o,t){return r(),v("svg",s_,[...t[0]||(t[0]=[n("path",{d:"M3 5v14"},null,-1),n("path",{d:"M21 12H7"},null,-1),n("path",{d:"m15 18 6-6-6-6"},null,-1)])])}const i_=Z({name:"lucide-arrow-right-from-line",render:o_}),r_={class:"lucide lucide-globe",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function u_(o,t){return r(),v("svg",r_,[...t[0]||(t[0]=[n("circle",{cx:"12",cy:"12",r:"10"},null,-1),n("path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"},null,-1),n("path",{d:"M2 12h20"},null,-1)])])}const d_=Z({name:"lucide-globe",render:u_}),c_={class:"lucide lucide-message-circle",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function p_(o,t){return r(),v("svg",c_,[...t[0]||(t[0]=[n("path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z"},null,-1)])])}const m_=Z({name:"lucide-message-circle",render:p_}),f_={class:"lucide lucide-timer",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function v_(o,t){return r(),v("svg",f_,[...t[0]||(t[0]=[n("line",{x1:"10",x2:"14",y1:"2",y2:"2"},null,-1),n("line",{x1:"12",x2:"15",y1:"14",y2:"11"},null,-1),n("circle",{cx:"12",cy:"14",r:"8"},null,-1)])])}const g_=Z({name:"lucide-timer",render:v_}),y_={class:"lucide lucide-user-pen",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function h_(o,t){return r(),v("svg",y_,[...t[0]||(t[0]=[n("path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2"},null,-1),n("path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z"},null,-1),n("circle",{cx:"10",cy:"7",r:"4"},null,-1)])])}const __=Z({name:"lucide-user-pen",render:h_}),b_={class:"lucide lucide-keyboard",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function k_(o,t){return r(),v("svg",b_,[...t[0]||(t[0]=[Zt('<path d="M10 8h.01"></path><path d="M12 12h.01"></path><path d="M14 8h.01"></path><path d="M16 12h.01"></path><path d="M18 8h.01"></path><path d="M6 8h.01"></path><path d="M7 16h10"></path><path d="M8 12h.01"></path><rect width="20" height="16" x="2" y="4" rx="2"></rect>',9)])])}const x_=Z({name:"lucide-keyboard",render:k_}),w_={class:"flex items-center gap-0.5 font-medium text-gray-600"},C_={key:2,class:"mb-4"},$_={key:0,class:"absolute size-1.5 translate-x-6 translate-y-1 rounded-full bg-blue-400 left-1",theme:"gray",variant:"solid"},A_={class:"overflow-y-auto overflow-x-hidden"},S_={key:0,class:"mx-2 my-2 h-1 border-b"},V_=["onClick"],I_={class:"flex flex-col"},E_={class:"flex flex-col gap-2"},D_=j({__name:"Sidebar",setup(o){const{isMobileView:t}=as(),l=ss(),s=Dl(),a=Ot(),i=xn(),{isExpanded:u,width:p}=Jl(wn()),m=Rl(),c=jl(),{isCallingEnabled:f}=Jl(c),k=$(!1),y=$(!1),h=$(!1),{pinnedViews:g,publicViews:b}=ds(),S=$(window.is_fc_site),F=N(()=>{var Ze,gt;let ce=Le.value?vs:gs;f.value||(ce=ce.filter(fe=>fe.label!=="Call Logs"));const le=[{label:"All Views",hideLabel:!0,opened:!0,views:ce}];return(Ze=b.value)!=null&&Ze.length&&!Le.value&&le.push({label:"Public Views",opened:!0,hideLabel:!1,views:I(b.value)}),(gt=g.value)!=null&&gt.length&&le.push({label:"Private Views",opened:!0,hideLabel:!1,views:I(g.value)}),le});function I(ce){return ce.map(le=>({label:le.label,icon:le.icon,to:{name:le.route_name,query:{view:le.name}},onClick:()=>{cs.value={label:le.label,icon:le.icon}}}))}const L=N(()=>[{label:"Log out",icon:"log-out",onClick:()=>a.logout()}]),_=N(()=>[{component:Z(ys)},{label:"Customer portal",icon:"users",onClick:()=>{const ce=s.resolve({name:"TicketsCustomer"});window.open(ce.href)}},{icon:"life-buoy",label:"Support",onClick:()=>window.open("https://t.me/frappedesk")},{icon:"book-open",label:"Docs",onClick:()=>window.open("https://docs.frappe.io/helpdesk")},{label:"Login to Frappe Cloud",icon:hr,onClick:()=>e_(),condition:()=>!t.value&&window.is_fc_site},{label:"Shortcuts",icon:de(x_),onClick:()=>y.value=!0},{label:"Settings",icon:"settings",onClick:()=>k.value=!0,condition:()=>a.isAdmin||a.isManager},{group:"Danger",hideLabel:!0,items:[{label:"Log out",icon:"log-out",onClick:()=>a.logout()}]}]),x=N(()=>Le.value?L.value:_.value);function V(ce){var le;return l.query.view?l.query.view==((le=ce==null?void 0:ce.query)==null?void 0:le.view):l.name===ce}function w(){h.value=!0}const B=de(hs,{class:"h-12 w-12"},null),M=N(()=>!Le.value&&!Y.value&&a.isManager),q=[{name:"setup_email_account",title:"Connect your support email",completed:!1,icon:Z(Vn),onClick:()=>{Ie.value=!0,k.value=!0,_t("Email Accounts")}},{name:"invite_agents",title:"Invite agents",completed:!1,icon:Z(oa),onClick:()=>{Ie.value=!0,k.value=!0,_t("Invite Agents")}},{name:"setup_sla",title:"Setup SLA",completed:!1,icon:Z(g_),onClick:()=>{_t("SLA Policies"),k.value=!0,Ie.value=!0}},{name:"create_first_ticket",title:"Create a ticket",completed:!1,icon:Z(wl),onClick:()=>{s.push({name:"TicketAgentNew"}),Ie.value=!0}},{name:"assign_to_agent",title:"Assign a ticket to an agent",completed:!1,icon:Z(__),onClick:async()=>{await oe(),ps.value=!0,Ie.value=!0}},{name:"reply_on_ticket",title:"Reply on a ticket",completed:!1,icon:Z(sa),onClick:async()=>{await oe(),Gl.value=!0,Kl.value=!1,Ie.value=!0}},{name:"comment_on_ticket",title:"Add a comment on a ticket",completed:!1,icon:Z(m_),onClick:async()=>{await oe(),Kl.value=!0,Gl.value=!1,Ie.value=!0}},{name:"first_article",title:"Create an article",completed:!1,icon:Z(ms),onClick:async()=>{const ce=await Ve();s.push({name:"NewArticle",query:{title:"General"},params:{id:ce}}),Ie.value=!0}},{name:"add_invite_contact",title:"Create & invite a contact",completed:!1,icon:Z(xr),onClick:()=>{Ie.value=!0,T.value={title:"Create & invite a contact",buttonLabel:"Create",videoURL:"/assets/helpdesk/desk/videos/createInviteContact.mp4",onClick:async()=>{P.value=!1,s.push({name:"ContactList"}),Ms.value=!0}},P.value=!0}},{name:"explore_customer_portal",title:"Explore customer portal",completed:!1,icon:Z(d_),onClick:()=>{window.open("/helpdesk/my-tickets","_blank"),rt("explore_customer_portal"),Ie.value=!0}}],U=$([{title:"Introduction",opened:!1,subArticles:[{name:"introduction",title:"Introduction"},{name:"setting-up",title:"Setting up"}]},{title:"Getting Started",opened:!1,subArticles:[{name:"lesson-1-your-first-ticket",title:"Creating a ticket"},{name:"lesson-2understanding-ticket-view",title:"Understanding ticket view"},{name:"lesson-3-agents-teams",title:"Agents & Teams"},{name:"customers-contacts",title:"Customers & Contacts"},{name:"lesson-4-knowledge-base",title:"Knowledge Base"},{name:"customer-portal",title:"Customer Portal"}]},{title:"Masters",opened:!1,subArticles:[{name:"ticket",title:"Ticket"},{name:"agent",title:"Agent"},{name:"team",title:"Team"},{name:"contact",title:"Contact"},{name:"customer",title:"Customer"},{name:"knowledge-base",title:"Knowledge Base"},{name:"canned-response",title:"Canned Responses"},{name:"service-level-agreement",title:"Service Level Agreement"},{name:"ticket-type",title:"Ticket Type"},{name:"ticket-priority",title:"Ticket Priority"}]},{title:"Customizations",opened:!1,subArticles:[{name:"custom-actions",title:"Custom Actions"},{name:"field-dependency",title:"Field Dependency"},{name:"custom-views",title:"Custom Views"},{name:"settings",title:"Settings"}]},{title:"Frappe Helpdesk Mobile",opened:!1,subArticles:[{name:"pwa-installation",title:"Mobile App Installation"}]}]),P=$(!1),T=$({}),{isOnboardingStepsCompleted:Y,setUp:X,updateOnboardingStep:rt}=ft("helpdesk");async function oe(){const ce=await Se();ce?s.push({name:"TicketAgent",params:{ticketId:ce}}):s.push({name:"TicketAgentNew"})}async function Se(){let ce=localStorage.getItem("firstTicket");return ce||await ot("helpdesk.api.onboarding.get_first_ticket")}async function Ve(){let ce=localStorage.getItem("generalCategoryId");if(!ce){if(ce=await ot("helpdesk.api.onboarding.get_general_category_id"),!ce)return;localStorage.setItem("generalCategoryId",ce)}return ce}function xt(){a.isManager&&(X(q),ul({key:"h",meta:!0},()=>{tt.value=!tt.value}))}return be(()=>{xt(),!Le.value&&ul({key:",",meta:!0},()=>{k.value=!k.value})}),(ce,le)=>{const Ze=W("Badge"),gt=W("FeatherIcon");return r(),v("div",{class:"flex select-none flex-col border-r border-gray-200 bg-gray-50 p-2 text-base duration-300 ease-in-out",style:Mt({"min-width":e(p),"max-width":e(p)})},[d(_s,{class:"mb-2",options:x.value},null,8,["options"]),e(Le)?A("",!0):(r(),E(e(wt),{key:0,label:"Search",class:"my-0.5",icon:e(Rt),"on-click":()=>w(),"is-expanded":e(u)},{right:C(()=>[n("span",w_,[(r(),E(Oe(e(m).modifierIcon),{class:"h-3 w-3"})),le[7]||(le[7]=n("span",null,"K",-1))])]),_:1},8,["icon","on-click","is-expanded"])),e(Le)?A("",!0):(r(),E(e(wt),{key:1,class:"relative my-0.5 min-h-7",label:"Dashboard",icon:e(bs),to:"Dashboard","is-active":V("Dashboard"),"is-expanded":e(u)},null,8,["icon","is-active","is-expanded"])),e(Le)?A("",!0):(r(),v("div",C_,[e(i).unread?(r(),v("div",$_)):A("",!0),d(e(wt),{class:"relative my-0.5",label:"Notifications",icon:e(bn),"on-click":()=>e(i).toggle(),"is-expanded":e(u)},{right:C(()=>[e(u)&&e(i).unread?(r(),E(Ze,{key:0,label:e(i).unread>9?"9+":e(i).unread,theme:"gray",variant:"subtle"},null,8,["label"])):A("",!0)]),_:1},8,["icon","on-click","is-expanded"])])),n("div",A_,[(r(!0),v(O,null,G(F.value,fe=>{var jt;return r(),v("div",{key:fe.label},[!fe.hideLabel&&!e(u)&&((jt=fe.views)!=null&&jt.length)?(r(),v("div",S_)):A("",!0),d(e(Cs),{label:fe.label,hideLabel:fe.hideLabel,opened:fe.opened},{header:C(({opened:K,hide:ne,toggle:se})=>[ne?A("",!0):(r(),v("div",{key:0,class:ee(["flex cursor-pointer gap-1.5 px-1 text-base font-medium text-ink-gray-5 transition-all duration-300 ease-in-out",e(u)?"mt-4 h-7 w-auto opacity-100":"ml-0 h-0 overflow-hidden opacity-0"]),onClick:ke=>se()},[d(gt,{name:"chevron-right",class:ee(["h-4 text-ink-gray-9 transition-all duration-300 ease-in-out",{"rotate-90":K}])},null,8,["class"]),n("span",null,D(fe.label),1)],10,V_))]),default:C(()=>[n("nav",I_,[(r(!0),v(O,null,G(fe.views,K=>(r(),E(e(wt),{icon:K.icon,label:K.label,to:K.to,key:K.label,"is-expanded":e(u),"is-active":V(K.to),class:"my-0.5 emoji",onClick:K.onClick},null,8,["icon","label","to","is-expanded","is-active","onClick"]))),128))])]),_:2},1032,["label","hideLabel","opened"])])}),128))]),le[8]||(le[8]=n("div",{class:"grow"},null,-1)),n("div",E_,[S.value&&!e(Le)?(r(),E(e(an),{key:0,isSidebarCollapsed:!e(u)},null,8,["isSidebarCollapsed"])):A("",!0),M.value?(r(),E(e(Ji),{key:1,isSidebarCollapsed:!e(u),appName:"helpdesk"},null,8,["isSidebarCollapsed"])):A("",!0),e(Y)&&!e(Le)?(r(),E(e(wt),{key:2,icon:Dn,label:"Help","is-expanded":e(u),onClick:le[0]||(le[0]=()=>{tt.value=e(Ie)?!0:!e(tt),Ie.value=!e(tt)})},null,8,["is-expanded"])):A("",!0),d(e(wt),{icon:e(u)?e(a_):e(i_),"is-active":!1,"is-expanded":e(u),label:e(u)?"Collapse":"Expand","on-click":()=>u.value=!e(u)},null,8,["icon","is-expanded","label","on-click"])]),S.value&&!e(Le)?(r(),E(e(an),{key:3,isSidebarCollapsed:!e(u)},null,8,["isSidebarCollapsed"])):A("",!0),d(Yh,{modelValue:k.value,"onUpdate:modelValue":le[1]||(le[1]=fe=>k.value=fe)},null,8,["modelValue"]),d(Kr,{modelValue:y.value,"onUpdate:modelValue":le[2]||(le[2]=fe=>y.value=fe)},null,8,["modelValue"]),e(tt)?(r(),E(e(qi),{key:4,modelValue:e(tt),"onUpdate:modelValue":le[3]||(le[3]=fe=>ut(tt)?tt.value=fe:null),articles:U.value,"onUpdate:articles":le[4]||(le[4]=fe=>U.value=fe),appName:"helpdesk",title:"Frappe Helpdesk",logo:e(B),docsLink:"https://docs.frappe.io/helpdesk",afterSkip:fe=>e(tl)("onboarding_step_skipped_"+fe),afterSkipAll:()=>e(tl)("onboarding_steps_skipped"),afterReset:fe=>e(tl)("onboarding_step_reset_"+fe),afterResetAll:()=>e(tl)("onboarding_steps_reset")},null,8,["modelValue","articles","logo","afterSkip","afterSkipAll","afterReset","afterResetAll"])):A("",!0),d(e(Yi),{modelValue:P.value,"onUpdate:modelValue":le[5]||(le[5]=fe=>P.value=fe),currentStep:T.value},null,8,["modelValue","currentStep"]),d(Bn,{modelValue:h.value,"onUpdate:modelValue":le[6]||(le[6]=fe=>h.value=fe)},null,8,["modelValue"])],4)}}}),B_={class:"flex h-screen w-screen"},L_={class:"flex-1 flex flex-col h-full overflow-auto"},cb={__name:"DesktopLayout",setup(o){return(t,l)=>(r(),v("div",B_,[d(D_),n("div",L_,[d(Nr),ae(t.$slots,"default")]),d(e(Mr)),d(e(Bn))]))}};export{cb as default};
//# sourceMappingURL=DesktopLayout-849da792.js.map
