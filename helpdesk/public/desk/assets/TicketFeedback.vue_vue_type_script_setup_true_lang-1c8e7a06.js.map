{"version":3,"file":"TicketFeedback.vue_vue_type_script_setup_true_lang-1c8e7a06.js","sources":["../../../../desk/src/pages/ticket/TicketFeedback.vue"],"sourcesContent":["<template>\n  <Dialog\n    :model-value=\"open\"\n    :options=\"{\n      title: __('Rate this ticket'),\n      actions: [\n        {\n          disabled: !preset,\n          label: __('Submit'),\n          theme: 'gray',\n          variant: 'solid',\n          onClick: () =>\n            setValue.submit({\n              fieldname: {\n                status: 'Closed',\n                feedback: preset,\n                feedback_extra: text,\n              },\n            }),\n        },\n      ],\n    }\"\n    @update:model-value=\"() => $emit('update:open', !open)\"\n  >\n    <template #body-content>\n      <div class=\"space-y-4 text-base text-gray-700\">\n        <div class=\"space-y-2\">\n          <span> {{ __(\"Select a rating\") }} </span>\n          <span class=\"text-red-500\"> * </span>\n          <StarRating\n            :static=\"false\"\n            :rating=\"rating\"\n            v-model=\"rating\"\n            @update:model-value=\"rating = $event\"\n          />\n        </div>\n        <div v-if=\"options.data?.length\" class=\"space-y-2\">\n          <span> {{ __(\"Pick an option\") }} </span>\n          <span class=\"text-red-500\"> * </span>\n          <div class=\"flex flex-wrap gap-2\">\n            <Button\n              v-for=\"o in options.data\"\n              :key=\"o.name\"\n              :label=\"o.label\"\n              :theme=\"preset === o.name ? 'blue' : 'gray'\"\n              variant=\"subtle\"\n              @click=\"preset = o.name\"\n            />\n          </div>\n        </div>\n        <div class=\"space-y-2\">\n          <span> {{ __(\"Other\") }} </span>\n          <FormControl\n            v-model=\"text\"\n            type=\"textarea\"\n            :placeholder=\"__('Tell us more')\"\n          />\n        </div>\n      </div>\n    </template>\n  </Dialog>\n</template>\n\n<script setup lang=\"ts\">\nimport { StarRating } from \"@/components\";\nimport { createListResource, createResource } from \"frappe-ui\";\nimport { inject, ref, watch } from \"vue\";\nimport { ITicket } from \"./symbols\";\nimport { __ } from \"@/translation\";\n\ninterface P {\n  open: boolean;\n}\n\ninterface E {\n  (event: \"update:open\", open: boolean): void;\n}\n\ndefineProps<P>();\nconst emit = defineEmits<E>();\nconst ticket = inject(ITicket);\nconst rating = ref(0);\nconst text = ref(\"\");\nconst preset = ref(null);\nconst options = createListResource({\n  doctype: \"HD Ticket Feedback Option\",\n  fields: [\"name\", \"label\"],\n  pageLength: 99999,\n});\nconst setValue = createResource({\n  url: \"frappe.client.set_value\",\n  debounce: 300,\n  makeParams: (params) => {\n    return {\n      doctype: \"HD Ticket\",\n      name: ticket.data.name,\n      fieldname: params.fieldname,\n      value: params.value,\n    };\n  },\n  onSuccess: () => {\n    emit(\"update:open\", false);\n    ticket.reload();\n  },\n});\nwatch(rating, (r) => {\n  preset.value = null;\n  text.value = \"\";\n  options.update({\n    filters: {\n      rating: r,\n      disabled: 0,\n    },\n  });\n  options.reload();\n});\n</script>\n"],"names":["emit","__emit","ticket","inject","ITicket","rating","ref","text","preset","options","createListResource","setValue","createResource","params","watch","r","_createBlock","_component_Dialog","__props","_unref","__","_cache","$emit","_createElementVNode","_hoisted_1","_hoisted_2","_createVNode","StarRating","$event","_openBlock","_createElementBlock","_hoisted_3","_hoisted_4","_Fragment","_renderList","o","_component_Button","_hoisted_5","_component_FormControl"],"mappings":"6qBA+EA,MAAMA,EAAOC,EACPC,EAASC,EAAOC,CAAO,EACvBC,EAASC,EAAI,CAAC,EACdC,EAAOD,EAAI,EAAE,EACbE,EAASF,EAAI,IAAI,EACjBG,EAAUC,EAAmB,CACjC,QAAS,4BACT,OAAQ,CAAC,OAAQ,OAAO,EACxB,WAAY,KAAA,CACb,EACKC,EAAWC,EAAe,CAC9B,IAAK,0BACL,SAAU,IACV,WAAaC,IACJ,CACL,QAAS,YACT,KAAMX,EAAO,KAAK,KAClB,UAAWW,EAAO,UAClB,MAAOA,EAAO,KAAA,GAGlB,UAAW,IAAM,CACfb,EAAK,cAAe,EAAK,EACzBE,EAAO,OAAO,CAChB,CAAA,CACD,EACK,OAAAY,EAAAT,EAASU,GAAM,CACnBP,EAAO,MAAQ,KACfD,EAAK,MAAQ,GACbE,EAAQ,OAAO,CACb,QAAS,CACP,OAAQM,EACR,SAAU,CACZ,CAAA,CACD,EACDN,EAAQ,OAAO,CAAA,CAChB,0EAlHCO,EA2DSC,EAAA,CA1DN,cAAaC,EAAI,KACjB,QAAO,OAAiBC,EAAEC,CAAA,EAAA,kBAAA,sBAAsEZ,EAAM,YAAmBW,EAAEC,CAAA,EAAA,QAAA,2CAAsGD,EAAAR,CAAA,EAAS,OAAM,qCAA0FH,EAAM,qBAAkCD,EAAI,YAmBtX,sBAAkBc,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,IAAQC,EAAK,MAAA,cAAA,CAAiBJ,EAAI,IAAA,EAAA,GAE1C,iBACT,IAiCM,OAAA,OAjCNK,EAiCM,MAjCNC,EAiCM,CAhCJD,EASM,MATNE,EASM,CARJF,EAA0C,cAAhCJ,EAAEC,CAAA,EAAA,iBAAA,CAAA,EAAA,CAAA,EACZC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAE,EAAqC,OAA/B,CAAA,MAAM,gBAAe,MAAG,EAAA,GAC9BG,EAKEP,EAAAQ,CAAA,EAAA,CAJC,OAAQ,GACR,OAAQtB,EAAM,iBACNA,EAAM,4CAANA,EAAM,MAAAuB,GACMP,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAO,GAAAvB,EAAA,MAASuB,wCAGvBT,EAAAA,EAAOV,CAAA,EAAC,OAARU,MAAAA,EAAc,QAAzBU,IAAAC,EAaM,MAbNC,EAaM,CAZJR,EAAyC,cAA/BJ,EAAEC,CAAA,EAAA,gBAAA,CAAA,EAAA,CAAA,EACZC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAE,EAAqC,OAA/B,CAAA,MAAM,gBAAe,MAAG,EAAA,GAC9BA,EASM,MATNS,EASM,EARJH,EAAA,EAAA,EAAAC,EAOEG,EANY,KAAAC,EAAAf,EAAAV,CAAA,EAAQ,KAAb0B,QADTnB,EAOEoB,EAAA,CALC,IAAKD,EAAE,KACP,MAAOA,EAAE,MACT,MAAO3B,EAAA,QAAW2B,EAAE,KAAI,OAAA,OACzB,QAAQ,SACP,QAAOP,GAAApB,EAAA,MAAS2B,EAAE,IAAA,4DAIzBZ,EAOM,MAPNc,EAOM,CANJd,EAAgC,cAAtBJ,EAAEC,CAAA,EAAA,OAAA,CAAA,EAAA,CAAA,EACZM,EAIEY,EAAA,YAHS/B,EAAI,2CAAJA,EAAI,MAAAqB,GACb,KAAK,WACJ,YAAaT,EAAEC,CAAA,EAAA,cAAA"}