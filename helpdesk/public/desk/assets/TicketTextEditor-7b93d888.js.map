{"version":3,"file":"TicketTextEditor-7b93d888.js","sources":["../../../../desk/src/components/TextEditor.vue","../../../../desk/src/pages/ticket/TicketTextEditor.vue"],"sourcesContent":["<template>\n  <div class=\"rounded p-3 shadow w-full\">\n    <FTextEditor\n      ref=\"e\"\n      :extensions=\"[PreserveVideoControls]\"\n      v-bind=\"$attrs\"\n      :editor-class=\"[\n        'prose-f max-h-64 max-w-none  overflow-auto my-4 min-h-[5rem]',\n        getFontFamily(modelValue),\n      ]\"\n      bubble-menu\n      :content=\"modelValue\"\n      @change=\"$emit('update:modelValue', $event)\"\n    >\n      <template #top>\n        <span class=\"text-base\">\n          <span class=\"flex items-center justify-between\">\n            <UserAvatar\n              :name=\"authStore.userName\"\n              :image=\"authStore.userImage\"\n              expand\n              strong\n            />\n            <slot name=\"top-right\" />\n          </span>\n          <slot name=\"top-bottom\" />\n        </span>\n      </template>\n      <template #bottom>\n        <div class=\"flex flex-col gap-2\">\n          <slot name=\"bottom-top\" />\n          <div\n            class=\"flex flex-col space-y-1.5 overflow-auto sm:flex-row sm:justify-between\"\n          >\n            <div class=\"flex items-center\">\n              <TextEditorFixedMenu :buttons=\"fixedMenu\" />\n              <slot name=\"bottom-left\" />\n            </div>\n            <div class=\"flex items-center gap-2\">\n              <Button\n                label=\"Discard\"\n                theme=\"gray\"\n                variant=\"subtle\"\n                @click=\"\n                  () => {\n                    editor.commands.clearContent(true);\n                    $emit('clear');\n                  }\n                \"\n              />\n              <slot name=\"bottom-right\" />\n            </div>\n          </div>\n        </div>\n      </template>\n    </FTextEditor>\n  </div>\n</template>\n<script setup lang=\"ts\">\nimport { UserAvatar } from \"@/components\";\nimport { useAuthStore } from \"@/stores/auth\";\nimport { PreserveVideoControls } from \"@/tiptap-extensions\";\nimport { getFontFamily } from \"@/utils\";\nimport { TextEditor as FTextEditor, TextEditorFixedMenu } from \"frappe-ui\";\nimport { computed, nextTick, ref } from \"vue\";\n\ninterface P {\n  modelValue: string;\n  autofocus?: boolean;\n}\n\ninterface E {\n  (event: \"clear\"): void;\n  (event: \"update:modelValue\", any): string;\n}\n\nconst props = withDefaults(defineProps<P>(), {\n  autofocus: false,\n});\n\ndefineEmits<E>();\n\nconst e = ref(null);\nconst editor = computed(() => e.value.editor);\nconst authStore = useAuthStore();\nconst fixedMenu = [\n  \"Paragraph\",\n  [\"Heading 2\", \"Heading 3\", \"Heading 4\", \"Heading 5\"],\n  \"Bullet List\",\n  \"Numbered List\",\n  \"Image\",\n  \"Video\",\n  \"Link\",\n  \"Blockquote\",\n  \"Code\",\n];\n\ndefineExpose({\n  editor,\n});\n\nif (props.autofocus) {\n  nextTick(() => e.value.editor.commands.focus());\n}\n</script>\n","<template>\n  <HTextEditor\n    v-if=\"expand\"\n    ref=\"e\"\n    :model-value=\"content\"\n    :placeholder=\"placeholder\"\n    @update:model-value=\"$emit('update:content', $event)\"\n    @clear=\"() => $emit('update:attachments', [])\"\n  >\n    <template #bottom-top>\n      <div class=\"flex flex-wrap gap-2\">\n        <AttachmentItem\n          v-for=\"a in attachments\"\n          :key=\"a.file_url\"\n          :label=\"a.file_name\"\n          :url=\"!['MOV', 'MP4'].includes(a.file_type) ? a.file_url : null\"\n        >\n          <template #suffix>\n            <LucideX\n              class=\"size-4\"\n              @click.stop=\"\n                () => {\n                  $emit(\n                    'update:attachments',\n                    attachments.filter((b) => b.file_url !== a.file_url)\n                  );\n                  removeAttachmentFromServer(a.name);\n                }\n              \"\n            />\n          </template>\n        </AttachmentItem>\n      </div>\n    </template>\n    <template #bottom-left>\n      <span class=\"flex\">\n        <slot name=\"bottom-left\" />\n        <FileUploader\n          :upload-args=\"{\n            folder: 'Home/Helpdesk',\n            private: true,\n          }\"\n          @success=\"\n            (f: File) => $emit('update:attachments', [...attachments, f])\n          \"\n          @failure=\"() => toast.error('Error uploading file')\"\n        >\n          <template #default=\"{ openFileSelector }\">\n            <Button theme=\"gray\" variant=\"ghost\" @click=\"openFileSelector()\">\n              <template #icon>\n                <LucidePaperclip class=\"size-4\" />\n              </template>\n            </Button>\n          </template>\n        </FileUploader>\n      </span>\n    </template>\n    <template #top-right>\n      <slot name=\"top-right\" />\n    </template>\n    <template #top-bottom>\n      <slot name=\"top-bottom\" />\n    </template>\n    <template #bottom-right>\n      <slot name=\"bottom-right\" />\n    </template>\n  </HTextEditor>\n  <div\n    v-else\n    class=\"flex w-full cursor-pointer items-center gap-2 rounded bg-gray-100 px-3.5 py-2 hover:bg-gray-200\"\n    @click=\"() => $emit('update:expand', !expand)\"\n  >\n    <UserAvatar\n      :name=\"authStore.userName\"\n      :image=\"authStore.userImage\"\n      size=\"sm\"\n    />\n    <span class=\"text-base text-gray-700\">\n      {{ placeholder }}\n    </span>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  AttachmentItem,\n  TextEditor as HTextEditor,\n  UserAvatar,\n} from \"@/components\";\nimport { useAuthStore } from \"@/stores/auth\";\nimport { File } from \"@/types\";\nimport { removeAttachmentFromServer } from \"@/utils\";\nimport { FileUploader, toast } from \"frappe-ui\";\nimport { computed, ref } from \"vue\";\n\ninterface P {\n  content: string;\n  placeholder: string;\n  attachments: File[];\n  expand?: boolean;\n}\n\ninterface E {\n  (event: \"update:content\", content: string): void;\n  (event: \"update:attachments\", attachments: File[]): void;\n  (event: \"update:expand\", expand: boolean): void;\n}\n\nwithDefaults(defineProps<P>(), {\n  expand: false,\n});\ndefineEmits<E>();\nconst e = ref(null);\nconst editor = computed(() => e.value.editor);\nconst authStore = useAuthStore();\ndefineExpose({\n  editor,\n});\n</script>\n"],"names":["props","__props","e","ref","editor","computed","authStore","useAuthStore","fixedMenu","__expose","nextTick","_openBlock","_createElementBlock","_hoisted_1","_createVNode","_unref","_mergeProps","PreserveVideoControls","$attrs","getFontFamily","_cache","$event","$emit","_createElementVNode","_hoisted_2","_hoisted_3","UserAvatar","_renderSlot","_ctx","_hoisted_4","_hoisted_5","_hoisted_6","TextEditorFixedMenu","_hoisted_7","_component_Button","_createBlock","HTextEditor","_Fragment","_renderList","a","AttachmentItem","_component_LucideX","_withModifiers","b","removeAttachmentFromServer","FileUploader","f","toast","_withCtx","openFileSelector","_component_LucidePaperclip","_toDisplayString"],"mappings":"8uCA4EA,MAAMA,EAAQC,EAMRC,EAAIC,EAAI,IAAI,EACZC,EAASC,EAAS,IAAMH,EAAE,MAAM,MAAM,EACtCI,EAAYC,IACZC,EAAY,CAChB,YACA,CAAC,YAAa,YAAa,YAAa,WAAW,EACnD,cACA,gBACA,QACA,QACA,OACA,aACA,MAAA,EAGW,OAAAC,EAAA,CACX,OAAAL,CAAA,CACD,EAEGJ,EAAM,WACRU,EAAS,IAAMR,EAAE,MAAM,OAAO,SAAS,OAAO,8BArG9C,OAAAS,EAAA,EAAAC,EAuDM,MAvDNC,EAuDM,CAtDJC,EAqDcC,KArDdC,EAqDc,SApDR,IAAJ,IAAId,EACH,YAAaa,EAAqBE,CAAA,CAAA,CAAA,EAC3BC,EAAM,OAAA,CACb,eAAY,gEAAoFH,EAAAI,CAAA,EAAclB,EAAU,UAAA,GAIzH,cAAA,GACC,QAASA,EAAU,WACnB,SAAMmB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAEC,EAAK,MAAA,oBAAsBD,CAAM,EAAA,IAE/B,MACT,IAWO,CAXPE,EAWO,OAXPC,EAWO,CAVLD,EAQO,OARPE,EAQO,CAPLX,EAKEC,EAAAW,CAAA,EAAA,CAJC,KAAMX,EAAST,CAAA,EAAC,SAChB,MAAOS,EAAST,CAAA,EAAC,UAClB,OAAA,GACA,OAAA,6BAEFqB,EAAyBC,EAAA,OAAA,WAAA,CAAA,GAE3BD,EAA0BC,EAAA,OAAA,YAAA,CAAA,KAGnB,SACT,IAwBM,CAxBNL,EAwBM,MAxBNM,EAwBM,CAvBJF,EAA0BC,EAAA,OAAA,YAAA,EAC1BL,EAqBM,MArBNO,EAqBM,CAlBJP,EAGM,MAHNQ,EAGM,CAFJjB,EAA4CC,EAAAiB,CAAA,EAAA,CAAtB,QAASxB,EAAS,EACxCmB,EAA2BC,EAAA,OAAA,aAAA,CAAA,GAE7BL,EAaM,MAbNU,EAaM,CAZJnB,EAUEoB,EAAA,CATA,MAAM,UACN,MAAM,OACN,QAAQ,SACP,QAAKd,EAAA,CAAA,IAAAA,EAAA,CAAA,OAAuDhB,EAAA,MAAC,SAAS,aAAY,EAAA,EAA4BkB,EAAK,MAAA,OAAA,CAAA,KAOtHK,EAA4BC,EAAA,OAAA,cAAA,CAAA,izBC8DpC,MAAA1B,EAAIC,EAAI,IAAI,EACZC,EAASC,EAAS,IAAMH,EAAE,MAAM,MAAM,EACtCI,EAAYC,IACL,OAAAE,EAAA,CACX,OAAAL,CAAA,CACD,6CAnHSH,EAAM,YADdkC,EAiEcpB,EAAAqB,CAAA,EAAA,eA/DR,IAAJ,IAAIlC,EACH,cAAaD,EAAO,QACpB,YAAaA,EAAW,YACxB,sBAAkBmB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAEC,EAAK,MAAA,iBAAmBD,CAAM,GAClD,wBAAaC,EAAK,MAAA,qBAAA,CAAA,CAAA,EAAA,GAER,eACT,IAsBM,CAtBNC,EAsBM,MAtBNV,EAsBM,QArBJD,EAoBiByB,EAAA,KAAAC,EAnBHrC,EAAW,YAAhBsC,QADTJ,EAoBiBpB,EAAAyB,CAAA,EAAA,CAlBd,IAAKD,EAAE,SACP,MAAOA,EAAE,UACT,IAAG,CAAA,MAAA,KAAA,EAAkB,SAASA,EAAE,SAAS,EAAc,KAAVA,EAAE,QAAQ,GAE7C,SACT,IAWE,CAXFzB,EAWE2B,EAAA,CAVA,MAAM,SACL,QAAKC,OAAuDd,EAAA,2BAAgE3B,EAAW,YAAC,OAAQ0C,GAAMA,EAAE,WAAaJ,EAAE,QAAQ,CAAA,EAAmExB,EAAA6B,CAAA,EAACL,EAAE,IAAI,2EAczP,gBACT,IAoBO,CApBPhB,EAoBO,OApBPC,GAoBO,CAnBLG,EAA2BC,EAAA,OAAA,aAAA,EAC3Bd,EAiBeC,EAAA8B,CAAA,EAAA,CAhBZ,cAAa,kCAGb,EACA,UAAOzB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAgB0B,GAAYxB,EAAAA,MAAgC,qBAAA,CAAA,GAAArB,EAAA,YAAa6C,CAAC,CAAA,GAGjF,UAAO1B,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,IAAQL,EAAKgC,CAAA,EAAC,MAAK,sBAAA,EAAA,GAEhB,QAAOC,EAChB,CAIS,CALW,iBAAAC,KAAgB,CACpCnC,EAISoB,EAAA,CAJD,MAAM,OAAO,QAAQ,QAAS,WAAOe,EAAgB,CAAA,GAChD,OACT,IAAkC,CAAlCnC,EAAkCoC,EAAA,CAAjB,MAAM,SAAQ,CAAA,mCAOhC,cACT,IAAyB,CAAzBvB,EAAyBC,EAAA,OAAA,WAAA,CAAA,GAEhB,eACT,IAA0B,CAA1BD,EAA0BC,EAAA,OAAA,YAAA,CAAA,GAEjB,iBACT,IAA4B,CAA5BD,EAA4BC,EAAA,OAAA,cAAA,CAAA,6CAGhC,EAAAhB,EAaM,MAAA,OAXJ,MAAM,kGACL,QAAKQ,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,IAAQE,EAAK,MAAA,gBAAA,CAAmBrB,EAAM,MAAA,EAAA,GAE5Ca,EAIEC,EAAAW,CAAA,EAAA,CAHC,KAAMX,EAAST,CAAA,EAAC,SAChB,MAAOS,EAAST,CAAA,EAAC,UAClB,KAAK,+BAEPiB,EAEO,OAFPE,GAEO0B,EADFlD,EAAW,WAAA,EAAA,CAAA"}