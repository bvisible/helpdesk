{"version":3,"file":"SearchAgent-c9eed405.js","sources":["../../../../desk/src/components/SearchMultiSelect.vue","../../../../desk/src/pages/SearchAgent.vue"],"sourcesContent":["<template>\n  <div class=\"relative inline-block text-left\">\n    <div class=\"flex\">\n      <Button\n        variant=\"outline\"\n        :class=\"{ 'ring-2 ring-outline-gray-2': isOpen }\"\n        @click=\"toggleDropdown\"\n      >\n        <div\n          class=\"flex items-center min-h-[20px]\"\n          :class=\"{ 'gap-2': hasSelectedImages && selectedCount > 0 }\"\n        >\n          <template v-if=\"selectedCount > 0\">\n            <!-- Stacked Avatars -->\n            <div class=\"flex -space-x-2 isolate\">\n              <div\n                v-for=\"(option, index) in selectedOptions.slice(0, 3)\"\n                :key=\"`avatar-${option.value}`\"\n                class=\"relative flex\"\n                :style=\"{ zIndex: 10 - index }\"\n              >\n                <Avatar\n                  v-if=\"option.image\"\n                  :image=\"option.image\"\n                  :label=\"option.label\"\n                  class=\"border-2 border-white flex-shrink-0\"\n                  size=\"sm\"\n                />\n              </div>\n            </div>\n            <!-- Count Text -->\n            <span class=\"text-ink-gray-7\">\n              {{\n                selectedCount === 1\n                  ? selectedOptions[0]?.label\n                  : `${selectedCount} ${selectionText}`\n              }}\n            </span>\n          </template>\n          <span v-else class=\"text-ink-gray-6\">{{ placeholder }}</span>\n        </div>\n        <template #suffix>\n          <LucideChevronDown\n            class=\"ml-2 h-4 w-4 transition-transform duration-200\"\n            :class=\"{ 'rotate-180': isOpen }\"\n          />\n        </template>\n      </Button>\n    </div>\n\n    <div\n      v-if=\"isOpen\"\n      class=\"absolute z-50 mt-2 w-64 divide-y divide-outline-gray-modals rounded-lg bg-surface-modal shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none left-0 origin-top-left\"\n    >\n      <!-- Header -->\n      <div class=\"py-1.5 px-1.5\">\n        <div\n          class=\"flex h-7 items-center text-sm font-medium text-ink-gray-6 justify-between\"\n        >\n          <input\n            ref=\"inputRef\"\n            v-model=\"filterText\"\n            :placeholder=\"label\"\n            class=\"px-2 flex-1 bg-transparent border-none outline-none text-sm focus:border-none focus:ring-0 text-ink-gray-6 placeholder-ink-gray-4\"\n            @click.stop\n            @keydown=\"handleInputKeydown\"\n          />\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            v-if=\"selectedCount > 0\"\n            @click=\"clearAll\"\n          >\n            <template #icon>\n              <LucideX class=\"size-4\" />\n            </template>\n          </Button>\n        </div>\n      </div>\n\n      <!-- Options List -->\n      <div class=\"px-1.5 pb-1.5 max-h-64 overflow-y-auto\">\n        <!-- Individual Options (ungrouped) -->\n        <div class=\"pt-1.5\" v-if=\"filteredIndividualOptions.length > 0\">\n          <button\n            v-for=\"option in filteredIndividualOptions\"\n            :key=\"`individual-${option.value}`\"\n            class=\"group flex h-7 w-full items-center rounded px-2 text-base hover:bg-surface-gray-3 text-ink-gray-6\"\n            :class=\"{ 'bg-surface-gray-2': isHighlighted(option) }\"\n            @click=\"toggleOption(option)\"\n          >\n            <Checkbox\n              :modelValue=\"props.modelValue.includes(option.value)\"\n              class=\"mr-2 flex-shrink-0\"\n            />\n\n            <component v-if=\"option.icon\" :is=\"renderIcon(option.icon)\" />\n\n            <Avatar\n              v-else-if=\"hasAnyVisualElements\"\n              :image=\"option.image\"\n              :label=\"option.label\"\n              class=\"mr-2 flex-shrink-0\"\n              size=\"sm\"\n            />\n\n            <span class=\"text-ink-gray-7 flex-1 text-left truncate\">\n              {{ option.label }}\n            </span>\n\n            <span\n              v-if=\"(option.count ?? 0) > 0\"\n              class=\"text-xs text-ink-gray-5 ml-auto\"\n            >\n              {{ option.count }}\n            </span>\n          </button>\n        </div>\n\n        <!-- Grouped Options -->\n        <div v-for=\"group in filteredGroups\" :key=\"`group-${group.group}`\">\n          <!-- Group Header -->\n          <div\n            class=\"flex h-7 pt-1.5 sticky top-0 bg-surface-white items-center px-2 text-sm font-medium text-ink-gray-6\"\n          >\n            {{ group.group }}\n          </div>\n\n          <!-- Group Options -->\n          <button\n            v-for=\"option in group.items\"\n            :key=\"`grouped-${option.value}`\"\n            class=\"group flex h-7 w-full items-center rounded px-2 text-base hover:bg-surface-gray-3 text-ink-gray-6\"\n            :class=\"{ 'bg-surface-gray-2': isHighlighted(option) }\"\n            @click=\"toggleOption(option)\"\n          >\n            <Checkbox\n              :modelValue=\"props.modelValue.includes(option.value)\"\n              class=\"mr-2 flex-shrink-0\"\n            />\n\n            <component v-if=\"option.icon\" :is=\"renderIcon(option.icon)\" />\n\n            <Avatar\n              v-else-if=\"option.image\"\n              :image=\"option.image\"\n              :label=\"option.label\"\n              class=\"mr-2 flex-shrink-0\"\n              size=\"sm\"\n            />\n\n            <!-- Spacer for alignment when other options have visual elements -->\n            <div\n              v-else-if=\"hasAnyVisualElements\"\n              class=\"mr-2 w-6 h-6 flex-shrink-0\"\n            ></div>\n\n            <span class=\"text-ink-gray-7 flex-1 text-left truncate\">\n              {{ option.label }}\n            </span>\n\n            <span\n              v-if=\"(option.count ?? 0) > 0\"\n              class=\"text-xs text-ink-gray-5 ml-auto\"\n            >\n              {{ option.count }}\n            </span>\n          </button>\n        </div>\n\n        <!-- No options message -->\n        <div\n          v-if=\"filteredOptions.length === 0\"\n          class=\"px-2 py-4 text-center text-sm text-ink-gray-5\"\n        >\n          No options found\n        </div>\n      </div>\n    </div>\n\n    <!-- Overlay to close dropdown -->\n    <div v-if=\"isOpen\" class=\"fixed inset-0 z-40\" @click=\"closeDropdown\"></div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Avatar, Button, Checkbox } from \"frappe-ui\";\nimport {\n  computed,\n  h,\n  nextTick,\n  ref,\n  useTemplateRef,\n  watch,\n  type Component,\n} from \"vue\";\nimport LucideChevronDown from \"~icons/lucide/chevron-down\";\nimport LucideX from \"~icons/lucide/x\";\n\n// Type Definitions\ninterface MultiSelectOption {\n  value: string;\n  label: string;\n  count?: number;\n  image?: string;\n  icon?: string | Component;\n}\n\ninterface MultiSelectGroup {\n  group: string;\n  items: MultiSelectOption[];\n}\n\n// Support both flat options and grouped options in the same prop\ntype MultiSelectData = MultiSelectOption[] | MultiSelectGroup[];\n\ninterface Props {\n  options: MultiSelectData;\n  modelValue: string[];\n  placeholder?: string;\n  label?: string;\n  selectionText?: string;\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  placeholder: \"Select options...\",\n  label: \"Options\",\n  selectionText: \"items\",\n  options: () => [],\n});\n\nconst emit = defineEmits<{\n  \"update:modelValue\": [value: string[]];\n}>();\n\n// Reactive State\nconst isOpen = ref(false);\nconst filterText = ref(\"\");\nconst highlightedIndex = ref(0);\nconst inputRef = useTemplateRef<HTMLInputElement>(\"inputRef\");\n\n// Core Computed Properties\nconst selectedCount = computed(() => props.modelValue.length);\n\n// Detect if the options are grouped or flat\nconst isGrouped = computed(() => {\n  return (\n    props.options.length > 0 &&\n    \"group\" in props.options[0] &&\n    \"items\" in props.options[0]\n  );\n});\n\n// Extract individual options and groups from the unified options prop\nconst individualOptions = computed(() => {\n  if (isGrouped.value) return [];\n  return props.options as MultiSelectOption[];\n});\n\nconst groups = computed(() => {\n  if (!isGrouped.value) return [];\n  return props.options as MultiSelectGroup[];\n});\n\n// Flatten all options for easier processing\nconst allOptions = computed(() => {\n  if (isGrouped.value) {\n    return (props.options as MultiSelectGroup[]).flatMap(\n      (group) => group.items\n    );\n  }\n  return props.options as MultiSelectOption[];\n});\n\nconst selectedOptions = computed(() =>\n  allOptions.value.filter((option) => props.modelValue.includes(option.value))\n);\n\n// UI Helper Computed Properties\nconst hasSelectedImages = computed(() =>\n  selectedOptions.value.some((option) => option.image)\n);\nconst hasAnyVisualElements = computed(() => {\n  return allOptions.value.some((option) => option.image || option.icon);\n});\n\n// Filtering Logic\nconst filteredGroups = computed(() => {\n  if (!isGrouped.value) return [];\n\n  const searchText = filterText.value.toLowerCase();\n\n  return groups.value\n    .map((group) => ({\n      ...group,\n      items: group.items.filter((option) => {\n        // Show all items if group name matches the search\n        const groupMatches = group.group.toLowerCase().includes(searchText);\n        // Show individual items if their label matches the search\n        const itemMatches = option.label.toLowerCase().includes(searchText);\n\n        return groupMatches || itemMatches;\n      }),\n    }))\n    .filter((group) => group.items.length > 0);\n});\n\nconst filteredIndividualOptions = computed(() =>\n  individualOptions.value.filter((option) =>\n    option.label.toLowerCase().includes(filterText.value.toLowerCase())\n  )\n);\n\n// All filtered options in a flat array for keyboard navigation\nconst filteredOptions = computed(() => {\n  const individual = filteredIndividualOptions.value;\n  const grouped = filteredGroups.value.flatMap((group) => group.items);\n  return [...individual, ...grouped];\n});\n\nconst highlightedOption = computed(\n  () => filteredOptions.value[highlightedIndex.value] || null\n);\n\n// Main Interaction Methods\nfunction toggleDropdown() {\n  isOpen.value = !isOpen.value;\n  if (isOpen.value) {\n    highlightedIndex.value = 0; // Reset to first item when opening\n    nextTick(() => {\n      inputRef.value?.focus();\n    });\n  }\n}\n\nfunction closeDropdown() {\n  isOpen.value = false;\n}\n\nfunction toggleOption(option: MultiSelectOption) {\n  const newValue = [...props.modelValue];\n  const index = newValue.indexOf(option.value);\n\n  if (index > -1) {\n    newValue.splice(index, 1);\n  } else {\n    newValue.push(option.value);\n  }\n\n  emit(\"update:modelValue\", newValue);\n}\n\nfunction clearAll() {\n  filterText.value = \"\";\n  emit(\"update:modelValue\", []);\n}\n\n// Keyboard Navigation\nfunction handleInputKeydown(event: KeyboardEvent) {\n  if (!isOpen.value) return;\n\n  if (event.key === \"Escape\") {\n    event.preventDefault();\n    closeDropdown();\n  } else if (event.key === \"Enter\" && highlightedOption.value) {\n    event.preventDefault();\n    event.stopPropagation();\n    toggleOption(highlightedOption.value);\n  } else if (event.key === \"ArrowDown\") {\n    event.preventDefault();\n    highlightedIndex.value = Math.min(\n      highlightedIndex.value + 1,\n      filteredOptions.value.length - 1\n    );\n  } else if (event.key === \"ArrowUp\") {\n    event.preventDefault();\n    highlightedIndex.value = Math.max(highlightedIndex.value - 1, 0);\n  }\n}\n\n// Utility Functions\nfunction renderIcon(icon: string | any) {\n  if (!icon) return null;\n\n  const iconContent =\n    typeof icon === \"string\"\n      ? h(\"span\", { class: \"text-base\" }, icon)\n      : h(icon, { class: \"w-4 h-4\" });\n\n  return h(\n    \"span\",\n    {\n      class:\n        \"flex-shrink-0 w-4 h-4 inline-flex items-center justify-center mr-2\",\n    },\n    [iconContent]\n  );\n}\n\nfunction isHighlighted(option: MultiSelectOption) {\n  return highlightedOption.value?.value === option.value;\n}\n\n// Watchers\n// Reset highlighted index when filter changes\nwatch(filterText, () => {\n  highlightedIndex.value = 0;\n});\n</script>\n","<template>\n  <div>\n    <div>\n      <LayoutHeader>\n        <template #left-header>\n          <Breadcrumbs\n            :items=\"[{ label: __('Search'), route: { name: 'SearchAgent' } }]\"\n          />\n        </template>\n      </LayoutHeader>\n      <div class=\"mx-auto mt-6 max-w-4xl px-4 sm:px-5\">\n        <div class=\"flex items-center space-x-2 px-2.5\">\n          <TextInput\n            ref=\"searchInput\"\n            class=\"flex-1\"\n            :placeholder=\"__('Search tickets, comments, and communications...')\"\n            autocomplete=\"off\"\n            :model-value=\"query\"\n            @update:model-value=\"updateQuery\"\n            @keydown=\"newSearch = true\"\n            @keydown.enter=\"() => submit()\"\n          >\n            <template #prefix>\n              <LucideSearch class=\"w-4 text-ink-gray-5\" />\n            </template>\n            <template #suffix>\n              <div class=\"flex items-center\">\n                <button\n                  v-if=\"query\"\n                  @click=\"clearSearch\"\n                  class=\"p-1 size-6 grid place-content-center focus:outline-none focus:ring focus:ring-outline-gray-3 rounded\"\n                >\n                  <LucideX class=\"w-4 text-ink-gray-7\" />\n                </button>\n              </div>\n            </template>\n          </TextInput>\n        </div>\n\n        <!-- Filter Panel -->\n        <div class=\"mt-2 px-2.5\">\n          <div class=\"flex gap-2 items-center\">\n            <!-- Team Filter -->\n            <SearchMultiSelect\n              :options=\"teamsFilterOptions\"\n              :model-value=\"activeFilters.agent_group || []\"\n              @update:model-value=\"\n                (values) => updateFilter('agent_group', values)\n              \"\n              :placeholder=\"__('Team')\"\n              :label=\"__('Team')\"\n            />\n\n            <!-- Status Filter -->\n            <SearchMultiSelect\n              :options=\"statusFilterOptions\"\n              :model-value=\"activeFilters.status || []\"\n              @update:model-value=\"(values) => updateFilter('status', values)\"\n              :placeholder=\"__('Status')\"\n              :label=\"__('Status')\"\n            />\n\n            <!-- Priority Filter -->\n            <SearchMultiSelect\n              :options=\"priorityFilterOptions\"\n              :model-value=\"activeFilters.priority || []\"\n              @update:model-value=\"(values) => updateFilter('priority', values)\"\n              :placeholder=\"__('Priority')\"\n              :label=\"__('Priority')\"\n            />\n\n            <!-- Document Type Filter -->\n            <SearchMultiSelect\n              :options=\"doctypesFilterOptions\"\n              :model-value=\"activeFilters.doctype || []\"\n              @update:model-value=\"(values) => updateFilter('doctype', values)\"\n              :placeholder=\"__('Type')\"\n              :label=\"__('Type')\"\n            />\n            <Button\n              v-if=\"hasActiveFilters()\"\n              size=\"sm\"\n              class=\"ml-auto text-ink-gray-5\"\n              variant=\"gray-ghost\"\n              @click=\"clearFilters\"\n              :label=\"__('Clear all filters')\"\n            />\n          </div>\n        </div>\n\n        <!-- Search Summary -->\n        <div\n          class=\"mt-2 px-2.5 text-sm flex items-center justify-between min-h-6\"\n        >\n          <div>\n            <template v-if=\"search.error\">\n              <ErrorMessage\n                :message=\"\n                  search.error.type == 'HelpdeskSearchIndexMissingError'\n                    ? __('Search index does not exist. Please build the index first.')\n                    : search.error\n                \"\n              />\n            </template>\n            <template v-else-if=\"newSearch && query.length > 2\">\n              <p class=\"text-ink-gray-6\">{{ __('Press enter to search') }}</p>\n            </template>\n            <template v-else-if=\"search.loading\">\n              <p class=\"text-ink-gray-6\">{{ __('Searching...') }}</p>\n            </template>\n            <template v-else-if=\"searchResponse?.summary\">\n              <div class=\"space-y-1\">\n                <p class=\"text-ink-gray-6\">\n                  {{ __(\"{0} matches ({1}s)\", [searchResponse.summary.filtered_matches, searchResponse.summary.duration]) }}\n                  <span v-if=\"hasActiveFilters()\">\n                    â€¢\n                    {{ __(\"{0} filter(s) applied\", [Object.keys(searchResponse.summary.applied_filters || {}).length]) }}\n                  </span>\n                </p>\n                <p\n                  v-if=\"searchResponse.summary.corrected_query\"\n                  class=\"text-ink-gray-6\"\n                >\n                  <span class=\"text-ink-gray-5\">{{ __('Searched for:') }}</span>\n                  <span class=\"ml-1 font-medium text-primary\">\n                    {{ searchResponse.summary.corrected_query }}\n                  </span>\n                </p>\n              </div>\n            </template>\n          </div>\n        </div>\n\n        <div class=\"mt-5\">\n          <template v-for=\"item in searchResponse?.results\" :key=\"item.id\">\n            <router-link\n              :to=\"getItemRoute(item)\"\n              class=\"flex space-x-2 overflow-hidden rounded px-2.5 py-3 hover:bg-surface-gray-2\"\n            >\n              <div class=\"flex items-start space-x-2\">\n                <div class=\"flex-shrink-0\">\n                  <LucideTicket\n                    v-if=\"item.doctype === 'HD Ticket'\"\n                    class=\"h-4 w-4 text-ink-gray-6\"\n                  />\n                  <LucideMessageSquare\n                    v-else-if=\"item.doctype === 'HD Ticket Comment'\"\n                    class=\"h-4 w-4 text-ink-gray-6\"\n                  />\n                  <LucideMail\n                    v-else-if=\"item.doctype === 'Communication'\"\n                    class=\"h-4 w-4 text-ink-gray-6\"\n                  />\n                </div>\n                <!-- <UserAvatar :name=\"item.raised_by || item.author || 'System'\" /> -->\n              </div>\n              <div class=\"w-full\">\n                <div class=\"flex items-center\">\n                  <div\n                    v-if=\"item.title\"\n                    class=\"text-base font-medium\"\n                    v-html=\"item.title\"\n                  />\n                  <div class=\"text-base font-medium\" v-else>\n                    {{ item.name }}\n                  </div>\n                  <span class=\"px-1 leading-none text-sm text-ink-gray-5\">\n                    &middot;\n                    {{\n                      item.doctype == \"Communication\"\n                        ? __(\"Email\")\n                        : item.doctype.replace(\"HD \", \"\")\n                    }}\n                  </span>\n                  <span class=\"px-1 leading-none text-sm text-ink-gray-5\">\n                    &middot; #{{ getTicketNumber(item) }}\n                  </span>\n                  <div class=\"ml-auto text-sm text-ink-gray-5\">\n                    {{ formatDate(item.modified) }}\n                  </div>\n                </div>\n                <div\n                  v-if=\"item.content\"\n                  class=\"mt-1 text-p-base text-ink-gray-6\"\n                  v-html=\"item.content\"\n                ></div>\n              </div>\n            </router-link>\n            <div class=\"border-b mx-2\"></div>\n          </template>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { LayoutHeader } from \"@/components\";\nimport SearchMultiSelect from \"@/components/SearchMultiSelect.vue\";\nimport { useShortcut } from \"@/composables/shortcuts\";\nimport dayjs from \"dayjs\";\nimport {\n  Breadcrumbs,\n  createResource,\n  debounce,\n  ErrorMessage,\n  TextInput,\n} from \"frappe-ui\";\nimport { computed, onMounted, ref, useTemplateRef, watch } from \"vue\";\nimport { useRoute, useRouter } from \"vue-router\";\nimport { __ } from \"@/translation\";\n// Icons\n\n// Type Definitions\ninterface SearchSummary {\n  duration: number;\n  total_matches: number;\n  returned_matches: number;\n  filtered_matches: number;\n  corrected_words?: Record<string, string>;\n  corrected_query?: string;\n  applied_filters?: SearchFilters;\n}\n\ninterface SearchResultItem {\n  id: string;\n  title: string;\n  content: string;\n  preview: string;\n  doctype: string;\n  name: string;\n  agent_group?: string;\n  status?: string;\n  priority?: string;\n  reference_ticket?: string;\n  reference_name?: string;\n  modified: number | string;\n  author?: string;\n  raised_by?: string;\n  score: number;\n}\n\ninterface SearchResponse {\n  results: SearchResultItem[];\n  summary: SearchSummary;\n}\n\ninterface SearchFilters {\n  agent_group?: string[];\n  status?: string[];\n  priority?: string[];\n  doctype?: string[];\n}\n\ninterface FilterOption {\n  value: string;\n  label: string;\n  count?: number;\n}\n\ninterface FilterOptions {\n  teams: Record<string, number>;\n  statuses: Record<string, number>;\n  priorities: Record<string, number>;\n  doctypes: Record<string, number>;\n}\n\n// Constants and Configuration\nconst STORAGE_KEY_PREFIX = \"helpdesk_search:\";\n\n// Reactive State\nconst query = ref(\"\");\nconst searchResponse = ref<SearchResponse | null>(null);\nconst newSearch = ref(true);\nconst activeFilters = ref<SearchFilters>({});\n\n// Template Refs\nconst searchInput = useTemplateRef<typeof TextInput>(\"searchInput\");\n\n// Composables and External Data\nconst router = useRouter();\nconst route = useRoute();\n\n// API Calls Setup\nconst search = createResource({\n  url: \"helpdesk.api.search.search\",\n  makeParams() {\n    return {\n      query: query.value,\n      filters: JSON.stringify(activeFilters.value),\n      limit: 50,\n    };\n  },\n  onSuccess(response) {\n    searchResponse.value = response;\n    newSearch.value = false;\n    if (query.value) {\n      saveSearchState(query.value, response);\n    }\n  },\n});\n\nconst filterOptions = createResource({\n  url: \"helpdesk.api.search.get_filter_options\",\n  auto: true,\n});\n\n// Filter Options Computed Properties\nconst teamsFilterOptions = computed(() => {\n  const options = filterOptions.data?.teams || {};\n  return Object.entries(options).map(([value]) => ({\n    value,\n    label: `${value}`,\n    // count,\n  }));\n});\n\nconst statusFilterOptions = computed(() => {\n  const options = filterOptions.data?.statuses || {};\n  return Object.entries(options).map(([value]) => ({\n    value,\n    label: `${value}`,\n    // count,\n  }));\n});\n\nconst priorityFilterOptions = computed(() => {\n  const options = filterOptions.data?.priorities || {};\n  return Object.entries(options).map(([value]) => ({\n    value,\n    label: `${value}`,\n    // count,\n  }));\n});\n\nconst doctypesFilterOptions = computed(() => {\n  return [\n    { value: \"HD Ticket\", label: __(\"Tickets\"), count: 0 },\n    { value: \"Communication\", label: __(\"Emails\"), count: 0 },\n    { value: \"HD Ticket Comment\", label: __(\"Comments\"), count: 0 },\n  ];\n});\n\n// Search Functions\nconst debouncedSubmit = debounce(() => {\n  if (query.value.length > 2) {\n    search.submit();\n  }\n}, 500);\n\nfunction updateQuery(value: string) {\n  query.value = value;\n  newSearch.value = true;\n  debouncedSubmit();\n}\n\nfunction submit() {\n  if (query.value.length > 2) {\n    // Update the URL query parameter\n    router.replace({ name: \"SearchAgent\", query: { q: query.value } });\n    search.submit();\n  }\n}\n\nfunction clearSearch() {\n  query.value = \"\";\n  searchResponse.value = null;\n  newSearch.value = true;\n  clearStoredSearches();\n  // Clear the URL query parameter\n  router.replace({ name: \"SearchAgent\" });\n}\n\nfunction clearFilters() {\n  activeFilters.value = {};\n  if (query.value.length > 2) {\n    debouncedSubmit();\n  }\n}\n\nfunction hasActiveFilters() {\n  return Object.values(activeFilters.value).some(\n    (filter) => filter && filter.length > 0\n  );\n}\n\nfunction updateFilter(key: keyof SearchFilters, values: string[]) {\n  if (!values || values.length === 0) {\n    delete activeFilters.value[key];\n  } else {\n    activeFilters.value[key] = values;\n  }\n\n  if (query.value.length > 2) {\n    debouncedSubmit();\n  }\n}\n\nfunction getItemRoute(item: SearchResultItem) {\n  if (!item || !item.doctype || !item.name) {\n    return { name: \"SearchAgent\" };\n  }\n\n  if (item.doctype === \"HD Ticket\") {\n    return {\n      name: \"TicketAgent\",\n      params: { ticketId: item.name },\n    };\n  } else if (item.doctype === \"HD Ticket Comment\" && item.reference_ticket) {\n    return {\n      name: \"TicketAgent\",\n      params: { ticketId: item.reference_ticket },\n      hash: `#comment-${item.name}`,\n    };\n  } else if (item.doctype === \"Communication\" && item.reference_name) {\n    return {\n      name: \"TicketAgent\",\n      params: { ticketId: item.reference_name },\n      hash: `#communication-${item.name}`,\n    };\n  }\n  return { name: \"SearchAgent\" };\n}\n\nfunction getTicketNumber(item: SearchResultItem) {\n  if (!item || !item.doctype) {\n    return \"\";\n  }\n\n  if (item.doctype === \"HD Ticket\") {\n    return item.name || \"\";\n  } else if (item.doctype === \"HD Ticket Comment\") {\n    return item.reference_ticket || \"\";\n  } else if (item.doctype === \"Communication\") {\n    return item.reference_name || \"\";\n  }\n  return \"\";\n}\n\nfunction formatDate(date: number | string) {\n  if (!date) return \"\";\n  let FORMAT = \"MMM D, YYYY hh:mm A\";\n  try {\n    // Handle Unix timestamp (seconds) - use dayjs.unix()\n    if (typeof date === \"number\") {\n      return dayjs.unix(date).format(FORMAT);\n    }\n    // Handle string dates\n    return dayjs(date).format(FORMAT);\n  } catch (error) {\n    return \"\";\n  }\n}\n\n// Search State Persistence\nfunction getStorageKey(query: string) {\n  return `${STORAGE_KEY_PREFIX}${query}`;\n}\n\nfunction loadSearchState(searchQuery: string) {\n  const saved = localStorage.getItem(getStorageKey(searchQuery));\n  if (saved) {\n    const state = JSON.parse(saved);\n    // Check if stored result is less than 30 minutes old\n    if (Date.now() - state.timestamp < 30 * 60 * 1000) {\n      searchResponse.value = state.results;\n      // Restore active filters if they exist\n      if (state.filters) {\n        activeFilters.value = state.filters;\n      }\n      newSearch.value = false;\n      return true;\n    }\n    // Remove expired results\n    localStorage.removeItem(getStorageKey(searchQuery));\n  }\n  return false;\n}\n\nfunction saveSearchState(searchQuery: string, results: SearchResponse) {\n  const state = {\n    results,\n    filters: activeFilters.value,\n    timestamp: Date.now(),\n  };\n  localStorage.setItem(getStorageKey(searchQuery), JSON.stringify(state));\n}\n\nfunction clearStoredSearches() {\n  for (let i = 0; i < localStorage.length; i++) {\n    const key = localStorage.key(i);\n    if (key?.startsWith(STORAGE_KEY_PREFIX)) {\n      localStorage.removeItem(key);\n    }\n  }\n}\n\n// Watch for route query changes (browser back/forward navigation)\nwatch(\n  () => route.query.q,\n  (newQuery) => {\n    if (newQuery && typeof newQuery === \"string\" && newQuery !== query.value) {\n      query.value = newQuery;\n      newSearch.value = false; // Prevent showing \"Press enter to search\"\n      search.submit();\n    } else if (!newQuery && query.value) {\n      query.value = \"\";\n      searchResponse.value = null;\n      newSearch.value = true;\n    }\n  }\n);\n\n// Lifecycle\nonMounted(() => {\n  const searchQuery = route.query.q as string;\n  if (searchQuery) {\n    query.value = searchQuery;\n    if (!loadSearchState(searchQuery)) {\n      submit();\n    }\n  } else {\n    clearStoredSearches();\n  }\n  // add a shortcut when presses \"/\" focus on this element\n  useShortcut(\"/\", () => {\n    searchInput.value.el.focus();\n  });\n});\n</script>\n"],"names":["props","__props","emit","__emit","isOpen","ref","filterText","highlightedIndex","inputRef","useTemplateRef","selectedCount","computed","isGrouped","individualOptions","groups","allOptions","group","selectedOptions","option","hasSelectedImages","hasAnyVisualElements","filteredGroups","searchText","groupMatches","itemMatches","filteredIndividualOptions","filteredOptions","individual","grouped","highlightedOption","toggleDropdown","nextTick","_a","closeDropdown","toggleOption","newValue","index","clearAll","handleInputKeydown","event","renderIcon","icon","iconContent","h","isHighlighted","watch","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_unref","Button","LucideChevronDown","_normalizeClass","_Fragment","_hoisted_3","_createBlock","Avatar","_hoisted_4","_toDisplayString","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","$event","LucideX","_hoisted_10","_hoisted_11","_renderList","Checkbox","_resolveDynamicComponent","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","STORAGE_KEY_PREFIX","query","searchResponse","newSearch","activeFilters","searchInput","router","useRouter","route","useRoute","search","createResource","response","saveSearchState","filterOptions","teamsFilterOptions","options","value","statusFilterOptions","priorityFilterOptions","doctypesFilterOptions","__","debouncedSubmit","debounce","updateQuery","submit","clearSearch","clearStoredSearches","clearFilters","hasActiveFilters","filter","updateFilter","key","values","getItemRoute","item","getTicketNumber","formatDate","date","FORMAT","dayjs","getStorageKey","loadSearchState","searchQuery","saved","state","results","i","newQuery","onMounted","useShortcut","LayoutHeader","Breadcrumbs","TextInput","_component_LucideSearch","_component_LucideX","SearchMultiSelect","_cache","_component_Button","ErrorMessage","_hoisted_9","_createTextVNode","_hoisted_12","_b","_component_router_link","_hoisted_16","_component_LucideTicket","_component_LucideMessageSquare","_component_LucideMail","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24"],"mappings":"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"}