{"version":3,"file":"CannedResponses-75b08609.js","sources":["../../../../desk/src/components/canned-response/CannedResponseModal.vue","../../../../desk/src/pages/CannedResponses.vue"],"sourcesContent":["<template>\n  <Dialog\n    v-model=\"show\"\n    :options=\"{\n      size: 'xl',\n      actions: [\n        {\n          label: !isNew ? 'Update' : 'Create',\n          variant: 'solid',\n          onClick: () => updateItem(),\n        },\n      ],\n    }\"\n  >\n    <template #body-title>\n      <div class=\"flex items-center gap-3\">\n        <h3 class=\"text-2xl font-semibold leading-6 text-gray-900\">\n          {{ !isNew ? \"Edit Canned Response\" : \"Create Canned Response\" }}\n        </h3>\n      </div>\n    </template>\n    <template #body-content>\n      <div class=\"flex flex-col gap-4\">\n        <div>\n          <div class=\"mb-1.5 text-sm text-gray-600\">{{ \"Title\" }}</div>\n          <TextInput\n            v-model=\"title\"\n            variant=\"outline\"\n            :placeholder=\"'Customer Query Resolved'\"\n          />\n        </div>\n        <div>\n          <div class=\"mb-1.5 text-sm text-gray-600\">{{ \"Message\" }}</div>\n          <TextEditor\n            ref=\"content\"\n            variant=\"outline\"\n            editor-class=\"!prose-sm overflow-auto min-h-[180px] max-h-80 py-1.5 px-2 rounded border border-gray-300 bg-white hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400 text-gray-800 transition-colors\"\n            :bubble-menu=\"true\"\n            :content=\"message\"\n            :placeholder=\"'Your query has been resolved. Thank you for reaching out.'\"\n            @change=\"(val) => (message = val)\"\n          />\n        </div>\n      </div>\n    </template>\n  </Dialog>\n</template>\n\n<script setup>\nimport { TextEditor, call, TextInput } from \"frappe-ui\";\n\nconst props = defineProps({\n  name: {\n    type: String,\n    required: false,\n    default: null,\n  },\n  isNew: {\n    type: Boolean,\n    required: false,\n    default: false,\n  },\n});\n\nconst show = defineModel();\nconst title = defineModel(\"title\");\nconst message = defineModel(\"message\");\nconst emit = defineEmits([\"update\"]);\n\nasync function updateItem() {\n  if (props.name) {\n    await call(\"frappe.client.set_value\", {\n      doctype: \"HD Canned Response\",\n      name: props.name,\n      fieldname: {\n        title: title.value,\n        message: message.value,\n      },\n    });\n  } else {\n    await call(\"frappe.client.insert\", {\n      doc: {\n        doctype: \"HD Canned Response\",\n        title: title.value,\n        message: message.value,\n      },\n    });\n  }\n  emit(\"update\");\n  show.value = false;\n}\n</script>\n","<template>\n  <div class=\"flex flex-col\">\n    <LayoutHeader>\n      <template #left-header>\n        <Breadcrumbs :items=\"breadcrumbs\" class=\"-ml-0.5\" />\n      </template>\n      <template #right-header>\n        <div class=\"flex items-center gap-2\">\n          <TextInput\n            v-model=\"searchQuery\"\n            type=\"text\"\n            :placeholder=\"'Search canned responses'\"\n            class=\"input input-bordered h-8 px-2 text-sm\"\n            style=\"min-width: 290px\"\n          >\n            <template #prefix>\n              <FeatherIcon name=\"search\" class=\"h-4 w-4 text-gray-500 ml-2\" />\n            </template>\n          </TextInput>\n          <Button\n            label=\"Create\"\n            theme=\"gray\"\n            variant=\"solid\"\n            @click=\"\n              () => {\n                title = null;\n                message = null;\n                showNewDialog = true;\n              }\n            \"\n          >\n            <template #prefix>\n              <LucidePlus class=\"h-4 w-4\" />\n            </template>\n          </Button>\n        </div>\n      </template>\n    </LayoutHeader>\n    <div class=\"flex-1 overflow-y-auto\">\n      <div\n        v-if=\"cannedResponses.data?.length > 0\"\n        class=\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4 p-4\"\n      >\n        <div\n          v-for=\"cannedResponse in cannedResponses.data\"\n          :key=\"cannedResponse.name\"\n          class=\"group flex h-60 cursor-pointer flex-col justify-between gap-2 rounded-lg border px-4 py-3 pt-2 shadow-sm hover:bg-gray-50\"\n          @click=\"editItem(cannedResponse)\"\n        >\n          <div class=\"flex items-center justify-between\">\n            <div class=\"truncate text-lg font-medium\">\n              {{ cannedResponse.title }}\n            </div>\n            <Dropdown\n              :options=\"[\n                {\n                  label: 'Delete',\n                  icon: 'trash-2',\n                  onClick: () => deleteItem(cannedResponse.name),\n                },\n              ]\"\n              @click.stop\n            >\n              <Button\n                icon=\"more-horizontal\"\n                variant=\"ghosted\"\n                class=\"hover:bg-white\"\n              />\n            </Dropdown>\n          </div>\n          <TextEditor\n            v-if=\"cannedResponse.message\"\n            :content=\"cannedResponse.message\"\n            :editable=\"false\"\n            editor-class=\"prose-sm\"\n            class=\"flex-1 overflow-hidden response-preview\"\n          />\n          <div class=\"mt-2 flex items-center justify-between gap-2\">\n            <div class=\"flex items-center gap-2\">\n              <UserAvatar :name=\"cannedResponse.owner\" size=\"xs\" />\n              <div class=\"text-sm text-gray-800\">\n                {{ getUser(cannedResponse.owner).full_name }}\n              </div>\n            </div>\n            <Tooltip\n              :text=\"dateFormat(cannedResponse.modified, dateTooltipFormat)\"\n            >\n              <div class=\"text-sm text-gray-700\">\n                {{ dayjs.tz(cannedResponse.modified).fromNow() }}\n              </div>\n            </Tooltip>\n          </div>\n        </div>\n      </div>\n      <EmptyState\n        v-else\n        title=\"No Canned Responses Found\"\n        @emptyStateAction=\"showNewDialog = true\"\n      />\n    </div>\n    <CannedResponseModal\n      v-model=\"showNewDialog\"\n      v-model:title=\"title\"\n      v-model:message=\"message\"\n      :name=\"name\"\n      :is-new=\"name ? false : true\"\n      @close=\"\n        () => {\n          showNewDialog = false;\n          title = null;\n          message = null;\n          name = null;\n        }\n      \"\n      @update=\"\n        () => {\n          cannedResponses.reload();\n          showNewDialog = false;\n          title = null;\n          message = null;\n          name = null;\n        }\n      \"\n    />\n  </div>\n</template>\n<script setup lang=\"ts\">\nimport { LayoutHeader } from \"@/components\";\nimport { CannedResponseModal } from \"@/components/canned-response/\";\nimport { dayjs } from \"@/dayjs\";\nimport { useUserStore } from \"@/stores/user\";\nimport { dateFormat, dateTooltipFormat } from \"@/utils\";\nimport { watchDebounced } from \"@vueuse/core\";\nimport {\n  Breadcrumbs,\n  Dropdown,\n  TextEditor,\n  Tooltip,\n  call,\n  createListResource,\n  usePageMeta,\n} from \"frappe-ui\";\nimport { ref } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport EmptyState from \"../components/EmptyState.vue\";\n\nconst { getUser } = useUserStore();\n\nconst breadcrumbs = [\n  { label: \"Canned Responses\", route: { name: \"CannedResponses\" } },\n];\nconst route = useRoute();\n\nconst title = ref(null);\nconst message = ref(null);\nconst name = ref(null);\nconst isNew = route.hash.split(\"#\")[1] === \"new\";\nconst showNewDialog = ref(isNew || false);\nconst searchQuery = ref(\"\");\n\nconst cannedResponses = createListResource({\n  doctype: \"HD Canned Response\",\n  fields: [\"name\", \"title\", \"message\", \"owner\", \"modified\"],\n  auto: true,\n  orFilters: {},\n  orderBy: \"modified desc\",\n});\n\n// reload responses when search query changes\nwatchDebounced(\n  searchQuery,\n  (newValue) => {\n    cannedResponses.update({\n      orFilters: newValue\n        ? {\n            message: [\"like\", `%${newValue}%`],\n            title: [\"like\", `%${newValue}%`],\n          }\n        : {},\n    });\n    cannedResponses.reload();\n  },\n  { debounce: 300 }\n);\n\nfunction editItem(cannedResponse) {\n  title.value = cannedResponse.title;\n  message.value = cannedResponse.message;\n  name.value = cannedResponse.name;\n  showNewDialog.value = true;\n}\n\nasync function deleteItem(name) {\n  await call(\"frappe.client.delete\", {\n    doctype: \"HD Canned Response\",\n    name,\n  });\n  cannedResponses.reload();\n}\n\nusePageMeta(() => {\n  return {\n    title: \"Canned Responses\",\n  };\n});\n</script>\n\n<style>\n.response-preview :where(p, span, a) {\n  @apply !text-gray-600;\n}\n</style>\n"],"names":["props","__props","show","_useModel","title","message","emit","__emit","updateItem","call","_createBlock","_component_Dialog","$event","_createElementVNode","_hoisted_1","_hoisted_2","_toDisplayString","_hoisted_3","_cache","_createVNode","_unref","TextInput","TextEditor","val","getUser","useUserStore","breadcrumbs","route","useRoute","ref","name","isNew","showNewDialog","searchQuery","cannedResponses","createListResource","watchDebounced","newValue","editItem","cannedResponse","deleteItem","usePageMeta","_openBlock","_createElementBlock","LayoutHeader","Breadcrumbs","_component_TextInput","_component_FeatherIcon","_component_Button","_component_LucidePlus","_hoisted_4","_Fragment","_renderList","_hoisted_6","_hoisted_7","Dropdown","_hoisted_8","_hoisted_9","_component_UserAvatar","_hoisted_10","Tooltip","dateFormat","dateTooltipFormat","_hoisted_11","dayjs","EmptyState","CannedResponseModal"],"mappings":"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"}