import{A as V,c as G,a_ as Z,e as a,k as v,l as t,j as Me,f as B,x as Ue,v as w,h as e,g as i,L as Xe,a1 as j,y as S,F as N,G as W,z as we,w as C,a8 as X,M as kt,m as Ve,n as _e,N as Le,Q as Ie,b4 as Fs,an as Se,ao as He,C as Ce,t as oe,I as Te,W as K,d as O,u as Rl,q as c,K as ne,J as De,a4 as ce,ar as Os,aV as al,aS as ol,aT as il,aU as rl,Y as ul,b1 as Ps,r as q,ai as ft,b0 as zs,a as et,Z as tt,p as Ge,U as dl,O as qe,aP as Hs,X as Je,S as H,bQ as qs,bR as It,bo as Qs,bS as bt,$ as Wt,aF as Ke,bT as Js,bU as Gs,bV as Ws,bW as Zs,bX as Ys,bY as Ks,bZ as Xs,b_ as en,am as cl,a0 as fe,V as Nl,aq as Et,b$ as Qe,ah as xt,b7 as tn,a9 as ae,aG as pe,bd as Ne,a7 as Oe,ac as Ze,c0 as $l,bg as jl,ba as jt,c1 as ml,c2 as pl,aj as se,b2 as qt,H as Re,b3 as Be,c3 as le,c4 as mt,c5 as ln,aW as Fl,aY as Ol,be as Pl,c6 as Zt,c7 as sn,c8 as nn,D as Yt,E as Kt,ab as Mt,ap as zl,c9 as Al,ca as Hl,P as _t,b as an,s as on,al as St}from"./index-b4c863a6.js";import{m as fl,j as Xt,n as rn,o as un,a as Ut,i as vl,_ as dn,h as ql,k as Ql,g as cn,u as mn,c as pn,p as fn,s as Sl,e as Vl,F as vn}from"./TypingIndicator.vue_vue_type_style_index_0_scoped_3f215bd3_lang-c8d975a4.js";import{d as Jl}from"./dayjs-95f8111d.js";import"./knowledgeBase-2d00b929.js";import{u as Gl}from"./notification-a08fd36e.js";import{u as Wl,e as gn,c as _n,a as hn,_ as yn,H as bn,b as kn,d as rt,L as xn}from"./CallUI.vue_vue_type_script_setup_true_lang-4f864ee1.js";import{_ as el}from"./UserAvatar.vue_vue_type_script_setup_true_lang-e554c997.js";import{u as gl}from"./telephony-64d62ea1.js";import{_ as wn}from"./Section-1a9e5612.js";import{_ as Zl}from"./plus-3c348a65.js";import{_ as lt}from"./Avatar.vue_vue_type_script_setup_true_lang-89128cfb.js";import{D as be,_ as Ee}from"./Dropdown-f79f7542.js";import{u as it,m as $e,s as ze}from"./onboarding-89cf30fe.js";import{_ as Cn}from"./EmailIcon-c867fb48.js";import{u as Ft}from"./agent-b7600b38.js";import{c as Ot,S as wt,H as Ct,d as _l,e as Pt}from"./types-27fcf86f.js";import{a as Yl,_ as Kl,L as $n}from"./calendar-213c6159.js";import{E as An,N as Sn}from"./EditIcon-f33e48c1.js";import{a as Xl}from"./Link-842a8a10.js";import{_ as Vn}from"./StarRating.vue_vue_type_script_setup_true_lang-4484b1d1.js";import{_ as Dn}from"./DateRangePicker.vue_vue_type_script_setup_true_lang-d7f22ac0.js";import{a as pt,_ as In}from"./DateTimePicker.vue_vue_type_script_setup_true_lang-a14f638d.js";import{u as hl}from"./ticketStatus-60f6a20e.js";import{g as Vt,a as Dt,b as En}from"./utils-4e66359c.js";import{T as Ln}from"./TabButtons-928aa2d2.js";import{_ as Bn}from"./chevron-right-cd59273c.js";import{L as es}from"./mail-28c56cfa.js";import{P as Tn}from"./PhoneIcon-ea7dd5f1.js";import{_ as Mn}from"./chevron-left-d60af664.js";import{F as ts}from"./FileUploader-44680597.js";import{s as Un}from"./dialogState-773daca3.js";import"./index-6b12b9aa.js";import"./index-3720151f.js";import"./portal-302b46c8.js";import"./popper-0aa08b12.js";import"./description-c763d251.js";function Rn(){const o=V(0),l=V(0),s=G(()=>Vt()),r=G(()=>{if(!(o.value&&l.value))return[];const m=l.value-1,_=o.value,b=Vt(_,m,1),g=Vt(_,m+1,0),h=b.getDay(),y=6-g.getDay(),k=Dt(b,-h),D=Dt(g,y),M=En(m,_),L=Dt(b,M-1);let T=[...k,b,...L,...D];if(T.length<42){const x=T.at(-1);if(x){const I=Dt(x,42-T.length);T=T.concat(...I)}}return T}),n=G(()=>{const m=[],_=r.value.slice();for(;_.length;){const b=_.splice(0,7);m.push(b)}return m}),u=G(()=>{if(!(o.value&&l.value))return"";const m=Vt(o.value,l.value-1,1);return`${m.toLocaleString("en-US",{month:"long"})}, ${m.getFullYear()}`});function d(){p(-1)}function f(){p(1)}function p(m){l.value=l.value+m,l.value<1&&(l.value=12,o.value=o.value-1),l.value>12&&(l.value=1,o.value=o.value+1)}return{currentYear:o,currentMonth:l,today:s,dates:r,datesAsWeeks:n,formattedMonth:u,prevMonth:d,nextMonth:f,changeMonth:p}}const Nn={class:"lucide lucide-eye",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function jn(o,l){return a(),v("svg",Nn,[...l[0]||(l[0]=[t("path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"},null,-1),t("circle",{cx:"12",cy:"12",r:"3"},null,-1)])])}const Fn=Z({name:"lucide-eye",render:jn}),On={class:"lucide lucide-eye-off",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Pn(o,l){return a(),v("svg",On,[...l[0]||(l[0]=[t("path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49"},null,-1),t("path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242"},null,-1),t("path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143"},null,-1),t("path",{d:"m2 2 20 20"},null,-1)])])}const zn=Z({name:"lucide-eye-off",render:Pn}),Hn={},qn={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Qn(o,l){return a(),v("svg",qn,[...l[0]||(l[0]=[t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 6.5C9.10457 6.5 10 5.60457 10 4.5C10 3.39543 9.10457 2.5 8 2.5C6.89543 2.5 6 3.39543 6 4.5C6 5.60457 6.89543 6.5 8 6.5ZM8 7.5C9.65685 7.5 11 6.15685 11 4.5C11 2.84315 9.65685 1.5 8 1.5C6.34315 1.5 5 2.84315 5 4.5C5 6.15685 6.34315 7.5 8 7.5ZM12 13.5C13.1046 13.5 14 12.6046 14 11.5C14 10.3954 13.1046 9.5 12 9.5C10.8954 9.5 10 10.3954 10 11.5C10 12.6046 10.8954 13.5 12 13.5ZM12 14.5C13.6569 14.5 15 13.1569 15 11.5C15 9.84315 13.6569 8.5 12 8.5C10.3431 8.5 9 9.84315 9 11.5C9 13.1569 10.3431 14.5 12 14.5ZM6 11.5C6 12.6046 5.10457 13.5 4 13.5C2.89543 13.5 2 12.6046 2 11.5C2 10.3954 2.89543 9.5 4 9.5C5.10457 9.5 6 10.3954 6 11.5ZM7 11.5C7 13.1569 5.65685 14.5 4 14.5C2.34315 14.5 1 13.1569 1 11.5C1 9.84315 2.34315 8.5 4 8.5C5.65685 8.5 7 9.84315 7 11.5Z",fill:"currentColor"},null,-1)])])}const ht=Me(Hn,[["render",Qn]]),Jn={},Gn={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-minimize-2"};function Wn(o,l){return a(),v("svg",Gn,[...l[0]||(l[0]=[t("polyline",{points:"4 14 10 14 10 20"},null,-1),t("polyline",{points:"20 10 14 10 14 4"},null,-1),t("line",{x1:"14",y1:"10",x2:"21",y2:"3"},null,-1),t("line",{x1:"3",y1:"21",x2:"10",y2:"14"},null,-1)])])}const Zn=Me(Jn,[["render",Wn]]),Yn={},Kn={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-maximize-2"};function Xn(o,l){return a(),v("svg",Kn,[...l[0]||(l[0]=[t("polyline",{points:"15 3 21 3 21 9"},null,-1),t("polyline",{points:"9 21 3 21 3 15"},null,-1),t("line",{x1:"21",y1:"3",x2:"14",y2:"10"},null,-1),t("line",{x1:"3",y1:"21",x2:"10",y2:"14"},null,-1)])])}const ea=Me(Yn,[["render",Xn]]),ta={},la={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function sa(o,l){return a(),v("svg",la,[...l[0]||(l[0]=[t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M14.25 8C14.25 11.4518 11.4518 14.25 8 14.25C4.54822 14.25 1.75 11.4518 1.75 8C1.75 4.54822 4.54822 1.75 8 1.75C11.4518 1.75 14.25 4.54822 14.25 8ZM15.25 8C15.25 12.0041 12.0041 15.25 8 15.25C3.99594 15.25 0.75 12.0041 0.75 8C0.75 3.99594 3.99594 0.75 8 0.75C12.0041 0.75 15.25 3.99594 15.25 8ZM7.37988 9.37695V9.44531H8.39062V9.37695C8.39062 9.10352 8.41992 8.88542 8.47852 8.72266C8.53711 8.55664 8.62826 8.41504 8.75195 8.29785C8.87891 8.18066 9.04329 8.06185 9.24512 7.94141C9.56087 7.74609 9.8099 7.51009 9.99219 7.2334C10.1745 6.95345 10.2656 6.61328 10.2656 6.21289C10.2656 5.82878 10.1745 5.49186 9.99219 5.20215C9.81315 4.91244 9.56087 4.6862 9.23535 4.52344C8.90983 4.36068 8.52734 4.2793 8.08789 4.2793C7.69401 4.2793 7.33268 4.35579 7.00391 4.50879C6.67513 4.65853 6.41146 4.88151 6.21289 5.17773C6.01432 5.4707 5.90853 5.82878 5.89551 6.25195H6.96973C6.986 6.0013 7.04948 5.79785 7.16016 5.6416C7.27083 5.4821 7.40755 5.36491 7.57031 5.29004C7.73633 5.21517 7.90885 5.17773 8.08789 5.17773C8.28971 5.17773 8.47363 5.22005 8.63965 5.30469C8.80892 5.38932 8.94075 5.50814 9.03516 5.66113C9.13281 5.81413 9.18164 5.99479 9.18164 6.20312C9.18164 6.47005 9.11003 6.69954 8.9668 6.8916C8.82357 7.0804 8.64453 7.23828 8.42969 7.36523C8.21159 7.50195 8.02279 7.64193 7.86328 7.78516C7.70703 7.92513 7.58659 8.11556 7.50195 8.35645C7.42057 8.59408 7.37988 8.93425 7.37988 9.37695ZM7.37988 11.5205C7.51986 11.654 7.69076 11.7207 7.89258 11.7207C8.09766 11.7207 8.26855 11.654 8.40527 11.5205C8.54525 11.3838 8.61523 11.2161 8.61523 11.0176C8.61523 10.8158 8.54525 10.6481 8.40527 10.5146C8.26855 10.3779 8.09766 10.3096 7.89258 10.3096C7.69076 10.3096 7.51986 10.3779 7.37988 10.5146C7.24316 10.6481 7.1748 10.8158 7.1748 11.0176C7.1748 11.2161 7.24316 11.3838 7.37988 11.5205Z",fill:"currentColor"},null,-1)])])}const ls=Me(ta,[["render",sa]]),na={class:"flex flex-col justify-center items-center gap-1 mt-4 mb-7"},aa={class:"text-base font-medium"},oa={class:"text-p-base font-normal"},ia={class:"flex flex-col gap-2.5 overflow-hidden"},ra={class:"flex justify-between items-center py-0.5"},ua={class:"flex"},da={class:"flex flex-col gap-1.5 overflow-y-auto"},ca=["onClick"],ma={__name:"OnboardingSteps",props:{appName:{type:String,default:"frappecrm"},title:{type:String,default:"Frappe CRM"},logo:{type:Object,required:!0},afterSkip:{type:Function,default:()=>{}},afterSkipAll:{type:Function,default:()=>{}},afterReset:{type:Function,default:()=>{}},afterResetAll:{type:Function,default:()=>{}}},setup(o){const l=o;function s(g){if(g.dependsOn&&!g.completed){const h=n.find(y=>y.name===g.dependsOn);if(h&&!h.completed)return!0}return!1}function r(g){if(g.dependsOn&&!g.completed){const h=n.find(y=>y.name===g.dependsOn);if(h&&!h.completed)return`You need to complete "${h.title}" first.`}return""}const{steps:n,stepsCompleted:u,totalSteps:d,completedPercentage:f,skip:p,skipAll:m,reset:_,resetAll:b}=it(l.appName);return(g,h)=>(a(),v(N,null,[t("div",na,[(a(),B(Ue(o.logo),{class:"size-10 shrink-0 rounded mb-4"})),t("div",aa,w("Welcome to "+o.title),1),t("div",oa,w(`${e(u)}/${e(d)} steps completed`),1)]),t("div",ia,[t("div",ra,[i(Xe,{label:`${e(f)}% completed`,theme:e(f)==100?"green":"orange",size:"lg"},null,8,["label","theme"]),t("div",ua,[e(f)!=0?(a(),B(j,{key:0,variant:"ghost",label:"Reset all",onClick:h[0]||(h[0]=()=>e(b)(o.afterResetAll))})):S("",!0),e(f)!=100?(a(),B(j,{key:1,variant:"ghost",label:"Skip all",onClick:h[1]||(h[1]=()=>e(m)(o.afterSkipAll))})):S("",!0)])]),t("div",da,[(a(!0),v(N,null,W(e(n),y=>(a(),v("div",{key:y.title,class:"group w-full flex gap-2 justify-between items-center hover:bg-surface-gray-1 rounded px-2 py-1.5 cursor-pointer",onClick:we(()=>!y.completed&&!s(y)&&y.onClick(),["stop"])},[(a(),B(Ue(s(y)?kt:"div"),{text:r(y)},{default:C(()=>[t("div",{class:X(["flex gap-2 items-center",[y.completed?"text-ink-gray-5":s(y)?"text-ink-gray-4":"text-ink-gray-8"]])},[(a(),B(Ue(y.icon),{class:"h-4"})),t("div",{class:X(["text-base",{"line-through":y.completed}])},w(y.title),3)],2)]),_:2},1032,["text"])),!y.completed&&!s(y)?(a(),B(j,{key:0,label:"Skip",class:"!h-4 text-xs !text-ink-gray-6 hidden group-hover:flex",onClick:()=>e(p)(y.name,o.afterSkip)},null,8,["onClick"])):s(y)?S("",!0):(a(),B(j,{key:1,label:"Reset",class:"!h-4 text-xs !text-ink-gray-6 hidden group-hover:flex",onClick:we(()=>e(_)(y.name,o.afterReset),["stop"])},null,8,["onClick"]))],8,ca))),128))])])],64))}},pa=ma,fa={class:"flex flex-col gap-2 overflow-hidden"},va={class:"m-1"},ga={class:"flex justify-between items-center text-base text-ink-gray-5 mx-2"},_a={class:"flex flex-col gap-1.5 overflow-y-auto"},ha=["onClick"],ya={class:"flex items-center gap-2"},ba={class:"text-base text-ink-gray-8"},ka={class:"flex flex-col gap-1.5 ml-5"},xa=["onClick"],wa={class:"flex items-center gap-2"},Ca={class:"text-base text-ink-gray-8"},$a={__name:"HelpCenter",props:Ve({docsLink:{type:String,default:"https://docs.frappe.io/crm"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const l=o,s=V(null),r=V(""),n=_e(o,"modelValue"),u=G(()=>r.value?n.value.filter(p=>{const m=p.subArticles.filter(_=>_.title.toLowerCase().includes(r.value.toLowerCase()));return p.title.toLowerCase().includes(r.value.toLowerCase())||m.length>0?{...p,subArticles:m}:!1}):n.value);function d(){window.open(l.docsLink,"_blank")}function f(p){window.open(`${l.docsLink}/${p}`,"_blank")}return Le(()=>{var p,m;(m=(p=s.value)==null?void 0:p.el)==null||m.focus()}),(p,m)=>(a(),v("div",fa,[t("div",va,[i(Fs,{ref_key:"searchInput",ref:s,placeholder:"Search articles...",modelValue:r.value,"onUpdate:modelValue":m[0]||(m[0]=_=>r.value=_),debounce:300},{prefix:C(()=>[i(Ie,{name:"search",class:"h-4 text-ink-gray-5"})]),_:1},8,["modelValue"])]),t("div",ga,[m[1]||(m[1]=t("div",null,"All articles",-1)),i(j,{variant:"ghost",onClick:d},{default:C(()=>[i(Ie,{name:"arrow-up-right",class:"h-4 text-ink-gray-5"})]),_:1})]),t("div",_a,[(a(!0),v(N,null,W(u.value,_=>(a(),v("div",{key:_.title,class:"flex flex-col gap-1.5"},[t("div",{class:"flex items-center justify-between p-1.5 hover:bg-surface-gray-1 rounded cursor-pointer",onClick:b=>_.opened=!_.opened},[t("div",ya,[i(Ie,{name:_.opened?"chevron-down":"chevron-right",class:"h-4 text-ink-gray-5"},null,8,["name"]),t("div",ba,w(_.title),1)])],8,ha),Se(t("div",ka,[(a(!0),v(N,null,W(_.subArticles,b=>(a(),v("div",{key:b.name,class:"group flex items-center justify-between gap-2 p-1.5 hover:bg-surface-gray-1 rounded cursor-pointer",onClick:()=>f(b.name)},[t("div",wa,[i(Ie,{name:"file-text",class:"h-4 text-ink-gray-5"}),t("div",Ca,w(b.title),1)]),i(Ie,{name:"arrow-up-right",class:"h-4 hidden group-hover:flex text-ink-gray-5"})],8,xa))),128))],512),[[He,_.opened]])]))),128))])]))}},Aa=$a,je=V(!1),Sa={class:"flex items-center justify-between px-2 py-1.5"},Va={class:"text-base font-medium"},Da={class:"flex gap-1"},Ia={class:"h-full overflow-hidden flex flex-col"},Ea={class:"flex flex-col gap-1.5"},La=["onClick"],Ba={class:"text-base"},Ta={__name:"HelpModal",props:Ve({appName:{type:String,default:"frappecrm"},title:{type:String,default:"Frappe CRM"},logo:{type:Object,required:!0},afterSkip:{type:Function,default:()=>{}},afterSkipAll:{type:Function,default:()=>{}},afterReset:{type:Function,default:()=>{}},afterResetAll:{type:Function,default:()=>{}},docsLink:{type:String,default:"https://docs.frappe.io/crm"}},{modelValue:{},modelModifiers:{},articles:{},articlesModifiers:{}}),emits:["update:modelValue","update:articles"],setup(o){const l=o,{syncStatus:s,resetAll:r,isOnboardingStepsCompleted:n}=it(l.appName),u=_e(o,"modelValue"),d=_e(o,"articles"),f=G(()=>{if(!n.value&&!je.value)return"Getting started";if(je.value)return"Help center"}),p=G(()=>[{icon:ht,label:"Reset onboarding steps",onClick:_,condition:()=>je.value&&n.value}].filter(g=>g.condition())),m=G(()=>[{icon:ls,label:"Help centre",onClick:()=>{s(),je.value=!0},condition:!n.value&&!je.value},{icon:ht,label:"Getting started",onClick:()=>je.value=!1,condition:je.value&&!n.value}].filter(g=>g.condition));function _(){r(),n.value=!1,je.value=!1}return Le(()=>{n.value&&(je.value=!0)}),(b,g)=>Se((a(),v("div",{class:X(["fixed z-50 right-0 w-80 h-[calc(100%_-_80px)] text-ink-gray-9 m-5 mt-[62px] p-3 flex gap-2 flex-col justify-between rounded-lg bg-surface-modal shadow-2xl",{"top-[calc(100%_-_120px)] border":e($e)}]),onClick:g[3]||(g[3]=we(()=>{},["stop"]))},[t("div",Sa,[t("div",Va,w(f.value),1),t("div",Da,[p.value.length?(a(),B(be,{key:0,options:p.value},{default:C(()=>[i(j,{variant:"ghost",icon:"more-horizontal"})]),_:1},8,["options"])):S("",!0),i(j,{onClick:g[0]||(g[0]=h=>$e.value=!e($e)),variant:"ghost"},{default:C(()=>[(a(),B(Ue(e($e)?ea:Zn),{class:"h-3.5"}))]),_:1}),i(j,{variant:"ghost",onClick:g[1]||(g[1]=h=>u.value=!1)},{default:C(()=>[i(Ie,{name:"x",class:"h-3.5"})]),_:1})])]),t("div",Ia,[!e(n)&&!e(je)?(a(),B(pa,{key:0,title:o.title,logo:o.logo,afterSkip:o.afterSkip,afterSkipAll:o.afterSkipAll,afterReset:o.afterReset,afterResetAll:o.afterResetAll,appName:o.appName},null,8,["title","logo","afterSkip","afterSkipAll","afterReset","afterResetAll","appName"])):e(je)?(a(),B(Aa,{key:1,modelValue:d.value,"onUpdate:modelValue":g[2]||(g[2]=h=>d.value=h),docsLink:o.docsLink},null,8,["modelValue","docsLink"])):S("",!0)]),(a(!0),v(N,null,W(m.value,h=>(a(),v("div",Ea,[t("div",{class:"w-full flex gap-2 items-center hover:bg-surface-gray-1 text-ink-gray-8 rounded px-2 py-1.5 cursor-pointer",onClick:h.onClick},[(a(),B(Ue(h.icon),{class:"h-4"})),t("div",Ba,w(h.label),1)],8,La)]))),256))],2)),[[He,u.value]])}},Ma=Ta,Ua={key:0,class:"flex flex-col gap-3 shadow-sm rounded-lg py-2.5 px-3 bg-surface-modal text-base"},Ra={key:0,class:"inline-flex text-ink-gray-9 gap-2"},Na={class:"flex flex-col text-p-sm gap-0.5"},ja={class:"text-ink-gray-7"},Fa={key:1,class:"flex flex-col gap-1"},Oa={class:"flex items-center justify-between gap-1"},Pa={class:"flex items-center gap-2 shrink-0"},za={__name:"GettingStartedBanner",props:{isSidebarCollapsed:{type:Boolean,default:!1},appName:{type:String,default:"frappecrm"}},setup(o){const l=o,{stepsCompleted:s,totalSteps:r,isOnboardingStepsCompleted:n}=it(l.appName),u=()=>{$e.value=!1,ze.value=!0};return(d,f)=>o.isSidebarCollapsed?e(s)!=e(r)?(a(),B(j,{key:1,onClick:u},{default:C(()=>[i(ht,{class:"h-4 my-0.5 shrink-0"})]),_:1})):S("",!0):(a(),v("div",Ua,[e(s)!=e(r)?(a(),v("div",Ra,[i(ht,{class:"h-4 my-0.5 shrink-0"}),t("div",Na,[f[1]||(f[1]=t("div",{class:"font-medium"},w("Getting started"),-1)),t("div",ja,w(`${e(s)}/${e(r)} steps`),1)])])):(a(),v("div",Fa,[t("div",Oa,[t("div",Pa,[i(ht,{class:"h-4 my-0.5"}),f[2]||(f[2]=t("div",{class:"text-ink-gray-9 font-medium"},w("You are all set"),-1))]),i(Ie,{name:"x",class:"h-4 cursor-pointer",onClick:f[0]||(f[0]=()=>{je.value=!0,n.value=!0})})]),f[3]||(f[3]=t("div",{class:"text-p-sm text-ink-gray-7"},w("All steps are completed successfully"),-1))])),e(s)!=e(r)?(a(),B(j,{key:2,label:e(s)==0?"Start now":"Continue",theme:"blue",onClick:u},{prefix:C(()=>[i(Ie,{name:"chevrons-right",class:"size-4"})]),_:1},8,["label"])):S("",!0)]))}},Ha=za,qa={class:"flex flex-col gap-2 text-ink-gray-9 text-base"},Qa={key:0},Ja={key:1,class:"w-full rounded",controls:"",autoplay:"",muted:""},Ga=["src"],Wa={__name:"IntermediateStepModal",props:Ve({currentStep:{type:Object,default:{title:"Title",message:"Message",videoURL:"",buttonLabel:"Button Label",onClick:()=>{}}},dialogOptions:{type:Object,default:()=>({})}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const l=o,s=_e(o,"modelValue"),r=G(()=>l.dialogOptions&&Object.keys(l.dialogOptions).length?l.dialogOptions:{title:l.currentStep.title,size:"2xl",actions:[{label:l.currentStep.buttonLabel,variant:"solid",onClick:l.currentStep.onClick}]});return(n,u)=>(a(),B(e(Te),{modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=d=>s.value=d),options:r.value},{"boday-header":C(()=>[Ce(n.$slots,"body-header")]),"body-content":C(()=>[Ce(n.$slots,"default",{},()=>[t("div",qa,[o.currentStep.message?(a(),v("div",Qa,w(o.currentStep.message),1)):S("",!0),o.currentStep.videoURL?(a(),v("video",Ja,[t("source",{src:o.currentStep.videoURL,type:"video/mp4"},null,8,Ga),u[1]||(u[1]=oe(" Your browser does not support the video tag. ",-1))])):S("",!0)])])]),actions:C(()=>[Ce(n.$slots,"actions")]),_:3},8,["modelValue","options"]))}},Za=Wa,Ya={},Ka={width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Xa(o,l){return a(),v("svg",Ka,[...l[0]||(l[0]=[t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.2641 1C5.5758 1 4.97583 1.46845 4.80889 2.1362L3.57555 7.06953C3.33887 8.01625 4.05491 8.93333 5.03077 8.93333H7.50682L6.72168 14.4293C6.68838 14.6624 6.82229 14.8872 7.04319 14.9689C7.26408 15.0507 7.51204 14.9671 7.63849 14.7684L13.2161 6.00354C13.6398 5.33782 13.1616 4.46667 12.3725 4.46667H9.59038L10.3017 1.62127C10.3391 1.4719 10.3055 1.31365 10.2108 1.19229C10.116 1.07094 9.97063 1 9.81666 1H6.2641ZM5.77903 2.37873C5.83468 2.15615 6.03467 2 6.2641 2H9.17627L8.46492 4.8454C8.42758 4.99477 8.46114 5.15302 8.55589 5.27437C8.65064 5.39573 8.79602 5.46667 8.94999 5.46667H12.3725L8.0395 12.2757L8.5783 8.50404C8.5988 8.36056 8.55602 8.21523 8.46105 8.10573C8.36608 7.99623 8.22827 7.93333 8.08332 7.93333H5.03077C4.70548 7.93333 4.4668 7.62764 4.5457 7.31207L5.77903 2.37873Z",fill:"currentColor"},null,-1)])])}const Dl=Me(Ya,[["render",Xa]]),eo={key:0,class:"flex flex-col gap-3 shadow-sm rounded-lg py-2.5 px-3 bg-surface-modal text-base"},to={class:"flex flex-col gap-1"},lo={class:"inline-flex text-ink-gray-9 gap-2 items-center font-medium"},so="Upgrade to a paid plan for uninterrupted services",no={__name:"TrialBanner",props:{isSidebarCollapsed:{type:Boolean,default:!1},afterUpgrade:{type:Function,default:()=>{}}},setup(o){const l=o,s=V(0),r=V(!1),n=V("https://frappecloud.com"),u=V(""),d=G(()=>s.value>1?"Trial ends in "+s.value+" days":"Trial ends tomorrow");K({url:"frappe.integrations.frappe_providers.frappecloud_billing.current_site_info",cache:"current_site_info_data",auto:!0,onSuccess:m=>{s.value=f(m.trial_end_date),n.value=m.base_url,u.value=m.site_name,r.value=m.plan.is_trial_plan&&s.value>0}});function f(m){if(!m)return 0;m=new Date(m);const b=m-new Date;return Math.ceil(b/(1e3*60*60*24))}function p(){var m;window.open(`${n.value}/dashboard/sites/${u.value}`,"_blank"),(m=l.afterUpgrade)==null||m.call(l)}return(m,_)=>!o.isSidebarCollapsed&&r.value?(a(),v("div",eo,[t("div",to,[t("div",lo,[i(Ie,{class:"h-4",name:"info"}),oe(" "+w(d.value),1)]),t("div",{class:"text-ink-gray-7 text-p-sm"},w(so))]),i(e(j),{label:"Upgrade plan",theme:"blue",onClick:p},{prefix:C(()=>[i(Dl,{class:"size-4"})]),_:1})])):o.isSidebarCollapsed&&r.value?(a(),B(e(j),{key:1,onClick:p},{default:C(()=>[i(Dl,{class:"h-4 my-0.5 shrink-0"})]),_:1})):S("",!0)}},Il=no,ao={class:"overflow-hidden text-ellipsis whitespace-nowrap"},oo={key:1,class:"ml-auto whitespace-nowrap pl-2 text-gray-600"},El=O({__name:"CPGroup",props:{item:{type:Object,required:!0},active:{type:Boolean,required:!0}},setup(o){return(l,s)=>(a(),v("div",{class:X(["flex w-full min-w-0 items-center rounded p-2 text-base font-medium text-gray-800",{"bg-gray-200":o.active}])},[o.item.icon?(a(),B(Ue(o.item.icon),{key:0,class:"mr-3 h-4 w-4 text-gray-700"})):S("",!0),t("span",ao,w(o.item.title)+"Â  ",1),o.item.modified?(a(),v("span",oo,w(e(Jl)(o.item.modified).fromNow(!0)),1)):S("",!0)],2))}}),io={class:"relative"},ro={class:"pl-4.5 absolute inset-y-0 left-0 flex items-center"},uo={key:0,class:"px-4.5 mb-2.5 text-base text-gray-600"},ss={__name:"CP",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o){const l=Rl();fl();const s=_e(o,"modelValue"),r=V(""),n=G(()=>{const g=[];return r.value.startsWith("#")?g.push({title:c("Go to Ticket #{0}",[r.value.slice(1)]),icon:()=>ne(Xt),route:{name:"TicketAgent",params:{ticketId:r.value.slice(1)}}}):g.push({title:c("Tickets"),icon:()=>ne(Xt),route:{name:"TicketsAgent"}}),g.push({title:c("Knowledge Base"),icon:()=>ne(rn),route:{name:De.value?"CustomerKnowledgeBase":"AgentKnowledgeBase"}}),{title:c("Jump to"),component:ne(El),items:g}}),u=G(()=>({title:c("Search"),hideTitle:!0,component:ne(El),items:[{title:c('Search for "{0}"',[r.value]),icon:()=>ne(un),route:{name:"SearchAgent",query:{q:r.value}}}]})),d=G(()=>{let g=[n.value];return r.value.length>2&&!De.value&&g.push(u.value),g}),f=g=>{r.value=g.target.value},p=g=>{g&&(l.push(g.route),_())},m=()=>{Ut({key:"k",meta:!0},b)};function _(){s.value=!1}function b(){s.value=!s.value}return ce(s,g=>{g&&(r.value="")}),Le(()=>{De.value||m()}),Os(()=>{_()}),(g,h)=>{const y=vl;return a(),B(e(Te),{modelValue:s.value,"onUpdate:modelValue":h[0]||(h[0]=k=>s.value=k),options:{size:"xl",position:"top"}},{body:C(()=>[t("div",null,[i(e(al),{nullable:"","onUpdate:modelValue":p},{default:C(()=>[t("div",io,[t("div",ro,[i(y,{class:"h-4 w-4"})]),i(e(ol),{placeholder:e(c)("Search tickets, emails, comments, or #234 to navigate to ticket"),class:"pl-11.5 pr-4.5 w-full border-none bg-transparent py-3 text-base text-gray-800 placeholder:text-gray-500 focus:ring-0",autocomplete:"off",onInput:f},null,8,["placeholder"])]),i(e(il),{class:"max-h-96 overflow-auto border-t border-gray-100",static:"",hold:!0},{default:C(()=>[(a(!0),v(N,null,W(d.value,k=>(a(),v("div",{key:k.title,class:"mt-4.5 mb-2 first:mt-3"},[k.hideTitle?S("",!0):(a(),v("div",uo,w(k.title),1)),(a(!0),v(N,null,W(k.items,D=>(a(),B(e(rl),{key:`${D.doctype}:${D.name}`,value:D,class:"px-2.5",disabled:D.disabled},{default:C(({active:M})=>[(a(),B(Ue(k.component),{item:D,active:M},null,8,["item","active"]))]),_:2},1032,["value","disabled"]))),128))]))),128))]),_:1})]),_:1})])]),_:1},8,["modelValue"])}}},co={},mo={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function po(o,l){return a(),v("svg",mo,[...l[0]||(l[0]=[t("path",{d:"M3 8.5C4.10457 8.5 5 9.39543 5 10.5C5 11.4316 4.3622 12.2113 3.5 12.4336V14C3.5 14.2761 3.27614 14.5 3 14.5C2.72386 14.5 2.5 14.2761 2.5 14V12.4336C1.6378 12.2113 1 11.4316 1 10.5C1 9.39543 1.89543 8.5 3 8.5ZM8 9.5C8.27614 9.5 8.5 9.72386 8.5 10V14C8.5 14.2761 8.27614 14.5 8 14.5C7.72386 14.5 7.5 14.2761 7.5 14V10C7.5 9.72386 7.72386 9.5 8 9.5ZM13 8.5C14.1046 8.5 15 9.39543 15 10.5C15 11.4316 14.3622 12.2113 13.5 12.4336V14C13.5 14.2761 13.2761 14.5 13 14.5C12.7239 14.5 12.5 14.2761 12.5 14V12.4336C11.6378 12.2113 11 11.4316 11 10.5C11 9.39543 11.8954 8.5 13 8.5ZM3 9.5C2.44772 9.5 2 9.94772 2 10.5C2 11.0523 2.44772 11.5 3 11.5C3.55228 11.5 4 11.0523 4 10.5C4 9.94772 3.55228 9.5 3 9.5ZM13 9.5C12.4477 9.5 12 9.94772 12 10.5C12 11.0523 12.4477 11.5 13 11.5C13.5523 11.5 14 11.0523 14 10.5C14 9.94772 13.5523 9.5 13 9.5ZM8 2C8.27614 2 8.5 2.22386 8.5 2.5V4.5C8.5 4.52163 8.49583 4.54257 8.49316 4.56348C9.35898 4.7833 10 5.56581 10 6.5C10 7.60457 9.10457 8.5 8 8.5C6.89543 8.5 6 7.60457 6 6.5C6 5.56614 6.64051 4.78362 7.50586 4.56348C7.50321 4.54261 7.5 4.52158 7.5 4.5V2.5C7.5 2.22386 7.72386 2 8 2ZM8 5.5C7.44772 5.5 7 5.94772 7 6.5C7 7.05228 7.44772 7.5 8 7.5C8.55228 7.5 9 7.05228 9 6.5C9 5.94772 8.55228 5.5 8 5.5ZM3 2C3.27614 2 3.5 2.22386 3.5 2.5V6.5C3.5 6.77614 3.27614 7 3 7C2.72386 7 2.5 6.77614 2.5 6.5V2.5C2.5 2.22386 2.72386 2 3 2ZM13 2C13.2761 2 13.5 2.22386 13.5 2.5V6.5C13.5 6.77614 13.2761 7 13 7C12.7239 7 12.5 6.77614 12.5 6.5V2.5C12.5 2.22386 12.7239 2 13 2Z",fill:"#525252"},null,-1)])])}const ns=Me(co,[["render",po]]),fo={},vo={width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function go(o,l){return a(),v("svg",vo,[...l[0]||(l[0]=[t("rect",{x:"0.75",y:"0.75",width:"30.5",height:"30.5",rx:"6.25",stroke:"currentColor","stroke-width":"1.5"},null,-1),t("path",{d:"M24.5011 14.1124C23.3954 12.4873 21.532 11.5477 19.594 11.6747C18.7616 10.1384 17.2211 9.12267 15.4198 9.0084C14.1651 8.93222 12.8979 9.3766 11.9165 10.24C11.2456 10.8367 10.7611 11.5223 10.463 12.2968C10.289 12.7539 9.89151 13.0459 9.46912 13.0459H6.5V15.5852H9.46912C10.9226 15.5852 12.2271 14.6584 12.7737 13.2237C12.9227 12.8301 13.1712 12.4873 13.5439 12.1571C14.0284 11.7255 14.662 11.4969 15.2583 11.535C16.1528 11.5985 16.7863 12.0175 17.1839 12.538C17.6063 13.0205 17.8423 13.7696 17.979 14.5187C18.774 14.2902 19.6437 14.0997 20.476 14.2394C21.1593 14.3536 21.7929 14.7218 22.2525 15.2678C22.327 15.3567 22.4016 15.4456 22.4637 15.5471C23.06 16.4232 23.1718 17.5024 22.7743 18.5689C22.414 19.5592 21.0847 20.4607 19.9791 20.4607H11.3326C10.1524 20.4607 9.18339 19.5592 9.03432 18.4038H6.54969C6.71119 20.9686 8.78585 23 11.3326 23H19.9915C22.1283 23 24.3769 21.451 25.1098 19.4704C25.7931 17.6167 25.5695 15.6614 24.5135 14.0997L24.5011 14.1124Z",fill:"currentColor"},null,-1)])])}const _o=Me(fo,[["render",go]]),ho={},yo={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function bo(o,l){return a(),v("svg",yo,[...l[0]||(l[0]=[ul('<path d="M10 11C12.2091 11 14 9.20914 14 7C14 4.79086 12.2091 3 10 3C7.79086 3 6 4.79086 6 7C6 9.20914 7.79086 11 10 11Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M10.3 15H7C5.93913 15 4.92172 15.4214 4.17157 16.1716C3.42143 16.9217 3 17.9391 3 19V21H11.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M22.166 13.834H14.8327C14.3264 13.834 13.916 14.2444 13.916 14.7507V20.2507C13.916 20.7569 14.3264 21.1673 14.8327 21.1673H22.166C22.6723 21.1673 23.0827 20.7569 23.0827 20.2507V14.7507C23.0827 14.2444 22.6723 13.834 22.166 13.834Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M23.0827 15.209L18.9714 17.8215C18.8299 17.9101 18.6663 17.9572 18.4993 17.9572C18.3324 17.9572 18.1688 17.9101 18.0273 17.8215L13.916 15.209" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><g clip-path="url(#clip0_368_1881)"><path d="M16.667 5H21.3337" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M19 2.66699V7.33366" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></g><defs><clipPath id="clip0_368_1881"><rect width="8" height="8" fill="white" transform="translate(15 1)"></rect></clipPath></defs>',6)])])}const ko=Me(ho,[["render",bo]]),xo={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-5 py-2.5"},wo={key:0,class:"divide-y text-base"},Co={class:"mb-2 leading-5"},$o={class:"space-x-1 text-gray-700"},Ao={class:"font-medium text-gray-900"},So={key:0},Vo={key:1},Do={key:2},Io={class:"font-medium text-gray-900"},Eo={class:"flex items-center gap-2"},Lo={class:"text-sm text-gray-600"},Bo={key:0,class:"h-1.5 w-1.5 rounded-full bg-blue-400"},To={key:1,class:"p-5 text-center text-gray-500 flex flex-col items-center justify-center gap-2 mt-20"},Mo=O({__name:"Notifications",setup(o){const l=Gl(),s=Wl(),r=V(null);Ps(r,()=>{l.visible&&l.toggle()},{ignore:["#notifications-btn"]});function n(d){l.toggle(),!d.read&&l.read(d.reference_ticket)}function u(d){switch(d.notification_type){case"Mention":return{name:"TicketAgent",params:{ticketId:d.reference_ticket},hash:"#"+d.reference_comment};case"Assignment":case"Reaction":return{name:"TicketAgent",params:{ticketId:d.reference_ticket}}}}return(d,f)=>{const p=dn,m=q("Button"),_=zs,b=q("RouterLink"),g=ql;return e(l).visible?(a(),v("span",{key:0,ref_key:"target",ref:r,class:"fixed z-10 h-screen overflow-auto bg-white",style:ft({"box-shadow":"8px 0px 8px rgba(0, 0, 0, 0.1)","max-width":"350px","min-width":"350px",left:e(s).width})},[t("div",xo,[f[2]||(f[2]=t("span",{class:"text-lg font-medium"},"Notifications",-1)),t("div",null,[e(l).data.length?(a(),B(m,{key:0,theme:"blue",variant:"ghost",onClick:f[0]||(f[0]=()=>e(l).clear.submit())},{icon:C(()=>[i(p,{class:"h-4 w-4"})]),_:1})):S("",!0),i(m,{theme:"gray",variant:"ghost",onClick:f[1]||(f[1]=()=>e(l).toggle())},{icon:C(()=>[i(_,{class:"h-4 w-4"})]),_:1})])]),e(l).data.length?(a(),v("div",wo,[(a(!0),v(N,null,W(e(l).data,h=>(a(),B(b,{key:h.name,class:"flex cursor-pointer items-start gap-3.5 px-5 py-2.5 hover:bg-gray-100",to:u(h),onClick:()=>{n(h)}},{default:C(()=>[i(e(el),{name:h.user_from},null,8,["name"]),t("span",null,[t("div",Co,[t("span",$o,[t("span",Ao,w(h.user_from),1),h.notification_type==="Mention"?(a(),v("span",So,"mentioned you in ticket")):S("",!0),h.notification_type==="Assignment"?(a(),v("span",Vo,"assigned you a ticket")):S("",!0),h.notification_type==="Reaction"?(a(),v("span",Do,"has reopened the ticket")):S("",!0),t("span",Io,w(h.reference_ticket),1)])]),t("div",Eo,[t("div",Lo,w(e(Jl).tz(h.creation).fromNow()),1),h.read?S("",!0):(a(),v("div",Bo))])])]),_:2},1032,["to","onClick"]))),128))])):(a(),v("div",To,[i(g,{class:"size-6"}),f[3]||(f[3]=t("p",{class:"text-base text-ink-gray-8"},"You are all caught up!",-1))]))],4)):S("",!0)}}}),Uo={class:"flex border-b pr-5"},Ro={class:"flex items-start justify-center"},No={__name:"AppHeader",setup(o){const{user:l}=et(),s=gl();return Le(()=>{s.fetchCallIntegrationStatus()}),(r,n)=>(a(),v("div",Uo,[n[0]||(n[0]=t("div",{id:"app-header",class:"flex-1 w-full"},null,-1)),t("div",Ro,[i(gn,{userEmail:e(l)},null,8,["userEmail"])])]))}},jo={class:"w-full grid grid-cols-2 gap-10 py-1 shortcutsModal"},Fo={class:"text-lg font-semibold text-ink-gray-9 mb-4"},Oo={class:"space-y-2"},Po={class:"text-ink-gray-7 text-base flex-1"},zo={class:"flex space-x-1 gap-1 justify-end"},ut="Shift",Ho=O({__name:"ShortcutsModal",props:Ve({modelValue:Boolean},{modelValue:{type:Boolean},modelModifiers:{}}),emits:Ve(["update:modelValue"],["update:modelValue"]),setup(o,{emit:l}){const s=_e(o,"modelValue"),{metaIcon:r}=fl(),n=G(()=>[{title:c("General"),shortcuts:[{keys:[r,"K"],description:c("Open command palette")},{keys:[r,","],description:c("Open settings")},{keys:[r,"/"],description:c("Show keyboard shortcuts")},{keys:[r,"H"],description:c("Open help")}]},{title:c("Ticket Management"),shortcuts:[{keys:["T"],description:c("Change ticket type")},{keys:["P"],description:c("Change priority")},{keys:[ut,"T"],description:c("Change team")},{keys:["A"],description:c("Assign ticket")},{keys:["S"],description:c("Change status")},{keys:[r,"."],description:c("Copy ticket id")},{keys:[r,ut,"."],description:c("Copy ticket URL")}]},{title:c("Communication"),shortcuts:[{keys:["R"],description:c("Open reply box")},{keys:["C"],description:c("Open comment box")}],hideBorder:!0},{title:c("Navigation"),shortcuts:[{keys:[ut,">"],description:c("Next ticket")},{keys:[ut,"<"],description:c("Previous ticket")}],hideBorder:!0}]);return Le(()=>{De.value||Ut({key:"/",meta:!0},()=>{s.value=!s.value})}),(u,d)=>(a(),B(e(Te),{modelValue:s.value,"onUpdate:modelValue":d[0]||(d[0]=f=>s.value=f),options:{title:e(c)("Keyboard Shortcuts"),size:"4xl"}},{"body-content":C(()=>[t("div",jo,[(a(!0),v(N,null,W(n.value,f=>(a(),v("div",{key:f.title,class:X(["pb-4",!f.hideBorder&&"border-b border-outline-gray-2"])},[t("h2",Fo,w(f.title),1),t("ul",Oo,[(a(!0),v(N,null,W(f.shortcuts,(p,m)=>(a(),v("li",{key:m,class:"flex items-start justify-between gap-4"},[t("div",Po,w(p.description),1),t("div",zo,[(a(!0),v(N,null,W(p.keys,(_,b)=>(a(),v("span",{key:b,class:X(["bg-surface-gray-2 border border-outline-gray-2 text-xs rounded-sm text-ink-gray-8 shadow-sm min-w-5 h-5 flex items-center justify-center",[![e(r),ut].includes(_)&&"w-5 ",_===ut&&"!px-2"]])},w(_),3))),128))])]))),128))])],2))),128))])]),_:1},8,["modelValue","options"]))}});const qo={name:"ConfirmDialog",props:{title:{type:String},message:{type:String},onConfirm:{type:Function,default:null},onCancel:{type:Function,default:null}},expose:["show","hide"],components:{Dialog:Te,Button:j},data(){return{showDialog:!0,isLoading:!1}},methods:{async handleConfirmation(){if(!this.isLoading){this.isLoading=!0;try{this.onConfirm&&await this.onConfirm({hideDialog:this.hide}),this.hide()}catch(o){console.error("Error in confirmation:",o)}finally{this.isLoading=!1}}},show(){this.showDialog=!0},closeDialog(){var o;this.hide(),(o=this.onCancel)==null||o.call(this)},hide(){this.showDialog=!1}}},Qo={class:"space-y-4"},Jo=["innerHTML"];function Go(o,l,s,r,n,u){const d=q("Button"),f=q("Dialog");return a(),B(f,{modelValue:n.showDialog,"onUpdate:modelValue":l[0]||(l[0]=p=>n.showDialog=p),options:{title:s.title},onClose:u.closeDialog},{"body-content":C(()=>[t("div",Qo,[s.message?(a(),v("p",{key:0,class:"text-p-base text-gray-800",innerHTML:s.message},null,8,Jo)):S("",!0)])]),actions:C(()=>[i(d,{class:"w-full",label:"Confirm",variant:"solid",loading:n.isLoading,onClick:s.onConfirm},null,8,["loading","onClick"])]),_:1},8,["modelValue","options","onClose"])}const We=Me(qo,[["render",Go]]),Lt=20,ye=tt({doctype:"HD Agent",fields:["name","user_image","agent_name","is_active"],start:0,pageLength:Lt,orderBy:"creation desc",auto:!De.value}),nt=V("Active");V(!1);const Wo=()=>{const o=V(""),l=Ge({});ce(o,r=>{ye.filters={agent_name:["like",`%${r}%`],...l},r||(ye.filters={...l},ye.start=0,ye.pageLength=Lt),ye.reload()}),ce(l,r=>{ye.filters={...ye.filters,...r},ye.start=0,ye.pageLength=Lt,ye.reload()},{deep:!0}),ce(nt,r=>{r==="Active"?ye.filters={...ye.filters,is_active:1}:r==="Inactive"?ye.filters={...ye.filters,is_active:0}:ye.filters={...ye.filters,is_active:["in",[0,1]]},ye.start=0,ye.pageLength=Lt,ye.reload()},{immediate:!0});async function s(r,n){await K({url:"frappe.client.set_value",params:{doctype:"HD Agent",name:r,fieldname:"is_active",value:n}}).submit()}return{search:o,agents:ye,filters:l,updateAgent:s}},Zo={},Yo={xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 28 28",fill:"none"};function Ko(o,l){return a(),v("svg",Yo,[...l[0]||(l[0]=[t("g",null,[t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M14 4.26331C15.9848 4.26331 17.5938 5.87228 17.5938 7.85706C17.5938 9.84183 15.9848 11.4508 14 11.4508C12.0152 11.4508 10.4063 9.84183 10.4063 7.85706C10.4063 5.87228 12.0152 4.26331 14 4.26331ZM13.7637 12.4449L14 12.4508C16.4578 12.4508 18.4649 10.5206 18.5879 8.09338L18.5938 7.85706C18.5938 5.39926 16.6636 3.39216 14.2363 3.26917L14 3.26331C11.463 3.26331 9.40627 5.32 9.40627 7.85706L9.41213 8.09338C9.53116 10.4423 11.4147 12.3259 13.7637 12.4449ZM11.999 14.4264L11.8643 14.1383H11.5459C8.15643 14.1385 5.22182 16.4927 4.48635 19.8014L4.32424 20.5319C3.78771 22.9462 5.62447 25.2367 8.09768 25.2369H19.9024C22.3758 25.2369 24.2133 22.9464 23.6768 20.5319L23.5147 19.8014C22.7792 16.4925 19.8438 14.1383 16.4541 14.1383H16.1358L16.001 14.4264L14 18.7067L11.999 14.4264ZM14 20.3883C14.1941 20.3883 14.3709 20.276 14.4531 20.1002L16.7676 15.1461C19.5547 15.2852 21.9272 17.2701 22.5381 20.0192L22.7002 20.7487C23.098 22.5386 21.736 24.2369 19.9024 24.2369H8.09768C6.26422 24.2367 4.90208 22.5385 5.29982 20.7487L5.46193 20.0192C6.07273 17.2706 8.44503 15.2859 11.2315 15.1461L13.5469 20.1002C13.6291 20.276 13.806 20.3882 14 20.3883Z",fill:"#525252"})],-1)])])}const as=Me(Zo,[["render",Ko]]),Xo={class:"flex flex-col h-full w-full pb-8"},ei={class:"px-10 py-8"},ti={class:"flex items-start justify-between"},li={class:"flex flex-col gap-1"},si={class:"text-lg font-semibold text-ink-gray-8"},ni={class:"text-p-sm text-gray-700 max-w-md text-ink-gray-6"},ai={key:0,class:"mt-6"},oi={class:"px-10 pb-8 overflow-y-auto h-full flex flex-col"},he=O({__name:"SettingsLayoutBase",props:{title:{type:String},description:{type:String}},setup(o){return(l,s)=>(a(),v("div",Xo,[t("div",ei,[t("div",ti,[t("div",li,[Ce(l.$slots,"title",{},()=>[t("h1",si,w(o.title),1)]),l.$slots.description||o.description?Ce(l.$slots,"description",{key:0},()=>[t("p",ni,w(o.description),1)]):S("",!0)]),l.$slots["header-actions"]?Ce(l.$slots,"header-actions",{key:0}):S("",!0)]),l.$slots["header-bottom"]?(a(),v("div",ai,[Ce(l.$slots,"header-bottom")])):S("",!0)]),t("div",oi,[Ce(l.$slots,"content")])]))}}),ii={class:"flex items-center gap-2 justify-between"},ri={class:"relative grow"},ui=["onClick"],di={class:"flex items-center justify-between flex-1"},ci={class:"whitespace-nowrap"},mi={class:"grow"},pi={key:0,class:"flex mt-28 justify-between w-full h-full"},fi={key:1,class:"flex flex-col items-center justify-center gap-4 h-full"},vi={class:"p-4 size-14.5 rounded-full bg-surface-gray-1 flex items-center justify-center"},gi={class:"flex flex-col items-center gap-1"},_i={class:"text-base font-medium text-ink-gray-6"},hi={class:"text-p-sm text-ink-gray-5 max-w-60 text-center"},yi={key:2,class:"w-full"},bi={class:"grid grid-cols-8 items-center gap-3 text-sm text-gray-600"},ki={class:"col-span-6 text-p-sm"},xi={class:"flex items-center justify-between h-14 group rounded"},wi={class:"flex items-center space-x-3 grow"},Ci={class:"flex items-center gap-2"},$i={class:"text-base"},Ai={class:"text-base text-ink-gray-6 mt-1"},Si={class:"flex items-center gap-2"},Vi={key:0},Di={class:"flex justify-center"},Ii=O({__name:"Agents",setup(o){const{getUserRole:l,updateUserRoleCache:s}=dl(),{isManager:r}=et(),n=Wo(),u=n.search,d=n.agents;function f(g){const h=l(g),y=[{label:"Agent",component:k=>p({role:"Agent",active:k.active,selected:h==="Agent",icon:"user",onClick:()=>{m(g,"Agent")}})}];return r&&y.unshift({label:"Manager",component:k=>p({role:"Manager",active:k.active,selected:h==="Manager",icon:"briefcase",onClick:()=>{m(g,"Manager")}})}),y}function p({active:g,role:h,onClick:y,selected:k,icon:D=null}){return ne("button",{class:[g?"bg-surface-gray-2":"text-ink-gray-7","group flex w-full text-ink-gray-8 justify-between items-center rounded-md px-2 py-2 text-sm hover:bg-surface-gray-3"],onClick:k?null:y},[ne("div",{class:"flex gap-2"},[D?ne(Ie,{name:D,class:["h-4 w-4 shrink-0"],"aria-hidden":!0}):null,ne("span",{class:"whitespace-nowrap"},h)]),k?ne(Hs,{class:["h-4 w-4 shrink-0 text-ink-gray-7"],"aria-hidden":!0}):null])}function m(g,h){l(g)!==h&&Je("helpdesk.helpdesk.doctype.hd_agent.hd_agent.update_agent_role",{user:g,new_role:h}).then(()=>{s(g,h),H.success(`Role updated to ${h}`)})}function _(g){let h=n.filters;return[{label:"Disable Agent",icon:"x-circle",onClick:async()=>{await n.updateAgent(g.name,0),d.reload({...h,search:u.value})},condition:()=>g.is_active},{label:"Enable Agent",icon:"check-circle",onClick:async()=>{await n.updateAgent(g.name,1),d.reload({...h,search:u.value})},condition:()=>!g.is_active}]}const b=[{label:"All",onClick:()=>{n.filters.is_active=["in",[0,1]],nt.value="All"}},{label:"Active",onClick:()=>{n.filters.is_active=["=",1],nt.value="Active"}},{label:"Inactive",onClick:()=>{n.filters.is_active=["=",0],nt.value="Inactive"}}];return qe(()=>{d.filters={}}),(g,h)=>{const y=Zl,k=q("Input"),D=q("Badge");return a(),B(he,{title:g.__("Agents"),description:g.__("Add, manage agents and assign roles to them.")},{"header-actions":C(()=>[i(e(j),{onClick:h[0]||(h[0]=()=>e(Pe)("Invite Agents")),label:"New",variant:"solid"},{prefix:C(()=>[i(y,{class:"h-4 w-4 stroke-1.5"})]),_:1})]),"header-bottom":C(()=>[t("div",ii,[t("div",ri,[i(k,{"model-value":e(u),onInput:h[1]||(h[1]=M=>u.value=M),placeholder:g.__("Search"),type:"text",class:"bg-white hover:bg-white focus:ring-0 border-outline-gray-2","icon-left":"search",debounce:"300",inputClass:"p-4 pr-12"},null,8,["model-value","placeholder"]),e(u)?(a(),B(e(j),{key:0,icon:"x",variant:"ghost",onClick:h[2]||(h[2]=M=>u.value=""),class:"absolute right-1 top-1/2 -translate-y-1/2"})):S("",!0)]),i(e(be),{options:b,placement:"right"},{default:C(({open:M})=>[i(e(j),{label:e(nt),class:"flex items-center justify-between w-fit p-4"},{suffix:C(()=>[i(e(Ie),{name:M?"chevron-up":"chevron-down",class:"h-4"},null,8,["name"])]),_:2},1032,["label"])]),item:C(({item:M})=>[t("button",{class:"group flex text-ink-gray-6 gap-4 h-7 w-full justify-between items-center rounded p-2 text-base hover:bg-surface-gray-3",onClick:M.onClick},[t("div",di,[t("span",ci,w(M.label),1),e(nt)===M.label?(a(),B(e(Ie),{key:0,name:"check",class:"size-4 text-ink-gray-7"})):S("",!0)])],8,ui)]),_:1})])]),content:C(()=>{var M,L;return[t("div",mi,[e(d).loading?(a(),v("div",pi,[i(e(j),{loading:e(d).loading,variant:"ghost",class:"w-full",size:"2xl"},null,8,["loading"])])):S("",!0),!e(d).loading&&!((M=e(d).data)!=null&&M.length)?(a(),v("div",fi,[t("div",vi,[i(as,{class:"size-6 text-ink-gray-6"})]),t("div",gi,[t("div",_i,w(g.__("No agent found")),1),t("div",hi,w(e(nt).length?g.__("Change your search terms or filters"):g.__("Add one to get started.")),1)]),i(e(j),{label:g.__("New"),variant:"outline","icon-left":"plus",onClick:h[3]||(h[3]=T=>e(Pe)("Invite Agents"))},null,8,["label"])])):S("",!0),!e(d).loading&&((L=e(d).data)!=null&&L.length)?(a(),v("div",yi,[t("div",bi,[t("div",ki,w(g.__("Agent Name")),1)]),h[5]||(h[5]=t("hr",{class:"mt-2"},null,-1)),(a(!0),v(N,null,W(e(d).data,(T,x)=>(a(),v("div",{key:T.agent_name},[t("div",xi,[t("div",wi,[i(e(lt),{image:T.user_image,label:T.agent_name,size:"xl"},null,8,["image","label"]),t("div",null,[t("div",Ci,[t("p",$i,w(T.agent_name),1),i(D,{label:g.__("Inactive"),theme:"gray",class:X(T.is_active?"opacity-0":"opacity-100"),variant:"subtle"},null,8,["label","class"])]),t("div",Ai,w(T.name),1)])]),t("div",Si,[e(r)?(a(),B(e(be),{key:0,class:"flex justify-end items-center",options:f(T.name),label:e(l)(T.name),button:{label:e(l)(T.name),iconRight:"chevron-down",iconLeft:e(l)(T.name)==="Agent"?"user":e(l)(T.name)==="Manager"?"briefcase":null},placement:"right"},null,8,["options","label","button"])):S("",!0),(a(),B(e(be),{options:_(T),key:T,class:"ml-2",placement:"right"},{default:C(()=>[i(e(j),{icon:"more-horizontal",variant:"ghost"})]),_:1},8,["options"]))])]),x!==e(d).data.length-1?(a(),v("hr",Vi)):S("",!0)]))),128)),t("div",Di,[!e(d).loading&&e(d).hasNextPage?(a(),B(e(j),{key:0,class:"mt-3.5 p-2",onClick:h[4]||(h[4]=()=>e(d).next()),loading:e(d).loading,label:g.__("Load More"),"icon-left":"refresh-cw"},null,8,["loading","label"])):S("",!0)])])):S("",!0)])]}),_:1},8,["title","description"])}}}),os="/assets/helpdesk/desk/assets/gmail-6497f877.png",is="/assets/helpdesk/desk/assets/outlook-e028ee9b.png",rs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwMAAALUBAMAAAClQPMzAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAlwSFlzAAAuIwAALiMBeKU/dgAAACRQTFRFR3BMNqzpdMXvXb3tr+f3o+P1AJ/ZGoPjALPjmeH1dc3uBqfjM5e/jQAAAAZ0Uk5TAPVwwVLTgnc47wAABIBJREFUeNrt1rEJwlAYhdEHNpZa2UpwAxewcAXtbdJYpQo4gATsBVdwAOcTd/DyknC+9zY4XPhLkSRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJGmGL/cTazo5gOWR69KFWCBAgQIAAAQIECBAgmArBHYEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAIGLCIEVIECAAAECBC4iBFaAAAECBAgQuIgQWAECBAgQIEDgIkJgBQgQIECAAMHfO4U6X9tP4reb9aX77/v9rqtH8Ar1bEOl1oWgNsGAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAjqEfShbu9QTajD/AhS8yqzCwECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIKheE2p3DFUkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZLG2Bet4fvU2eVggAAAAABJRU5ErkJggg==",us="/assets/helpdesk/desk/assets/sparkpost-3d6653ba.webp",ds="/assets/helpdesk/desk/assets/yahoo-bf2216d3.png",cs="/assets/helpdesk/desk/assets/yandex-5e1e6be8.png",ms="/assets/helpdesk/desk/assets/frappe-mail-579163d7.svg",ps=[{label:"Account Name",name:"email_account_name",type:"text",placeholder:"Support / Sales"},{label:"Email ID",name:"email_id",type:"email",placeholder:"johndoe@example.com"}],fs=[{label:"Enable Incoming",name:"enable_incoming",type:"checkbox",description:"If enabled, tickets can be created from the incoming emails on this account."},{label:"Enable Outgoing",name:"enable_outgoing",type:"checkbox",description:"If enabled, outgoing emails can be sent from this account."},{label:"Default Incoming",name:"default_incoming",type:"checkbox",description:"If enabled, all replies to your company (eg: replies@yourcomany.com) will come to this account. Note: Only one account can be default incoming."},{label:"Default Outgoing",name:"default_outgoing",type:"checkbox",description:"If enabled, all outgoing emails will be sent from this account. Note: Only one account can be default outgoing."}],vs=[...ps,{label:"Password",name:"password",type:"password",placeholder:"********"}],gs=[...ps,{label:"Frappe Mail Site",name:"frappe_mail_site",type:"text",placeholder:"https://frappemail.com"},{label:"API Key",name:"api_key",type:"text",placeholder:"********"},{label:"API Secret",name:"api_secret",type:"password",placeholder:"********"}],_s=[{name:"GMail",icon:os,info:`Setting up GMail requires you to enable two factor authentication
		  and app specific passwords. Read more`,link:"https://support.google.com/accounts/answer/185833",custom:!1},{name:"Outlook",icon:is,info:`Setting up Outlook requires you to enable two factor authentication
		  and app specific passwords. Read more`,link:"https://support.microsoft.com/en-us/account-billing/how-to-get-and-use-app-passwords-5896ed9b-4263-e681-128a-a6f2979a7944",custom:!1},{name:"Sendgrid",icon:rs,info:`Setting up Sendgrid requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://sendgrid.com/docs/ui/account-and-settings/two-factor-authentication/",custom:!1},{name:"SparkPost",icon:us,info:`Setting up SparkPost requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://support.sparkpost.com/docs/my-account-and-profile/enabling-two-factor-authentication",custom:!1},{name:"Yahoo",icon:ds,info:`Setting up Yahoo requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://help.yahoo.com/kb/SLN15241.html",custom:!1},{name:"Yandex",icon:cs,info:`Setting up Yandex requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://yandex.com/support/id/authorization/app-passwords.html",custom:!1},{name:"Frappe Mail",icon:ms,info:"Setting up Frappe Mail requires you to have an API key and API Secret of your email account. Read more ",link:"https://github.com/frappe/mail",custom:!0}],hs={GMail:os,Outlook:is,Sendgrid:rs,SparkPost:us,Yahoo:ds,Yandex:cs,"Frappe Mail":ms};function ys(o,l){if(!o.email_account_name)return"Account name is required";if(!o.email_id)return"Email ID is required";if(!qs(o.email_id))return"Invalid email ID";if(!l&&!o.password)return"Password is required";if(l){if(!o.api_key)return"API Key is required";if(!o.api_secret)return}return""}const Ei=["src"],Li={key:0,class:"text-center text-p-xs text-gray-700"},yl=O({__name:"EmailProviderIcon",props:{serviceName:{default:""},logo:{default:""},selected:{type:Boolean,default:!1}},setup(o){return(l,s)=>(a(),v(N,null,[t("div",{class:X(["flex size-8 cursor-pointer items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200",{"ring-2 ring-blue-500":o.selected}])},[t("img",{src:o.logo,class:"size-4.5"},null,8,Ei)],2),o.serviceName?(a(),v("p",Li,w(o.serviceName),1)):S("",!0)],64))}}),Bi={class:"flex h-full flex-col gap-4"},Ti={class:"flex flex-col gap-4 overflow-y-auto p-0.5"},Mi={class:"flex flex-wrap items-center gap-4"},Ui=["onClick"],Ri={key:0,class:"flex flex-col gap-4"},Ni={class:"flex items-center gap-2 rounded-md p-2 ring-1 ring-gray-200"},ji={class:"text-wrap text-xs text-gray-700"},Fi=["href"],Oi={class:"flex flex-col gap-4"},Pi={class:"grid grid-cols-1 gap-4"},zi={class:"grid grid-cols-2 gap-4"},Hi={class:"text-gray-500 text-p-sm"},qi={class:"mt-auto flex justify-between -mb-8"},Qi=O({__name:"EmailAdd",emits:["update:step"],setup(o,{emit:l}){const s=l,{updateOnboardingStep:r}=it("helpdesk"),n=Ge({service:"",email_account_name:"",email_id:"",password:"",api_key:"",api_secret:"",frappe_mail_site:"",enable_incoming:!1,enable_outgoing:!1,default_incoming:!1,default_outgoing:!1}),u=V(null),d=G(()=>u.value.custom?gs:vs);function f(b){u.value=b,n.service=b.name}const p=K({url:"helpdesk.api.settings.email.create_email_account",makeParams:b=>({...b}),onSuccess:()=>{H.success(c("Email account created")),s("update:step","email-list"),r("setup_email_account")},onError:()=>{m.value=c("Failed to create email account, Invalid credentials")}}),m=V();function _(){m.value=ys(n,u.value.custom),!m.value&&p.submit({data:n})}return(b,g)=>{const h=q("FormControl"),y=q("ErrorMessage"),k=q("Button");return a(),B(he,{title:e(c)("Setup Email"),description:e(c)("Choose the email service provider you want to configure.")},{content:C(()=>[t("div",Bi,[t("div",Ti,[t("div",Mi,[(a(!0),v(N,null,W(e(_s),D=>{var M;return a(),v("div",{key:D.name,class:"min-w-3 flex flex-col items-center gap-1",onClick:L=>f(D)},[i(yl,{"service-name":D.name,logo:D.icon,selected:((M=u.value)==null?void 0:M.name)===(D==null?void 0:D.name)},null,8,["service-name","logo","selected"])],8,Ui)}),128))]),u.value?(a(),v("div",Ri,[t("div",null,[t("div",Ni,[i(e(It),{class:"h-6 w-5 w-min-5 w-max-5 min-h-5 max-w-5 text-blue-500"}),t("div",ji,[oe(w(u.value.info)+" ",1),t("a",{href:u.value.link,target:"_blank",class:"text-blue-500 underline"},"here",8,Fi),g[1]||(g[1]=oe(" . ",-1))])])]),t("div",Oi,[t("div",Pi,[(a(!0),v(N,null,W(d.value,D=>(a(),v("div",{key:D.name,class:"flex flex-col gap-1"},[i(h,{modelValue:n[D.name],"onUpdate:modelValue":M=>n[D.name]=M,label:D.label,name:D.name,type:D.type,placeholder:D.placeholder},null,8,["modelValue","onUpdate:modelValue","label","name","type","placeholder"])]))),128))]),t("div",zi,[(a(!0),v(N,null,W(e(fs),D=>(a(),v("div",{key:D.name,class:"flex flex-col gap-1"},[i(h,{modelValue:n[D.name],"onUpdate:modelValue":M=>n[D.name]=M,label:D.label,name:D.name,type:D.type},null,8,["modelValue","onUpdate:modelValue","label","name","type"]),t("p",Hi,w(D.description),1)]))),128))]),m.value?(a(),B(y,{key:0,class:"ml-1",message:m.value},null,8,["message"])):S("",!0)])])):S("",!0)]),t("div",qi,[i(k,{label:e(c)("Back"),theme:"gray",variant:"outline",disabled:e(p).loading,onClick:g[0]||(g[0]=D=>s("update:step","email-list"))},null,8,["label","disabled"]),i(k,{label:e(c)("Create"),variant:"solid",loading:e(p).loading,onClick:_},null,8,["label","loading"])])])]),_:1},8,["title","description"])}}}),Ji={class:"flex justify-between items-center border-gray-200 p-2 cursor-pointer hover:bg-gray-50 rounded h-14"},Gi={class:"flex justify-between items-center gap-2"},Wi={class:"text-base text-ink-gray-7 font-medium"},Zi={class:"text-sm w-full text-ink-gray-5 mt-1"},Yi=O({__name:"EmailAccountCard",props:{emailAccount:{}},setup(o){const l=o,s=G(()=>{if(l.emailAccount.default_incoming&&l.emailAccount.default_outgoing){const r=l.emailAccount.enable_incoming&&l.emailAccount.enable_outgoing?"blue":"gray";return[c("Default Sending and Inbox"),r]}else if(l.emailAccount.default_incoming){const r=l.emailAccount.enable_incoming?"blue":"gray";return[c("Default Inbox"),r]}else if(l.emailAccount.default_outgoing){const r=l.emailAccount.enable_outgoing?"blue":"gray";return[c("Default Sending"),r]}else{const r=l.emailAccount.enable_incoming?"blue":"gray";return[c("Inbox"),r]}});return(r,n)=>{const u=q("Badge");return a(),v("div",Ji,[t("div",Gi,[i(yl,{logo:e(hs)[o.emailAccount.service]},null,8,["logo"]),t("div",null,[t("p",Wi,w(o.emailAccount.email_account_name),1),t("div",Zi,w(o.emailAccount.email_id),1)])]),t("div",null,[i(u,{variant:"subtle",label:s.value[0],theme:s.value[1]},null,8,["label","theme"])])])}}}),Ki={key:0,class:"-ml-2 grow"},Xi={class:"flex text-sm text-gray-600"},er={class:"ml-2"},tr={key:1,class:"flex flex-col items-center justify-center gap-4 h-full"},lr={class:"p-4 size-14.5 rounded-full bg-surface-gray-1 flex justify-center items-center"},sr={class:"flex flex-col items-center gap-1"},nr={class:"text-base font-medium text-ink-gray-6"},ar={class:"text-p-sm text-ink-gray-5 max-w-60 text-center"},or=O({__name:"EmailAccountList",emits:["update:step"],setup(o,{emit:l}){const s=l,r=tt({doctype:"Email Account",cache:["Email Accounts"],fields:["*"],filters:{email_id:["Not Like","%example%"]},pageLength:10,auto:!0,onSuccess:n=>{n.forEach(u=>{u.enable_incoming=!!u.enable_incoming,u.enable_outgoing=!!u.enable_outgoing,u.default_incoming=!!u.default_incoming,u.default_outgoing=!!u.default_outgoing})}});return(n,u)=>{const d=q("Button"),f=Cn;return a(),B(he,{title:n.__("Email Accounts"),description:n.__("Manage your email accounts and configure incoming and outgoing settings.")},{"header-actions":C(()=>[i(d,{label:n.__("New"),theme:"gray",variant:"solid",onClick:u[0]||(u[0]=p=>s("update:step","email-add")),"icon-left":"plus"},null,8,["label"])]),content:C(()=>{var p;return[!e(r).loading&&((p=e(r).data)!=null&&p.length)?(a(),v("div",Ki,[t("div",Xi,[t("div",er,w(n.__("Email Account name")),1)]),u[3]||(u[3]=t("hr",{class:"mx-2 mt-2"},null,-1)),(a(!0),v(N,null,W(e(r).data,m=>(a(),v("div",{key:m.name},[i(Yi,{emailAccount:m,onClick:_=>s("update:step","email-edit",m)},null,8,["emailAccount","onClick"]),u[2]||(u[2]=t("hr",{class:"mx-2"},null,-1))]))),128))])):(a(),v("div",tr,[t("div",lr,[i(f,{class:"size-6 text-ink-gray-6"})]),t("div",sr,[t("div",nr,w(n.__("No email account found")),1),t("div",ar,w(n.__("Add one to get started.")),1)]),i(d,{label:n.__("New"),variant:"outline","icon-left":"plus",onClick:u[1]||(u[1]=m=>s("update:step","email-add"))},null,8,["label"])]))]}),_:1},8,["title","description"])}}}),ir={class:"flex h-full flex-col gap-4"},rr={class:"overflow-y-auto flex flex-col gap-4 p-0.5"},ur={class:"w-fit"},dr={class:"flex items-center gap-2 rounded-md p-2 ring-1 ring-gray-200"},cr={class:"text-wrap text-xs text-gray-700"},mr=["href"],pr={class:"flex flex-col gap-4"},fr={class:"grid grid-cols-1 gap-4"},vr={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},gr={class:"text-p-sm text-gray-500"},_r={class:"mt-auto flex justify-between -mb-8"},hr={class:"flex gap-2"},yr=O({__name:"EmailEdit",props:{accountData:{default:null}},emits:["update:step"],setup(o,{emit:l}){var L,T,x,I;const s=o,r=l,n=Ge({email_account_name:s.accountData.email_account_name||"",service:s.accountData.service||"",email_id:s.accountData.email_id||"",api_key:((L=s.accountData)==null?void 0:L.api_key)||null,api_secret:((T=s.accountData)==null?void 0:T.api_secret)||null,password:((x=s.accountData)==null?void 0:x.password)||null,frappe_mail_site:((I=s.accountData)==null?void 0:I.frappe_mail_site)||"",enable_incoming:s.accountData.enable_incoming||!1,enable_outgoing:s.accountData.enable_outgoing||!1,default_outgoing:s.accountData.default_outgoing||!1,default_incoming:s.accountData.default_incoming||!1}),u={description:c("To know more about setting up email accounts, click"),link:"https://docs.erpnext.com/docs/user/manual/en/email-account"},d=G(()=>_s.find(A=>A.name===s.accountData.service).custom),f=G(()=>d.value?gs:vs),p=V(),m=V(!1),_=Qs(`loading-emails-${n.email_account_name}`,!1);async function b(){if(p.value=ys(n,d.value),p.value)return;const A={...s.accountData},$={...n},E=A.email_account_name!==$.email_account_name;delete A.email_account_name,delete $.email_account_name;const Q=h.value,F=$;if(!E&&!Q){H.create({message:c("No changes made"),icon:ne(It,{class:"text-ink-blue-2"})});return}if(E)try{m.value=!0,await y(),D()}catch{M()}if(Q)try{m.value=!0,await k(F),D()}catch{M()}}function g(){_.value=!0,H.create({message:c("Pulling emails, this may take a few minutes."),icon:ne(It,{class:"text-blue-500"})}),Je("frappe.email.doctype.email_account.email_account.pull_emails",{email_account:n.email_account_name}).then(()=>{localStorage.removeItem(`loading-emails-${n.email_account_name}`),_.value=null,H.success(c("Emails pulled successfully"))}).catch(()=>{localStorage.removeItem(`loading-emails-${n.email_account_name}`),_.value=null,p.value=c("Failed to pull emails")})}const h=G(()=>n.email_id!==s.accountData.email_id||n.api_key!==s.accountData.api_key||n.api_secret!==s.accountData.api_secret||n.password!==s.accountData.password||n.enable_incoming!==s.accountData.enable_incoming||n.enable_outgoing!==s.accountData.enable_outgoing||n.default_outgoing!==s.accountData.default_outgoing||n.default_incoming!==s.accountData.default_incoming||n.frappe_mail_site!==s.accountData.frappe_mail_site);async function y(){return await Je("frappe.client.rename_doc",{doctype:"Email Account",old_name:s.accountData.email_account_name,new_name:n.email_account_name})}async function k(A){return(await Je("frappe.client.set_value",{doctype:"Email Account",name:n.email_account_name,fieldname:A})).name}function D(){r("update:step","email-list"),H.success(c("Email account updated successfully"))}function M(){m.value=!1,p.value=c("Failed to update email account, Invalid credentials")}return(A,$)=>{const E=q("FormControl"),Q=q("ErrorMessage"),F=q("Button");return a(),B(he,{title:e(c)("Edit Email"),description:e(c)("Edit your email account")},{content:C(()=>[t("div",ir,[t("div",rr,[t("div",ur,[i(yl,{logo:e(hs)[o.accountData.service],"service-name":o.accountData.service},null,8,["logo","service-name"])]),t("div",dr,[i(e(It),{class:"h-6 w-5 w-min-5 w-max-5 min-h-5 max-w-5 text-ink-blue-2"}),t("div",cr,[oe(w(u.description)+" ",1),t("a",{href:u.link,target:"_blank",class:"text-ink-blue-2 underline"},"here",8,mr),$[1]||($[1]=oe(" . ",-1))])]),t("div",pr,[t("div",fr,[(a(!0),v(N,null,W(f.value,Y=>(a(),v("div",{key:Y.name,class:"flex flex-col gap-1"},[i(E,{modelValue:n[Y.name],"onUpdate:modelValue":z=>n[Y.name]=z,label:Y.label,name:Y.name,type:Y.type,placeholder:Y.placeholder},null,8,["modelValue","onUpdate:modelValue","label","name","type","placeholder"])]))),128))]),t("div",vr,[(a(!0),v(N,null,W(e(fs),Y=>(a(),v("div",{key:Y.name,class:"flex flex-col gap-1"},[i(E,{modelValue:n[Y.name],"onUpdate:modelValue":z=>n[Y.name]=z,label:Y.label,name:Y.name,type:Y.type},null,8,["modelValue","onUpdate:modelValue","label","name","type"]),t("p",gr,w(Y.description),1)]))),128))]),p.value?(a(),B(Q,{key:0,class:"ml-1",message:p.value},null,8,["message"])):S("",!0)])]),t("div",_r,[i(F,{label:e(c)("Back"),theme:"gray",variant:"outline",disabled:m.value,onClick:$[0]||($[0]=Y=>r("update:step","email-list"))},null,8,["label","disabled"]),t("div",hr,[i(F,{label:e(c)("Update Account"),variant:"solid",onClick:b,loading:m.value},null,8,["label","loading"]),o.accountData.enable_incoming?(a(),B(F,{key:0,label:e(c)("Pull Emails"),variant:"subtle",onClick:g,loading:e(_),disabled:m.value},null,8,["label","loading","disabled"])):S("",!0)])])])]),_:1},8,["title","description"])}}}),br={key:0,class:"h-full"},kr={key:1,class:"h-full"},xr={key:2,class:"h-full"},wr=O({__name:"EmailConfig",setup(o){const l=V("email-list"),s=V(null);function r(n,u){l.value=n,s.value=u}return(n,u)=>l.value==="email-add"?(a(),v("div",br,[i(Qi,{"onUpdate:step":r})])):l.value==="email-list"?(a(),v("div",kr,[i(or,{"onUpdate:step":r})])):l.value==="email-edit"?(a(),v("div",xr,[i(yr,{"account-data":s.value,"onUpdate:step":r},null,8,["account-data"])])):S("",!0)}}),bs=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],P=V({assignCondition:"",unassignCondition:"",assignConditionJson:[],unassignConditionJson:[],rule:"Round Robin",priority:1,users:[],disabled:!1,description:"",name:"",assignmentRuleName:"",assignmentDays:bs}),bl=()=>{P.value={assignCondition:"",unassignCondition:"",assignConditionJson:[],unassignConditionJson:[],rule:"Round Robin",priority:1,users:[],disabled:!1,description:"",name:"",assignmentRuleName:"",assignmentDays:bs}},Ae=V({screen:"list",data:null}),ot=(o,l=!1,s=!1)=>{const r=n=>{var u,d,f,p,m,_;if(!(o&&n!==o))switch(n){case"assignmentRuleName":((u=P.value.assignmentRuleName)==null?void 0:u.length)==0?ge.value.assignmentRuleName="Name is required":ge.value.assignmentRuleName="";break;case"description":ge.value.description=((d=P.value.description)==null?void 0:d.length)>0?"":"Description is required";break;case"assignCondition":if(l)break;ge.value.assignCondition=((f=P.value.assignConditionJson)==null?void 0:f.length)>0?"":"Assign condition is required",bt(P.value.assignConditionJson)?ge.value.assignConditionError="":ge.value.assignConditionError="Assign conditions are invalid";break;case"unassignCondition":if(s)break;((p=P.value.unassignConditionJson)==null?void 0:p.length)>0&&!bt(P.value.unassignConditionJson)?ge.value.unassignConditionError="Unassign conditions are invalid":ge.value.unassignConditionError="";break;case"users":ge.value.users=((m=P.value.users)==null?void 0:m.length)>0?"":"Users are required";break;case"assignmentDays":ge.value.assignmentDays=((_=P.value.assignmentDays)==null?void 0:_.length)>0?"":"Assignment days are required";break}};return o?r(o):Object.keys(ge.value).forEach(r),ge.value},ge=V({assignmentRuleName:"",assignCondition:"",assignConditionError:"",unassignConditionError:"",users:"",description:"",assignmentDays:""}),Cr=()=>{Object.keys(ge.value).forEach(o=>{ge.value[o]=""})},$r={class:"lucide lucide-lock",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Ar(o,l){return a(),v("svg",$r,[...l[0]||(l[0]=[t("rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"},null,-1),t("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"},null,-1)])])}const Sr=Z({name:"lucide-lock",render:Ar}),Vr={class:"lucide lucide-settings-2",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Dr(o,l){return a(),v("svg",Vr,[...l[0]||(l[0]=[t("path",{d:"M14 17H5"},null,-1),t("path",{d:"M19 7h-9"},null,-1),t("circle",{cx:"17",cy:"17",r:"3"},null,-1),t("circle",{cx:"7",cy:"7",r:"3"},null,-1)])])}const kl=Z({name:"lucide-settings-2",render:Dr}),Ir={class:"lucide lucide-lock-open",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Er(o,l){return a(),v("svg",Ir,[...l[0]||(l[0]=[t("rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"},null,-1),t("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"},null,-1)])])}const Lr=Z({name:"lucide-unlock",render:Er}),Br={class:"flex items-center space-x-3 w-4/5"},Tr={class:"flex items-center gap-2"},Mr={class:"text-base"},Ur={class:"text-base text-ink-gray-6 mt-1"},Rr=O({__name:"AgentCard",props:{agent:{type:Object,required:!0},showStatus:{type:Boolean,default:!1}},setup(o){return(l,s)=>{const r=q("Badge");return a(),v("div",{class:X(["flex items-center justify-between py-2",l.$attrs])},[t("div",Br,[i(e(lt),{image:o.agent.user_image,label:o.agent.agent_name,size:"xl"},null,8,["image","label"]),t("div",null,[t("div",Tr,[t("p",Mr,w(o.agent.agent_name),1),o.showStatus?(a(),B(r,{key:0,label:"Inactive",theme:"gray",class:X(o.showStatus&&!o.agent.is_active?"opacity-100":"opacity-0"),variant:"subtle"},null,8,["class"])):S("",!0)]),t("div",Ur,w(o.agent.name),1)])]),Ce(l.$slots,"right")],2)}}}),Nr={class:"flex flex-wrap gap-1 bg-surface-gray-2 p-0.5 border rounded w-full"},jr={class:"flex-1"},Fr={class:"flex flex-col gap-1 p-1 text-ink-gray-8"},Or={class:"text-base font-medium"},Pr={class:"text-sm text-ink-gray-5"},ks=O({__name:"AgentSelector",props:Ve({existingAgents:{type:Array,default:()=>[]}},{modelValue:{},modelModifiers:{}}),emits:Ve(["change"],["update:modelValue"]),setup(o,{emit:l}){const s=_e(o,"modelValue"),r=l,n=o,u=V([]),d=V(null),f=V(""),p=V(!1),m=V(null),{agents:_}=Wt(Ft()),b=G(()=>{let L=_.value.data;return f.value&&(L=L.filter(T=>T.agent_name.toLowerCase().includes(f.value.toLowerCase())||T.name.toLowerCase().includes(f.value.toLowerCase()))),n.existingAgents.length&&(L=L.filter(T=>!n.existingAgents.includes(T.name))),s.value.length&&(L=L.filter(T=>!s.value.includes(T.name))),L});function g(L){s.value=s.value.filter(T=>T!==L)}function h(){var T;if(f.value)return;let L=(T=u.value[u.value.length-1])==null?void 0:T.rootRef;document.activeElement===L?(s.value.pop(),cl(()=>{s.value.length?(L=u.value[u.value.length-1].rootRef,L==null||L.focus()):M()})):L==null||L.focus()}function y(L){L&&(s.value,s.value.push(L),f.value="",r("change",s.value))}function k(L){f.value=L.target.value,p.value=!0}function D(){f.value&&y(f.value)}function M(){var L,T;(T=(L=d.value)==null?void 0:L.focus)==null||T.call(L)}return(L,T)=>{const x=q("FeatherIcon");return a(),v("div",Nr,[(a(!0),v(N,null,W(s.value,I=>(a(),B(e(j),{ref_for:!0,ref_key:"emails",ref:u,key:I,label:I,theme:"gray",variant:"outline",onKeydownCapture:Ke(we(h,["stop"]),["delete"]),class:"active:bg-surface-gray-1 active:border-outline-gray-2 hover:border-outline-gray-2 hover:bg-surface-gray-1"},{prefix:C(()=>[i(e(el),{name:I,size:"xs"},null,8,["name"])]),suffix:C(()=>[i(x,{class:"h-3.5",name:"x",onClick:we(A=>g(I),["stop"])},null,8,["onClick"])]),_:2},1032,["label","onKeydownCapture"]))),128)),t("div",jr,[i(e(en),{"model-value":m.value,open:p.value,"onUpdate:open":T[4]||(T[4]=I=>p.value=I),"ignore-filter":!0,"onUpdate:modelValue":y},{default:C(()=>[i(e(Js),{class:"flex h-7 w-full items-center gap-2 rounded px-2 py-1 border border-transparent bg-surface-gray-2 hover:bg-surface-gray-2"},{default:C(()=>[i(e(Gs),{ref_key:"search",ref:d,value:f.value,autocomplete:"off",class:"bg-transparent p-0 outline-none border-0 text-base text-ink-gray-8 h-full placeholder:text-ink-gray-4 focus:outline-none focus:ring-0 focus:border-0 w-full select-none",placeholder:"Type agent name or email",onFocus:T[0]||(T[0]=I=>p.value=!0),onClick:T[1]||(T[1]=I=>p.value=!0),onInput:k,onKeydownCapture:Ke(we(h,["stop"]),["delete"]),onKeydown:Ke(we(D,["prevent"]),["enter"])},null,8,["value","onKeydownCapture","onKeydown"])]),_:1}),i(e(Ws),null,{default:C(()=>[i(e(Zs),{class:"z-10 mt-1 min-w-48 w-auto max-w-96 bg-surface-modal overflow-hidden rounded-lg shadow-2xl ring-1 ring-black ring-opacity-5",position:"popper",align:"start",onOpenAutoFocus:T[2]||(T[2]=we(()=>{},["prevent"])),onCloseAutoFocus:T[3]||(T[3]=we(()=>{},["prevent"]))},{default:C(()=>[i(e(Ys),{class:"max-h-60 overflow-auto p-1.5"},{default:C(()=>[i(e(Ks),{class:"flex gap-2 rounded px-2 py-1 text-base text-ink-gray-5"},{default:C(()=>[...T[5]||(T[5]=[oe(" Agent not found ",-1)])]),_:1}),(a(!0),v(N,null,W(b.value,I=>(a(),B(e(Xs),{key:I.name,value:I.name,class:"text-base leading-none text-ink-gray-7 rounded flex items-center px-2 py-1 relative select-none data-[highlighted]:outline-none data-[highlighted]:bg-surface-gray-3 cursor-pointer"},{default:C(()=>[i(e(el),{class:"mr-1",name:I.agent_name,size:"lg"},null,8,["name"]),t("div",Fr,[t("div",Or,w(I.agent_name),1),t("div",Pr,w(I.name),1)])]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value","open"])])])}}}),zr={class:"flex items-center justify-between w-full"},Hr={class:"flex items-center gap-1 justify-center -ml-[16px]"},qr={class:"flex gap-2 items-center"},Qr={class:"flex flex-col gap-1.5 w-full"},Jr={class:"flex gap-2"},Gr={class:"flex flex-1"},Wr={key:0,class:"w-full h-full"},Zr={class:"grid grid-cols-8 items-center gap-3 text-sm text-gray-600"},Yr={class:"col-span-6 text-p-sm"},Kr={class:"grid grid-cols-8 items-center gap-4 group"},Xr={class:"w-full p-2 pl-0 col-span-8"},eu={key:0},tu={key:1,class:"flex flex-col items-center justify-center gap-4 h-full"},lu={class:"p-4 size-14.5 rounded-full bg-surface-gray-1 flex justify-center items-center"},su={class:"flex flex-col items-center gap-1"},nu={class:"text-base font-medium text-ink-gray-6"},au={class:"text-p-sm text-ink-gray-5 max-w-60 text-center"},ou={class:"text-p-base text-ink-gray-7"},iu=O({__name:"TeamEdit",props:{teamName:{}},emits:["update:step"],setup(o,{emit:l}){var A;const s=o,r=l,{getUser:n}=dl(),{agents:u}=Ft(),d=fe(Ot),{teamRestrictionApplied:f}=Nl(),p=V([]),m=V(s.teamName),_=Et({doctype:"HD Team",name:s.teamName,auto:!0,delete:{onSuccess(){H.success(c("Team deleted")),r("update:step","team-list")}}}),b=G({get(){var $;return!!(($=_.doc)!=null&&$.ignore_restrictions)},set($){_.doc&&_.setValue.submit({ignore_restrictions:$})}}),g=G(()=>{var E;return(((E=_.doc)==null?void 0:E.users)||[]).map(Q=>{let F=n(Q.user);return{name:Q.user,user_image:F.user_image,agent_name:F.full_name}})});function h($){var Q,F;const E=(F=(Q=_.doc)==null?void 0:Q.users)==null?void 0:F.filter(Y=>Y.user!==$);_.setValue.submit({users:E})}function y($){const E=_.doc.users.concat($.map(Q=>({user:Q})));_.setValue.submit({users:E}),p.value=[]}const k=V(!1),D={title:c("Rename team"),message:c("Enter the new name for the team"),actions:[{label:c("Confirm"),variant:"solid",loading:_.loading,onClick:({close:$})=>{M($)}}]};function M($){K({url:"frappe.client.rename_doc",makeParams(){return{doctype:"HD Team",old_name:s.teamName,new_name:m.value}},validate(Q){if(!Q.new_name)return c("New title is required");if(Q.new_name===Q.old_name)return c("New and old title cannot be same")},onSuccess(){d.reload(),H.success(c("Team renamed")),$(),r("update:step","team-list")}}).submit()}const L=V(!1),T=[{label:c("View Assignment rule"),icon:Z(ne(kl,{class:"rotate-90"})),onClick:()=>{var $;Ae.value={data:{name:($=_.doc)==null?void 0:$.assignment_rule},screen:"view"},Pe("Assignment Rules")}},{label:c("Rename"),icon:"edit-3",onClick:()=>k.value=!k.value},{condition:()=>f,label:(A=_.doc)!=null&&A.ignore_restrictions?c("Disable Bypass Restrictions"):c("Enable Bypass Restrictions"),component:()=>ne(kt,{text:b.value?c("Members of this team will see the tickets assigned to this team only"):c("Members of this team will be able to see the tickets assigned to all the teams")},{default:()=>{var $,E;return[ne("div",{class:"flex items-center gap-2 p-2 cursor-pointer hover:bg-gray-100 rounded",onClick:()=>b.value=!b.value},[ne(($=_.doc)!=null&&$.ignore_restrictions?Sr:Lr,{class:"h-4 w-4 text-gray-700",stroke:"currentColor","aria-hidden":"true"}),ne("span",{class:"whitespace-nowrap text-ink-gray-7 text-p-base"},[(E=_.doc)!=null&&E.ignore_restrictions?c("Access only this team's tickets"):c("Access all team tickets")])])]}})},{label:c("Delete"),component:ne(j,{label:c("Delete"),variant:"ghost",iconLeft:"trash-2",theme:"red",style:"width: 100%; justify-content: flex-start;",onClick:()=>{L.value=!L.value}})}],x=V(!1),I=$=>Qe({onConfirmDelete:()=>h($.name),isConfirmingDelete:x});return Le(()=>{var $;u.loading||($=u.data)!=null&&$.length||u.list.promise||u.fetch()}),($,E)=>{const Q=Ql,F=Zl,Y=q("FormControl");return a(),v(N,null,[i(he,null,{title:C(()=>[t("div",zr,[t("div",Hr,[i(e(j),{variant:"ghost","icon-left":"chevron-left",label:o.teamName,size:"md",onClick:E[0]||(E[0]=()=>r("update:step","team-list")),class:"cursor-pointer hover:bg-transparent focus:bg-transparent focus:outline-none focus:ring-0 focus:ring-offset-0 focus-visible:none active:bg-transparent active:outline-none active:ring-0 active:ring-offset-0 active:text-ink-gray-5 font-semibold text-ink-gray-7 text-lg hover:opacity-70 !pr-0"},null,8,["label"])])])]),"header-actions":C(()=>[i(e(be),{placement:"right",options:T},{default:C(()=>[i(e(j),{variant:"ghost"},{icon:C(()=>[i(Q,{class:"h-4 w-4"})]),_:1})]),_:1})]),"header-bottom":C(()=>[t("div",qr,[t("div",Qr,[t("div",Jr,[t("div",Gr,[i(ks,{modelValue:p.value,"onUpdate:modelValue":E[1]||(E[1]=z=>p.value=z),"existing-agents":g.value.map(z=>z.name)},null,8,["modelValue","existing-agents"])]),i(e(j),{label:"Add Member",variant:"solid",disabled:!p.value.length,onClick:E[2]||(E[2]=z=>y(p.value)),class:"h-8"},{prefix:C(()=>[i(F,{class:"h-4 w-4 stroke-1.5"})]),_:1},8,["disabled"])])])])]),content:C(()=>{var z;return[((z=g.value)==null?void 0:z.length)>0?(a(),v("div",Wr,[t("div",Zr,[t("div",Yr,w(e(c)("Members ({0})",g.value.length)),1)]),E[8]||(E[8]=t("hr",{class:"mt-2"},null,-1)),(a(!0),v(N,null,W(g.value,(U,ee)=>(a(),v("div",{key:U.name},[t("div",Kr,[t("div",Xr,[i(Rr,{agent:U,class:"!py-0"},{right:C(()=>[i(e(be),{options:I(U),placement:"right"},{default:C(()=>[i(e(j),{icon:"more-horizontal",variant:"ghost",onClick:E[3]||(E[3]=re=>x.value=!1)})]),_:1},8,["options"])]),_:2},1032,["agent"])])]),U!==g.value.at(-1)?(a(),v("hr",eu)):S("",!0)]))),128))])):(a(),v("div",tu,[t("div",lu,[i(e(Yl),{class:"size-6 text-ink-gray-6"})]),t("div",su,[t("div",nu,w(e(c)("No members found")),1),t("div",au,w(e(c)("Add members to this team to get started.")),1)])]))]}),_:1}),i(e(Te),{modelValue:L.value,"onUpdate:modelValue":E[5]||(E[5]=z=>L.value=z),options:{title:"Delete team"}},{"body-content":C(()=>[t("p",ou,w(e(c)("Are you sure you want to delete this team? This action cannot be reversed!")),1),i(e(j),{variant:"solid",class:"mt-4 float-right",label:e(c)("Confirm"),theme:"red",onClick:E[4]||(E[4]=()=>{e(_).delete.submit(),L.value=!1,r("update:step","team-list")})},null,8,["label"])]),_:1},8,["modelValue"]),i(e(Te),{modelValue:k.value,"onUpdate:modelValue":E[7]||(E[7]=z=>k.value=z),options:D},{"body-content":C(()=>[i(Y,{modelValue:m.value,"onUpdate:modelValue":E[6]||(E[6]=z=>m.value=z),label:e(c)("Title"),placeholder:e(c)("Product Experts"),maxlength:"50"},null,8,["modelValue","label","placeholder"])]),_:1},8,["modelValue"])],64)}}}),ru=O({__name:"NewTeamModal",props:{modelValue:{},modelModifiers:{}},emits:Ve(["create"],["update:modelValue"]),setup(o,{emit:l}){const s=l,r=_e(o,"modelValue"),n=V(null),u=K({url:"frappe.client.insert",makeParams(){return{doc:{doctype:"HD Team",team_name:n.value}}},validate(d){if(!d.doc.team_name)return c("Title is required")},auto:!1,onSuccess(){H.success(c("Team created")),n.value=null,r.value=!1,s("create")}});return(d,f)=>{const p=q("FormControl"),m=q("Dialog");return a(),B(m,{modelValue:r.value,"onUpdate:modelValue":f[2]||(f[2]=_=>r.value=_),options:{title:e(c)("New team"),actions:[{label:e(c)("Create"),variant:"solid",onClick:()=>{e(u).submit()}}]}},{"body-content":C(()=>[t("form",{class:"space-y-2",onSubmit:f[1]||(f[1]=we((..._)=>e(u).submit&&e(u).submit(..._),["prevent"]))},[i(p,{modelValue:n.value,"onUpdate:modelValue":f[0]||(f[0]=_=>n.value=_),label:e(c)("Title"),placeholder:e(c)("Product experts"),type:"text"},null,8,["modelValue","label","placeholder"])],32)]),_:1},8,["modelValue","options"])}}}),uu=O({__name:"RenameTeamModal",props:{modelValue:{},modelModifiers:{}},emits:Ve(["onRename"],["update:modelValue"]),setup(o,{emit:l}){const s=l,r=_e(o,"modelValue"),n=V(r.value.teamName),u=K({url:"frappe.client.rename_doc",makeParams(){return{doctype:"HD Team",old_name:r.value.teamName,new_name:n.value}},validate(p){if(!p.new_name)return c("New title is required");if(p.new_name===p.old_name)return c("New and old title cannot be same")},onSuccess(p){H.success(c("Team renamed")),r.value.show=!1,s("onRename",p)}}),d=G(()=>({title:c("Rename team"),message:c("Enter the new name for the team")}));function f(){u.submit()}return ce(()=>r.value.show,()=>{n.value=r.value.teamName}),(p,m)=>{const _=q("FormControl"),b=q("Button");return a(),B(e(Te),{modelValue:r.value.show,"onUpdate:modelValue":m[1]||(m[1]=g=>r.value.show=g),options:d.value},{"body-content":C(()=>[i(_,{modelValue:n.value,"onUpdate:modelValue":m[0]||(m[0]=g=>n.value=g),label:e(c)("Title"),placeholder:e(c)("Product Experts")},null,8,["modelValue","label","placeholder"])]),actions:C(()=>[i(b,{variant:"solid",onClick:f,loading:e(u).loading,disabled:n.value==r.value.teamName||n.value.trim()==""},{default:C(()=>[...m[2]||(m[2]=[oe(" Confirm ",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue","options"])}}}),du={class:"relative"},cu={key:0,class:"w-full h-full -ml-2"},mu={class:"flex text-sm text-gray-600"},pu={class:"ml-2"},fu={class:"flex items-center cursor-pointer hover:bg-gray-50 rounded h-12.5"},vu=["onClick"],gu={class:"text-base text-ink-gray-7 font-medium"},_u={class:"flex justify-between items-center pr-2"},hu={key:0,class:"mx-2"},yu={class:"flex justify-center"},bu={key:1,class:"flex mt-28 justify-between w-full h-full"},ku={key:2,class:"flex flex-col items-center justify-center gap-4 h-full"},xu={class:"p-4 size-14.5 rounded-full bg-surface-gray-1 flex justify-center items-center"},wu={class:"flex flex-col items-center gap-1"},Cu={class:"text-base font-medium text-ink-gray-6"},$u={class:"text-p-sm text-ink-gray-5 max-w-60 text-center"},Au=O({__name:"TeamsList",emits:["update:step"],setup(o,{emit:l}){const s=l,r=fe("teamsSearchQuery"),n=fe(Ot),u=V(!1),d=V({show:!1,teamName:""}),f=V(!1),p=_=>[{label:c("Rename"),icon:Z(An),onClick:()=>{d.value={show:!0,teamName:_.name}}},...Qe({onConfirmDelete:()=>m(_),isConfirmingDelete:f})],m=_=>{if(!f.value){f.value=!0;return}n.delete.submit(_.name,{onSuccess:()=>{H.success(c("Team deleted"))}})};return ce(r,_=>{n.filters={...n.filters,name:["like",`%${_}%`]},n.reload()}),(_,b)=>{var y;const g=q("Button"),h=as;return a(),v(N,null,[i(he,{title:e(c)("Teams"),description:e(c)("Create and manage teams and assign agents to specific teams.")},xt({"header-actions":C(()=>[i(g,{label:e(c)("New"),theme:"gray",variant:"solid",onClick:b[0]||(b[0]=k=>s("update:step","new-team","")),"icon-left":"plus"},null,8,["label"])]),content:C(()=>{var k,D;return[!e(n).loading&&((k=e(n).data)==null?void 0:k.length)>0?(a(),v("div",cu,[t("div",mu,[t("div",pu,w(e(c)("Team name")),1)]),b[10]||(b[10]=t("hr",{class:"mx-2 mt-2"},null,-1)),(a(!0),v(N,null,W(e(n).data,(M,L)=>(a(),v("div",{key:M.name},[t("div",fu,[t("div",{class:"w-full py-3 pl-2",onClick:()=>s("update:step","team-edit",M.name)},[t("div",gu,w(M.name),1)],8,vu),t("div",_u,[t("div",null,[i(e(be),{placement:"right",options:p(M)},{default:C(()=>[i(g,{icon:"more-horizontal",variant:"ghost",onClick:b[3]||(b[3]=T=>f.value=!1)})]),_:1},8,["options"])])])]),L!==e(n).data.length-1?(a(),v("hr",hu)):S("",!0)]))),128)),t("div",yu,[!e(n).loading&&e(n).hasNextPage?(a(),B(g,{key:0,class:"mt-3.5 p-2",onClick:b[4]||(b[4]=()=>e(n).next()),loading:e(n).loading,label:e(c)("Load More"),"icon-left":"refresh-cw"},null,8,["loading","label"])):S("",!0)])])):S("",!0),e(n).loading?(a(),v("div",bu,[i(g,{loading:e(n).loading,variant:"ghost",class:"w-full",size:"2xl"},null,8,["loading"])])):S("",!0),!e(n).loading&&!((D=e(n).data)!=null&&D.length)?(a(),v("div",ku,[t("div",xu,[i(h,{class:"size-6 text-ink-gray-6"})]),t("div",wu,[t("div",Cu,w(e(c)("No team found")),1),t("div",$u,w(e(r).length?e(c)("Change your search terms to find teams."):e(c)("Add one to get started.")),1)]),i(g,{label:e(c)("New"),variant:"outline","icon-left":"plus",onClick:b[5]||(b[5]=M=>u.value=!0)},null,8,["label"])])):S("",!0)]}),_:2},[((y=e(n).data)==null?void 0:y.length)>9||e(r).length?{name:"header-bottom",fn:C(()=>[t("div",du,[i(e(tn),{"model-value":e(r),onInput:b[1]||(b[1]=k=>r.value=k),placeholder:e(c)("Search"),type:"text",class:"bg-white hover:bg-white focus:ring-0 border-outline-gray-2","icon-left":"search",debounce:"300",inputClass:"p-4 pr-12"},null,8,["model-value","placeholder"]),e(r)?(a(),B(g,{key:0,icon:"x",variant:"ghost",onClick:b[2]||(b[2]=k=>r.value=""),class:"absolute right-1 top-1/2 -translate-y-1/2"})):S("",!0)])]),key:"0"}:void 0]),1032,["title","description"]),i(ru,{modelValue:u.value,"onUpdate:modelValue":b[6]||(b[6]=k=>u.value=k),onCreate:b[7]||(b[7]=()=>{e(n).reload()})},null,8,["modelValue"]),i(uu,{modelValue:d.value,"onUpdate:modelValue":b[8]||(b[8]=k=>d.value=k),onOnRename:b[9]||(b[9]=()=>e(n).reload())},null,8,["modelValue"])],64)}}}),Su={class:"flex items-center gap-2"},Vu={class:"flex flex-col gap-4"},Du={class:"space-y-1.5"},Iu={class:"flex flex-col gap-1.5"},Eu={class:"flex"},Lu=O({__name:"NewTeam",emits:["update:step"],setup(o,{emit:l}){const s=l,r=fe(Ot),{agents:n}=Ft(),u=G(()=>f.value.name||f.value.agents.length),d=V({show:!1,title:"",message:"",onConfirm:()=>{}}),f=V({name:"",agents:[]}),p=V({name:"",agents:""}),m=()=>{const g={show:!0,title:c("Unsaved changes"),message:c("Are you sure you want to go back? Unsaved changes will be lost."),onConfirm:m};if(u.value&&!d.value.show){d.value=g;return}setTimeout(()=>{s("update:step","team-list")},250),d.value.show=!1},_=()=>{if(b(),Object.values(p.value).some(g=>g)){H.error(c("Please fill all required fields"));return}r.insert.submit({team_name:f.value.name,users:f.value.agents.map(g=>({user:g}))},{onSuccess:g=>{H.success(c("Team created")),s("update:step","team-edit",g.name)}})},b=g=>{const h=y=>{var k;if(!(g&&y!==g))switch(y){case"name":((k=f.value.name)==null?void 0:k.length)==0?p.value.name="Name is required":p.value.name="";break;case"agents":f.value.agents.length==0?p.value.agents="At least one team member is required":p.value.agents="";break}};return g?h(g):Object.keys(p.value).forEach(h),p.value};return Le(()=>{var g;n.loading||(g=n.data)!=null&&g.length||n.list.promise||n.fetch()}),(g,h)=>{const y=q("Button");return a(),B(he,null,{title:C(()=>[t("div",Su,[i(y,{variant:"ghost","icon-left":"chevron-left",label:f.value.name||e(c)("New Team"),size:"md",onClick:h[0]||(h[0]=k=>m()),class:"cursor-pointer -ml-4 hover:bg-transparent focus:bg-transparent focus:outline-none focus:ring-0 focus:ring-offset-0 focus-visible:none active:bg-transparent active:outline-none active:ring-0 active:ring-offset-0 active:text-ink-gray-5 font-semibold text-ink-gray-7 text-lg hover:opacity-70 !pr-0"},null,8,["label"]),u.value?(a(),B(e(Xe),{key:0,variant:"subtle",theme:"orange",size:"sm",label:e(c)("Unsaved")},null,8,["label"])):S("",!0)])]),"header-actions":C(()=>[i(y,{label:e(c)("Save"),variant:"solid",onClick:h[1]||(h[1]=k=>_()),disabled:!u.value,loading:e(r).insert.loading},null,8,["label","disabled","loading"])]),content:C(()=>[t("div",Vu,[t("div",Du,[i(e(ae),{modelValue:f.value.name,"onUpdate:modelValue":h[2]||(h[2]=k=>f.value.name=k),label:e(c)("Team Name"),placeholder:e(c)("Product Experts"),maxlength:"50",required:"",onChange:h[3]||(h[3]=k=>b("name"))},null,8,["modelValue","label","placeholder"]),i(e(pe),{message:p.value.name},null,8,["message"])]),t("div",Iu,[i(e(Ne),{label:e(c)("Members"),required:""},null,8,["label"]),t("div",Eu,[i(ks,{modelValue:f.value.agents,"onUpdate:modelValue":h[4]||(h[4]=k=>f.value.agents=k),onChange:h[5]||(h[5]=k=>b("agents"))},null,8,["modelValue"])]),i(e(pe),{message:p.value.agents},null,8,["message"])])])]),_:1})}}}),Bu=O({__name:"TeamsConfig",setup(o){const l=V("team-list"),s=V("");function r(d,f){l.value=d,s.value=f}const n=V(""),u=tt({doctype:"HD Team",cache:["Teams"],fields:["name"],auto:!0,orderBy:"modified desc",start:0,pageLength:20});return Oe("teamsSearchQuery",n),Oe(Ot,u),qe(()=>{n.value="",u.filters={}}),(d,f)=>l.value==="team-list"?(a(),B(Au,{key:0,"onUpdate:step":r})):l.value==="new-team"?(a(),B(Lu,{key:1,"onUpdate:step":r})):l.value==="team-edit"?(a(),B(iu,{key:2,"onUpdate:step":r,"team-name":s.value},null,8,["team-name"])):S("",!0)}}),xs=[{workday:"Monday",start_time:"09:00:00",end_time:"17:00:00",id:Math.random().toString(36).substring(2,9)},{workday:"Tuesday",start_time:"09:00:00",end_time:"17:00:00",id:Math.random().toString(36).substring(2,9)},{workday:"Wednesday",start_time:"09:00:00",end_time:"17:00:00",id:Math.random().toString(36).substring(2,9)},{workday:"Thursday",start_time:"09:00:00",end_time:"17:00:00",id:Math.random().toString(36).substring(2,9)},{workday:"Friday",start_time:"09:00:00",end_time:"17:00:00",id:Math.random().toString(36).substring(2,9)}],R=V({name:"",service_level:"",description:"",enabled:!0,default_sla:!1,apply_sla_for_resolution:!0,priorities:[],holiday_list:"Default",default_priority:"",start_date:"",end_date:"",loading:!1,support_and_resolution:xs,default_ticket_status:"",reopen_ticket_status:"",condition:[],condition_json:[]}),ws=()=>{R.value={name:"",service_level:"",description:"",enabled:!0,default_sla:!1,apply_sla_for_resolution:!0,priorities:[],holiday_list:"Default",default_priority:"",start_date:"",end_date:"",loading:!1,support_and_resolution:xs,default_ticket_status:"",reopen_ticket_status:"",condition:[],condition_json:[]}},ve=V({screen:"list",data:null,fetchData:!0}),te=V({service_level:"",description:"",enabled:"",default_sla:"",apply_sla_for_resolution:"",priorities:"",holiday_list:"",default_priority:"",start_date:"",end_date:"",support_and_resolution:"",condition:""}),Cs=()=>{te.value={service_level:"",description:"",enabled:"",default_sla:"",apply_sla_for_resolution:"",priorities:"",holiday_list:"",default_priority:"",start_date:"",end_date:"",support_and_resolution:"",condition:""}};function at(o,l=!1){Cs();const s=r=>{var n,u;if(!(o&&r!==o))switch(r){case"service_level":(n=R.value.service_level)!=null&&n.trim()?te.value.service_level="":te.value.service_level="SLA policy name is required";break;case"priorities":if(!Array.isArray(R.value.priorities)||R.value.priorities.length===0)te.value.priorities="At least one priority is required";else{const f=[];R.value.priorities.forEach((b,g)=>{var y;const h=g+1;(y=b.priority)!=null&&y.trim()||f.push(`Priority ${h}: Priority name is required`),(!b.response_time||b.response_time==0)&&f.push(`Priority ${h}: Response time is required`),R.value.apply_sla_for_resolution&&(!b.resolution_time||b.resolution_time==0)&&f.push(`Priority ${h}: Resolution time is required`),b.response_time>b.resolution_time&&R.value.apply_sla_for_resolution&&f.push(`Priority ${h}: Response time cannot be greater than resolution time`)});const p=R.value.priorities.map(b=>{var g;return(g=b.priority)==null?void 0:g.trim().toLowerCase()}).filter(Boolean),m=new Set(p);p.length!==m.size&&f.push("Priorities must be unique"),f.length>0?te.value.priorities=f.join(", "):te.value.priorities="",R.value.priorities.some(b=>!!b.default_priority)?te.value.default_priority="":te.value.default_priority="Default priority is required"}break;case"holiday_list":R.value.holiday_list?te.value.holiday_list="":te.value.holiday_list="Holiday list is required";break;case"start_date":new Date(R.value.end_date)<new Date(R.value.start_date)?te.value.start_date="Start date cannot be after end date":te.value.start_date="";break;case"end_date":R.value.end_date&&new Date(R.value.end_date)<new Date(R.value.start_date)?te.value.end_date="End date cannot be before start date":te.value.end_date="";break;case"condition":if(l)break;R.value.condition_json.length>0&&!bt(R.value.condition_json)?te.value.condition="Valid conditions are required":te.value.condition="";break;case"support_and_resolution":const d=(u=R.value.support_and_resolution)==null?void 0:u.filter(f=>f.workday&&f.workday.trim()!==""&&f.start_time&&f.end_time&&f.start_time.trim()!==""&&f.end_time.trim()!=="");if(!(d!=null&&d.length))te.value.support_and_resolution="At least one valid workday with workday, start time, and end time is required";else{const f=new Map,p=[];for(const _ of d)f.has(_.workday)?p.push(_.workday):f.set(_.workday,!0);if(p.length>0)return te.value.support_and_resolution=`Duplicate workday found: ${p.join(", ")}. Each workday should be unique.`,te.value;te.value.support_and_resolution="";const m=[];for(const _ of d){const b=_.start_time.trim(),g=_.end_time.trim(),h=y=>{const[k,D]=y.split(":").map(Number),M=new Date;return M.setHours(k,D||0,0,0),M};try{const y=h(b),k=h(g);y>=k&&m.push(`${_.workday} (${b} - ${g})`)}catch{m.push(`${_.workday} (Invalid time format)`)}}m.length>0?te.value.support_and_resolution=`End time must be after start time for: ${m.join(", ")}`:te.value.support_and_resolution=""}break}};return o?s(o):Object.keys(te.value).forEach(s),te.value}const Tu={class:"grid grid-cols-6 items-center gap-4 cursor-pointer hover:bg-gray-50 rounded"},Mu={class:"text-base text-ink-gray-7 font-medium flex items-center gap-2"},Uu={key:0,class:"text-sm w-full text-ink-gray-5 mt-1 truncate"},Ru={class:"flex justify-between items-center w-full pr-2"},Nu={class:"flex flex-col gap-4"},ju={class:"flex gap-2 justify-end"},Fu=O({__name:"SlaPolicyListItem",props:{data:{type:Object,required:!0}},setup(o){const l=fe(wt),s=V({show:!1,name:""}),r=o,n=V(!1),u=[{label:c("Duplicate"),onClick:()=>{s.value={show:!0,name:r.data.name+" (Copy)"}},icon:"copy"},...Qe({onConfirmDelete:()=>f(),isConfirmingDelete:n})],d=()=>{K({url:"helpdesk.api.sla.duplicate_sla",params:{docname:r.data.name,new_name:s.value.name},onSuccess:m=>{l.reload(),H.success(c("SLA policy duplicated")),s.value={show:!1,name:""},setTimeout(()=>{ve.value={screen:"view",data:m,fetchData:!0}},250)},auto:!0})},f=()=>{if(!n.value){n.value=!0;return}l.delete.submit(r.data.name,{onSuccess:()=>{H.success(c("SLA policy deleted"))}})},p=()=>{if(r.data.default_sla){H.error(c("SLA set as default cannot be disabled"));return}l.setValue.submit({name:r.data.name,enabled:!r.data.enabled},{onSuccess:()=>{H.success(c("SLA policy status updated"))}})};return(m,_)=>{const b=q("FormControl");return a(),v(N,null,[t("div",Tu,[t("div",{onClick:_[0]||(_[0]=g=>ve.value={screen:"view",data:o.data,fetchData:!0}),class:"w-full pl-2 col-span-5 flex flex-col justify-center h-14"},[t("div",Mu,[oe(w(o.data.name)+" ",1),o.data.default_sla?(a(),B(e(Xe),{key:0,color:"gray",size:"sm"},{default:C(()=>[..._[6]||(_[6]=[oe("Default",-1)])]),_:1})):S("",!0)]),o.data.description&&o.data.description.length>0?(a(),v("div",Uu,w(o.data.description),1)):S("",!0)]),t("div",Ru,[t("div",null,[i(e(Ee),{size:"sm",modelValue:o.data.enabled,"onUpdate:modelValue":p},null,8,["modelValue"])]),t("div",null,[i(e(be),{placement:"right",options:u},{default:C(()=>[i(e(j),{icon:"more-horizontal",variant:"ghost",onClick:_[1]||(_[1]=g=>n.value=!1)})]),_:1})])])]),i(e(Te),{options:{title:e(c)("Duplicate SLA Policy")},modelValue:s.value.show,"onUpdate:modelValue":_[5]||(_[5]=g=>s.value.show=g)},{"body-content":C(()=>[t("div",Nu,[i(b,{label:e(c)("New SLA Policy Name"),type:"text",modelValue:s.value.name,"onUpdate:modelValue":_[2]||(_[2]=g=>s.value.name=g)},null,8,["label","modelValue"])])]),actions:C(()=>[t("div",ju,[i(e(j),{variant:"subtle",label:e(c)("Close"),onClick:_[3]||(_[3]=g=>s.value.show=!1)},null,8,["label"]),i(e(j),{variant:"solid",label:e(c)("Duplicate"),onClick:_[4]||(_[4]=g=>d())},null,8,["label"])])]),_:1},8,["options","modelValue"])],64)}}}),Ou={class:"lucide lucide-shield-check",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Pu(o,l){return a(),v("svg",Ou,[...l[0]||(l[0]=[t("path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"},null,-1),t("path",{d:"m9 12 2 2 4-4"},null,-1)])])}const $s=Z({name:"lucide-shield-check",render:Pu}),zu={key:0,class:"flex items-center justify-center mt-12"},Hu={key:1,class:"grow"},qu={key:0,class:"flex flex-col items-center justify-center gap-4 h-full"},Qu={class:"p-4 size-14.5 rounded-full bg-surface-gray-1 flex justify-center items-center"},Ju={class:"flex flex-col items-center gap-1"},Gu={class:"text-base font-medium text-ink-gray-6"},Wu={class:"text-p-sm text-ink-gray-5 max-w-60 text-center"},Zu={key:1,class:"-ml-2"},Yu={class:"grid grid-cols-6 items-center gap-3 text-sm text-gray-600 ml-2"},Ku={class:"col-span-5"},Xu={class:"col-span-1"},ed={key:0,class:"mx-2"},td=O({__name:"SlaPolicyList",setup(o){const l=fe(wt),s=()=>{ws(),ve.value={screen:"view",data:null,fetchData:!0}};return(r,n)=>{var u;return e(l).list.loading&&!e(l).list.data?(a(),v("div",zu,[i(e(Ze),{class:"w-4"})])):(a(),v("div",Hu,[!e(l).list.loading&&!((u=e(l).list.data)!=null&&u.length)?(a(),v("div",qu,[t("div",Qu,[i(e($s),{class:"size-6 text-ink-gray-6"})]),t("div",Ju,[t("div",Gu,w(r.__("No SLA found")),1),t("div",Wu,w(r.__("Add one to get started.")),1)]),i(e(j),{label:r.__("New"),variant:"outline","icon-left":"plus",onClick:n[0]||(n[0]=d=>s())},null,8,["label"])])):(a(),v("div",Zu,[t("div",Yu,[t("div",Ku,w(r.__("Policy Name")),1),t("div",Xu,w(r.__("Enabled")),1)]),n[1]||(n[1]=t("hr",{class:"mt-2 mx-2"},null,-1)),(a(!0),v(N,null,W(e(l).list.data,(d,f)=>(a(),v("div",{key:d.name},[i(Fu,{data:d},null,8,["data"]),f!==e(l).list.data.length-1?(a(),v("hr",ed)):S("",!0)]))),128))]))]))}}}),ld={class:"text-lg font-semibold text-ink-gray-8"},sd={class:"text-p-sm max-w-md text-ink-gray-6"},nd={href:"https://docs.frappe.io/helpdesk/service-level-agreement",target:"_blank",class:"underline"},ad={class:"relative"},od=O({__name:"SlaPolicies",setup(o){const l=fe(wt),s=fe("slaSearchQuery"),r=()=>{ws(),ve.value={screen:"view",data:null,fetchData:!0}};return ce(s,n=>{l.filters={name:["like",`%${n}%`]},n||(l.start=0,l.pageLength=10),l.reload()}),(n,u)=>{var f;const d=q("Input");return a(),B(he,null,xt({title:C(()=>[t("h1",ld,w(n.__("Service Level Agreements (SLAs)")),1)]),description:C(()=>[t("p",sd,[oe(w(n.__("SLAs align your team and customers with defined timelines for a reliable experience."))+" ",1),t("a",nd,w(n.__("Learn more about SLA")),1)])]),"header-actions":C(()=>[i(e(j),{label:n.__("New"),theme:"gray",variant:"solid",onClick:u[0]||(u[0]=p=>r()),"icon-left":"plus"},null,8,["label"])]),content:C(()=>[i(td)]),_:2},[((f=e(l).data)==null?void 0:f.length)>9||e(s).length?{name:"header-bottom",fn:C(()=>[t("div",ad,[i(d,{"model-value":e(s),onInput:u[1]||(u[1]=p=>s.value=p),placeholder:n.__("Search"),type:"text",class:"bg-white hover:bg-white focus:ring-0 border-outline-gray-2","icon-left":"search",debounce:"300",inputClass:"p-4 pr-12"},null,8,["model-value","placeholder"]),e(s)?(a(),B(e(j),{key:0,icon:"x",variant:"ghost",onClick:u[2]||(u[2]=p=>s.value=""),class:"absolute right-1 top-1/2 -translate-y-1/2"})):S("",!0)])]),key:"0"}:void 0]),1024)}}}),id={class:"lucide lucide-group",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function rd(o,l){return a(),v("svg",id,[...l[0]||(l[0]=[ul('<path d="M3 7V5c0-1.1.9-2 2-2h2"></path><path d="M17 3h2c1.1 0 2 .9 2 2v2"></path><path d="M21 17v2c0 1.1-.9 2-2 2h-2"></path><path d="M7 21H5c-1.1 0-2-.9-2-2v-2"></path><rect width="7" height="5" x="7" y="7" rx="1"></rect><rect width="7" height="5" x="10" y="12" rx="1"></rect>',6)])])}const ud=Z({name:"lucide-group",render:rd}),dd={class:"lucide lucide-ungroup",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function cd(o,l){return a(),v("svg",dd,[...l[0]||(l[0]=[t("rect",{width:"8",height:"6",x:"5",y:"4",rx:"1"},null,-1),t("rect",{width:"8",height:"6",x:"11",y:"14",rx:"1"},null,-1)])])}const md=Z({name:"lucide-ungroup",render:cd}),yt=K({url:"helpdesk.api.doc.get_filterable_fields",params:{doctype:"HD Ticket",ignore_team_restrictions:!0},transform:o=>(o=o.filter(l=>!l.fieldname.startsWith("_")).map(l=>({label:l.label,value:l.fieldname,...l})),o)}),pd={class:X("text-end text-base text-gray-600")},fd={key:0,class:"min-w-[66px] text-start"},vd={key:1,class:"min-w-[66px] flex items-start"},gd={key:0,class:"flex items-center gap-2 w-full"},_d={id:"fieldname",class:"w-full"},hd={id:"operator"},yd={id:"value",class:"w-full"},bd={class:X("w-max")},kd=O({__name:"CFCondition",props:{condition:{type:Array,required:!0},isChild:{type:Boolean,default:!1},itemIndex:{type:Number},level:{type:Number,default:0},isGroup:{type:Boolean,default:!1},conjunction:{type:String},disableAddCondition:{type:Boolean,default:!1}},emits:["remove","unGroupConditions","toggleConjunction","turnIntoGroup"],setup(o,{emit:l}){const s=V(!1),r=l,n=o,u=G(()=>{const $=[];return!n.isGroup&&n.level<4&&$.push({label:"Turn into a group",icon:()=>ne(ud),onClick:()=>{r("turnIntoGroup")}}),n.isGroup&&$.push({label:"Ungroup conditions",icon:()=>ne(md),onClick:()=>{r("unGroupConditions")}}),$.push({label:"Remove",component:E=>$l({option:"Remove",icon:"trash-2",active:E.active,variant:"danger",onClick:()=>{r("remove")}}),condition:()=>!n.isGroup}),$.push({label:"Remove group",component:E=>$l({option:"Remove group",icon:"trash-2",active:E.active,variant:"danger",onClick:()=>{r("remove")}}),condition:()=>n.isGroup}),$}),d=["Check"],f=["Link","Dynamic Link"],p=["Float","Int","Currency","Percent"],m=["Select"],_=["Data","Long Text","Small Text","Text Editor","Text"],b=["Date","Datetime"],g=["Rating"];function h(){r("toggleConjunction",n.conjunction)}const y=$=>{n.condition[0]=$==null?void 0:$.fieldname,k()},k=()=>{n.condition[2]=""};function D(){var z;const[$,E]=n.condition;if(!$)return null;const Q=(z=yt.data)==null?void 0:z.find(U=>U.fieldname==$);if(!Q)return null;const{fieldtype:F,options:Y}=Q;if(E=="is")return ne(ae,{type:"select",options:[{label:"Set",value:"set"},{label:"Not Set",value:"not set"}]});if(["like","not like","in","not in"].includes(E))return ne(ae,{type:"text"});if(m.includes(F)||d.includes(F)){const U=F=="Check"?["Yes","No"]:L(Y);return ne(ae,{type:"select",options:U.map(ee=>({label:ee,value:ee}))})}else return f.includes(F)?F=="Dynamic Link"?ne(ae,{type:"text"}):ne(Xl,{class:"form-control",doctype:Y,value:n.condition[2]}):p.includes(F)?ne(ae,{type:"number"}):b.includes(F)&&E=="between"?ne(Dn,{value:n.condition[2],iconLeft:""}):b.includes(F)?ne(F=="Date"?pt:In,{value:n.condition[2],iconLeft:""}):g.includes(F)?ne(Vn,{rating:n.condition[2]||0,static:!1,class:"truncate","onUpdate:modelValue":U=>M(U)}):ne(ae,{type:"text"})}function M($){$=$.target?$.target.value:$,n.condition[1]==="between"?n.condition[2]=[$.split(",")[0],$.split(",")[1]]:n.condition[2]=$+""}function L($){return $.split(`
`)}function T($){let E=$.target._value,Q=$.target.value;n.condition[1]=$.target.value,A(E,Q)||(n.condition[2]=I(n.condition[0])),k()}function x(){var U;let $=[];const E=n.condition[0];if(!E)return $;const Q=(U=yt.data)==null?void 0:U.find(ee=>ee.fieldname==E);if(!Q)return $;const{fieldtype:F,fieldname:Y}=Q;_.includes(F)&&$.push({label:"Equals",value:"=="},{label:"Not Equals",value:"!="},{label:"Like",value:"like"},{label:"Not Like",value:"not like"},{label:"In",value:"in"},{label:"Not In",value:"not in"},{label:"Is",value:"is"}),Y==="_assign"&&($=[{label:"Like",value:"like"},{label:"Not Like",value:"not like"},{label:"Is",value:"is"}]),p.includes(F)&&$.push({label:"Equals",value:"=="},{label:"Not Equals",value:"!="},{label:"Like",value:"like"},{label:"Not Like",value:"not like"},{label:"In",value:"in"},{label:"Not In",value:"not in"},{label:"Is",value:"is"},{label:"<",value:"<"},{label:">",value:">"},{label:"<=",value:"<="},{label:">=",value:">="}),m.includes(F)&&$.push({label:"Equals",value:"=="},{label:"Not Equals",value:"!="},{label:"In",value:"in"},{label:"Not In",value:"not in"},{label:"Is",value:"is"}),f.includes(F)&&$.push({label:"Equals",value:"=="},{label:"Not Equals",value:"!="},{label:"Like",value:"like"},{label:"Not Like",value:"not like"},{label:"In",value:"in"},{label:"Not In",value:"not in"},{label:"Is",value:"is"}),d.includes(F)&&$.push({label:"Equals",value:"=="}),["Duration"].includes(F)&&$.push({label:"Like",value:"like"},{label:"Not Like",value:"not like"},{label:"In",value:"in"},{label:"Not In",value:"not in"},{label:"Is",value:"is"}),b.includes(F)&&$.push({label:"Equals",value:"=="},{label:"Not Equals",value:"!="},{label:"Is",value:"is"},{label:">",value:">"},{label:"<",value:"<"},{label:">=",value:">="},{label:"<=",value:"<="},{label:"Between",value:"between"}),g.includes(F)&&$.push({label:"Equals",value:"=="},{label:"Not Equals",value:"!="},{label:"Is",value:"is"},{label:">",value:">"},{label:"<",value:"<"},{label:">=",value:">="},{label:"<=",value:"<="});const z=$.find(ee=>ee.value==n.condition[1]);return n.condition[1]=(z==null?void 0:z.value)||$[0].value,$}function I($){return m.includes($.fieldtype)?L($.options)[0]:d.includes($.fieldtype)?"Yes":b.includes($.fieldtype)?null:g.includes($.fieldtype)?0:""}function A($,E){let Q=["==","!=","in","not in",">","<",">=","<="];return!!(Q.includes($)&&Q.includes(E))}return($,E)=>(a(),v(N,null,[t("div",{class:X(["flex gap-2",[{"items-center":!n.isGroup}]])},[t("div",{class:X(["flex gap-2 w-full",[{"items-center justify-between":!n.isGroup}]])},[t("div",pd,[n.itemIndex==0?(a(),v("div",fd," Where ")):(a(),v("div",vd,[i(e(j),{variant:"subtle",class:"w-max",onClick:h,"icon-right":"refresh-cw",disabled:n.itemIndex>2,label:o.conjunction},null,8,["disabled","label"])]))]),n.isGroup?S("",!0):(a(),v("div",gd,[t("div",_d,[i(e(jl),{options:e(yt).data,modelValue:n.condition[0],"onUpdate:modelValue":[E[0]||(E[0]=Q=>n.condition[0]=Q),y],placeholder:"Field"},null,8,["options","modelValue"])]),t("div",hd,[n.condition[0]?(a(),B(e(ae),{key:1,disabled:!n.condition[0],type:"select",modelValue:n.condition[1],"onUpdate:modelValue":E[1]||(E[1]=Q=>n.condition[1]=Q),onChange:T,options:x(),class:"w-max min-w-[100px]"},null,8,["disabled","modelValue","options"])):(a(),B(e(ae),{key:0,disabled:"",type:"text",placeholder:"operator",class:"w-[100px]"}))]),t("div",yd,[n.condition[0]?(a(),B(Ue(D()),{key:1,modelValue:n.condition[2],"onUpdate:modelValue":E[2]||(E[2]=Q=>n.condition[2]=Q),onChange:M,placeholder:"condition"},null,40,["modelValue"])):(a(),B(e(ae),{key:0,disabled:"",type:"text",placeholder:"condition",class:"w-full"}))])])),n.isGroup&&!(n.level==2||n.level==4)?(a(),B(Rt,{key:1,conditions:n.condition,isChild:!0,level:n.level,disableAddCondition:n.disableAddCondition},null,8,["conditions","level","disableAddCondition"])):S("",!0),n.isGroup&&(n.level==2||n.level==4)?(a(),B(e(j),{key:2,variant:"outline",onClick:E[3]||(E[3]=Q=>s.value=!0),label:"Open nested conditions"})):S("",!0)],2),t("div",bd,[i(e(be),{placement:"right",options:u.value},{default:C(()=>[i(e(j),{variant:"ghost",icon:"more-horizontal"})]),_:1},8,["options"])])],2),i(e(Te),{modelValue:s.value,"onUpdate:modelValue":E[4]||(E[4]=Q=>s.value=Q),options:{size:"3xl",title:"Nested conditions"}},{"body-content":C(()=>[i(Rt,{conditions:n.condition,isChild:!0,level:n.level,disableAddCondition:n.disableAddCondition},null,8,["conditions","level","disableAddCondition"])]),_:1},8,["modelValue"])],64))}}),xd={class:"rounded-lg border border-gray-300 p-3 flex flex-col gap-4 w-full"},wd={key:0,class:"flex"},Rt=O({__name:"CFConditions",props:{conditions:{type:Array,required:!0},isChild:{type:Boolean,default:!1},level:{type:Number,default:0},disableAddCondition:{type:Boolean,default:!1}},setup(o){const l=o,s=()=>{let m="and";return l.conditions.forEach(_=>{typeof _=="string"&&(m=_)}),m},r=m=>{l.conditions.splice(l.conditions.indexOf(m),1,[m])},n=m=>Array.isArray(m),u=G(()=>{const m=[{label:"Add condition",onClick:()=>{const _=s();l.conditions.push(_,["","",""])}}];return l.level<3&&m.push({label:"Add condition group",onClick:()=>{const _=s();l.conditions.push(_,[[]])}}),m});function d(m){const _=l.conditions.indexOf(m);_==0?l.conditions.splice(_,2):l.conditions.splice(_-1,2)}function f(m){const _=s(),b=m.map(h=>typeof h=="string"?_:h),g=l.conditions.indexOf(m);g!==-1&&l.conditions.splice(g,1,...b)}function p(m){for(let _=0;_<l.conditions.length;_++)typeof l.conditions[_]=="string"&&(l.conditions[_]=m=="and"?"or":"and")}return Le(()=>{yt.fetched||yt.submit()}),(m,_)=>(a(),v("div",xd,[(a(!0),v(N,null,W(l.conditions,(b,g)=>(a(),v(N,{key:b.field},[Array.isArray(b)?(a(),B(kd,{key:0,condition:b,isChild:l.isChild,itemIndex:g,onRemove:h=>d(b),onUnGroupConditions:h=>f(b),level:l.level+1,onToggleConjunction:p,isGroup:n(b[0]),conjunction:s(),onTurnIntoGroup:h=>r(b),disableAddCondition:l.disableAddCondition},null,8,["condition","isChild","itemIndex","onRemove","onUnGroupConditions","level","isGroup","conjunction","onTurnIntoGroup","disableAddCondition"])):S("",!0)],64))),128)),l.isChild?(a(),v("div",wd,[i(e(be),{options:u.value},{default:C(({open:b})=>[i(e(j),{disabled:l.disableAddCondition,label:"Add condition","icon-left":"plus","icon-right":b?"chevron-up":"chevron-down"},null,8,["disabled","icon-right"])]),_:1},8,["options"])])):S("",!0)]))}}),Cd={class:"flex items-center justify-between mt-2"},$d=O({__name:"SlaAssignmentConditions",props:{conditions:{type:Array,required:!0}},setup(o){const l=o,s=()=>{let u="and";return l.conditions.forEach(d=>{typeof d=="string"&&(u=d)}),u},r=[{label:"Add condition",onClick:()=>{n()}},{label:"Add condition group",onClick:()=>{const u=s();l.conditions.push(u,[[]])}}],n=()=>{if(!bt(l.conditions))return;const d=s();l.conditions.push(d,["","",""])};return jt(()=>[...l.conditions],()=>{at("condition")},{deep:!0,debounce:100}),(u,d)=>(a(),v(N,null,[l.conditions.length>0?(a(),B(Rt,{key:0,conditions:l.conditions,level:0,disableAddCondition:e(te).condition!=""},null,8,["conditions","disableAddCondition"])):S("",!0),l.conditions.length==0?(a(),v("div",{key:1,class:"flex p-4 items-center cursor-pointer justify-center gap-2 text-sm border border-gray-300 text-gray-600 rounded-md",onClick:d[0]||(d[0]=f=>l.conditions.push(["","",""]))},[i(e(Ie),{name:"plus",class:"h-4"}),oe(" "+w(u.__("Add a custom condition")),1)])):S("",!0),t("div",Cd,[l.conditions.length>0?(a(),B(e(be),{key:0,options:r},{default:C(({open:f})=>[i(e(j),{disabled:e(te).condition!="","icon-right":f?"chevron-up":"chevron-down",label:u.__("Add condition")},null,8,["disabled","icon-right","label"])]),_:1})):S("",!0),i(e(pe),{message:e(te).condition},null,8,["message"])])],64))}}),Ad={class:"flex flex-col gap-4"},Sd={key:0},Vd={class:"flex gap-2"},Dd=O({__name:"WorkDayModal",props:Ve({workDaysList:{type:Array,required:!0}},{modelValue:{required:!0,default:()=>({show:!1,isEditing:!1,data:{workday:"",start_time:"",end_time:""}})},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const l=V(!1),s=o,r=_e(o,"modelValue"),n=Ge({workday:"",start_time:"",end_time:""}),u=Ge({workday:"",start_time:"",end_time:""}),d=h=>{if(h.preventDefault(),!l.value){l.value=!0;return}const y=s.workDaysList.findIndex(k=>k.workday===n.workday);y!==-1&&s.workDaysList.splice(y,1)};function f(h){if(!h)return"";if(/^\d{1,2}:\d{2}:\d{2}$/.test(h)){const[y,k,D]=h.split(":");return`${y.padStart(2,"0")}:${k.padStart(2,"0")}:${D.padStart(2,"0")}`}if(/^\d{1,2}:\d{2}$/.test(h)){const[y,k]=h.split(":");return`${y.padStart(2,"0")}:${k.padStart(2,"0")}:00`}return""}function p(){n.workday="",n.start_time="",n.end_time="",u.workday="",u.start_time="",u.end_time="",l.value=!1}const m=h=>n[h]?(u[h]="",!0):(u[h]="This field is required",!1),_=()=>{if(!n.start_time||!n.end_time)return n.start_time||(u.start_time="Start time is required"),n.end_time||(u.end_time="End time is required"),!1;const[h,y]=n.start_time.split(":").map(Number),[k,D]=n.end_time.split(":").map(Number);return k<h||k===h&&D<=y?(u.end_time="End time must be after start time",!1):(u.end_time="",!0)},b=()=>{const h=m("workday"),y=m("start_time"),k=m("end_time")&&_();return h&&y&&k},g=()=>{if(!b()){H.error("Please fix the errors in the form");return}try{if(r.value.isEditing){const h=s.workDaysList.findIndex(y=>{var k;return y.workday===((k=r.value.data)==null?void 0:k.workday)});if(h!==-1){const y={...s.workDaysList[h],...n};s.workDaysList.splice(h,1,y),H.success("Workday updated")}}else{if(s.workDaysList.some(k=>k.workday===n.workday)){u.workday="This workday already exists",H.error("A workday with this name already exists");return}const y={...n};s.workDaysList.push(y),H.success("Workday added")}r.value.show=!1}catch(h){H.error(`Failed to save workday: ${h}`)}};return ce(()=>r.value.show,h=>{h&&(r.value.isEditing&&r.value.data?(n.workday=r.value.data.workday,n.start_time=f(r.value.data.start_time),n.end_time=f(r.value.data.end_time)):p())}),(h,y)=>{const k=q("ErrorMessage");return a(),B(e(Te),{modelValue:r.value.show,"onUpdate:modelValue":y[6]||(y[6]=D=>r.value.show=D),onAfterLeave:p,options:{title:r.value.isEditing?"Edit workday":"Add workday"}},{"body-content":C(()=>[t("div",Ad,[t("div",null,[i(e(ae),{type:"select",size:"sm",variant:"subtle",placeholder:"Select Workday",label:"Workday",modelValue:n.workday,"onUpdate:modelValue":y[0]||(y[0]=D=>n.workday=D),options:[{label:"Monday",value:"Monday"},{label:"Tuesday",value:"Tuesday"},{label:"Wednesday",value:"Wednesday"},{label:"Thursday",value:"Thursday"},{label:"Friday",value:"Friday"},{label:"Saturday",value:"Saturday"},{label:"Sunday",value:"Sunday"}],class:X({"border-red-500":u.workday}),onBlur:y[1]||(y[1]=D=>m("workday"))},null,8,["modelValue","class"]),i(k,{message:u.workday,class:"mt-2"},null,8,["message"])]),t("div",null,[i(e(ae),{type:"time",size:"sm",variant:"subtle",placeholder:"Start Time",label:"Start Time",modelValue:n.start_time,"onUpdate:modelValue":y[2]||(y[2]=D=>n.start_time=D),class:X({"border-red-500":u.start_time}),onBlur:y[3]||(y[3]=D=>m("start_time"))},null,8,["modelValue","class"]),i(k,{message:u.start_time,class:"mt-2"},null,8,["message"])]),t("div",null,[i(e(ae),{type:"time",size:"sm",variant:"subtle",placeholder:"End Time",label:"End Time",modelValue:n.end_time,"onUpdate:modelValue":y[4]||(y[4]=D=>n.end_time=D),class:X({"border-red-500":u.end_time}),onBlur:_},null,8,["modelValue","class"]),i(k,{message:u.end_time,class:"mt-2"},null,8,["message"])])])]),actions:C(()=>[t("div",{class:X(["flex",{"justify-between":r.value.isEditing,"justify-end":!r.value.isEditing}])},[r.value.isEditing?(a(),v("div",Sd,[i(e(j),{variant:"subtle",theme:l.value?"red":"gray",label:l.value?"Confirm Delete":"Delete",onClick:d,"icon-left":"trash-2"},null,8,["theme","label"])])):S("",!0),t("div",Vd,[i(e(j),{variant:"subtle",theme:"gray",onClick:y[5]||(y[5]=D=>r.value.show=!1),label:"Cancel"}),i(e(j),{variant:"solid",onClick:g,label:"Save"})])],2)]),_:1},8,["modelValue","options"])}}}),Id={key:0},Ed={key:1,class:"ml-2"},Ld=["onUpdate:modelValue"],Bd=["value"],Td={class:"flex justify-end"},Md={key:0},Ud=O({__name:"SlaWorkDaysListItem",props:{columns:{},row:{},isLast:{type:Boolean}},setup(o){const l=o,s=[{label:"Monday",value:"Monday"},{label:"Tuesday",value:"Tuesday"},{label:"Wednesday",value:"Wednesday"},{label:"Thursday",value:"Thursday"},{label:"Friday",value:"Friday"},{label:"Saturday",value:"Saturday"},{label:"Sunday",value:"Sunday"}],r=V({show:!1,isEditing:!1,data:{}}),n=V(!1),u=[{label:"Edit",onClick:()=>f(),icon:"edit"},...Qe({onConfirmDelete:()=>d(),isConfirmingDelete:n})],d=()=>{if(!n.value){n.value=!0;return}const m=R.value.support_and_resolution.indexOf(l.row);m!==-1&&R.value.support_and_resolution.splice(m,1)},f=()=>{r.value.show=!0,r.value.isEditing=!0,r.value.data={workday:l.row.workday,start_time:l.row.start_time,end_time:l.row.end_time}},p=m=>{if(!m)return"00:00";const[_,b]=m.split(":"),g=new Date;return g.setHours(parseInt(_)||0,parseInt(b)||0,0),g.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0})};return(m,_)=>(a(),v(N,null,[t("div",{class:"grid gap-2 py-3.5 px-4 items-center",style:ft({gridTemplateColumns:e(pl)(l.columns)})},[(a(!0),v(N,null,W(l.columns,b=>(a(),v("div",{key:b.key,class:"w-full overflow-hidden whitespace-nowrap text-ellipsis"},[b.key==="start_time"||b.key==="end_time"?(a(),v("div",Id,w(p(l.row[b.key])),1)):(a(),v("div",Ed,[Se(t("select",{class:"w-full h-7 text-base hover:bg-surface-gray-3 rounded-md p-0 pl-2 pr-5 bg-transparent -ml-2 border-0 text-ink-gray-8 focus-visible:!ring-0 bg-none truncate","onUpdate:modelValue":g=>l.row[b.key]=g},[(a(),v(N,null,W(s,g=>t("option",{key:g.value,value:g.value},w(g.label),9,Bd)),64))],8,Ld),[[ml,l.row[b.key]]])]))]))),128)),t("div",Td,[i(e(be),{placement:"right",options:u},{default:C(()=>[i(e(j),{icon:"more-horizontal",variant:"ghost",onClick:_[0]||(_[0]=b=>n.value=!1)})]),_:1})])],4),l.isLast?S("",!0):(a(),v("hr",Md)),i(Dd,{modelValue:r.value,"onUpdate:modelValue":_[1]||(_[1]=b=>r.value=b),workDaysList:e(R).support_and_resolution},null,8,["modelValue","workDaysList"])],64))}}),Rd={class:"rounded-md border px-2 border-gray-300 text-sm"},Nd={key:0,class:"text-red-500"},jd={key:1},Fd={key:2,class:"text-center p-4 text-gray-600"},Od={class:"flex items-center justify-between mt-2.5"},Pd=O({__name:"SlaWorkDaysList",setup(o){const l=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],s=()=>{const n=new Set(R.value.support_and_resolution.map(d=>d.workday)),u=l.find(d=>!n.has(d))||l[0];R.value.support_and_resolution.push({workday:u,start_time:"09:00:00",end_time:"17:00:00",id:Math.random().toString(36).substring(2,9)})},r=[{label:"Day",key:"workday",isRequired:!0},{label:"Start time",key:"start_time",isRequired:!0},{label:"End time",key:"end_time",isRequired:!0}];return(n,u)=>{var f,p,m;const d=q("ErrorMessage");return a(),v(N,null,[t("div",Rd,[((f=e(R).support_and_resolution)==null?void 0:f.length)!==0?(a(),v("div",{key:0,class:"grid p-2 px-4 items-center",style:ft({gridTemplateColumns:e(pl)(r)})},[(a(),v(N,null,W(r,_=>t("div",{key:_.key,class:X(["text-gray-600 overflow-hidden whitespace-nowrap text-ellipsis",{"ml-2":_.key==="workday"}])},[oe(w(_.label)+" ",1),_.isRequired?(a(),v("span",Nd,"*")):S("",!0)],2)),64))],4)):S("",!0),((p=e(R).support_and_resolution)==null?void 0:p.length)!==0?(a(),v("hr",jd)):S("",!0),(a(!0),v(N,null,W(e(R).support_and_resolution,(_,b)=>(a(),B(Ud,{key:b+_.workday+_.id,row:_,columns:r,isLast:b===e(R).support_and_resolution.length-1},null,8,["row","isLast"]))),128)),((m=e(R).support_and_resolution)==null?void 0:m.length)===0?(a(),v("div",Fd," No workdays in the list ")):S("",!0)]),t("div",Od,[e(R).support_and_resolution.length<7?(a(),B(e(j),{key:0,variant:"subtle",label:"Add row",onClick:s,"icon-left":"plus"})):S("",!0),i(d,{message:e(te).support_and_resolution},null,8,["message"])])],64)}}}),xe=V({screen:"list",data:null}),ke=V({holiday_list_name:"",from_date:"",to_date:""}),J=V({holiday_list_name:"",description:"",associate_holiday_list:!0,loading:!1,total_holidays:0,holidays:[],from_date:null,to_date:null,recurring_holidays:[]}),xl=()=>{J.value={holiday_list_name:"",description:"",associate_holiday_list:!0,loading:!1,total_holidays:0,holidays:[],from_date:null,to_date:null,recurring_holidays:[]}},Qt=o=>{const l=s=>{var r;if(!(o&&s!==o))switch(s){case"holiday_list_name":(r=J.value.holiday_list_name)!=null&&r.trim()?ke.value.holiday_list_name="":ke.value.holiday_list_name="Holiday list name is required";break;case"from_date":if(J.value.from_date?ke.value.from_date="":ke.value.from_date="Start date is required",J.value.to_date){const n=new Date(J.value.from_date),u=new Date(J.value.to_date);n>u?ke.value.dateRange="Start date cannot be after end date":ke.value.dateRange=""}break;case"to_date":if(J.value.to_date?ke.value.to_date="":ke.value.to_date="End date is required",J.value.from_date){const n=new Date(J.value.from_date),u=new Date(J.value.to_date);n>u?ke.value.dateRange="Start date cannot be after end date":ke.value.dateRange=""}break}};return o?l(o):Object.keys(ke.value).forEach(l),ke.value};function Bt(){const o=J.value.holidays.filter(l=>!l.weekly_off);for(const l of J.value.recurring_holidays){const s=Qd(J.value.from_date,J.value.to_date,l.day,o,l.repetition);o.push(...s)}J.value.holidays=o}function zd(o){const s=o.startOf("month").day(),r=(o.date()+s-1)/7;return Math.ceil(r)}function Hd(o,l,s,r=[],n){const u=se(o),d=se(l),f=[],m={sunday:0,monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6}[s.toLowerCase()];if(m===void 0)return f;const _=r.map(h=>se(h.holiday_date).startOf("day").toDate());let b=u.day(m);b.isBefore(u,"day")&&(b=b.add(1,"week"));const g=!n||n.all;for(;b.isSameOrBefore(d,"day");){const h=b.toDate(),y=se(h).startOf("day");(g||qd(b,n))&&(_.some(k=>se(k).startOf("day").isSame(y))||f.push(h)),b=b.add(1,"week")}return f}function qd(o,l){if(l.all)return!0;switch(zd(o)){case 1:return l.first;case 2:return l.second;case 3:return l.third;case 4:return l.fourth;case 5:return l.fifth;default:return!1}}function Qd(o,l,s,r=[],n={all:!0,first:!1,second:!1,third:!1,fourth:!1,fifth:!1}){return Hd(o,l,s,r,n).map((d,f)=>({description:s.charAt(0).toUpperCase()+s.slice(1),holiday_date:d,weekly_off:1,idx:f+1,repetition:n}))}const Jd={class:"flex items-center justify-between"},Gd={class:"flex flex-col gap-1"},Wd={class:"text-lg font-semibold text-ink-gray-8"},Zd={class:"text-p-sm text-ink-gray-6 max-w-lg"},Yd={class:"my-2 min-w-40 rounded-lg bg-surface-modal shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none"},Kd={class:"max-h-52 overflow-y-auto p-1"},Xd=["onClick"],ec={class:"flex items-center gap-2 w-full"},tc=["checked"],lc={class:"select-none"},sc={class:"flex cursor-pointer items-center gap-1"},nc={class:"mt-1.5 flex flex-col gap-1 border-t border-outline-gray-modals pt-1.5 p-1"},ac={class:"mt-5"},oc=O({__name:"SlaHolidays",setup(o){const l=()=>{Pe("Business Holidays"),xe.value={screen:"view",data:null,previousScreen:{screen:"view",data:R.value.name}},xl()},s=n=>{Pe("Business Holidays"),xe.value={screen:"view",data:n,previousScreen:{screen:"view",data:R.value.name}}},r=tt({doctype:"HD Service Holiday List",fields:["name","holiday_list_name"],auto:!0});return jt(R.value.support_and_resolution,()=>{at("support_and_resolution")},{debounce:300}),(n,u)=>(a(),v(N,null,[t("div",Jd,[t("div",Gd,[t("div",Wd,w(n.__("Work schedule and holidays")),1),t("div",Zd,w(n.__("Set working days, hours, and holidays by selecting a predefined schedule or creating a new one")),1)]),i(e(Sn),null,{target:C(({open:d})=>[i(e(j),{class:"text-sm","icon-right":d?"chevron-up":"chevron-down",label:e(R).holiday_list},null,8,["icon-right","label"])]),body:C(()=>[t("div",Yd,[t("div",Kd,[(a(!0),v(N,null,W(e(r).data,d=>(a(),v("div",{key:d.name,class:"flex items-center justify-between gap-4 rounded px-2 py-1.5 text-base text-ink-gray-8 cursor-pointer hover:bg-surface-gray-3",onClick:f=>e(R).holiday_list=d.name},[t("div",ec,[t("input",{name:"holiday_list",checked:d.name===e(R).holiday_list,type:"radio"},null,8,tc),t("div",lc,w(d.holiday_list_name),1)]),t("div",sc,[i(e(j),{variant:"ghost",onClick:we(f=>s(d),["stop"]),icon:"edit"},null,8,["onClick"])])],8,Xd))),128))]),t("div",nc,[i(e(j),{class:"w-full !justify-start !text-ink-gray-5",variant:"ghost",label:n.__("Create new business holiday"),onClick:u[0]||(u[0]=d=>l()),"icon-left":"plus"},null,8,["label"])])])]),_:1})]),t("div",ac,[i(Pd)])],64))}});const ic=Me(oc,[["__scopeId","data-v-410cd042"]]),rc={class:"flex gap-2 border border-gray-300 rounded w-fit min-w-max px-4 select-none shadow-sm"},uc={key:0,class:"p-2 flex flex-col items-center group relative"},dc={class:"flex items-center gap-1"},cc={class:"flex flex-col group-hover:opacity-100 opacity-0 absolute top-1/2 -translate-y-1/2 -right-3"},mc={key:1,class:"p-2 flex flex-col items-center group relative"},pc={class:"flex items-center gap-1"},fc={class:"flex flex-col group-hover:opacity-100 opacity-0 absolute top-1/2 -translate-y-1/2 -right-3"},vc={key:2,class:"p-2 flex flex-col items-center group relative"},gc={class:"flex items-center gap-1"},_c={class:"flex flex-col group-hover:opacity-100 opacity-0 absolute top-1/2 -translate-y-1/2 -right-3"},hc=300,yc=50,bc=O({__name:"DurationPicker",props:{modelValue:{default:0},min:{default:0},max:{default:Number.MAX_SAFE_INTEGER},options:{default:()=>({})}},emits:["update:modelValue","change"],setup(o,{emit:l}){const s=o,r=G(()=>{var z,U,ee;return{hours:((z=s.options)==null?void 0:z.hours)??!0,minutes:((U=s.options)==null?void 0:U.minutes)??!0,seconds:((ee=s.options)==null?void 0:ee.seconds)??!1}}),n=G(()=>{const{hours:z,minutes:U,seconds:ee}=r.value;return!z&&!U&&!ee?{hours:!0,minutes:!0,seconds:!1}:{hours:z,minutes:U,seconds:ee}}),u=l,d=V(s.modelValue),f=V(null),p=V(null),m=V(null),_=V(null),b=V(null);let g=!1,h=null;const y=G({get:()=>Math.floor(d.value/3600).toString(),set:z=>{if(z==="")return;const U=parseInt(z,10);if(!isNaN(U)&&U>=0){const ee=U*3600+L()*60+T();$(ee)}}}),k=G({get:()=>Math.floor(d.value%3600/60).toString(),set:z=>{if(z==="")return;const U=parseInt(z,10);if(!isNaN(U)&&U>=0&&U<=59){const ee=M()*3600+U*60+T();$(ee)}}}),D=G({get:()=>(d.value%60).toString(),set:z=>{if(z==="")return;const U=parseInt(z,10);if(!isNaN(U)&&U>=0&&U<=59){const ee=M()*3600+L()*60+U;$(ee)}}});function M(){return Math.floor(d.value/3600)}function L(){return Math.floor(d.value%3600/60)}function T(){return d.value%60}qe(()=>{x(),h&&clearTimeout(h)});function x(){_.value!==null&&(clearInterval(_.value),_.value=null),h&&(clearTimeout(h),h=null),g=!1}function I(z){g||(g=!0,z(),h=window.setTimeout(()=>{g&&(b.value=z,_.value=window.setInterval(()=>{b.value&&b.value()},yc))},hc))}function A(){x()}document.addEventListener("mouseup",A),document.addEventListener("touchend",A),qe(()=>{document.removeEventListener("mouseup",A),document.removeEventListener("touchend",A)});function $(z,U=!0){z=Math.max(s.min,Math.min(s.max,z)),z!==d.value&&(d.value=z,U&&(u("update:modelValue",d.value),u("change",d.value)))}function E(z){switch(z){case"hours":y.value=y.value;break;case"minutes":k.value=k.value;break;case"seconds":D.value=D.value;break}}function Q(z){z.target.blur()}function F(z){let U=d.value;switch(z){case"hours":U+=3600;break;case"minutes":U+=60;break;case"seconds":U+=1;break}$(U)}function Y(z){let U=d.value;switch(z){case"hours":U-=3600;break;case"minutes":U-=60;break;case"seconds":U-=1;break}$(U)}return ce(()=>s.modelValue,z=>{z!==d.value&&(d.value=Math.max(s.min,Math.min(s.max,z)))},{immediate:!0}),(z,U)=>{const ee=q("FeatherIcon");return a(),v("div",rc,[n.value.hours?(a(),v("div",uc,[t("div",dc,[Se(t("input",{ref_key:"hoursInput",ref:f,"onUpdate:modelValue":U[0]||(U[0]=re=>y.value=re),type:"number",min:"0",class:"w-8 text-sm bg-transparent border-0 p-0 text-center focus:ring-0 focus:outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",onBlur:U[1]||(U[1]=re=>E("hours")),onKeyup:Ke(Q,["enter"])},null,544),[[qt,y.value,void 0,{number:!0}]]),t("div",cc,[t("button",{onMousedown:U[2]||(U[2]=re=>I(()=>F("hours"))),onTouchstart:U[3]||(U[3]=re=>I(()=>F("hours"))),onMouseup:x,onMouseleave:x,onTouchend:x,onTouchcancel:x,class:"hover:bg-gray-100 rounded-sm select-none"},[i(ee,{name:"chevron-up",class:"size-3.5"})],32),t("button",{onMousedown:U[4]||(U[4]=re=>I(()=>Y("hours"))),onTouchstart:U[5]||(U[5]=re=>I(()=>Y("hours"))),onMouseup:x,onMouseleave:x,onTouchend:x,onTouchcancel:x,class:"hover:bg-gray-100 rounded-sm select-none"},[i(ee,{name:"chevron-down",class:"size-3.5"})],32)])]),U[18]||(U[18]=t("div",{class:"text-xs text-gray-600 mt-1"},"Hrs",-1))])):S("",!0),n.value.minutes?(a(),v("div",mc,[t("div",pc,[Se(t("input",{ref_key:"minutesInput",ref:p,"onUpdate:modelValue":U[6]||(U[6]=re=>k.value=re),type:"number",min:"0",max:"59",class:"w-8 text-sm bg-transparent border-0 p-0 text-center focus:ring-0 focus:outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",onBlur:U[7]||(U[7]=re=>E("minutes")),onKeyup:Ke(Q,["enter"])},null,544),[[qt,k.value,void 0,{number:!0}]]),t("div",fc,[t("button",{onMousedown:U[8]||(U[8]=re=>I(()=>F("minutes"))),onTouchstart:U[9]||(U[9]=re=>I(()=>F("minutes"))),onMouseup:x,onMouseleave:x,onTouchend:x,onTouchcancel:x,class:"hover:bg-gray-100 rounded-sm select-none"},[i(ee,{name:"chevron-up",class:"size-3.5"})],32),t("button",{onMousedown:U[10]||(U[10]=re=>I(()=>Y("minutes"))),onTouchstart:U[11]||(U[11]=re=>I(()=>Y("minutes"))),onMouseup:x,onMouseleave:x,onTouchend:x,onTouchcancel:x,class:"hover:bg-gray-100 rounded-sm select-none"},[i(ee,{name:"chevron-down",class:"size-3.5"})],32)])]),U[19]||(U[19]=t("div",{class:"text-xs text-gray-600 mt-1"},"Min",-1))])):S("",!0),n.value.seconds?(a(),v("div",vc,[t("div",gc,[Se(t("input",{ref_key:"secondsInput",ref:m,"onUpdate:modelValue":U[12]||(U[12]=re=>D.value=re),type:"number",min:"0",max:"59",class:"w-8 text-sm bg-transparent border-0 p-0 text-center focus:ring-0 focus:outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",onBlur:U[13]||(U[13]=re=>E("seconds")),onKeyup:Ke(Q,["enter"])},null,544),[[qt,D.value,void 0,{number:!0}]]),t("div",_c,[t("button",{onMousedown:U[14]||(U[14]=re=>I(()=>F("seconds"))),onTouchstart:U[15]||(U[15]=re=>I(()=>F("seconds"))),onMouseup:x,onMouseleave:x,onTouchend:x,onTouchcancel:x,class:"hover:bg-gray-100 rounded-sm select-none"},[i(ee,{name:"chevron-up",class:"size-3.5"})],32),t("button",{onMousedown:U[16]||(U[16]=re=>I(()=>Y("seconds"))),onTouchstart:U[17]||(U[17]=re=>I(()=>Y("seconds"))),onMouseup:x,onMouseleave:x,onTouchend:x,onTouchcancel:x,class:"hover:bg-gray-100 rounded-sm select-none"},[i(ee,{name:"chevron-down",class:"size-3.5"})],32)])]),U[20]||(U[20]=t("div",{class:"text-xs text-gray-600 mt-1"},"Sec",-1))])):S("",!0)])}}});const tl=Me(bc,[["__scopeId","data-v-d03c027b"]]);function ll(o){const l=Math.floor(o/86400),s=Math.floor(o%(3600*24)/3600),r=Math.floor(o%3600/60),n=Math.floor(o%60);let u="";return l>0&&(u+=`${l} days `),s>0&&(u+=`${s} hours `),r>0&&(u+=`${r} minutes `),n>0&&(u+=`${n} seconds`),u.trim()}const kc={class:"flex flex-col gap-4"},xc=["onClick"],wc={key:0},Cc={key:1,class:"text-gray-500"},$c={class:"absolute bg-white top-2"},Ac=["onClick"],Sc={key:0},Vc={key:1,class:"text-gray-500"},Dc={class:"absolute bg-white top-2"},Ic={class:"flex justify-between"},Ec={class:"flex gap-2"},Lc=O({__name:"EditResponseResolutionModal",props:Ve({row:{type:Object,required:!0}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:Ve(["onDefaultPriorityChange"],["update:modelValue"]),setup(o,{emit:l}){const s=_e(o,"modelValue"),r=V(!1),n=o,u=fe("priorityOptions"),d=V({priority:n.row.priority,resolution_time:n.row.resolution_time,response_time:n.row.response_time,default_priority:n.row.default_priority}),f=()=>{if(!d.value.priority)return H.error("Please select a priority"),!1;const _=parseInt(d.value.resolution_time);if(isNaN(_)||_<=0)return H.error("Resolution time must be a positive number"),!1;const b=parseInt(d.value.response_time);return isNaN(b)||b<=0?(H.error("Response time must be a positive number"),!1):(d.value.default_priority&&R.value.priorities.forEach(g=>{g.default_priority=!1}),!0)},p=_=>{if(_.preventDefault(),!r.value){r.value=!0;return}R.value.priorities.splice(R.value.priorities.indexOf(n.row),1)},m=()=>{f()&&(n.row.priority=d.value.priority,n.row.resolution_time=d.value.resolution_time,n.row.response_time=d.value.response_time,n.row.default_priority=d.value.default_priority,s.value=!1)};return(_,b)=>(a(),B(e(Te),{modelValue:s.value,"onUpdate:modelValue":b[5]||(b[5]=g=>s.value=g),options:{title:"Edit response and resolution"}},{"body-content":C(()=>[t("div",kc,[i(e(ae),{type:"select",size:"sm",variant:"subtle",placeholder:"Select Priority",label:"Priority",modelValue:d.value.priority,"onUpdate:modelValue":b[0]||(b[0]=g=>d.value.priority=g),options:e(u),required:""},null,8,["modelValue","options"]),t("div",null,[i(e(Ne),{label:"Response time",required:""}),i(e(Re),{class:"mt-2"},{target:C(({togglePopover:g})=>[t("div",{onClick:h=>g(),class:"w-full bg-gray-100 rounded p-1.5 px-2 text-base text-gray-800"},[d.value.response_time?(a(),v("div",wc,w(e(ll)(d.value.response_time)),1)):(a(),v("div",Cc,"Select time"))],8,xc)]),body:C(()=>[t("div",$c,[i(tl,{modelValue:d.value.response_time,"onUpdate:modelValue":b[1]||(b[1]=g=>d.value.response_time=g),options:{seconds:!1}},null,8,["modelValue"])])]),_:1})]),t("div",null,[i(e(Ne),{label:"Resolution time",required:""}),i(e(Re),{class:"mt-2"},{target:C(({togglePopover:g})=>[t("div",{onClick:h=>g(),class:"w-full bg-gray-100 rounded p-1.5 px-2 text-base text-gray-800"},[d.value.resolution_time?(a(),v("div",Sc,w(e(ll)(d.value.resolution_time)),1)):(a(),v("div",Vc,"Select time"))],8,Ac)]),body:C(()=>[t("div",Dc,[i(tl,{modelValue:d.value.resolution_time,"onUpdate:modelValue":b[2]||(b[2]=g=>d.value.resolution_time=g),options:{seconds:!1}},null,8,["modelValue"])])]),_:1})]),i(e(Be),{modelValue:d.value.default_priority,"onUpdate:modelValue":b[3]||(b[3]=g=>d.value.default_priority=g),label:"Set default priority"},null,8,["modelValue"])])]),actions:C(()=>[t("div",Ic,[t("div",null,[i(e(j),{variant:"subtle",theme:r.value?"red":"gray",label:r.value?"Confirm Delete":"Delete",onClick:p,"icon-left":"trash-2"},null,8,["theme","label"])]),t("div",Ec,[i(e(j),{variant:"subtle",theme:"gray",onClick:b[4]||(b[4]=g=>s.value=!1),label:"Cancel"}),i(e(j),{variant:"solid",onClick:m,label:"Save"})])])]),_:1},8,["modelValue"]))}}),Bc={key:0},Tc={key:1},Mc=["onClick"],Uc={class:"absolute bg-white top-2"},Rc={key:2,class:"ml-2"},Nc=["onUpdate:modelValue"],jc=["value"],Fc={class:"flex justify-end"},Oc={key:0},Pc=O({__name:"SlaPriorityListItem",props:{columns:{type:Array,required:!0},row:{type:Object,required:!0},isLast:{type:Boolean,default:!1}},setup(o){const l=o,s=V(!1),r=V(!1),n=V({priority:l.row.priority,resolution_time:l.row.resolution_time,response_time:l.row.response_time,default_priority:l.row.default_priority}),u=fe("priorityOptions"),d=[{label:"Edit",onClick:()=>m(),icon:"edit"},...Qe({onConfirmDelete:()=>p(),isConfirmingDelete:s})],f=fe("gridTemplateColumns"),p=()=>{if(!s.value){s.value=!0;return}R.value.priorities.splice(R.value.priorities.indexOf(l.row),1)},m=()=>{r.value=!0,n.value={priority:l.row.priority,resolution_time:l.row.resolution_time,response_time:l.row.response_time,default_priority:l.row.default_priority}},_=b=>{R.value.priorities.forEach(g=>{g.default_priority=!1}),l.row.default_priority=b};return(b,g)=>(a(),v(N,null,[t("div",{class:"grid gap-2 py-3.5 px-4 items-center",style:ft({gridTemplateColumns:e(f)})},[(a(!0),v(N,null,W(l.columns,h=>(a(),v("div",{key:h.key,class:"w-full overflow-hidden whitespace-nowrap text-ellipsis"},[h.key==="default_priority"?(a(),v("div",Bc,[i(e(Be),{modelValue:l.row.default_priority,"onUpdate:modelValue":[g[0]||(g[0]=y=>l.row.default_priority=y),g[1]||(g[1]=y=>_(y))]},null,8,["modelValue"])])):h.key==="response_time"||h.key==="resolution_time"?(a(),v("div",Tc,[i(e(Re),null,{target:C(({togglePopover:y})=>[t("div",{onClick:k=>y(),class:"min-h-7 w-full cursor-pointer select-none leading-5 p-1 px-2 hover:bg-gray-200 rounded"},w(e(ll)(l.row[h.key])),9,Mc)]),body:C(()=>[t("div",Uc,[i(tl,{modelValue:l.row[h.key],"onUpdate:modelValue":y=>l.row[h.key]=y},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024)])):(a(),v("div",Rc,[Se(t("select",{class:"w-full h-7 text-base hover:bg-surface-gray-3 rounded-md p-0 pl-2 pr-5 bg-transparent -ml-2 border-0 text-ink-gray-8 focus-visible:!ring-0 bg-none truncate","onUpdate:modelValue":y=>l.row[h.key]=y},[(a(!0),v(N,null,W(e(u),y=>(a(),v("option",{key:y.value,value:y.value},w(y.label),9,jc))),128))],8,Nc),[[ml,l.row[h.key]]])]))]))),128)),t("div",Fc,[i(e(be),{placement:"right",options:d},{default:C(()=>[i(e(j),{icon:"more-horizontal",variant:"ghost",onClick:g[2]||(g[2]=h=>s.value=!1)})]),_:1})])],4),l.isLast?S("",!0):(a(),v("hr",Oc)),i(Lc,{modelValue:r.value,"onUpdate:modelValue":g[3]||(g[3]=h=>r.value=h),row:l.row},null,8,["modelValue","row"])],64))}}),zc={class:"rounded-md border px-2 border-gray-300 text-sm"},Hc={key:0,class:"text-red-500"},qc={key:1},Qc={key:2,class:"text-center p-4 text-gray-600"},Jc={key:0,class:"flex items-center justify-between mt-2.5"},Gc=O({__name:"SlaPriorityList",setup(o){K({url:"frappe.client.get_list",params:{doctype:"HD Ticket Priority",fields:["name"],order_by:"integer_value desc"},auto:!0,onSuccess(u){l.push(...u.map(d=>({label:d.name,value:d.name}))),ve.value.data||(R.value.priorities=l.map((d,f)=>({priority:d.value,resolution_time:60*60,response_time:60*60,default_priority:f===0})))}});const l=Ge([]);Oe("priorityOptions",l);const s=()=>{const u=R.value.priorities.map(p=>p.priority),d=l.filter(p=>!u.includes(p.value));if(d.length===0){H.error("All available priorities have already been added");return}const f=d[0].value;R.value.priorities.push({priority:f,resolution_time:60*60,response_time:60*60,default_priority:R.value.priorities.length===0})},r=G(()=>[{label:"Priority",key:"priority",isRequired:!0},{label:"Default priority",key:"default_priority",isRequired:!0},{label:"First response time",key:"response_time",isRequired:!0},{label:"Resolution time",key:"resolution_time",isRequired:!0}]),n=G(()=>pl(r.value));return Oe("gridTemplateColumns",n),jt(()=>[...R.value.priorities],()=>{at("priorities")},{deep:!0,debounce:300}),(u,d)=>{var p,m,_;const f=q("ErrorMessage");return a(),v(N,null,[t("div",zc,[((p=e(R).priorities)==null?void 0:p.length)!==0?(a(),v("div",{key:0,class:"grid p-2 px-4 items-center",style:ft({gridTemplateColumns:n.value})},[(a(!0),v(N,null,W(r.value,b=>(a(),v("div",{key:b.key,class:X(["text-gray-600 overflow-hidden whitespace-nowrap text-ellipsis",{"ml-2":b.key==="priority"||b.key==="response_time"||b.key==="resolution_time"}])},[oe(w(b.label)+" ",1),b.isRequired?(a(),v("span",Hc,"*")):S("",!0)],2))),128))],4)):S("",!0),((m=e(R).priorities)==null?void 0:m.length)!==0?(a(),v("hr",qc)):S("",!0),(a(!0),v(N,null,W(e(R).priorities,(b,g)=>(a(),B(Pc,{key:b.priority,row:b,columns:r.value,isLast:g===e(R).priorities.length-1},null,8,["row","columns","isLast"]))),128)),((_=e(R).priorities)==null?void 0:_.length)===0?(a(),v("div",Qc," No priorities in the list ")):S("",!0)]),e(R).priorities.length!==l.length||e(te).default_priority||e(te).priorities?(a(),v("div",Jc,[t("div",null,[e(R).priorities.length!==l.length?(a(),B(e(j),{key:0,variant:"subtle",label:"Add row",onClick:s,"icon-left":"plus"})):S("",!0)]),i(f,{message:e(te).default_priority||e(te).priorities},null,8,["message"])])):S("",!0)],64)}}}),Wc={class:"flex gap-5 w-full"},Zc=O({__name:"SlaStatusList",setup(o){const{statuses:l}=hl(),s=G(()=>{var r,n;return((n=(r=l==null?void 0:l.data)==null?void 0:r.filter(u=>u.category==="Open"))==null?void 0:n.map(u=>({label:u.label_agent,value:u.label_agent})))||[]});return(r,n)=>{const u=q("FormControl");return a(),v("div",Wc,[i(u,{type:"autocomplete",label:"Default ticket status",options:s.value,class:"flex-1",modelValue:e(R).default_ticket_status,"onUpdate:modelValue":n[0]||(n[0]=d=>e(R).default_ticket_status=d)},null,8,["options","modelValue"]),i(u,{type:"autocomplete",label:"Ticket reopen status",options:s.value,class:"flex-1",modelValue:e(R).reopen_ticket_status,"onUpdate:modelValue":n[1]||(n[1]=d=>e(R).reopen_ticket_status=d)},null,8,["options","modelValue"])])}}}),Yc={class:"flex items-center gap-2"},Kc={class:"flex gap-4 items-center"},Xc={class:"text-sm text-ink-gray-7 font-medium"},em={key:0,class:"flex items-center h-full justify-center"},tm={key:1},lm={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},sm={class:"flex flex-col gap-1"},nm={class:"text-lg font-semibold text-ink-gray-8"},am={class:"text-p-sm text-ink-gray-6"},om={class:"mt-3"},im={class:"flex items-center justify-between"},rm={key:0},um={class:"text-sm text-ink-gray-6 flex gap-1 cursor-default"},dm={class:"text-sm text-ink-gray-6 p-2 bg-white rounded-md max-w-96 text-wrap whitespace-pre-wrap leading-5"},cm={key:0,class:"mt-5"},mm={key:0,class:"flex flex-col gap-3 items-center text-center text-ink-gray-7 text-sm mb-2 border border-gray-300 rounded-md p-3 py-4"},pm={class:"flex flex-col gap-1"},fm={class:"text-lg font-semibold text-ink-gray-8"},vm={class:"text-p-sm text-ink-gray-6"},gm={class:"mt-3.5 flex gap-5 flex-col md:flex-row"},_m={class:"w-full space-y-1.5"},hm={class:"w-full space-y-1.5"},ym={class:"flex flex-col gap-1"},bm={class:"text-lg font-semibold text-ink-gray-8"},km={class:"text-p-sm text-ink-gray-6"},xm={class:"mt-5"},wm={class:"mt-5"},Cm={class:"flex flex-col gap-1"},$m={class:"text-lg font-semibold text-ink-gray-8"},Am={class:"text-p-sm text-ink-gray-6"},Sm={class:"mt-5"},Vm=O({__name:"SlaPolicyView",setup(o){var M,L;const{updateOnboardingStep:l}=it("helpdesk"),s=V({show:!1,title:"",message:"",onConfirm:()=>{}}),r=V(!1),n=V(null),u=V(!0),d=V(!1),f=fe(wt),p=`${window.location.origin}/app/hd-service-level-agreement/${(M=ve.value.data)==null?void 0:M.name}`,m=K({url:"helpdesk.api.sla.get_sla",params:{docname:(L=ve.value.data)==null?void 0:L.name},onSuccess(T){var E,Q;let x;try{x=JSON.parse(T.condition_json||"[]")}catch{H.error("Assignment conditions are invalid or corrupt, recreate the conditions."),x=[]}const I={...T,loading:!1,condition_json:x};R.value=I,R.value.apply_sla_for_resolution=!0,n.value=JSON.stringify(I);const A=((E=R.value.condition)==null?void 0:E.length)>0,$=((Q=R.value.condition_json)==null?void 0:Q.length)>0;A&&!$?(u.value=!1,d.value=!0):(u.value=!0,d.value=!1)}});ve.value.data&&ve.value.fetchData?(R.value.loading=!0,m.submit()):ue.value=!0;const _=()=>{const T={show:!0,title:c("Unsaved changes"),message:c("Are you sure you want to go back? Unsaved changes will be lost."),onConfirm:_};if(r.value&&!s.value.show){s.value=T;return}if(!ve.value.data&&!s.value.show){s.value=T;return}setTimeout(()=>{ve.value={screen:"list",data:null,fetchData:!0}},250),s.value.show=!1},b=()=>{const T=at(void 0,!u.value);if(Object.values(T).some(x=>x)){H.error(c("Invalid fields, check if all are filled in and values are correct."));return}if(ve.value.data){if(d.value&&u.value){s.value={show:!0,title:c("Confirm overwrite"),message:c("Your old conditions will be overwritten. Are you sure you want to save?"),onConfirm:()=>{h(),s.value.show=!1}};return}h()}else g()},g=()=>{var I,A;const T=R.value.default_ticket_status?(I=R.value.default_ticket_status)==null?void 0:I.value:null,x=R.value.reopen_ticket_status?(A=R.value.reopen_ticket_status)==null?void 0:A.value:null;f.insert.submit({...R.value,default_ticket_status:T,ticket_reopen_status:x,condition:mt({conditions:R.value.condition_json,fieldPrefix:"doc"}),condition_json:JSON.stringify(R.value.condition_json)},{onSuccess($){H.success(c("SLA policy created")),ve.value.data=$,ve.value.screen="view",m.submit({docname:$.name}),l("setup_sla",!0)}})},h=()=>{var I,A;const T=R.value.default_ticket_status?(I=R.value.default_ticket_status)==null?void 0:I.value:null,x=R.value.reopen_ticket_status?(A=R.value.reopen_ticket_status)==null?void 0:A.value:null;f.setValue.submit({...R.value,name:ve.value.data.name,default_ticket_status:T,ticket_reopen_status:x,condition:u.value?mt({conditions:R.value.condition_json,fieldPrefix:"doc"}):R.value.condition,condition_json:u.value?JSON.stringify(R.value.condition_json):null},{onSuccess(){m.submit(),H.success(c("SLA policy updated")),f.reload()}})},y=()=>{if(R.value.default_sla){H.error(c("SLA set as default cannot be disabled"));return}R.value.enabled=!R.value.enabled},k=()=>{R.value.default_sla=!R.value.default_sla,R.value.default_sla&&(R.value.enabled=!0)};ce(R,T=>{n.value&&(r.value=JSON.stringify(T)!=n.value,r.value?ue.value=!0:ue.value=!1)},{deep:!0});const D=T=>{r.value&&(T.preventDefault(),T.returnValue=!0)};return Le(()=>{addEventListener("beforeunload",D)}),qe(()=>{removeEventListener("beforeunload",D),Cs(),ue.value=!1}),(T,x)=>{const I=q("FormControl"),A=q("FeatherIcon"),$=Kl;return a(),v(N,null,[i(he,null,{title:C(()=>[t("div",Yc,[i(e(j),{variant:"ghost","icon-left":"chevron-left",label:e(R).service_level||e(c)("New SLA Policy"),size:"md",onClick:x[0]||(x[0]=E=>_()),class:"cursor-pointer -ml-4 hover:bg-transparent focus:bg-transparent focus:outline-none focus:ring-0 focus:ring-offset-0 focus-visible:none active:bg-transparent active:outline-none active:ring-0 active:ring-offset-0 active:text-ink-gray-5 font-semibold text-ink-gray-7 text-lg hover:opacity-70 !pr-0"},null,8,["label"]),r.value?(a(),B(e(Xe),{key:0,variant:"subtle",theme:"orange",size:"sm",label:e(c)("Unsaved")},null,8,["label"])):S("",!0)])]),"header-actions":C(()=>[t("div",Kc,[t("div",{class:"flex items-center justify-between gap-2 cursor-pointer",onClick:y},[i(e(Ee),{size:"sm",modelValue:e(R).enabled,"onUpdate:modelValue":x[1]||(x[1]=E=>e(R).enabled=E)},null,8,["modelValue"]),t("span",Xc,w(e(c)("Enabled")),1)]),i(e(j),{label:e(c)("Save"),theme:"gray",variant:"solid",onClick:x[2]||(x[2]=E=>b()),disabled:!!(!r.value&&e(ve).data),loading:e(R).loading||e(f).setValue.loading},null,8,["label","disabled","loading"])])]),content:C(()=>[e(R).loading?(a(),v("div",em,[i(e(Ze),{class:"w-4"})])):S("",!0),e(R).loading?S("",!0):(a(),v("div",tm,[t("div",lm,[t("div",null,[i(I,{type:"text",size:"sm",variant:"subtle",placeholder:e(c)("Name"),label:e(c)("Name"),modelValue:e(R).service_level,"onUpdate:modelValue":x[3]||(x[3]=E=>e(R).service_level=E),required:"",onChange:x[4]||(x[4]=E=>e(at)("service_level")),disabled:!!e(ve).data,maxlength:"50"},null,8,["placeholder","label","modelValue","disabled"]),i(e(pe),{message:e(te).service_level,class:"mt-2"},null,8,["message"])]),i(I,{type:"textarea",size:"sm",variant:"subtle",placeholder:e(c)("Description"),label:e(c)("Description"),modelValue:e(R).description,"onUpdate:modelValue":x[5]||(x[5]=E=>e(R).description=E),maxlength:"140"},null,8,["placeholder","label","modelValue"])]),x[14]||(x[14]=t("hr",{class:"my-8"},null,-1)),t("div",null,[t("div",sm,[t("span",nm,w(e(c)("Assignment conditions")),1),t("span",am,w(e(c)("Choose which tickets are affected by this policy.")),1)]),t("div",om,[t("div",im,[i(e(Be),{label:e(c)("Set as default SLA"),"model-value":e(R).default_sla,"onUpdate:modelValue":k,class:"text-ink-gray-6 text-base font-medium"},null,8,["label","model-value"]),d.value&&e(ve).data&&!e(R).default_sla?(a(),v("div",rm,[i(e(Re),{trigger:"hover",hoverDelay:.25,placement:"top-end"},{target:C(()=>[t("div",um,[oe(w(e(c)("Old Conditions"))+" ",1),i(A,{name:"info",class:"size-4"})])]),"body-main":C(()=>[t("div",dm,[t("code",null,w(e(R).condition),1)])]),_:1})])):S("",!0)]),e(R).default_sla?S("",!0):(a(),v("div",cm,[u.value?S("",!0):(a(),v("div",mm,[t("span",{class:"text-p-sm"},[x[12]||(x[12]=oe(" Conditions for this SLA were created from ",-1)),t("a",{href:p,target:"_blank",class:"underline"},"desk"),x[13]||(x[13]=oe(" which are not compatible with this UI, you will need to recreate the conditions here if you want to manage and add new conditions from this UI. ",-1))]),i(e(j),{label:e(c)("I understand, add conditions"),variant:"subtle",theme:"gray",onClick:x[6]||(x[6]=E=>u.value=!0)},null,8,["label"])])),u.value?(a(),B($d,{key:1,conditions:e(R).condition_json},null,8,["conditions"])):S("",!0)]))])]),x[15]||(x[15]=t("hr",{class:"my-8"},null,-1)),t("div",null,[t("div",pm,[t("span",fm,w(e(c)("Valid from")),1),t("span",vm,w(e(c)("Choose how long this SLA policy will be active.")),1)]),t("div",gm,[t("div",_m,[i(e(Ne),{label:e(c)("From date"),for:"from_date"},null,8,["label"]),i(e(pt),{modelValue:e(R).start_date,"onUpdate:modelValue":x[7]||(x[7]=E=>e(R).start_date=E),variant:"subtle",placeholder:"11/01/2025",class:"w-full",id:"from_date",onChange:x[8]||(x[8]=E=>e(at)("start_date")),formatter:E=>e(le)(E)},{prefix:C(()=>[i($,{class:"size-4"})]),_:1},8,["modelValue","formatter"]),i(e(pe),{message:e(te).start_date},null,8,["message"])]),t("div",hm,[i(e(Ne),{label:e(c)("To date"),for:"to_date"},null,8,["label"]),i(e(pt),{modelValue:e(R).end_date,"onUpdate:modelValue":x[9]||(x[9]=E=>e(R).end_date=E),variant:"subtle",placeholder:"25/12/2025",class:"w-full",id:"to_date",onChange:x[10]||(x[10]=E=>e(at)("end_date")),formatter:E=>e(le)(E)},{prefix:C(()=>[i($,{class:"size-4"})]),_:1},8,["modelValue","formatter"]),i(e(pe),{message:e(te).end_date},null,8,["message"])])])]),x[16]||(x[16]=t("hr",{class:"my-8"},null,-1)),t("div",null,[t("div",ym,[t("span",bm,w(e(c)("Response and resolution")),1),t("span",km,w(e(c)("Add time targets around support milestones like first reply and resolution times")),1)]),t("div",xm,[t("div",wm,[i(Gc)])])]),x[17]||(x[17]=t("hr",{class:"my-8"},null,-1)),t("div",null,[t("div",Cm,[t("span",$m,w(e(c)("Status details")),1),t("span",Am,w(e(c)("Set the default status assigned when a ticket is created, and the status to apply when a ticket is reopened. If not specified, the default status from HD Settings will be used.")),1)]),t("div",Sm,[i(Zc)])]),x[18]||(x[18]=t("hr",{class:"my-8"},null,-1)),i(ic)]))]),_:1}),i(We,{modelValue:s.value.show,"onUpdate:modelValue":x[11]||(x[11]=E=>s.value.show=E),title:s.value.title,message:s.value.message,onConfirm:s.value.onConfirm,onCancel:()=>s.value.show=!1},null,8,["modelValue","title","message","onConfirm","onCancel"])],64)}}});const Dm=Me(Vm,[["__scopeId","data-v-28be9227"]]),Im=O({__name:"Sla",setup(o){const l=tt({doctype:"HD Service Level Agreement",fields:["name","default_sla","enabled","description"],cache:["SLAPolicyList"],orderBy:"modified desc",start:0,pageLength:999,auto:!0}),s=V("");return Oe("slaSearchQuery",s),Oe(wt,l),qe(()=>{s.value="",l.filters={}}),(r,n)=>e(ve).screen=="list"?(a(),B(od,{key:0})):e(ve).screen=="view"?(a(),B(Dm,{key:1})):S("",!0)}}),Em={class:"flex items-center cursor-pointer hover:bg-gray-50 rounded"},Lm={class:"text-base text-ink-gray-7 font-medium"},Bm={key:0,class:"text-sm text-ink-gray-5 mt-1 truncate"},Tm={class:"flex justify-between items-center pr-2"},Mm={class:"flex flex-col gap-4"},Um={class:"flex gap-2 justify-end"},Rm=O({__name:"HolidayListItem",props:{data:{type:Object,required:!0}},setup(o){const l=o,s=fe(Ct),r=V({show:!1,name:""}),n=V(!1),u=[{label:c("Duplicate"),onClick:()=>{r.value.show=!0,r.value.name=l.data.name+" (Copy)"},icon:"copy"},...Qe({onConfirmDelete:()=>f(),isConfirmingDelete:n})],d=()=>{K({url:"helpdesk.api.holiday_list.duplicate_holiday_list",params:{docname:l.data.name,new_name:r.value.name},onSuccess:p=>{s.reload(),H.success(c("Holiday list duplicated")),r.value={show:!1,name:""},setTimeout(()=>{xe.value={screen:"view",data:p}},250)},auto:!0})},f=()=>{if(!n.value){n.value=!0;return}s.delete.submit(l.data.name,{onSuccess:()=>{H.success(c("Holiday list deleted"))}})};return(p,m)=>{const _=q("FormControl"),b=q("Dialog");return a(),v(N,null,[t("div",Em,[t("div",{class:"w-full pl-2 flex flex-col justify-center h-14",onClick:m[0]||(m[0]=g=>xe.value={screen:"view",data:o.data})},[t("div",Lm,w(o.data.name),1),o.data.description&&o.data.description.length>0?(a(),v("div",Bm,w(o.data.description),1)):S("",!0)]),t("div",Tm,[t("div",null,[i(e(be),{placement:"right",options:u},{default:C(()=>[i(e(j),{icon:"more-horizontal",variant:"ghost",onClick:m[1]||(m[1]=g=>n.value=!1)})]),_:1})])])]),i(b,{options:{title:e(c)("Duplicate Holiday List")},modelValue:r.value.show,"onUpdate:modelValue":m[5]||(m[5]=g=>r.value.show=g)},{"body-content":C(()=>[t("div",Mm,[i(_,{label:e(c)("New Holiday List Name"),type:"text",modelValue:r.value.name,"onUpdate:modelValue":m[2]||(m[2]=g=>r.value.name=g)},null,8,["label","modelValue"])])]),actions:C(()=>[t("div",Um,[i(e(j),{variant:"subtle",label:e(c)("Close"),onClick:m[3]||(m[3]=g=>r.value.show=!1)},null,8,["label"]),i(e(j),{variant:"solid",label:e(c)("Duplicate"),onClick:m[4]||(m[4]=g=>d())},null,8,["label"])])]),_:1},8,["options","modelValue"])],64)}}}),Nm={class:"lucide lucide-briefcase",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function jm(o,l){return a(),v("svg",Nm,[...l[0]||(l[0]=[t("path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"},null,-1),t("rect",{width:"20",height:"14",x:"2",y:"6",rx:"2"},null,-1)])])}const As=Z({name:"lucide-briefcase",render:jm}),Fm={key:0,class:"flex items-center justify-center mt-12"},Om={key:1,class:"-ml-2 grow"},Pm={key:0,class:"flex flex-col items-center justify-center gap-4 h-full"},zm={class:"p-4 size-14.5 rounded-full bg-surface-gray-1 flex justify-center items-center"},Hm={class:"flex flex-col items-center gap-1"},qm={class:"text-base font-medium text-ink-gray-6"},Qm={class:"text-p-sm text-ink-gray-5 max-w-60 text-center"},Jm={key:1},Gm={class:"flex text-sm text-gray-600"},Wm={class:"ml-2"},Zm={key:0,class:"mx-2"},Ym=O({__name:"HolidayList",setup(o){const l=fe(Ct),s=()=>{xl(),xe.value={screen:"view",data:null}};return(r,n)=>{var u;return e(l).list.loading&&!e(l).list.data?(a(),v("div",Fm,[i(e(Ze),{class:"w-4"})])):(a(),v("div",Om,[!e(l).list.loading&&!((u=e(l).list.data)!=null&&u.length)?(a(),v("div",Pm,[t("div",zm,[i(e(As),{class:"size-6 text-ink-gray-6"})]),t("div",Hm,[t("div",qm,w(r.__("No Holiday list found")),1),t("div",Qm,w(r.__("Add one to get started.")),1)]),i(e(j),{label:r.__("New"),variant:"outline","icon-left":"plus",onClick:n[0]||(n[0]=d=>s())},null,8,["label"])])):(a(),v("div",Jm,[t("div",Gm,[t("div",Wm,w(r.__("Schedule name")),1)]),n[1]||(n[1]=t("hr",{class:"mx-2 mt-2"},null,-1)),t("div",null,[(a(!0),v(N,null,W(e(l).list.data,(d,f)=>(a(),v("div",{key:d.name},[i(Rm,{data:d},null,8,["data"]),f!==e(l).list.data.length-1?(a(),v("hr",Zm)):S("",!0)]))),128))])]))]))}}}),Km={class:"relative"},Xm=O({__name:"Holidays",setup(o){const l=fe(Ct),s=fe("holidaySearchRef"),r=()=>{xl(),xe.value={screen:"view",data:null}};return ce(s,n=>{l.filters={name:["like",`%${n}%`]},n||(l.start=0,l.pageLength=10),l.reload()}),(n,u)=>{var p;const d=q("Button"),f=q("Input");return a(),B(he,{title:n.__("Business Holidays"),description:n.__("Set your teamâs working days, hours, and holidays using a template or custom schedule.")},xt({"header-actions":C(()=>[i(d,{label:n.__("New"),theme:"gray",variant:"solid",onClick:u[0]||(u[0]=m=>r()),"icon-left":"plus"},null,8,["label"])]),content:C(()=>[i(Ym)]),_:2},[((p=e(l).data)==null?void 0:p.length)>9||e(s).length?{name:"header-bottom",fn:C(()=>[t("div",Km,[i(f,{"model-value":e(s),onInput:u[1]||(u[1]=m=>s.value=m),placeholder:n.__("Search"),type:"text",class:"bg-white hover:bg-white focus:ring-0 border-outline-gray-2","icon-left":"search",debounce:"300",inputClass:"p-4 pr-12"},null,8,["model-value","placeholder"]),e(s)?(a(),B(d,{key:0,icon:"x",variant:"ghost",onClick:u[2]||(u[2]=m=>s.value=""),class:"absolute right-1 top-1/2 -translate-y-1/2"})):S("",!0)])]),key:"0"}:void 0]),1032,["title","description"])}}}),ep={class:"flex flex-col gap-4 mt-4"},tp={class:"flex flex-col gap-1.5"},lp={class:"flex flex-col gap-1.5"},sp={class:"flex justify-end gap-2"},wl=O({__name:"AddHolidayModal",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o){const l=_e(o,"modelValue"),s=V({holiday_date:"",description:""}),r=()=>{l.value.holiday_date=new Date,l.value.description="",s.value={holiday_date:"",description:""}},n=()=>{var p;if(((p=l.value.description)==null?void 0:p.trim())===""&&(s.value.description="Please enter a description"),l.value.holiday_date||(s.value.holiday_date="Please enter a valid date"),s.value.holiday_date||s.value.description)return;const u=se(l.value.holiday_date).startOf("day"),d=se(J.value.from_date).startOf("day"),f=se(J.value.to_date).startOf("day");if(u.isBefore(d)||u.isAfter(f)){H.error(`Holiday date must be between ${le(J.value.from_date)} and ${le(J.value.to_date)}`);return}if(l.value.editing){const m=J.value.holidays.find(b=>le(b.holiday_date)===le(l.value.holiday_date));if(m&&le(m.holiday_date)!==le(l.value.editing.holiday_date)){H.error("Holiday already exists");return}const _=J.value.holidays.indexOf(l.value.editing);J.value.holidays.splice(_,1,{...l.value,weekly_off:0})}else{if(J.value.holidays.findIndex(_=>le(_.holiday_date)===le(l.value.holiday_date))!==-1){H.error("Holiday already exists");return}J.value.holidays.push({...l.value,weekly_off:0})}l.value={show:!1,holiday_date:null,description:"",editing:null}};return(u,d)=>(a(),B(e(Te),{modelValue:l.value.show,"onUpdate:modelValue":d[5]||(d[5]=f=>l.value.show=f),options:{size:"sm",title:l.value.editing?"Edit Holiday":"Add Holiday"},onAfterLeave:r},{"body-content":C(()=>[t("div",ep,[t("div",tp,[i(e(Ne),{label:"Date",required:""}),i(e(pt),{value:e(se)(l.value.holiday_date).format("MM-DD-YYYY"),"onUpdate:modelValue":d[0]||(d[0]=f=>l.value.holiday_date=f),formatter:f=>e(le)(f),variant:"subtle",placeholder:"Date",class:"w-full",id:"holiday_date",required:"",onChange:d[1]||(d[1]=f=>s.value.holiday_date="")},null,8,["value","formatter"]),i(e(pe),{message:s.value.holiday_date},null,8,["message"])]),t("div",lp,[i(e(ae),{type:"textarea",size:"sm",variant:"subtle",placeholder:"National holiday, etc.",label:"Description",modelValue:l.value.description,"onUpdate:modelValue":d[2]||(d[2]=f=>l.value.description=f),required:"",onChange:d[3]||(d[3]=f=>s.value.description="")},null,8,["modelValue"]),i(e(pe),{message:s.value.description},null,8,["message"])])])]),actions:C(()=>[t("div",sp,[i(e(j),{variant:"subtle",theme:"gray",label:"Cancel",onClick:d[4]||(d[4]=f=>l.value.show=!1)}),i(e(j),{variant:"solid","icon-left":"plus",label:"Add Holiday",onClick:n})])]),_:1},8,["modelValue","options"]))}}),np={class:"rounded-md border px-2 border-gray-300 text-sm"},ap={class:"grid p-2 px-4 items-center gap-2",style:{gridTemplateColumns:"1fr 4fr 22px"}},op={class:"grid gap-2 py-3.5 px-4 items-center",style:{gridTemplateColumns:"1fr 4fr 22px"}},ip=["onUpdate:modelValue"],rp={key:1},up={class:"flex justify-end"},dp={key:0},cp={key:0,class:"text-center p-4 text-gray-600"},mp=O({__name:"HolidaysTableView",setup(o){const l=V(!1),s=p=>[{label:"Edit",onClick:()=>d(p),icon:"edit"},...Qe({onConfirmDelete:()=>f(p),isConfirmingDelete:l})],r=V({show:!1,holiday_date:null,description:"",editing:null}),n=G(()=>J.value.holidays.filter(p=>p.weekly_off==0)),u=[{label:"Date",key:"holiday_date"},{label:"Description",key:"description"}],d=p=>{r.value={show:!0,holiday_date:p.holiday_date,description:p.description,editing:p}},f=p=>{if(!l.value){l.value=!0;return}const m=J.value.holidays.findIndex(_=>{const b=le(_.holiday_date),g=le(p==null?void 0:p.holiday_date);return b===g});J.value.holidays.splice(m,1),l.value=!1};return(p,m)=>{var b;const _=q("Button");return a(),v(N,null,[t("div",np,[t("div",ap,[(a(),v(N,null,W(u,g=>t("div",{key:g.key,class:"text-gray-600 overflow-hidden whitespace-nowrap text-ellipsis"},w(g.label),1)),64))]),m[2]||(m[2]=t("hr",null,null,-1)),(a(!0),v(N,null,W(n.value,(g,h)=>(a(),v("div",{key:g.name},[t("div",op,[(a(),v(N,null,W(u,y=>t("div",{key:y.key,class:"w-full overflow-hidden whitespace-nowrap text-ellipsis"},[y.key==="description"?Se((a(),v("input",{key:0,type:"text",placeholder:"Description","onUpdate:modelValue":k=>g[y.key]=k,class:"!bg-white w-full text-base px-0 focus:!ring-0 border-none hover:bg-white outline-none no-underline focus:!outline-none"},null,8,ip)),[[ln,g[y.key]]]):(a(),v("div",rp,w(e(se)(g[y.key]).format("DD MMM YYYY")),1))])),64)),t("div",up,[i(e(be),{placement:"right",options:s(g)},{default:C(()=>[i(_,{icon:"more-horizontal",variant:"ghost",onClick:m[0]||(m[0]=y=>l.value=!1)})]),_:1},8,["options"])])]),h!==n.value.length-1?(a(),v("hr",dp)):S("",!0)]))),128)),((b=n.value)==null?void 0:b.length)===0?(a(),v("div",cp," No items in the list ")):S("",!0)]),i(wl,{modelValue:r.value,"onUpdate:modelValue":m[1]||(m[1]=g=>r.value=g)},null,8,["modelValue"])],64)}}});var Ss={exports:{}};(function(o,l){(function(s,r){o.exports=r()})(Fl,function(){return function(s,r){r.prototype.isSameOrBefore=function(n,u){return this.isSame(n,u)||this.isBefore(n,u)}}})})(Ss);var pp=Ss.exports;const fp=Ol(pp);var Vs={exports:{}};(function(o,l){(function(s,r){o.exports=r()})(Fl,function(){return function(s,r){r.prototype.weekday=function(n){var u=this.$locale().weekStart||0,d=this.$W,f=(d<u?d+7:d)-u;return this.$utils().u(n)?f:this.subtract(f,"day").add(n,"day")}}})})(Vs);var vp=Vs.exports;const gp=Ol(vp),_p=o=>{const l=[];if(o.all)l.push("week");else{if(o.first&&l.push("first"),o.second&&l.push("second"),o.third&&l.push("third"),o.fourth&&l.push("fourth"),o.fifth&&l.push("fifth"),l.length===0)return"";if(l.length>1){const s=l.pop();l[l.length-1]=`${l[l.length-1]} and ${s}`}return l[0]=l[0].charAt(0)+l[0].slice(1),`Every ${l.join(", ")} week`}return l[0]?`Every ${l[0]}`:""},hp={class:"rounded-md border p-1 border-gray-300 text-sm"},yp={key:0,class:"grid p-2 items-center",style:{gridTemplateColumns:"1fr 4fr 22px"}},bp={key:1,class:"my-0.5"},kp={class:"grid gap-2 px-2 py-2 items-center",style:{gridTemplateColumns:"1fr 4fr 22px"}},xp={key:0},wp={key:1},Cp={class:"flex justify-end"},$p={key:0,class:"my-0.5"},Ap={key:2,class:"text-center p-4 text-gray-600"},Sp={key:0},Vp={key:1,class:"flex flex-col gap-4"},Dp={class:"flex flex-col gap-1.5"},Ip={class:"flex flex-col gap-1.5"},Ep={class:"grid grid-cols-2 gap-2 mt-2"},Lp=O({__name:"RecurringHolidaysList",props:{holidays:{type:Array,default:()=>[],required:!0},holidayData:{type:Object,default:()=>{},required:!0}},setup(o){se.extend(gp),se.extend(fp);const l=V(!1),s=V({day:null,repetition:{all:!1,first:!1,second:!1,third:!1,fourth:!1,fifth:!1},isEditing:!1,editIndex:-1}),r=o,n=[{label:"Day",key:"day"},{label:"Repetition",key:"repetition"}],u=V([{label:"Monday",value:"Monday"},{label:"Tuesday",value:"Tuesday"},{label:"Wednesday",value:"Wednesday"},{label:"Thursday",value:"Thursday"},{label:"Friday",value:"Friday"},{label:"Saturday",value:"Saturday"},{label:"Sunday",value:"Sunday"}]),d=h=>[{label:"Edit",onClick:()=>_(h),icon:"edit"},...Qe({onConfirmDelete:()=>g(h),isConfirmingDelete:p})],f=G(()=>{const h=new Set(r.holidays.filter((y,k)=>!s.value.isEditing||k!==s.value.editIndex).map(y=>y.day));return s.value.isEditing&&s.value.day&&h.delete(s.value.day),u.value.filter(y=>!h.has(y.value))}),p=V(!1),m=()=>{s.value={day:null,repetition:{all:!1,first:!1,second:!1,third:!1,fourth:!1,fifth:!1},isEditing:!1,editIndex:-1},l.value=!0},_=h=>{const y=r.holidays.findIndex(k=>k.day===h.day);s.value={...JSON.parse(JSON.stringify(h)),isEditing:!0,editIndex:y},l.value=!0},b=()=>{if(!s.value.day){H.error("Please select a day of the week");return}const{all:h,first:y,second:k,third:D,fourth:M,fifth:L}=s.value.repetition;if(!h&&!y&&!k&&!D&&!M&&!L){H.error("Please select at least one repetition option");return}const T={...s.value};if(T.isEditing)if(T.editIndex!==void 0&&T.editIndex>=0)r.holidays[T.editIndex]={...T},Bt();else{H.error("Error: Unable to find the holiday to update");return}else{if(r.holidays.some(I=>I.day===T.day&&JSON.stringify(I.repetition)===JSON.stringify(T.repetition))){H.error("Holiday with the same day and repetition already exists");return}r.holidays.push({...T,isEditing:!1}),Bt()}l.value=!1},g=h=>{if(!p.value){p.value=!0;return}const y=r.holidays.findIndex(k=>k.day===h.day);r.holidays.splice(y,1),Bt(),l.value=!1,p.value=!1};return(h,y)=>{var M,L,T;const k=q("Button"),D=q("Dialog");return a(),v(N,null,[t("div",hp,[((M=o.holidays)==null?void 0:M.length)!==0?(a(),v("div",yp,[(a(),v(N,null,W(n,x=>t("div",{key:x.key,class:"text-gray-600 overflow-hidden whitespace-nowrap text-ellipsis"},w(x.label),1)),64))])):S("",!0),((L=o.holidays)==null?void 0:L.length)!==0?(a(),v("hr",bp)):S("",!0),(a(!0),v(N,null,W(o.holidays,(x,I)=>(a(),v("div",{key:x.day},[t("div",kp,[(a(),v(N,null,W(n,A=>t("div",{key:A.key,class:"w-full py-2 overflow-hidden whitespace-nowrap text-ellipsis"},[A.key==="repetition"?(a(),v("div",xp,w(e(_p)(x[A.key])),1)):(a(),v("div",wp,w(x[A.key]),1))])),64)),t("div",Cp,[i(e(be),{placement:"right",options:d(x)},{default:C(()=>[i(k,{icon:"more-horizontal",variant:"ghost",onClick:y[0]||(y[0]=A=>p.value=!1)})]),_:1},8,["options"])])]),I!==o.holidays.length-1?(a(),v("hr",$p)):S("",!0)]))),128)),((T=o.holidays)==null?void 0:T.length)===0?(a(),v("div",Ap," No items in the list ")):S("",!0)]),i(k,{variant:"subtle",onClick:m,class:"mt-2.5",label:"Add Recurring Holiday","icon-left":"plus"}),i(D,{modelValue:l.value,"onUpdate:modelValue":y[8]||(y[8]=x=>l.value=x),options:{size:"md",title:s.value.isEditing?"Edit Recurring Holiday":"Add Recurring Holiday"}},{"body-content":C(()=>[!r.holidayData.from_date||!r.holidayData.to_date?(a(),v("div",Sp,[...y[9]||(y[9]=[t("div",{class:"text-center p-4 text-gray-600"}," Please select start and end date first ",-1)])])):(a(),v("div",Vp,[t("div",Dp,[i(e(Ne),{label:"Day",required:""}),i(e(Pl),{options:f.value,modelValue:s.value.day,"onUpdate:modelValue":y[1]||(y[1]=x=>s.value.day=x),disabled:f.value.length===0},null,8,["options","modelValue","disabled"])]),t("div",Ip,[i(e(Ne),{label:"Repetition",required:""}),t("div",Ep,[i(e(Be),{modelValue:s.value.repetition.all,"onUpdate:modelValue":y[2]||(y[2]=x=>s.value.repetition.all=x),label:"Every week",disabled:s.value.repetition.first||s.value.repetition.second||s.value.repetition.third||s.value.repetition.fourth},null,8,["modelValue","disabled"]),i(e(Be),{modelValue:s.value.repetition.first,"onUpdate:modelValue":y[3]||(y[3]=x=>s.value.repetition.first=x),label:"Every first week",disabled:s.value.repetition.all},null,8,["modelValue","disabled"]),i(e(Be),{modelValue:s.value.repetition.second,"onUpdate:modelValue":y[4]||(y[4]=x=>s.value.repetition.second=x),label:"Every second week",disabled:s.value.repetition.all},null,8,["modelValue","disabled"]),i(e(Be),{modelValue:s.value.repetition.third,"onUpdate:modelValue":y[5]||(y[5]=x=>s.value.repetition.third=x),label:"Every third week",disabled:s.value.repetition.all},null,8,["modelValue","disabled"]),i(e(Be),{modelValue:s.value.repetition.fourth,"onUpdate:modelValue":y[6]||(y[6]=x=>s.value.repetition.fourth=x),label:"Every fourth week",disabled:s.value.repetition.all},null,8,["modelValue","disabled"]),i(e(Be),{modelValue:s.value.repetition.fifth,"onUpdate:modelValue":y[7]||(y[7]=x=>s.value.repetition.fifth=x),label:"Every fifth week",disabled:s.value.repetition.all},null,8,["modelValue","disabled"])])])]))]),actions:C(()=>[r.holidayData.from_date&&r.holidayData.to_date?(a(),B(k,{key:0,variant:"solid",onClick:b,class:"w-full",label:s.value.isEditing?"Update Holiday":"Add Holiday","icon-left":s.value.isEditing?"edit-2":"plus"},null,8,["label","icon-left"])):S("",!0)]),_:1},8,["modelValue","options"])],64)}}}),Bp={class:"w-max mx-auto"},Tp={class:"text-base font-medium mb-2 text-gray-800 ml-2.5"},Mp={class:"rounded-md text-sm"},Up={class:"flex items-center text-xs uppercase"},Rp=["onMouseover","onMouseleave","onClick"],Np=["onMouseover","onMouseleave"],jp={class:"grow"},Fp={class:"text-sm font-semibold"},Op={class:"text-xs mt-1"},Pp=["onMouseover","onMouseleave"],zp=["onClick"],Ll=O({__name:"HLCalender",props:{year:{type:Number,required:!0},month:{type:Number,required:!0},holidays:{type:Array,required:!0}},setup(o){const l=V({show:!1,holiday_date:null,description:"",editing:null}),{currentYear:s,currentMonth:r,today:n,datesAsWeeks:u,formattedMonth:d}=Rn(),f=u,p=V(!1),m=V({}),_=o,b=V(le(n.value)),g=(I,A)=>{m.value[I]&&clearTimeout(m.value[I]),m.value[I]=setTimeout(()=>{A()},350)},h=(I,A)=>{m.value[I]&&clearTimeout(m.value[I]),m.value[I]=setTimeout(()=>{A()},350)},y=I=>{l.value={holiday_date:I,description:"",show:!0,editing:null}},k=I=>{if(!J.value.from_date||!J.value.to_date)return!1;const A=se(I).startOf("day"),$=se(J.value.from_date).startOf("day"),E=se(J.value.to_date).endOf("day");return(A.isAfter($)||A.isSame($,"day"))&&(A.isBefore(E)||A.isSame(E,"day"))},D=I=>{var $;if(!(($=_.holidays)!=null&&$.length))return!1;const A=se(I).startOf("day");return _.holidays.some(E=>se(E.holiday_date).startOf("day").isSame(A))},M=I=>{var $;if(!(($=_.holidays)!=null&&$.length))return!1;const A=se(I).startOf("day");return _.holidays.some(E=>se(E.holiday_date).startOf("day").isSame(A)&&E.weekly_off==1)},L=I=>{const A=_.holidays.find($=>{const E=le($.holiday_date),Q=le(I);return E===Q});l.value={show:!0,holiday_date:A.holiday_date,description:A.description,editing:A}},T=(I,A,$)=>{if(I.stopPropagation(),I.preventDefault(),!p.value){p.value=!0;return}const E=_.holidays.find(F=>{const Y=le(F.holiday_date),z=le(A);return Y===z}),Q=_.holidays.findIndex(F=>{const Y=le(F.holiday_date),z=le(E.holiday_date);return Y===z});_.holidays.splice(Q,1),l.value={show:!1,holiday_date:null,description:"",editing:null},p.value=!1,$()},x=I=>{const A=_.holidays.find(E=>{const Q=le(E.holiday_date),F=le(I);return Q===F});return A!=null&&A.weekly_off?`${Zt((A==null?void 0:A.description)||"")}: Recurring holiday`:Zt((A==null?void 0:A.description)||"")};return ce(()=>[_.year,_.month],([I,A])=>{s.value=I,r.value=A},{immediate:!0}),(I,A)=>{const $=q("Button");return a(),v(N,null,[t("div",Bp,[t("div",Tp,w(e(d)),1),t("div",Mp,[t("div",Up,[(a(),v(N,null,W(["s","m","t","w","t","f","s"],(E,Q)=>t("div",{class:"flex size-7.5 items-center justify-center text-center text-gray-600",key:Q},w(E),1)),64))]),(a(!0),v(N,null,W(e(f),(E,Q)=>(a(),v("div",{class:"flex items-center",key:Q},[(a(!0),v(N,null,W(E,F=>(a(),v("div",{key:e(le)(F)},[D(F)?(a(),B(e(Re),{key:0},{target:C(({open:Y,close:z})=>[t("div",{class:X(["flex size-7 cursor-pointer text-orange-700 bg-yellow-100 items-center justify-center rounded hover:bg-yellow-100 select-none m-[1px]",{"!text-ink-gray-4 !bg-gray-100":M(F)}]),onMouseover:U=>g(e(le)(F),Y),onMouseleave:U=>h(e(le)(F),z),onClick:()=>{M(F)||(z(),L(F))}},w(F.getDate()),43,Rp)]),"body-main":C(({close:Y,open:z})=>[t("div",{class:"p-3 flex gap-2.5 text-ink-gray-9 w-80 border border-gray-100 rounded-md",onMouseover:U=>g(e(le)(F),z),onMouseleave:U=>h(e(le)(F),Y)},[A[2]||(A[2]=t("div",{class:"w-[5%]"},[t("div",{class:"size-3.5 bg-orange-500 rounded-sm mt-1"})],-1)),t("div",jp,[t("div",Fp,w(x(F)),1),t("div",Op,w(F.toLocaleDateString()),1)]),M(F)?S("",!0):(a(),B(e(Re),{key:0,onClose:A[0]||(A[0]=U=>p.value=!1)},{target:C(({open:U,close:ee})=>[i($,{icon:"more-horizontal",variant:"ghost",onClick:U,onMouseleave:re=>h(e(le)(F)+"dropdown",ee)},null,8,["onClick","onMouseleave"])]),"body-main":C(({close:U,open:ee})=>[t("div",{class:"p-2 flex flex-col gap-1 w-40 text-ink-gray-9 border border-gray-100 rounded-md",onMouseover:re=>{g(e(le)(F),z),g(e(le)(F)+"dropdown",ee)},onMouseleave:re=>{h(e(le)(F),Y),h(e(le)(F)+"dropdown",U)}},[i($,{class:"w-full flex !justify-start","icon-left":"edit",variant:"ghost",label:"Edit",onClick:()=>{Y(),U(),L(F)}},null,8,["onClick"]),i($,{class:"w-full flex !justify-start","icon-left":"trash-2",variant:"ghost",label:p.value?"Confirm Delete":"Delete",theme:p.value?"red":"gray",onClick:re=>{T(re,F,()=>{Y(),U()})}},null,8,["label","theme","onClick"])],40,Pp)]),_:2},1024))],40,Np)]),_:2},1024)):(a(),v("div",{key:1,class:X(["flex size-7 items-center justify-center rounded m-[1px] select-none",{"cursor-pointer hover:bg-surface-gray-2":k(F),"text-ink-gray-3":F.getMonth()!==e(r)-1||!k(F),"bg-black text-ink-white hover:!bg-black/80 hover:text-ink-white":e(le)(F)===b.value&&k(F),"opacity-50 cursor-not-allowed":!k(F)}]),onClick:Y=>k(F)?y(F):null},w(F.getDate()),11,zp))]))),128))]))),128))])]),i(wl,{modelValue:l.value,"onUpdate:modelValue":A[1]||(A[1]=E=>l.value=E)},null,8,["modelValue"])],64)}}}),Hp={class:"p-6.5 px-5 rounded-xl border border-gray-300"},qp={class:"mb-6.5 flex justify-between items-center"},Qp={class:"ml-1"},Jp={class:"w-24"},Gp={ref:"yearsContainer",class:"max-h-60 overflow-y-auto py-1"},Wp=["onClick"],Zp={key:1,class:"flex items-center gap-2 px-2 font-semibold text-xl select-none"},Yp={class:"flex gap-2 items-center"},Kp={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5"},Xp={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 justify-between gap-5"},ef={class:"flex gap-2 items-center w-full justify-center mt-8"},tf=O({__name:"HolidaysCalendarView",setup(o){const l=V("first-half"),s=V([1,2,3,4,5,6,7,8,9,10,11,12]),r=V(se().year()),n=V(se(J.value.from_date||se()).year()),u=V(se(J.value.to_date||se()).year()),d=G(()=>{const m=[];for(let _=n.value;_<=u.value;_++)m.push(_);return m}),f=(m,_)=>{r.value=_,_===se(J.value.from_date).year()?se(J.value.from_date).month()>=6&&(l.value="second-half"):_===se(J.value.to_date).year()?se(J.value.to_date).month()>=6&&(l.value="first-half"):l.value="first-half",m()},p=()=>{const m=se();r.value=m.year(),l.value=m.month()>=6?"second-half":"first-half"};return ce(()=>[J.value.from_date,J.value.to_date],([m,_])=>{m=se(m),_=se(_),n.value=m.year(),u.value=_.year(),r.value=m.year(),l.value=m.month()>=6?"second-half":"first-half"}),Le(()=>{const m=se(J.value.from_date||se());l.value=m.month()>=6?"second-half":"first-half"}),(m,_)=>{const b=q("FeatherIcon");return a(),v("div",Hp,[t("div",qp,[t("div",Qp,[n.value!==u.value?(a(),B(e(Re),{key:0},{target:C(({togglePopover:g})=>[i(e(j),{class:"flex items-center gap-2 font-semibold text-xl cursor-pointer select-none",variant:"ghost",onClick:g,label:r.value+"","icon-right":"chevron-down"},null,8,["onClick","label"])]),"body-main":C(({togglePopover:g})=>[t("div",Jp,[t("div",Gp,[(a(!0),v(N,null,W(d.value,h=>(a(),v("div",{key:h,ref_for:!0,ref:"yearItems",class:"cursor-pointer px-3 py-1.5 text-sm hover:bg-gray-100 flex items-center justify-between",onClick:y=>f(g,h)},[oe(w(h)+" ",1),h===r.value?(a(),B(b,{key:0,name:"check",class:"size-4"})):S("",!0)],8,Wp))),128))],512)])]),_:1})):(a(),v("div",Zp,w(n.value),1))]),t("div",Yp,[i(e(j),{variant:"ghost",icon:"chevron-left",disabled:l.value==="first-half",onClick:_[0]||(_[0]=g=>l.value="first-half")},null,8,["disabled"]),i(e(j),{variant:"ghost",label:"Today",onClick:_[1]||(_[1]=g=>p())}),i(e(j),{variant:"ghost",icon:"chevron-right",disabled:l.value==="second-half",onClick:_[2]||(_[2]=g=>l.value="second-half")},null,8,["disabled"])])]),l.value==="first-half"?(a(),v("div",Kp,[(a(!0),v(N,null,W(s.value.slice(0,6),g=>(a(),B(Ll,{key:g,year:r.value,month:g,holidays:e(J).holidays},null,8,["year","month","holidays"]))),128))])):(a(),v("div",Xp,[(a(!0),v(N,null,W(s.value.slice(6,12),g=>(a(),B(Ll,{key:g,year:r.value,month:g,holidays:e(J).holidays},null,8,["year","month","holidays"]))),128))])),t("div",ef,[t("div",{class:X(["size-1.5 rounded-full cursor-pointer",{"bg-black":l.value==="first-half","bg-gray-400":l.value==="second-half"}]),onClick:_[3]||(_[3]=g=>l.value="first-half")},null,2),t("div",{class:X(["size-1.5 rounded-full cursor-pointer",{"bg-black":l.value==="second-half","bg-gray-400":l.value==="first-half"}]),onClick:_[4]||(_[4]=g=>l.value="second-half")},null,2)])])}}}),lf={class:"flex items-center gap-2"},sf={key:0,class:"h-full"},nf={class:"flex items-center gap-2 mt-2"},af={class:"text-sm"},of={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},rf={class:"flex flex-col gap-1"},uf={class:"text-lg font-semibold text-ink-gray-8"},df={class:"text-p-sm text-ink-gray-6"},cf={class:"mt-3.5 flex gap-5 flex-col md:flex-row"},mf={class:"w-full space-y-1.5"},pf={class:"w-full space-y-1.5"},ff={class:"flex flex-col gap-1"},vf={class:"text-lg font-semibold text-ink-gray-8"},gf={class:"text-p-sm text-ink-gray-6"},_f={class:"mt-5"},hf={class:"flex justify-between items-center"},yf={class:"flex justify-between flex-col gap-1"},bf={class:"text-lg font-semibold text-ink-gray-8"},kf={class:"text-p-sm text-ink-gray-6"},xf={class:"mt-5"},wf={class:"mt-2.5 flex justify-between items-center"},Cf={key:0,class:"flex gap-4"},$f={class:"gap-1 flex items-center"},Af={class:"text-sm text-ink-gray-6"},Sf={class:"gap-1 flex items-center"},Vf={class:"text-sm text-ink-gray-6"},Df=O({__name:"HolidayView",setup(o){var k,D;const l=V({show:!1,holiday_date:new Date,description:"",editing:null}),s=V(!1),r=V(null),n=V("calendar"),u=V(!1),d=fe(Ct),f=K({url:"helpdesk.api.holiday_list.get_holiday_list",params:{docname:(k=xe.value.data)==null?void 0:k.name},onSuccess(M){J.value=M,r.value=JSON.stringify(M)},transform(M){for(let L of M.holidays)L.description=Zt(L.description);return M.recurring_holidays=JSON.parse(M.recurring_holidays||"[]"),M}});(D=xe.value.data)!=null&&D.name?(J.value.loading=!0,f.fetch()):r.value=JSON.stringify(J.value);const p=M=>{Qt(M),(!ke.value.dateRange||ke.value.dateRange==="")&&Bt()},m=()=>{if(s.value&&!u.value){u.value=!0;return}xe.value.previousScreen&&(Pe("SLA Policies"),ve.value={screen:"view",data:{name:xe.value.previousScreen.data},fetchData:!1}),u.value=!1,setTimeout(()=>{xe.value={screen:"list",data:null}},250)},_=()=>{const M=Qt();if(Object.values(M).some(L=>L)){H.error(c("Invalid fields, check if all are filled in and values are correct."));return}xe.value.data?h():b()},b=()=>{const M=J.value.holidays.map(L=>({...L,holiday_date:se(L.holiday_date).format("YYYY-MM-DD")}));d.insert.submit({holiday_list_name:J.value.holiday_list_name,description:J.value.description,from_date:J.value.from_date,to_date:J.value.to_date,holidays:M,recurring_holidays:JSON.stringify(J.value.recurring_holidays)},{onSuccess(L){H.success(c("Holiday list created")),xe.value.data=L,xe.value.screen="view",f.submit({docname:L.name})}})},g=K({url:"helpdesk.api.holiday_list.update_holiday_list",onSuccess(M){xe.value.data=M,f.submit({docname:M.name}),H.success(c("Holiday list updated"))}}),h=()=>{const M=J.value.holidays.map(L=>({...L,holiday_date:se(L.holiday_date).format("YYYY-MM-DD")}));g.submit({docname:xe.value.data.name,doc:{holiday_list_name:J.value.holiday_list_name,description:J.value.description,from_date:J.value.from_date,to_date:J.value.to_date,holidays:M,recurring_holidays:JSON.stringify(J.value.recurring_holidays)}})};ce(J,M=>{r.value&&(s.value=JSON.stringify(M)!=r.value,s.value?ue.value=!0:ue.value=!1)},{deep:!0});const y=M=>{s.value&&(M.preventDefault(),M.returnValue=!0)};return Le(()=>{addEventListener("beforeunload",y)}),qe(()=>{removeEventListener("beforeunload",y),ke.value={holiday_list_name:"",from_date:"",to_date:""},ue.value=!1}),(M,L)=>{const T=q("Badge"),x=q("ErrorMessage"),I=Kl;return a(),v(N,null,[i(he,null,{title:C(()=>{var A;return[t("div",lf,[i(e(j),{variant:"ghost","icon-left":"chevron-left",label:((A=e(J))==null?void 0:A.holiday_list_name)||e(c)("New Business Holiday"),size:"md",onClick:L[0]||(L[0]=$=>m()),class:"cursor-pointer -ml-4 hover:bg-transparent focus:bg-transparent focus:outline-none focus:ring-0 focus:ring-offset-0 focus-visible:none active:bg-transparent active:outline-none active:ring-0 active:ring-offset-0 active:text-ink-gray-5 font-semibold text-ink-gray-7 text-lg hover:opacity-70 !pr-0"},null,8,["label"]),s.value?(a(),B(T,{key:0,variant:"subtle",theme:"orange",size:"sm",label:e(c)("Unsaved")},null,8,["label"])):S("",!0)])]}),"header-actions":C(()=>[i(e(j),{label:e(c)("Save"),theme:"gray",variant:"solid",onClick:L[1]||(L[1]=A=>_()),disabled:!!(!s.value&&e(xe).data),loading:e(d).list.loading||e(g).loading||e(f).loading},null,8,["label","disabled","loading"])]),content:C(()=>[e(J).loading?S("",!0):(a(),v("div",sf,[t("div",nf,[t("span",af,[L[13]||(L[13]=oe(" There are in total ",-1)),t("b",null,w(e(J).holidays.length),1),L[14]||(L[14]=oe(" holidays in this list",-1))])]),L[17]||(L[17]=t("hr",{class:"mb-8 mt-2"},null,-1)),t("div",of,[t("div",null,[i(e(ae),{type:"text",size:"sm",variant:"subtle",placeholder:e(c)("Name"),label:e(c)("Name"),modelValue:e(J).holiday_list_name,"onUpdate:modelValue":L[2]||(L[2]=A=>e(J).holiday_list_name=A),required:"",maxlength:"50",onChange:L[3]||(L[3]=A=>e(Qt)("holiday_list_name"))},null,8,["placeholder","label","modelValue"]),i(x,{message:e(ke).holiday_list_name,class:"mt-2"},null,8,["message"])]),i(e(ae),{type:"textarea",size:"sm",variant:"subtle",placeholder:e(c)("Description"),label:e(c)("Description"),modelValue:e(J).description,"onUpdate:modelValue":L[4]||(L[4]=A=>e(J).description=A),maxlength:"140"},null,8,["placeholder","label","modelValue"])]),L[18]||(L[18]=t("hr",{class:"my-8"},null,-1)),t("div",null,[t("div",rf,[t("span",uf,w(e(c)("Valid from")),1),t("span",df,w(e(c)("Choose the duration of this holiday list.")),1)]),t("div",cf,[t("div",mf,[i(e(Ne),{label:e(c)("From date"),for:"from_date",required:""},null,8,["label"]),i(e(pt),{modelValue:e(J).from_date,"onUpdate:modelValue":[L[5]||(L[5]=A=>e(J).from_date=A),L[6]||(L[6]=A=>p("from_date"))],variant:"subtle",placeholder:"11/01/2025",class:"w-full",id:"from_date",formatter:A=>e(le)(A),debounce:300},{prefix:C(()=>[i(I,{class:"size-4"})]),_:1},8,["modelValue","formatter"]),i(x,{message:e(ke).from_date||e(ke).dateRange},null,8,["message"])]),t("div",pf,[i(e(Ne),{label:e(c)("To date"),for:"to_date",required:""},null,8,["label"]),i(e(pt),{modelValue:e(J).to_date,"onUpdate:modelValue":[L[7]||(L[7]=A=>e(J).to_date=A),L[8]||(L[8]=A=>p("to_date"))],variant:"subtle",placeholder:"25/12/2025",class:"w-full",id:"to_date",formatter:A=>e(le)(A),debounce:300},{prefix:C(()=>[i(I,{class:"size-4"})]),_:1},8,["modelValue","formatter"]),i(x,{message:e(ke).to_date},null,8,["message"])])])]),L[19]||(L[19]=t("hr",{class:"my-8"},null,-1)),t("div",null,[t("div",ff,[t("div",vf,w(e(c)("Recurring holidays")),1),t("div",gf,w(e(c)("Add recurring holidays such as weekends.")),1)]),t("div",_f,[i(Lp,{holidayData:e(J),holidays:e(J).recurring_holidays},null,8,["holidayData","holidays"])])]),L[20]||(L[20]=t("hr",{class:"my-8"},null,-1)),t("div",null,[t("div",hf,[t("div",yf,[t("span",bf,w(e(c)("Holidays")),1),t("div",kf,w(e(c)("Add holidays here to make sure theyâre excluded from SLA calculations.")),1)]),i(e(Ln),{buttons:[{value:"calendar",icon:"calendar"},{value:"list",icon:"list"}],modelValue:n.value,"onUpdate:modelValue":L[9]||(L[9]=A=>n.value=A)},null,8,["modelValue"])]),t("div",xf,[n.value==="list"?(a(),B(mp,{key:0})):(a(),B(tf,{key:1}))]),t("div",wf,[i(e(j),{variant:"subtle",label:e(c)("Add Holiday"),onClick:L[10]||(L[10]=A=>l.value.show=!0),"icon-left":"plus"},null,8,["label"]),n.value==="calendar"?(a(),v("div",Cf,[t("div",$f,[L[15]||(L[15]=t("span",{class:"bg-yellow-100 size-4 rounded-sm"},null,-1)),t("span",Af,w(e(c)("Holidays")),1)]),t("div",Sf,[L[16]||(L[16]=t("span",{class:"bg-gray-100 size-4 rounded-sm"},null,-1)),t("span",Vf,w(e(c)("Recurring holidays")),1)])])):S("",!0)])])]))]),_:1}),i(wl,{modelValue:l.value,"onUpdate:modelValue":L[11]||(L[11]=A=>l.value=A)},null,8,["modelValue"]),i(We,{modelValue:u.value,"onUpdate:modelValue":L[12]||(L[12]=A=>u.value=A),title:e(c)("Unsaved changes"),message:e(c)("Are you sure you want to go back? Unsaved changes will be lost."),onConfirm:m,onCancel:()=>u.value=!1},null,8,["modelValue","title","message","onCancel"])],64)}}});const If=Me(Df,[["__scopeId","data-v-26564b10"]]),Ef=O({__name:"Holiday",setup(o){const l=tt({doctype:"HD Service Holiday List",fields:["name","description"],cache:["HolidayList"],orderBy:"modified desc",start:0,pageLength:999,auto:!0}),s=V("");return Oe("holidaySearchRef",s),Oe(Ct,l),qe(()=>{s.value="",l.filters={}}),(r,n)=>e(xe).screen=="list"?(a(),B(Xm,{key:0})):e(xe).screen=="view"?(a(),B(If,{key:1})):S("",!0)}}),Fe=tt({doctype:"HD Form Script",filters:{is_standard:1,name:["like","%Field Dependency%"]},fields:["name","enabled","owner"],auto:!0,cache:["FD","List"],orderBy:"modified desc",start:0,pageLength:999}),Lf=G(()=>{var l;let o=[];return(l=Fe.data)==null||l.forEach(s=>{let[r,n,u]=s.name.split("-");n&&u&&(o.push(u),o.push(n))}),o}),dt=Ge({});async function Bf(o){if(dt[o.value])return dt[o.value];if(o.type==="Select")return dt[o.value]=o.options.split(`
`),dt[o.value];if(o.type==="Link"){let l=await Je("frappe.client.get_list",{doctype:o.options,fields:["name"],limit_page_length:999});return dt[o.value]=l.map(s=>s.name),dt[o.value]}}const Tf=["href"],sl=O({__name:"DocumentationButton",props:{url:{},color:{}},setup(o){return(l,s)=>{const r=sn,n=q("Tooltip");return a(),B(n,{text:"View documentation"},{default:C(()=>[t("a",{href:o.url,target:"_blank"},[i(r,{class:X(["h-4 w-4 text-ink-gray-6",o.color])},null,8,["class"])],8,Tf)]),_:1})}}}),Mf={class:"lucide lucide-square-check-big",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Uf(o,l){return a(),v("svg",Mf,[...l[0]||(l[0]=[t("path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344"},null,-1),t("path",{d:"m9 11 3 3L22 4"},null,-1)])])}const Ds=Z({name:"lucide-check-square",render:Uf}),Rf={class:"lucide lucide-square",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Nf(o,l){return a(),v("svg",Rf,[...l[0]||(l[0]=[t("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"},null,-1)])])}const Is=Z({name:"lucide-square",render:Nf}),jf={name:"Autocomplete",props:["label","modelValue","options","placeholder","bodyClasses","multiple","loading","hideSearch","autoFocus","placement","showFooter","buttonClasses","disabled"],emits:["update:modelValue","update:query","change"],components:{Popover:Re,Combobox:al,ComboboxInput:ol,ComboboxOptions:il,ComboboxOption:rl,ComboboxButton:nn,LucideCheckSquare:Ds,LucideSquare:Is},expose:["togglePopover"],data(){return{query:"",showOptions:!1}},computed:{selectedValue:{get(){var l;let o;return this.multiple?(o=(l=this.modelValue)==null?void 0:l.map(s=>{const r=this.findOption(s);return r||this.sanitizeOption(s)}),this.modelValue&&!o.length&&(o=this.sanitizeOptions(this.modelValue)),o):(o=this.findOption(this.modelValue),this.modelValue&&!o&&(o=this.sanitizeOption(this.modelValue)),o)},set(o){this.query="",o&&!this.multiple&&(this.showOptions=!1),this.$emit("update:modelValue",o)}},groups(){var l;return!this.options||this.options.length==0?[]:((l=this.options[0])!=null&&l.group?this.options:[{group:"",items:this.sanitizeOptions(this.options)}]).map((s,r)=>({key:r,group:s.group,hideLabel:s.hideLabel||!1,items:this.filterOptions(this.sanitizeOptions(s.items))})).filter(s=>s.items.length>0)},allOptions(){return this.groups.flatMap(o=>o.items)},areAllOptionsSelected(){var o;return this.multiple?this.allOptions.length===((o=this.selectedValue)==null?void 0:o.length):!1}},watch:{query(o){this.$emit("update:query",o)},showOptions(o){o&&cl(()=>{var l,s;return(s=(l=this.$refs.searchInput)==null?void 0:l.$el)==null?void 0:s.focus()})}},methods:{togglePopover(o){this.showOptions=o??!this.showOptions},findOption(o){return o&&this.allOptions.find(l=>l.value===(o.value||o))},filterOptions(o){return this.query?fuzzySearch(o,{term:this.query,keys:["label","value"]}):o},displayValue(o){if(!o)return"";if(!this.multiple){if(typeof o=="object")return this.getLabel(o);let l=this.allOptions.find(s=>s.value===o);return this.getLabel(l)}return!Array.isArray(o)||o.length===0?"":o.length===1?this.getLabel(o[0]):`${o.length} values`},getLabel(o){return typeof o!="object"?o:(o==null?void 0:o.label)||(o==null?void 0:o.value)||"No label"},sanitizeOptions(o){return o?o.map(l=>this.sanitizeOption(l)):[]},sanitizeOption(o){return typeof o=="string"?{label:o,value:o}:o},isOptionSelected(o){var l,s;return this.multiple?(s=this.selectedValue)==null?void 0:s.find(r=>r&&r.value===o.value):((l=this.selectedValue)==null?void 0:l.value)===o.value},selectAll(){this.selectedValue=this.allOptions},fuzzySearch(o,{term:l,keys:s}){const r=l.toLowerCase();return o.reduce((u,d)=>{const f=s.reduce((p,m)=>{const _=d[m];if(_){const b=_.toLowerCase().indexOf(r);if(b!==-1)return p+b+1}return p},0);return f&&u.push({item:d,score:f}),u},[]).sort((u,d)=>u.score-d.score).map(u=>u.item)}}},Ff={class:"w-full space-y-1.5"},Of={key:0,class:"block text-xs text-gray-600"},Pf=["onClick"],zf={class:"flex flex-1 items-center gap-2 overflow-hidden"},Hf={key:0,class:"flex-1 truncate text-left text-base leading-5"},qf={key:1,class:"text-base leading-5 text-gray-600"},Qf={key:0,class:"relative mb-1 w-full flex-shrink-0"},Jf={class:"w-full flex-1 overflow-y-auto"},Gf={key:0,class:"sticky top-0 truncate bg-white px-2.5 py-1.5 text-sm font-medium text-gray-600"},Wf={class:"flex flex-1 items-center gap-2 overflow-hidden"},Zf={key:0,class:"flex-shrink-0"},Yf={class:"flex-1 truncate"},Kf={key:0,class:"ml-2 flex-shrink-0"},Xf={key:0,class:"text-sm text-gray-600"},ev={key:1,class:"rounded-md px-2.5 py-1.5 text-base text-gray-600"},tv={key:0,class:"border-t p-1"},lv={key:0,class:"flex items-center justify-end gap-1"},sv={key:1,class:"flex items-center justify-end"};function nv(o,l,s,r,n,u){const d=q("FeatherIcon"),f=q("LoadingIndicator"),p=q("ComboboxInput"),m=Is,_=Ds,b=q("ComboboxOption"),g=q("ComboboxOptions"),h=q("Button"),y=q("Popover"),k=q("Combobox");return a(),B(k,{modelValue:u.selectedValue,"onUpdate:modelValue":l[4]||(l[4]=D=>u.selectedValue=D),multiple:s.multiple,nullable:""},{default:C(({open:D})=>[i(y,{class:"w-full",show:n.showOptions,"onUpdate:show":l[3]||(l[3]=M=>n.showOptions=M),placement:s.placement},{target:C(({open:M,togglePopover:L,close:T})=>[Ce(o.$slots,"target",Yt(Kt({open:M,close:T,togglePopover:L,isOpen:D})),()=>[t("div",Ff,[o.$props.label?(a(),v("label",Of,w(o.$props.label),1)):S("",!0),t("button",{class:X(["flex h-7 w-full items-center justify-between gap-2 rounded bg-gray-100 py-1 px-2 transition-colors hover:bg-gray-200 focus:ring-2 focus:ring-gray-400",[D?"bg-gray-200":"",o.$props.buttonClasses,s.disabled?"cursor-not-allowed opacity-50":""]]),onClick:()=>{!s.disabled&&L()}},[t("div",zf,[Ce(o.$slots,"prefix"),u.selectedValue?(a(),v("span",Hf,w(u.displayValue(u.selectedValue)),1)):(a(),v("span",qf,w(s.placeholder||""),1)),Ce(o.$slots,"suffix")]),Se(i(d,{name:"chevron-down",class:"h-4 w-4 text-gray-600","aria-hidden":"true"},null,512),[[He,!s.loading]]),Se(i(f,{class:"h-4 w-4 text-gray-600"},null,512),[[He,s.loading]])],10,Pf)])])]),body:C(({isOpen:M,togglePopover:L})=>[Se(t("div",null,[t("div",{class:X(["relative mt-1 overflow-hidden rounded-lg bg-white text-base shadow-2xl",s.bodyClasses])},[i(g,{class:"flex max-h-[15rem] flex-col overflow-hidden p-1.5",static:""},{default:C(()=>[s.hideSearch?S("",!0):(a(),v("div",Qf,[i(p,{ref:"searchInput",class:"form-input w-full",type:"text",value:n.query,onChange:l[0]||(l[0]=T=>n.query=T.target.value),autocomplete:"off",placeholder:"Search"},null,8,["value"]),t("button",{class:"absolute right-0 inline-flex h-7 w-7 items-center justify-center",onClick:l[1]||(l[1]=T=>u.selectedValue=null)},[i(d,{name:"x",class:"w-4"})])])),t("div",Jf,[(a(!0),v(N,null,W(u.groups,T=>Se((a(),v("div",{key:T.key},[T.group&&!T.hideLabel?(a(),v("div",Gf,w(T.group),1)):S("",!0),(a(!0),v(N,null,W(T.items.slice(0,50),(x,I)=>(a(),B(b,{as:"template",key:(x==null?void 0:x.value)||I,value:x},{default:C(({active:A,selected:$})=>[t("li",{class:X(["flex h-7 cursor-pointer items-center justify-between rounded px-2.5 text-base",{"bg-gray-100":A}])},[t("div",Wf,[o.$slots["item-prefix"]||o.$props.multiple?(a(),v("div",Zf,[Ce(o.$slots,"item-prefix",Mt({ref_for:!0},{active:A,selected:$,option:x}),()=>[Se(i(m,{class:"h-4 w-4 text-gray-700"},null,512),[[He,!u.isOptionSelected(x)]]),Se(i(_,{class:"h-4 w-4 text-gray-700"},null,512),[[He,u.isOptionSelected(x)]])])])):S("",!0),t("span",Yf,w(u.getLabel(x)),1)]),o.$slots["item-suffix"]||x!=null&&x.description?(a(),v("div",Kf,[Ce(o.$slots,"item-suffix",Mt({ref_for:!0},{active:A,selected:$,option:x}),()=>[x!=null&&x.description?(a(),v("div",Xf,w(x.description),1)):S("",!0)])])):S("",!0)],2)]),_:2},1032,["value"]))),128))])),[[He,T.items.length>0]])),128))]),u.groups.length==0?(a(),v("li",ev," No results found ")):S("",!0)]),_:3}),o.$slots.footer||s.showFooter||s.multiple?(a(),v("div",tv,[Ce(o.$slots,"footer",Yt(Kt({togglePopover:L})),()=>[s.multiple?(a(),v("div",lv,[u.areAllOptionsSelected?S("",!0):(a(),B(h,{key:0,label:"Select All",onClick:we(u.selectAll,["stop"])},null,8,["onClick"]))])):(a(),v("div",sv,[i(h,{label:"Clear",onClick:l[2]||(l[2]=we(T=>u.selectedValue=null,["stop"]))})]))])])):S("",!0)],2)],512),[[He,M]])]),_:2},1032,["show","placement"])]),_:3},8,["modelValue","multiple"])}const Bl=Me(jf,[["render",nv]]),av={class:"flex justify-between items-start flex-col gap-6"},ov={class:"text-sm text-ink-gray-5 pt-4 w-full"},iv={class:"flex flex-col gap-4 w-full pb-2"},rv={class:"flex items-center gap-3 justify-between"},uv={class:"flex gap-3 items-center"},dv={class:"flex items-center gap-1"},cv={class:"text-sm text-ink-gray-5"},mv={class:"flex items-center gap-3 justify-between w-full"},pv={class:"flex gap-3 items-center"},fv={class:"flex items-center gap-1"},vv={class:"text-sm text-ink-gray-5"},gv=O({__name:"FieldDependencyCriteria",props:Ve({parentFieldValues:{}},{modelValue:{},modelModifiers:{},selections:{},selectionsModifiers:{}}),emits:["update:modelValue","update:selections"],setup(o){const l=o,s=_e(o,"modelValue"),r=_e(o,"selections"),{getField:n}=zl("HD Ticket"),u=G(()=>{var _,b;let p=r.value.selectedChildField,m=r.value.selectedParentField;return p=(_=n(p))==null?void 0:_.label,m=(b=n(m))==null?void 0:b.label,{childField:p,parentField:m}}),d=G(()=>{const p=[{label:"Any",value:"Any"}];return l.parentFieldValues.forEach(m=>{p.some(_=>_.value===m)||p.push({label:m,value:m})}),p});function f(p,m){const _=p.map(b=>b.value);s.value[m].value=p,_.length===0?s.value[m].value=[{label:"Any",value:"Any"}]:_[0]==="Any"&&_.length>1?s.value[m].value=_.filter(b=>b!=="Any").map(b=>({label:b,value:b})):_.at(-1)==="Any"&&_.length>1&&(s.value[m].value=[{label:"Any",value:"Any"}])}return(p,m)=>(a(),v("div",av,[t("span",ov,"Set visibility and mandatory criteria for "+w(u.value.childField||"child")+" field:",1),t("div",iv,[t("div",rv,[t("div",uv,[i(e(Ee),{modelValue:s.value.display.enabled,"onUpdate:modelValue":m[0]||(m[0]=_=>s.value.display.enabled=_)},null,8,["modelValue"]),t("div",dv,[t("span",cv,"Show "+w(u.value.childField)+" if "+w(u.value.parentField)+" is set to",1),i(sl,{url:"https://docs.frappe.io/helpdesk/field-dependency#handling-visibility-of-child-field",color:"!text-ink-gray-6"})])]),i(Bl,{disabled:!s.value.display.enabled,class:"min-w-[120px] max-w-[120px]",options:d.value,"model-value":s.value.display.value,"onUpdate:modelValue":m[1]||(m[1]=_=>f(_,"display")),multiple:!0,placeholder:"Select Child Field values",placement:"top"},null,8,["disabled","options","model-value"])]),t("div",mv,[t("div",pv,[i(e(Ee),{modelValue:s.value.mandatory.enabled,"onUpdate:modelValue":m[2]||(m[2]=_=>s.value.mandatory.enabled=_)},null,8,["modelValue"]),t("div",fv,[t("span",vv,"Make "+w(u.value.childField)+" mandatory if "+w(u.value.parentField)+" is set to",1),i(sl,{url:"https://docs.frappe.io/helpdesk/field-dependency#handling-if-the-child-field-is-mandatory",color:"!text-ink-gray-6"})])]),i(Bl,{disabled:!s.value.mandatory.enabled,class:"min-w-[120px] max-w-[120px]",options:d.value,"model-value":s.value.mandatory.value,"onUpdate:modelValue":m[3]||(m[3]=_=>f(_,"mandatory")),multiple:!0,placeholder:"Select Child Field values",placement:"top"},null,8,["disabled","options","model-value"])])])]))}}),_v={class:"flex gap-3 w-full justify-between flex-1"},hv={class:"flex-1 flex flex-col gap-1.5"},yv={class:"flex-1 flex flex-col gap-1.5"},bv=O({__name:"FieldDependencyFieldsSelection",props:Ve({isNew:{type:Boolean},parentFields:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const l=_e(o,"modelValue");return(s,r)=>(a(),v("div",_v,[t("div",hv,[r[2]||(r[2]=t("span",{class:"block text-xs text-ink-gray-5"},[oe("Parent Field "),t("span",{class:"text-ink-red-3 select-none"},"*")],-1)),i(e(Al),{modelValue:l.value.selectedParentField,"onUpdate:modelValue":r[0]||(r[0]=n=>l.value.selectedParentField=n),options:o.parentFields,disabled:!o.isNew},null,8,["modelValue","options","disabled"])]),t("div",yv,[r[3]||(r[3]=t("span",{class:"block text-xs text-ink-gray-5"},[oe("Child Field "),t("span",{class:"text-ink-red-3 select-none"},"*")],-1)),i(e(Al),{modelValue:l.value.selectedChildField,"onUpdate:modelValue":r[1]||(r[1]=n=>l.value.selectedChildField=n),options:l.value.childFields,disabled:!l.value.selectedParentField||!o.isNew},null,8,["modelValue","options","disabled"])])]))}}),kv={class:"flex w-full flex-1 justify-between h-full h-[420px] max-h-[420px] min-h-[420px]"},xv={class:"flex-1 flex flex-col gap-1.5"},wv={class:"border flex-1 border-r-0 rounded-l p-2 flex flex-col gap-2"},Cv={class:"flex-1 overflow-y-auto hide-scrollbar basis-0"},$v={class:"max-w-[350px] overflow-y-auto"},Av=["onClick"],Sv={class:"text-base text-ink-gray-6 max-w-[90%] truncate"},Vv={key:1,class:"flex flex-col items-center mt-20 h-full text-ink-gray-4 text-sm"},Dv={class:"flex-1 flex flex-col gap-1.5"},Iv={class:"border flex-1 rounded-r p-2 flex flex-col gap-2"},Ev={class:"flex-1 overflow-y-auto hide-scrollbar basis-0"},Lv={class:"text-base text-ink-gray-8 font-medium"},Bv={class:"max-w-[350px] overflow-y-auto"},Tv=["onClick"],Mv={class:"text-base text-ink-gray-6"},Uv={key:1,class:"flex flex-col items-center mt-20 h-full text-ink-gray-4 text-sm"},Rv={key:2,class:"flex flex-col items-center mt-20 h-full text-ink-gray-4 text-sm"},Nv=O({__name:"FieldDependencyValueSelection",props:Ve({isNew:{type:Boolean},parentFields:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const l=o,s=_e(o,"modelValue"),r=G(()=>s.value.parentSearch?s.value.parentFieldValues.filter(y=>y.toLowerCase().includes(s.value.parentSearch.toLowerCase())):s.value.parentFieldValues),n=G(()=>s.value.childSearch?s.value.childFieldValues.filter(y=>y.toLowerCase().includes(s.value.childSearch.toLowerCase())):s.value.childFieldValues),u=G(()=>{var k;return s.value.selectedParentField?`Search ${(k=l.parentFields.find(D=>D.value===s.value.selectedParentField))==null?void 0:k.label} values`:"Search values"}),d=G(()=>s.value.currentParentSelection?`Search ${s.value.currentParentSelection} values`:"Search values");function f(y){s.value.currentParentSelection=y}function p(y){const k=s.value.currentParentSelection;k&&(s.value.childSelections[k]instanceof Set||(s.value.childSelections[k]=new Set),s.value.childSelections[k].has(y)?s.value.childSelections[k].delete(y):s.value.childSelections[k].add(y))}function m(y){return s.value.childSelections[y]instanceof Set?s.value.childSelections[y].size:0}const _=G({get(){const y=s.value.currentParentSelection;return!y||!(s.value.childSelections[y]instanceof Set)?!1:s.value.childSelections[y].size===n.value.length},set(y){g(y)}}),b=G(()=>{const y=s.value.currentParentSelection;if(!y)return"Select All";const k=m(y);return k===0?"Select All":`${k} ${k===1?"value":"values"} selected`});function g(y){const k=s.value.currentParentSelection;k&&(s.value.childSelections[k]instanceof Set||(s.value.childSelections[k]=new Set),y?n.value.forEach(D=>{s.value.childSelections[k].add(D)}):s.value.childSelections[k].clear())}function h(y){const k=s.value.currentParentSelection;return s.value.childSelections[k]instanceof Set&&s.value.childSelections[k].has(y)}return(y,k)=>{const D=vl,M=q("FormControl"),L=Bn,T=q("Badge");return a(),v("div",kv,[t("div",xv,[k[3]||(k[3]=t("span",{class:"block text-xs text-ink-gray-5"}," Select parent field value ",-1)),t("div",wv,[s.value.selectedParentField?(a(),v(N,{key:0},[i(M,{modelValue:s.value.parentSearch,"onUpdate:modelValue":k[0]||(k[0]=x=>s.value.parentSearch=x),placeholder:u.value,type:"text",class:"w-full"},{prefix:C(()=>[i(D,{class:"h-4 w-4 text-gray-500"})]),_:1},8,["modelValue","placeholder"]),t("div",Cv,[t("ul",$v,[(a(!0),v(N,null,W(r.value,x=>(a(),v("li",{key:x,class:X(["py-2 mb-1 px-2.5 cursor-pointer rounded flex justify-between items-center hover:bg-surface-gray-1 overflow-hidden max-w-full",{"bg-surface-gray-2 hover:bg-surface-gray-3":s.value.currentParentSelection===x}]),onClick:I=>f(x)},[t("span",Sv,w(x),1),m(x)===0||s.value.currentParentSelection===x?(a(),B(L,{key:0,class:"h-4 w-4 text-ink-gray-6"})):(a(),B(T,{key:1,label:m(x),theme:"gray",variant:"subtle",class:"!h-4"},null,8,["label"]))],10,Av))),128))])])],64)):(a(),v("div",Vv," Please select a parent field first "))])]),t("div",Dv,[k[4]||(k[4]=t("span",{class:"block text-xs text-ink-gray-5 pl-1.5"}," Select child field value ",-1)),t("div",Iv,[s.value.selectedChildField&&s.value.currentParentSelection?(a(),v(N,{key:0},[i(M,{modelValue:s.value.childSearch,"onUpdate:modelValue":k[1]||(k[1]=x=>s.value.childSearch=x),placeholder:d.value,type:"text",class:"w-full"},{prefix:C(()=>[i(D,{class:"h-4 w-4 text-gray-500"})]),_:1},8,["modelValue","placeholder"]),t("div",Ev,[t("li",{class:"py-2 mb-1 px-2.5 cursor-pointer rounded flex items-center bg-surface-gray-1 hover:bg-surface-gray-2",onClick:k[2]||(k[2]=x=>g(!_.value))},[i(M,{type:"checkbox","model-value":_.value,class:"mr-2"},null,8,["model-value"]),t("span",Lv,w(b.value),1)]),t("ul",Bv,[(a(!0),v(N,null,W(n.value,x=>(a(),v("li",{key:x,class:"py-2 mb-1 px-2.5 cursor-pointer rounded flex items-center hover:bg-surface-gray-1 max-w-full truncate",onClick:I=>p(x)},[i(M,{type:"checkbox","model-value":h(x),class:"mr-2"},null,8,["model-value"]),t("span",Mv,w(x),1)],8,Tv))),128))])])],64)):s.value.selectedChildField?(a(),v("div",Rv," Please select a parent value first ")):(a(),v("div",Uv," Please select a child field first "))])])])}}}),jv={class:"flex items-center gap-2"},Fv={class:"flex gap-4"},Ov={class:"flex gap-2 items-center"},Pv={class:"text-p-base text-ink-gray-6"},zv={class:"flex gap-1"},Hv={class:"w-full flex-1 flex flex-col gap-8"},qv={class:"flex flex-col gap-8"},Qv=O({__name:"FieldDependency",props:{fieldDependencyName:{type:String,default:""}},emits:["update:step"],setup(o,{emit:l}){const s=o,r=l,n=G(()=>!s.fieldDependencyName),u=G(()=>n.value?c("New Field Dependency"):Hl(s.fieldDependencyName)),{getFields:d}=zl("HD Ticket"),f=G(()=>{let x=d();if(!x||x.length===0)return[];const I=["status","agreement_status"];return x=x.filter(A=>(A.fieldtype==="Select"||A.fieldtype==="Link")&&!I.includes(A.fieldname)),x.map(A=>({label:A.label,value:A.fieldname,options:A.options||[],type:A.fieldtype}))});let p=Ge({selectedParentField:"",selectedChildField:"",childFields:[],parentFieldValues:[],childFieldValues:[],currentParentSelection:"",childSelections:{},initialChildSelections:{},parentSearch:"",childSearch:"",enabled:!0}),m=Ge({display:{enabled:!0,value:[{label:"Any",value:"Any"}]},mandatory:{enabled:!0,value:[{label:"Any",value:"Any"}]}});const _=K({url:"helpdesk.api.settings.field_dependency.create_update_field_dependency",auto:!1,makeParams:()=>({parent_field:p.selectedParentField,child_field:p.selectedChildField,parent_child_mapping:k(),enabled:p.enabled,fields_criteria:JSON.stringify(m)}),onSuccess:()=>{if(!n.value){b.reload();return}r("update:step","fd-list")}}),b=K({url:"helpdesk.api.settings.field_dependency.get_field_dependency",params:{name:s.fieldDependencyName},auto:!n.value,onSuccess:x=>{p.selectedParentField=x.parent_field,p.selectedChildField=x.child_field,p.enabled=x.enabled,g(x.parent_child_mapping),h(x.fields_criteria)}});function g(x){const I=JSON.parse(x||"{}");let A={};Object.keys(I).forEach($=>{A[$]=new Set(I[$])}),p.childSelections=A,p.initialChildSelections=structuredClone(A),p.currentParentSelection||(p.currentParentSelection=Object.keys(I)[0]||"")}function h(x){const I=JSON.parse(x||"{}");m.display=I.display||{enabled:!0,value:[{label:"Any",value:"Any"}]},m.mandatory=I.mandatory||{enabled:!0,value:[{label:"Any",value:"Any"}]}}const y=G(()=>{var x,I;return n.value?p.enabled!==!0||p.selectedParentField!=="":b.loading?!1:!!((x=b.data)!=null&&x.enabled)!=!!p.enabled||k(p.childSelections)!==k(p.initialChildSelections)||JSON.stringify(m)!==((I=b.data)==null?void 0:I.fields_criteria)});ce(()=>y.value,x=>{ue.value=x});function k(x=null){const I=x&&Object.keys(x).length>0?x:p.childSelections,A={};return Object.keys(I).forEach($=>{Array.from(I[$]).length&&(A[$]=Array.from(I[$]))}),JSON.stringify(A)}async function D(x,I){if(!x)return[];if(I)if(n.value){p.selectedChildField="",p.childFieldValues=[],p.currentParentSelection="",p.childSelections={};let E=[x,...Lf.value];p.childFields=f.value.filter(Q=>!E.includes(Q.value))}else p.childFields=f.value.filter(E=>E.value===p.selectedChildField);const A=I?f.value.find(E=>E.value===x):p.childFields.find(E=>E.value===x);return A?await Bf(A):[]}const M=V(!1);function L(){if(!_.loading){if(y.value){M.value=!0;return}r("update:step","fd-list")}}function T(){if(!y.value)return;_.submit();let x=n.value?c("Field Dependency created successfully"):c("Field Dependency updated successfully");H.success(x)}return ce(()=>p.selectedParentField,async x=>{p.parentFieldValues=await D(x,!0)}),ce(()=>p.selectedChildField,async x=>{p.childFieldValues=await D(x,!1),n.value&&(p.childSelections={}),p.currentParentSelection=p.parentFieldValues[0]||""}),ce(()=>p.currentParentSelection,()=>{p.childSearch=""}),qe(()=>{ue.value=!1}),(x,I)=>{const A=q("Button"),$=q("Badge");return a(),v(N,null,[i(he,null,{title:C(()=>[t("div",jv,[i(A,{variant:"ghost","icon-left":"chevron-left",label:u.value,size:"md",onClick:L,class:"cursor-pointer -ml-4 hover:bg-transparent focus:bg-transparent focus:outline-none focus:ring-0 focus:ring-offset-0 focus-visible:none active:bg-transparent active:outline-none active:ring-0 active:ring-offset-0 active:text-ink-gray-5 font-semibold text-ink-gray-7 text-lg hover:opacity-70 !pr-0"},null,8,["label"]),y.value?(a(),B($,{key:0,theme:"orange"},{default:C(()=>[oe(w(e(c)("Unsaved")),1)]),_:1})):S("",!0)])]),"header-actions":C(()=>[t("div",Fv,[t("div",Ov,[i(e(Ee),{modelValue:e(p).enabled,"onUpdate:modelValue":I[0]||(I[0]=E=>e(p).enabled=E),class:"!w-fit"},null,8,["modelValue"]),t("span",Pv,w(e(c)("Enabled")),1)]),t("div",zv,[i(A,{label:e(c)("Save"),variant:"solid",size:"sm",disabled:!e(p).selectedParentField||!e(p).selectedChildField||Object.keys(e(p).childSelections).length===0,loading:e(_).loading,onClick:T},null,8,["label","disabled","loading"])])])]),content:C(()=>[t("div",null,[t("div",Hv,[i(bv,{modelValue:e(p),"onUpdate:modelValue":I[1]||(I[1]=E=>_t(p)?p.value=E:p=E),"is-new":n.value,"parent-fields":f.value},null,8,["modelValue","is-new","parent-fields"]),t("div",qv,[i(Nv,{modelValue:e(p),"onUpdate:modelValue":I[2]||(I[2]=E=>_t(p)?p.value=E:p=E),"is-new":n.value,"parent-fields":f.value},null,8,["modelValue","is-new","parent-fields"]),i(gv,{"parent-field-values":e(p).parentFieldValues,modelValue:e(m),"onUpdate:modelValue":I[3]||(I[3]=E=>_t(m)?m.value=E:m=E),selections:e(p),"onUpdate:selections":I[4]||(I[4]=E=>_t(p)?p.value=E:p=E)},null,8,["parent-field-values","modelValue","selections"])])])])]),_:1}),i(We,{modelValue:M.value,"onUpdate:modelValue":I[5]||(I[5]=E=>M.value=E),title:e(c)("Unsaved changes"),message:e(c)("Are you sure you want to go back? Unsaved changes will be lost."),onConfirm:()=>x.$emit("update:step","fd-list"),onCancel:()=>M.value=!1},null,8,["modelValue","title","message","onConfirm","onCancel"])],64)}}}),Jv={class:"flex items-center gap-2"},Gv={class:"text-lg font-semibold text-ink-gray-8"},Wv={class:"text-p-sm max-w-md text-ink-gray-6"},Zv={class:"grow"},Yv={key:0,class:"flex items-center justify-center py-4"},Kv={key:1,class:"flex flex-col items-center justify-center gap-4 p-4 h-full"},Xv={class:"p-4 size-14.5 rounded-full bg-surface-gray-1 flex justify-center items-center"},eg={class:"flex flex-col items-center gap-1"},tg={class:"text-base font-medium text-ink-gray-6"},lg={class:"text-p-sm text-ink-gray-5 max-w-60 text-center"},sg={key:2,class:"w-full -ml-2"},ng={class:"grid grid-cols-11 items-center gap-4 text-sm text-gray-600"},ag={class:"col-span-7 ml-2"},og={class:"col-span-2"},ig={class:"col-span-2"},rg={class:"grid grid-cols-11 items-center gap-4 cursor-pointer hover:bg-gray-50 rounded h-12.5"},ug=["onClick"],dg={class:"col-span-2 flex items-center gap-1"},cg={class:"text-base text-ink-gray-7 truncate"},mg={class:"flex justify-between items-center w-full pr-2 col-span-2"},pg={key:0,class:"mx-2"},fg=O({__name:"FieldDependencyList",setup(o){Le(()=>{Fe.reload()});const l=V(!1);function s(n){return Qe({isConfirmingDelete:l,onConfirmDelete:()=>{Fe.delete.submit(n,{onSuccess:()=>{H.success(c("Field dependency deleted successfully")),Fe.reload()}})}})}function r(n,u){Fe.setValue.submit({name:n,enabled:u},{onSuccess:()=>{H.success(c("Field dependency updated successfully."))}})}return(n,u)=>{const d=Ql;return a(),B(he,null,{title:C(()=>[t("div",Jv,[t("h1",Gv,w(e(c)("Field Dependencies")),1),i(sl,{url:"https://docs.frappe.io/helpdesk/field-dependency",color:"!text-ink-gray-6"})])]),description:C(()=>[t("p",Wv,w(e(c)("Create dependencies between fields to dynamically control options based on user selections.")),1)]),"header-actions":C(()=>[i(e(j),{label:e(c)("New"),theme:"gray",variant:"solid",onClick:u[0]||(u[0]=f=>n.$emit("update:step","fd")),"icon-left":"plus"},null,8,["label"])]),content:C(()=>{var f,p;return[t("div",Zv,[e(Fe).loading?(a(),v("div",Yv,[i(e(Ze),{scale:5})])):S("",!0),!e(Fe).loading&&!((f=e(Fe).data)!=null&&f.length)?(a(),v("div",Kv,[t("div",Xv,[i(ns,{class:"size-6 text-ink-gray-6"})]),t("div",eg,[t("div",tg,w(e(c)("No field dependency found")),1),t("div",lg,w(e(c)("Add one to get started")),1)]),i(e(j),{label:e(c)("New"),variant:"outline","icon-left":"plus",onClick:u[1]||(u[1]=m=>n.$emit("update:step","fd"))},null,8,["label"])])):S("",!0),!e(Fe).loading&&((p=e(Fe).data)==null?void 0:p.length)>0?(a(),v("div",sg,[t("div",null,[t("div",ng,[t("div",ag,w(e(c)("Name")),1),t("div",og,w(e(c)("Created By")),1),t("div",ig,w(e(c)("Enabled")),1)]),u[4]||(u[4]=t("hr",{class:"mt-2 mx-2"},null,-1)),(a(!0),v(N,null,W(e(Fe).data,(m,_)=>(a(),v("div",{key:m.name},[t("div",rg,[t("div",{onClick:we(b=>n.$emit("update:step","fd",m.name),["stop"]),class:"w-full py-3 pl-2 col-span-7 text-base text-ink-gray-7"},[t("span",null,w(e(Hl)(m.name)),1)],8,ug),t("div",dg,[i(e(lt),{size:"sm",image:m.owner,label:m.owner},null,8,["image","label"]),t("span",cg,w(m.owner),1)]),t("div",mg,[t("div",null,[i(e(Ee),{"model-value":m.enabled,"onUpdate:modelValue":b=>r(m.name,b),onClick:u[2]||(u[2]=we(()=>{},["stop"]))},null,8,["model-value","onUpdate:modelValue"])]),t("div",null,[i(e(be),{placement:"right",options:s(m.name)},{default:C(()=>[i(e(j),{variant:"ghost",onClick:u[3]||(u[3]=we(()=>{l.value=!1},["stop"]))},{icon:C(()=>[i(d,{class:"h-4 w-4"})]),_:1})]),_:1},8,["options"])])])]),_!==e(Fe).data.length-1?(a(),v("hr",pg)):S("",!0)]))),128))])])):S("",!0)])]}),_:1})}}}),vg={key:0,class:"h-full"},gg={key:1,class:"h-full"},_g=O({__name:"FieldDependencyConfig",setup(o){const l=V("fd-list"),s=V("");function r(n,u){l.value=n,s.value=u}return(n,u)=>l.value==="fd-list"?(a(),v("div",vg,[i(fg,{"onUpdate:step":r})])):l.value==="fd"?(a(),v("div",gg,[i(Qv,{"onUpdate:step":r,"field-dependency-name":s.value},null,8,["field-dependency-name"])])):S("",!0)}}),hg={class:"mt-8 text-base font-semibold"},yg={class:"flex flex-col gap-[0.375rem] mt-3"},bg={class:"text-base"},kg={class:"text-ink-gray-8"},xg={class:"text-ink-gray-5"},wg=O({__name:"InviteAgents",setup(o){const l=et(),{isAdmin:s,isManager:r}=l,{updateOnboardingStep:n}=it("helpdesk"),u=V(""),d=T=>{switch(T){case"Agent":return"Agent";case"Agent Manager":return"Manager";case"System Manager":return"Admin";default:const x=T;throw new Error(`Invalid role: ${x}`)}},f=[{label:d("Agent"),value:"Agent",description:c("Can work on tickets, create custom views and manage private views.")}],p={label:d("Agent Manager"),value:"Agent Manager",description:c("Can invite new agents, manage tickets, create custom views and manage public views.")};s?f.push(p,{label:d("System Manager"),value:"System Manager",description:c("Can manage all aspects of Helpdesk.")}):r&&f.push(p);const m=V(f[0].value),_=G(()=>f.find(T=>T.value===m.value).description),b=async()=>{u.value.trim()===""&&H.error(c("At least one email required")),await y.submit({emails:u.value,roles:L(m.value),redirect_to_path:"/helpdesk",app_name:"helpdesk"}),g()},g=()=>{u.value="",m.value=f[0].value},h=T=>T.join(", "),y=K({url:"frappe.core.api.user_invitation.invite_by_email",onSuccess(T){g();let x=h(T.invited_emails);x.trim()!==""&&H.success(`${x} invited successfully`),x=h(T.disabled_user_emails),x.trim()!==""&&H.info(`${x} already present and disabled`),x=h(T.pending_invite_emails),x.trim()!==""&&H.info(`${x} already invited`),x=h(T.accepted_invite_emails),x.trim()!==""&&H.info(`${x} already present`),k.reload(),n("invite_your_team")}}),k=K({url:"frappe.core.api.user_invitation.get_pending_invitations",params:{app_name:"helpdesk"},auto:!0,method:"GET"}),D=K({url:"frappe.core.api.user_invitation.cancel_invitation",method:"PATCH",onSuccess(){H.success("Invitation cancelled successfully"),k.fetch()}}),M=T=>{const x=new Set(T);if(x.has("System Manager"))return d("System Manager");if(x.has("Agent Manager"))return d("Agent Manager");if(x.has("Agent"))return d("Agent");throw new Error(`Invalid roles: ${T.join(", ")}`)},L=T=>{const x=[];switch(T){case"System Manager":x.push("Agent","Agent Manager");break;case"Agent Manager":x.push("Agent");break;case"Agent":break;default:const I=T;throw new Error(`Invalid selected role: ${I}`)}return x.push(T),x};return(T,x)=>(a(),B(he,{title:e(c)("Invite Agents"),description:e(c)("Easily invite new agents, managers, or admins.")},{content:C(()=>{var I;return[t("form",{onSubmit:we(b,["prevent"]),class:"flex flex-col gap-5"},[i(e(ae),{type:"textarea",required:!0,label:e(c)("Invite by email"),placeholder:"user1@example.com, user2@example.com, ...",modelValue:u.value,"onUpdate:modelValue":x[0]||(x[0]=A=>u.value=A),debounce:100,description:e(c)("Comma separated emails to invite")},null,8,["label","modelValue","description"]),i(e(ae),{label:e(c)("Role"),type:"select",required:!0,options:f,modelValue:m.value,"onUpdate:modelValue":x[1]||(x[1]=A=>m.value=A),description:_.value},null,8,["label","modelValue","description"]),i(e(j),{type:"submit",variant:"solid",class:"w-fit mt-1",disabled:e(D).loading,loading:e(y).loading},{default:C(()=>[oe(w(e(c)("Send Invites")),1)]),_:1},8,["disabled","loading"])],32),(I=e(k).data)!=null&&I.length?(a(),v(N,{key:0},[t("h2",hg,w(e(c)("Pending Invites")),1),t("ul",yg,[(a(!0),v(N,null,W(e(k).data,A=>(a(),v("li",{key:A.name,class:"flex items-center justify-between px-3 py-1 rounded-lg bg-surface-gray-2"},[t("div",bg,[t("span",kg,w(A.email),1),t("span",xg," ("+w(M(A.roles))+") ",1)]),t("div",null,[i(e(kt),{disabled:e(y).loading||e(D).loading,text:e(c)("Cancel Invitation")},{default:C(()=>[t("div",null,[i(e(j),Mt({icon:"x",variant:"ghost",loading:e(D).loading&&A.name===e(D).params.name,onClick:()=>{e(y).loading||e(D).loading||e(D).submit({name:A.name,app_name:"helpdesk"})}},{ref_for:!0},{...e(D).loading&&e(D).params.name!==A.name||e(y).loading?{"aria-disabled":!0,class:"opacity-25"}:{}}),null,16,["loading","onClick"])])]),_:2},1032,["disabled","text"])])]))),128))])],64)):S("",!0)]}),_:1},8,["title","description"]))}}),Cg={class:"lucide lucide-mail-open",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function $g(o,l){return a(),v("svg",Cg,[...l[0]||(l[0]=[t("path",{d:"M21.2 8.4c.5.38.8.97.8 1.6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V10a2 2 0 0 1 .8-1.6l8-6a2 2 0 0 1 2.4 0l8 6Z"},null,-1),t("path",{d:"m22 10-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 10"},null,-1)])])}const Es=Z({name:"lucide-mail-open",render:$g}),Ag={class:"lucide lucide-user-plus",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Sg(o,l){return a(),v("svg",Ag,[...l[0]||(l[0]=[t("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"},null,-1),t("circle",{cx:"9",cy:"7",r:"4"},null,-1),t("line",{x1:"19",x2:"19",y1:"8",y2:"14"},null,-1),t("line",{x1:"22",x2:"16",y1:"11",y2:"11"},null,-1)])])}const Ls=Z({name:"lucide-user-plus",render:Sg}),Vg={class:"grid grid-cols-12 items-center gap-4 cursor-pointer hover:bg-gray-50 rounded"},Dg={class:"text-base text-ink-gray-7 font-medium"},Ig={key:0,class:"text-sm w-full text-ink-gray-5 mt-1 truncate"},Eg={class:"col-span-3"},Lg=["value"],Bg={class:"flex justify-between items-center w-full pr-2 col-span-2"},Tg={class:"flex flex-col gap-4"},Mg={class:"flex gap-2 justify-end"},Ug=O({__name:"AssignmentRuleListItem",props:{data:{type:Object,required:!0}},setup(o){const l=fe(_l),s=o,r=[{label:"Low",value:"0"},{label:"Low-Medium",value:"1"},{label:"Medium",value:"2"},{label:"Medium-High",value:"3"},{label:"High",value:"4"}],n=V({show:!1,name:""}),u=V(!1),d=()=>{K({url:"frappe.client.delete",params:{doctype:"Assignment Rule",name:s.data.name},onSuccess:()=>{l.reload(),u.value=!1,H.success(c("Assignment rule deleted"))},auto:!0})},f=[{label:c("Duplicate"),onClick:()=>{n.value={show:!0,name:s.data.name+" (Copy)"}},icon:"copy"},...Qe({onConfirmDelete:()=>d(),isConfirmingDelete:u})],p=()=>{K({url:"helpdesk.api.assignment_rule.duplicate_assignment_rule",params:{docname:s.data.name,new_name:n.value.name},onSuccess:g=>{l.reload(),H.success(c("Assignment rule duplicated")),n.value.show=!1,n.value.name="",Ae.value={screen:"view",data:{name:g.name}}},auto:!0})},m=()=>{b("priority",s.data.priority)},_=()=>{if(!s.data.users_exists&&s.data.disabled){H.error(c("Cannot enable rule without adding users in it"));return}b("disabled",!s.data.disabled,"status")},b=(g,h,y=void 0)=>{K({url:"frappe.client.set_value",params:{doctype:"Assignment Rule",name:s.data.name,fieldname:g,value:h},onSuccess:()=>{l.reload(),H.success(c("Assignment rule {0} updated",y||g))},auto:!0})};return(g,h)=>(a(),v(N,null,[t("div",Vg,[t("div",{onClick:h[0]||(h[0]=y=>Ae.value={screen:"view",data:o.data}),class:"w-full pl-2 col-span-7 h-14 flex flex-col justify-center"},[t("div",Dg,w(o.data.name),1),o.data.description&&o.data.description.length>0?(a(),v("div",Ig,w(o.data.description),1)):S("",!0)]),t("div",Eg,[Se(t("select",{class:"w-full h-7 text-base hover:bg-surface-gray-3 rounded-md p-0 pl-2 pr-5 bg-transparent -ml-2 border-0 text-ink-gray-8 focus-visible:!ring-0 bg-none truncate","onUpdate:modelValue":h[1]||(h[1]=y=>o.data.priority=y),"on:update:modelValue":m,onChange:m},[(a(),v(N,null,W(r,y=>t("option",{key:y.value,value:y.value},w(y.label),9,Lg)),64))],544),[[ml,o.data.priority]])]),t("div",Bg,[t("div",null,[i(e(Ee),{size:"sm",modelValue:!o.data.disabled,"onUpdate:modelValue":_},null,8,["modelValue"])]),t("div",null,[i(e(be),{placement:"right",options:f},{default:C(()=>[i(e(j),{icon:"more-horizontal",variant:"ghost",onClick:h[2]||(h[2]=y=>u.value=!1)})]),_:1})])])]),i(e(Te),{options:{title:e(c)("Duplicate Assignment Rule")},modelValue:n.value.show,"onUpdate:modelValue":h[6]||(h[6]=y=>n.value.show=y)},{"body-content":C(()=>[t("div",Tg,[i(e(ae),{label:e(c)("New Assignment Rule Name"),type:"text",modelValue:n.value.name,"onUpdate:modelValue":h[3]||(h[3]=y=>n.value.name=y)},null,8,["label","modelValue"])])]),actions:C(()=>[t("div",Mg,[i(e(j),{variant:"subtle",label:e(c)("Close"),onClick:h[4]||(h[4]=y=>n.value.show=!1)},null,8,["label"]),i(e(j),{variant:"solid",label:e(c)("Duplicate"),onClick:h[5]||(h[5]=y=>p())},null,8,["label"])])]),_:1},8,["options","modelValue"])],64))}}),Rg={key:0,class:"flex items-center justify-center mt-12"},Ng={key:1,class:"-ml-2 grow"},jg={key:0,class:"flex flex-col items-center justify-center gap-4 h-full"},Fg={class:"p-4 size-14.5 rounded-full bg-surface-gray-1 flex justify-center items-center"},Og={class:"flex flex-col items-center gap-1"},Pg={class:"text-base font-medium text-ink-gray-6"},zg={class:"text-p-sm text-ink-gray-5 max-w-60 text-center"},Hg={key:1},qg={class:"grid grid-cols-12 items-center gap-4 text-sm text-gray-600"},Qg={class:"col-span-7 ml-2"},Jg={class:"col-span-3"},Gg={class:"col-span-2"},Wg={key:0,class:"mx-2"},Zg=O({__name:"AssignmentRulesListView",setup(o){const l=fe(_l),s=V(l.data||[]),r=fe("assignmentRuleSearchQuery"),n=()=>{bl(),Ae.value={screen:"view",data:null}};return ce(()=>[r.value,l.data],([u,d])=>{if(!u){s.value=d||[];return}s.value=(d==null?void 0:d.filter(f=>f.name.toLowerCase().includes(u.toLowerCase())||f.description.toLowerCase().includes(u.toLowerCase())))||[]}),(u,d)=>{var p;const f=q("Button");return e(l).loading&&!e(l).data?(a(),v("div",Rg,[i(e(Ze),{class:"w-4"})])):(a(),v("div",Ng,[!e(l).loading&&!((p=s.value)!=null&&p.length)?(a(),v("div",jg,[t("div",Fg,[i(e(kl),{class:"size-6 text-ink-gray-6 rotate-90"})]),t("div",Og,[t("div",Pg,w(u.__("No assignment rule found")),1),t("div",zg,w(u.__("Add one to get started.")),1)]),i(f,{label:u.__("New"),variant:"outline","icon-left":"plus",onClick:d[0]||(d[0]=m=>n())},null,8,["label"])])):(a(),v("div",Hg,[t("div",qg,[t("div",Qg,w(u.__("Assignment rule")),1),t("div",Jg,w(u.__("Priority")),1),t("div",Gg,w(u.__("Enabled")),1)]),d[1]||(d[1]=t("hr",{class:"mt-2 mx-2"},null,-1)),(a(!0),v(N,null,W(s.value,(m,_)=>(a(),v("div",{key:m.name},[i(Ug,{data:m},null,8,["data"]),_!==s.value.length-1?(a(),v("hr",Wg)):S("",!0)]))),128))]))]))}}}),Yg={class:"text-lg font-semibold text-ink-gray-8"},Kg={class:"text-p-sm max-w-md text-ink-gray-6"},Xg={class:"relative"},e1=O({__name:"AssignmentRulesList",setup(o){const l=K({url:"helpdesk.api.assignment_rule.get_assignment_rules_list",cache:["assignmentRules","get_assignment_rules_list"],auto:!0}),s=fe("assignmentRuleSearchQuery");Oe(_l,l);const r=()=>{bl(),Ae.value={screen:"view",data:null}};return(n,u)=>{var f;const d=q("Input");return a(),B(he,null,xt({title:C(()=>[t("h1",Yg,w(n.__("Assignment Rules")),1)]),description:C(()=>[t("p",Kg,w(n.__("Assignment Rules automatically route tickets to the right team members based on predefined conditions.")),1)]),"header-actions":C(()=>[i(e(j),{label:n.__("New"),theme:"gray",variant:"solid",onClick:u[0]||(u[0]=p=>r()),"icon-left":"plus"},null,8,["label"])]),content:C(()=>[i(Zg)]),_:2},[((f=e(l).data)==null?void 0:f.length)>9||e(s).length?{name:"header-bottom",fn:C(()=>[t("div",Xg,[i(d,{"model-value":e(s),onInput:u[1]||(u[1]=p=>s.value=p),placeholder:n.__("Search"),type:"text",class:"bg-white hover:bg-white focus:ring-0 border-outline-gray-2","icon-left":"search",debounce:"300",inputClass:"p-4 pr-12"},null,8,["model-value","placeholder"]),e(s)?(a(),B(e(j),{key:0,icon:"x",variant:"ghost",onClick:u[2]||(u[2]=p=>s.value=""),class:"absolute right-1 top-1/2 -translate-y-1/2"})):S("",!0)])]),key:"0"}:void 0]),1024)}}}),t1={class:"mt-1 rounded-lg bg-white py-1 text-base shadow-2xl w-60"},l1={class:"relative px-1.5 pt-0.5"},s1={class:"flex gap-2 items-center w-full select-none"},n1={class:"flex flex-col gap-1 truncate"},a1={class:"font-semibold text-ink-gray-7 truncate"},o1={class:"text-ink-gray-6 truncate"},i1={key:0,class:"mt-1.5 rounded-md p-1.5 text-base text-gray-600"},r1={class:"border-t p-1.5 pb-0.5"},u1=O({__name:"AssigneeSearch",emits:["addAssignee"],setup(o,{emit:l}){const s=l,r=V(""),{agents:n}=Ft(),u=fe("isAssignmentRuleFormDirty"),d=V({show:!1,title:"",message:"",onConfirm:()=>{}}),f=G(()=>{var b;let _=((b=n.data)==null?void 0:b.filter(g=>!P.value.users.some(h=>h.user===g.user)))||[];if(r.value){const g=r.value.toLowerCase(),h=g.includes("@")||g.includes(".");_=_.filter(y=>{var k,D;return h?(k=y.user)==null?void 0:k.toLowerCase().includes(g):(D=y.agent_name)==null?void 0:D.toLowerCase().includes(g)})}return _}),p=_=>{P.value.users.push({user:_.user}),s("addAssignee",_)},m=()=>{u.value?d.value={show:!0,title:c("Unsaved changes"),message:c("Are you sure you want to leave? Unsaved changes will be lost."),onConfirm:()=>{Pe("Invite Agents")}}:Pe("Invite Agents")};return Le(()=>{var _;n.loading||(_=n.data)!=null&&_.length||n.list.promise||n.fetch()}),(_,b)=>{const g=q("Button"),h=q("FeatherIcon");return a(),v(N,null,[i(e(al),{multiple:!0},{default:C(()=>[i(e(Re),{placement:"bottom-end"},{target:C(({togglePopover:y})=>[i(g,{variant:"subtle","icon-left":"plus",onClick:k=>y(),label:e(c)("Add Assignee")},null,8,["onClick","label"])]),body:C(({togglePopover:y})=>[t("div",t1,[t("div",l1,[i(e(ol),{ref:"search",class:"form-input w-full",type:"text",onChange:b[0]||(b[0]=k=>{r.value=k.target.value}),value:r.value,autocomplete:"off",placeholder:e(c)("Search")},null,8,["value","placeholder"]),t("button",{class:"absolute right-1.5 inline-flex h-7 w-7 items-center justify-center",onClick:b[1]||(b[1]=k=>r.value="")},[i(h,{name:"x",class:"w-4"})])]),i(e(il),{class:"my-2 max-h-64 overflow-y-auto px-1.5",static:""},{default:C(()=>[(a(!0),v(N,null,W(f.value,k=>Se((a(),B(e(rl),{key:k.name,value:k,as:"template",onClick:D=>{D.stopPropagation(),p(k)}},{default:C(({active:D})=>[t("li",{class:X(["flex items-center rounded p-1.5 w-full text-base",{"bg-gray-100":D}])},[t("div",s1,[i(e(lt),{shape:"circle",image:k.user_image,label:k.agent_name,size:"lg"},null,8,["image","label"]),t("div",n1,[t("div",a1,w(k.agent_name),1),t("div",o1,w(k.user),1)])])],2)]),_:2},1032,["value","onClick"])),[[He,f.value.length>0]])),128)),f.value.length==0?(a(),v("li",i1,w(e(c)("No results found")),1)):S("",!0)]),_:1}),t("div",r1,[i(g,{variant:"ghost",class:"w-full","icon-left":"plus",label:e(c)("Invite agent"),onClick:m},null,8,["label"])])])]),_:1})]),_:1}),i(We,{modelValue:d.value.show,"onUpdate:modelValue":b[2]||(b[2]=y=>d.value.show=y),title:d.value.title,message:d.value.message,onConfirm:d.value.onConfirm},null,8,["modelValue","title","message","onConfirm"])],64)}}}),d1={class:"flex flex-col gap-1"},c1={class:"text-lg font-semibold text-ink-gray-8"},m1={class:"text-p-sm text-ink-gray-6"},p1={class:"mt-8 flex items-center justify-between gap-2"},f1={class:"text-base font-medium text-ink-gray-8"},v1={class:"text-p-sm text-ink-gray-6 mt-1"},g1=["onClick"],_1={class:"p-1 text-ink-gray-7 mt-1 bg-white shadow-xl rounded w-[--reka-popper-anchor-width]"},h1=["onClick"],y1={class:"mt-7 flex items-center justify-between gap-2"},b1={class:"text-base font-medium text-ink-gray-8"},k1={class:"text-p-sm text-ink-gray-6 mt-1"},x1={class:"mt-4 flex flex-wrap gap-2"},w1={class:"text-ink-gray-7"},C1={class:"text-xs rounded-full select-none bg-blue-600 text-white p-0.5 px-2"},$1=O({__name:"AssigneeRules",setup(o){const{getUser:l}=dl(),s=[{label:"Auto-rotate",value:"Round Robin"},{label:"Assign by workload",value:"Load Balancing"}],r=u=>{P.value.users=P.value.users.filter(d=>d.user!==u.name),ot("users")},n=G(()=>{const u=[];return P.value.users.forEach(d=>{u.push(l(d.user))}),u});return(u,d)=>{const f=q("FeatherIcon");return a(),v("div",null,[t("div",d1,[t("span",c1,w(u.__("Assignee Rules")),1),t("span",m1,w(u.__("Define who receives the tickets and how theyâre distributed among agents.")),1)]),t("div",p1,[t("div",null,[t("div",f1,w(u.__("Ticket Routing")),1),t("div",v1,w(u.__("Choose how tickets are distributed among selected assignees.")),1)]),t("div",null,[i(e(Re),{placement:"bottom-end"},{target:C(({togglePopover:p})=>{var m;return[t("div",{class:"flex items-center justify-between text-base rounded h-7 py-1.5 pl-2 pr-2 border border-[--surface-gray-2] bg-surface-gray-2 placeholder-ink-gray-4 hover:border-outline-gray-modals hover:bg-surface-gray-3 focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3 text-ink-gray-8 transition-colors w-full dark:[color-scheme:dark] select-none min-w-44",onClick:_=>p()},[t("div",null,w((m=s.find(_=>_.value==e(P).rule))==null?void 0:m.label),1),i(f,{name:"chevron-down",class:"size-4"})],8,g1)]}),body:C(({togglePopover:p})=>[t("div",_1,[(a(),v(N,null,W(s,m=>t("div",{key:m.value,class:"p-2 cursor-pointer hover:bg-surface-gray-3 text-sm flex items-center justify-between rounded",onClick:()=>{e(P).rule=m.value,p()}},[t("span",null,w(m.label),1),e(P).rule==m.value?(a(),B(f,{key:0,name:"check",class:"size-4"})):S("",!0)],8,h1)),64))])]),_:1})])]),t("div",y1,[t("div",null,[t("div",b1,w(u.__("Assignees")),1),t("div",k1,w(u.__("Choose who receives the tickets.")),1)]),i(u1,{onAddAssignee:d[0]||(d[0]=p=>e(ot)("users"))})]),t("div",x1,[(a(!0),v(N,null,W(n.value,p=>(a(),v("div",{key:p.name,class:"flex items-center gap-2 text-sm bg-surface-gray-2 rounded-md p-1 w-max px-2 select-none"},[i(e(lt),{image:p.user_image,label:p.full_name,size:"sm"},null,8,["image","label"]),t("div",w1,w(p.full_name),1),p.email==e(P).lastUser?(a(),B(e(kt),{key:0,text:u.__("Last user assigned by this rule"),"hover-delay":.35,placement:"top"},{default:C(()=>[t("div",C1,w(u.__("Last")),1)]),_:1},8,["text"])):S("",!0),i(e(j),{variant:"ghost",icon:"x",onClick:m=>r(p)},null,8,["onClick"])]))),128))]),i(e(pe),{message:e(ge).users},null,8,["message"])])}}}),A1={class:"flex items-center justify-between mt-2"},Tl=O({__name:"AssignmentRulesSection",props:{conditions:Array,name:String,errors:String},setup(o){const l=o,s=()=>{let u="and";return l.conditions.forEach(d=>{typeof d=="string"&&(u=d)}),u},r=[{label:c("Add condition"),onClick:()=>{n()}},{label:c("Add condition group"),onClick:()=>{const u=s();l.conditions.push(u,[[]])}}],n=()=>{if(!bt(l.conditions))return;const d=s();l.conditions.push(d,["","",""])};return jt(()=>[...l.conditions],()=>{ot(l.name)},{deep:!0,debounce:300}),(u,d)=>(a(),v(N,null,[l.conditions.length>0?(a(),B(Rt,{key:0,conditions:l.conditions,level:0,disableAddCondition:l.errors!==""},null,8,["conditions","disableAddCondition"])):S("",!0),l.conditions.length==0?(a(),v("div",{key:1,class:"flex p-4 items-center cursor-pointer justify-center gap-2 text-sm border border-gray-300 text-gray-600 rounded-md",onClick:d[0]||(d[0]=f=>{l.conditions.push(["","",""]),e(ot)(l.name)})},[i(e(Ie),{name:"plus",class:"h-4"}),oe(" "+w(e(c)("Add a condition")),1)])):S("",!0),t("div",A1,[l.conditions.length>0?(a(),B(e(be),{key:0,class:"mt-2",options:r},{default:C(({open:f})=>[i(e(j),{disabled:l.errors!=="","icon-right":f?"chevron-up":"chevron-down",label:e(c)("Add condition")},null,8,["disabled","icon-right","label"])]),_:1})):S("",!0),l.conditions.length>0?(a(),B(e(pe),{key:1,message:l.errors,class:"mt-2"},null,8,["message"])):S("",!0)])],64))}}),S1={class:"grid py-3.5 px-4 items-center",style:{"grid-template-columns":"3fr 1fr"}},V1={class:"text-ink-gray-7 font-medium"},D1={class:"flex justify-start"},I1={key:0},E1=O({__name:"AssignmentScheduleItem",props:{data:{type:Object,required:!0},isLast:{type:Boolean,default:!1}},setup(o){const l=o,s=r=>{const n=P.value.assignmentDays.findIndex(u=>u===l.data.day);r&&n===-1?P.value.assignmentDays.push(l.data.day):P.value.assignmentDays.splice(n,1)};return(r,n)=>(a(),v(N,null,[t("div",S1,[t("div",V1,w(o.data.day),1),t("div",D1,[i(e(Ee),{modelValue:o.data.active,"onUpdate:modelValue":[n[0]||(n[0]=u=>o.data.active=u),s]},null,8,["modelValue"])])]),o.isLast?S("",!0):(a(),v("hr",I1))],64))}}),L1={class:"rounded-md border px-2 border-gray-300 text-sm"},B1={class:"grid p-2 px-4 items-center",style:{"grid-template-columns":"3fr 1fr"}},T1=O({__name:"AssignmentSchedule",setup(o){const l=[{label:c("Days"),key:"day"},{label:c("Active"),key:"active"}],s=V([{day:"Monday",active:!1},{day:"Tuesday",active:!1},{day:"Wednesday",active:!1},{day:"Thursday",active:!1},{day:"Friday",active:!1},{day:"Saturday",active:!1},{day:"Sunday",active:!1}]);return Le(()=>{P.value.assignmentDays.forEach(r=>{const n=s.value.find(u=>u.day===r);n&&(n.active=!0)})}),(r,n)=>(a(),v(N,null,[t("div",L1,[t("div",B1,[(a(),v(N,null,W(l,u=>t("div",{key:u.key,class:"text-gray-600 overflow-hidden whitespace-nowrap text-ellipsis"},w(u.label),1)),64))]),n[0]||(n[0]=t("hr",null,null,-1)),(a(!0),v(N,null,W(s.value,(u,d)=>(a(),B(E1,{key:u.day,data:u,isLast:d===s.value.length-1},null,8,["data","isLast"]))),128))]),i(e(pe),{message:e(ge).assignmentDays,class:"mt-2"},null,8,["message"])],64))}}),M1={class:"flex items-center gap-2"},U1={class:"flex items-center gap-4"},R1={class:"text-sm text-ink-gray-7"},N1={key:0,class:"flex items-center h-full justify-center"},j1={key:1},F1={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},O1={class:"flex flex-col gap-1.5"},P1=["onClick"],z1={class:"p-1 text-ink-gray-6 top-1 absolute bg-white shadow-2xl rounded w-[--reka-popper-anchor-width]"},H1=["onClick"],q1={class:"flex flex-col gap-1"},Q1={class:"text-lg font-semibold text-ink-gray-8"},J1={class:"flex items-center justify-between gap-6"},G1={class:"text-p-sm text-ink-gray-6"},W1={class:"font-medium underline",href:"https://docs.frappe.io/helpdesk/assignment-rule",target:"_blank"},Z1={key:0},Y1={class:"text-sm text-ink-gray-6 flex gap-1 cursor-default text-nowrap flex items-center"},K1={class:"text-sm text-ink-gray-6 p-2 bg-white rounded-md max-w-96 text-wrap whitespace-pre-wrap leading-5"},X1={class:"mt-5"},e_={key:0,class:"flex flex-col gap-3 items-center text-center text-ink-gray-7 text-sm mb-2 border border-gray-300 rounded-md p-3 py-4"},t_={class:"flex flex-col gap-1"},l_={class:"text-lg font-semibold text-ink-gray-8"},s_={class:"flex items-center justify-between gap-6"},n_={class:"text-p-sm text-ink-gray-6"},a_={class:"font-medium underline",href:"https://docs.frappe.io/helpdesk/assignment-rule",target:"_blank"},o_={key:0},i_={class:"text-sm text-ink-gray-6 flex gap-1 cursor-default text-nowrap flex items-center"},r_={class:"text-sm text-ink-gray-6 p-2 bg-white rounded-md max-w-96 text-wrap whitespace-pre-wrap leading-5"},u_={class:"mt-5"},d_={key:0,class:"flex flex-col gap-3 items-center text-center text-ink-gray-7 text-sm mb-2 border border-gray-300 rounded-md p-3 py-4"},c_={class:"flex flex-col gap-1"},m_={class:"text-lg font-semibold text-ink-gray-8"},p_={class:"text-p-sm text-ink-gray-6"},f_={class:"mt-6"},v_=O({__name:"AssignmentRuleView",setup(o){var T,x;const l=V(!1),s=V(null),r=V(!1);Oe("isAssignmentRuleFormDirty",l);const n=V({show:!1,title:"",message:"",onConfirm:()=>{}}),u=V(!0),d=V(!0),f=V(!1),p=V(!1),m=`${window.location.origin}/app/assignment-rule/${(T=Ae.value.data)==null?void 0:T.name}`,_=K({url:"frappe.client.get",params:{doctype:"Assignment Rule",name:(x=Ae.value.data)==null?void 0:x.name},auto:!!Ae.value.data,onSuccess(I){var z,U,ee,re;let A,$;try{A=JSON.parse(I.assign_condition_json||"[]")}catch{H.error("Assignment conditions are invalid or corrupt, recreate the conditions."),A=[]}try{$=JSON.parse(I.unassign_condition_json||"[]")}catch{H.error("Unassignment conditions are invalid or corrupt, recreate the conditions."),$=[]}P.value={loading:!1,assignCondition:I.assign_condition,unassignCondition:I.unassign_condition,assignConditionJson:A,unassignConditionJson:$,rule:I.rule,priority:I.priority,users:I.users,disabled:I.disabled,description:I.description,name:I.name,assignmentRuleName:I.name,assignmentDays:I.assignment_days.map(vt=>vt.day)},s.value=JSON.stringify(P.value);const E=((z=P.value.assignCondition)==null?void 0:z.length)>0,Q=((U=P.value.assignConditionJson)==null?void 0:U.length)>0;E&&!Q?(u.value=!1,f.value=!0):(u.value=!0,f.value=!1);const F=((ee=P.value.unassignCondition)==null?void 0:ee.length)>0,Y=((re=P.value.unassignConditionJson)==null?void 0:re.length)>0;F&&!Y?(d.value=!1,p.value=!0):(d.value=!0,p.value=!1)}});Ae.value.data||(ue.value=!0,s.value=JSON.stringify(P.value));const b=()=>{const I={show:!0,title:c("Unsaved changes"),message:c("Are you sure you want to go back? Unsaved changes will be lost."),onConfirm:b};if(l.value&&!n.value.show){n.value=I;return}setTimeout(()=>{Ae.value={screen:"list",data:null}},250),n.value.show=!1},g=()=>{const I=ot(void 0,!u.value,!d.value);if(Object.values(I).some(A=>A)){H.error(c("Invalid fields, check if all are filled in and values are correct."));return}if(Ae.value.data){if(f.value&&u.value){h();return}if(p.value&&d.value){h();return}M()}else y()},h=()=>{n.value={show:!0,title:"Confirm overwrite",message:"Your old condition will be overwritten. Are you sure you want to save?",onConfirm:()=>{M(),n.value.show=!1}}},y=()=>{k.submit({doc:{doctype:"Assignment Rule",document_type:"HD Ticket",rule:P.value.rule,priority:P.value.priority,users:P.value.users,disabled:P.value.disabled,description:P.value.description,assignment_days:P.value.assignmentDays.map(I=>({day:I})),name:P.value.assignmentRuleName,assignment_rule_name:P.value.assignmentRuleName,assign_condition:mt({conditions:P.value.assignConditionJson}),unassign_condition:mt({conditions:P.value.unassignConditionJson}),assign_condition_json:JSON.stringify(P.value.assignConditionJson),unassign_condition_json:JSON.stringify(P.value.unassignConditionJson)}})},k=K({url:"frappe.client.insert",onSuccess(I){H.success(c("Assignment rule created")),Ae.value={screen:"view",data:I},_.submit({doctype:"Assignment Rule",name:I.name})}}),D=[{label:"Low",value:"0"},{label:"Low-Medium",value:"1"},{label:"Medium",value:"2"},{label:"Medium-High",value:"3"},{label:"High",value:"4"}],M=async()=>{r.value=!0,await Je("frappe.client.set_value",{doctype:"Assignment Rule",document_type:"HD Ticket",name:P.value.name,fieldname:{rule:P.value.rule,priority:P.value.priority,users:P.value.users,disabled:P.value.disabled,description:P.value.description,assignment_days:P.value.assignmentDays.map(I=>({day:I})),assign_condition:u.value?mt({conditions:P.value.assignConditionJson}):P.value.assignCondition,unassign_condition:d.value?mt({conditions:P.value.unassignConditionJson}):P.value.unassignCondition,assign_condition_json:u.value?JSON.stringify(P.value.assignConditionJson):null,unassign_condition_json:d.value?JSON.stringify(P.value.unassignConditionJson):null}}).catch(I=>{var $;const A=(($=I==null?void 0:I.messages)==null?void 0:$[0])||c("Some error occurred while updating assignment rule");H.error(A),r.value=!1}),P.value.name!==P.value.assignmentRuleName?(await Je("frappe.client.rename_doc",{doctype:"Assignment Rule",old_name:P.value.name,new_name:P.value.assignmentRuleName}).catch(async I=>{var $;const A=(($=I==null?void 0:I.messages)==null?void 0:$[0])||c("Some error occurred while renaming assignment rule");H.error(A),await _.reload(),r.value=!1}),await _.submit({doctype:"Assignment Rule",name:P.value.assignmentRuleName})):_.reload(),r.value=!1,H.success(c("Assignment rule updated"))};ce(P,I=>{s.value&&(l.value=JSON.stringify(I)!=s.value,l.value?ue.value=!0:ue.value=!1)},{deep:!0});const L=I=>{l.value&&(I.preventDefault(),I.returnValue=!0)};return Le(()=>{addEventListener("beforeunload",L)}),qe(()=>{Cr(),bl(),removeEventListener("beforeunload",L),ue.value=!1}),(I,A)=>{const $=q("FeatherIcon");return a(),v(N,null,[i(he,null,{title:C(()=>[t("div",M1,[i(e(j),{variant:"ghost","icon-left":"chevron-left",label:e(P).assignmentRuleName||e(c)("New Assignment Rule"),size:"md",onClick:A[0]||(A[0]=E=>b()),class:"cursor-pointer -ml-4 hover:bg-transparent focus:bg-transparent focus:outline-none focus:ring-0 focus:ring-offset-0 focus-visible:none active:bg-transparent active:outline-none active:ring-0 active:ring-offset-0 active:text-ink-gray-5 font-semibold text-lg hover:opacity-70 !pr-0 !max-w-96 !justify-start"},null,8,["label"]),l.value?(a(),B(e(Xe),{key:0,variant:"subtle",theme:"orange",size:"sm",label:e(c)("Unsaved")},null,8,["label"])):S("",!0)])]),"header-actions":C(()=>[t("div",U1,[t("div",{class:"flex items-center justify-between gap-2",onClick:A[1]||(A[1]=E=>e(P).disabled=!e(P).disabled)},[i(e(Ee),{size:"sm","model-value":!e(P).disabled},null,8,["model-value"]),t("span",R1,w(e(c)("Enabled")),1)]),i(e(j),{disabled:!!(!l.value&&e(Ae).data),label:e(c)("Save"),theme:"gray",variant:"solid",onClick:A[2]||(A[2]=E=>g()),loading:r.value||e(_).loading||e(k).loading},null,8,["disabled","label","loading"])])]),content:C(()=>[e(_).loading?(a(),v("div",N1,[i(e(Ze),{class:"w-4"})])):S("",!0),e(_).loading?S("",!0):(a(),v("div",j1,[t("div",F1,[t("div",null,[i(e(ae),{type:"text",size:"sm",variant:"subtle",placeholder:e(c)("Name"),label:e(c)("Name"),modelValue:e(P).assignmentRuleName,"onUpdate:modelValue":A[3]||(A[3]=E=>e(P).assignmentRuleName=E),required:"",maxlength:"50",onChange:A[4]||(A[4]=E=>e(ot)("assignmentRuleName"))},null,8,["placeholder","label","modelValue"]),i(e(pe),{message:e(ge).assignmentRuleName,class:"mt-2"},null,8,["message"])]),t("div",O1,[i(e(Ne),{label:e(c)("Priority")},null,8,["label"]),i(e(Re),null,{target:C(({togglePopover:E})=>{var Q;return[t("div",{class:"flex items-center justify-between text-base rounded h-7 py-1.5 pl-2 pr-2 border border-[--surface-gray-2] bg-surface-gray-2 placeholder-ink-gray-4 hover:border-outline-gray-modals hover:bg-surface-gray-3 focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3 text-ink-gray-8 transition-colors w-full dark:[color-scheme:dark] cursor-default",onClick:F=>E()},[t("div",null,w((Q=D.find(F=>F.value==e(P).priority))==null?void 0:Q.label),1),i($,{name:"chevron-down",class:"size-4"})],8,P1)]}),body:C(({togglePopover:E})=>[t("div",z1,[(a(),v(N,null,W(D,Q=>t("div",{key:Q.value,class:"p-2 cursor-pointer hover:bg-gray-50 text-base flex items-center justify-between rounded",onClick:F=>{e(P).priority=Q.value,E()}},[oe(w(Q.label)+" ",1),e(P).priority==Q.value?(a(),B($,{key:0,name:"check",class:"size-4"})):S("",!0)],8,H1)),64))])]),_:1})]),t("div",null,[i(e(ae),{type:"textarea",size:"sm",variant:"subtle",placeholder:e(c)("Description"),label:e(c)("Description"),required:"",maxlength:"140",onChange:A[5]||(A[5]=E=>e(ot)("description")),modelValue:e(P).description,"onUpdate:modelValue":A[6]||(A[6]=E=>e(P).description=E)},null,8,["placeholder","label","modelValue"]),i(e(pe),{message:e(ge).description,class:"mt-2"},null,8,["message"])])]),A[14]||(A[14]=t("hr",{class:"my-8"},null,-1)),t("div",null,[t("div",q1,[t("span",Q1,w(e(c)("Assignment condition")),1),t("div",J1,[t("span",G1,[oe(w(e(c)("Choose which tickets are affected by this assignment rule."))+" ",1),t("a",W1,w(e(c)("Learn about conditions")),1)]),f.value&&e(Ae).data?(a(),v("div",Z1,[i(e(Re),{trigger:"hover",hoverDelay:.25,placement:"top-end"},{target:C(()=>[t("div",Y1,[t("span",null,w(e(c)("Old Condition")),1),i($,{name:"info",class:"size-4"})])]),"body-main":C(()=>[t("div",K1,[t("code",null,w(e(P).assignCondition),1)])]),_:1})])):S("",!0)])]),t("div",X1,[!u.value&&e(P).assignCondition?(a(),v("div",e_,[t("span",{class:"text-p-sm"},[A[10]||(A[10]=oe(" Conditions for this rule were created from ",-1)),t("a",{href:m,target:"_blank",class:"underline"},"desk"),A[11]||(A[11]=oe(" which are not compatible with this UI, you will need to recreate the conditions here if you want to manage and add new conditions from this UI. ",-1))]),i(e(j),{label:"I understand, add conditions",variant:"subtle",theme:"gray",onClick:A[7]||(A[7]=E=>u.value=!0)})])):(a(),B(Tl,{key:1,conditions:e(P).assignConditionJson,name:"assignCondition",errors:e(ge).assignConditionError},null,8,["conditions","errors"])),i(e(pe),{message:e(ge).assignCondition,class:"mt-2"},null,8,["message"])])]),A[15]||(A[15]=t("hr",{class:"my-8"},null,-1)),t("div",null,[t("div",t_,[t("span",l_,w(e(c)("Unassignment condition")),1),t("div",s_,[t("span",n_,[oe(w(e(c)("Choose which tickets are affected by this un-assignment rule."))+" ",1),t("a",a_,w(e(c)("Learn about conditions")),1)]),p.value&&e(Ae).data&&e(P).unassignCondition?(a(),v("div",o_,[i(e(Re),{trigger:"hover",hoverDelay:.25,placement:"top-end"},{target:C(()=>[t("div",i_,[t("span",null,w(e(c)("Old Condition")),1),i($,{name:"info",class:"size-4"})])]),"body-main":C(()=>[t("div",r_,[t("code",null,w(e(P).unassignCondition),1)])]),_:1})])):S("",!0)])]),t("div",u_,[!d.value&&e(P).unassignCondition?(a(),v("div",d_,[t("span",{class:"text-p-sm"},[A[12]||(A[12]=oe(" Conditions for this rule were created from ",-1)),t("a",{href:m,target:"_blank",class:"underline"},"desk"),A[13]||(A[13]=oe(" which are not compatible with this UI, you will need to recreate the conditions here if you want to manage and add new conditions from this UI. ",-1))]),i(e(j),{label:"I understand, add conditions",variant:"subtle",theme:"gray",onClick:A[8]||(A[8]=E=>d.value=!0)})])):(a(),B(Tl,{key:1,conditions:e(P).unassignConditionJson,name:"unassignCondition",errors:e(ge).unassignConditionError},null,8,["conditions","errors"]))])]),A[16]||(A[16]=t("hr",{class:"my-8"},null,-1)),t("div",null,[t("div",c_,[t("span",m_,w(e(c)("Assignment Schedule")),1),t("span",p_,w(e(c)("Choose the days of the week when this rule should be active.")),1)]),t("div",f_,[i(T1)])]),A[17]||(A[17]=t("hr",{class:"my-8"},null,-1)),i($1)]))]),_:1}),i(We,{modelValue:n.value.show,"onUpdate:modelValue":A[9]||(A[9]=E=>n.value.show=E),title:n.value.title,message:n.value.message,onConfirm:n.value.onConfirm,onCancel:()=>{n.value.onCancel?n.value.onCancel():n.value.show=!1}},null,8,["modelValue","title","message","onConfirm","onCancel"])],64)}}}),g_=O({__name:"AssignmentRules",setup(o){const l=V("");return Oe("assignmentRuleSearchQuery",l),(s,r)=>(a(),v(N,null,[e(Ae).screen==="list"?(a(),B(e1,{key:0})):S("",!0),e(Ae).screen==="view"?(a(),B(v_,{key:1})):S("",!0)],64))}}),__={class:"rounded bg-surface-gray-7 py-1.5 px-2 text-xs text-ink-white shadow-xl"},h_={class:"flex items-center gap-1"},Tt=O({__name:"Password",props:{value:{type:String,default:""},modelValue:{type:String,default:""}},setup(o){const l=o,s=V(!1),r=G(()=>{let n=l.modelValue||l.value;return!(n!=null&&n.includes("*"))});return(n,u)=>(a(),B(e(ae),Mt({type:s.value?"text":"password",value:o.modelValue||o.value},n.$attrs,{onKeydown:[u[1]||(u[1]=Ke(we(d=>s.value=!s.value,["meta","prevent"]),["i"])),u[2]||(u[2]=Ke(we(d=>s.value=!s.value,["ctrl","prevent"]),["i"]))]}),xt({suffix:C(()=>[i(e(kt),null,{body:C(()=>[t("div",__,[t("span",h_,w(s.value?"Hide Password":"Show Password"),1)])]),default:C(()=>[t("div",null,[Se((a(),B(Ue(s.value?e(zn):e(Fn)),{class:"h-3 cursor-pointer mr-1",onClick:u[0]||(u[0]=d=>s.value=!s.value)},null,512)),[[He,r.value]])])]),_:1})]),_:2},[n.$slots.prefix?{name:"prefix",fn:C(()=>[Ce(n.$slots,"prefix")]),key:"0"}:void 0]),1040,["type","value"]))}}),Jt=(o,l)=>JSON.stringify(o)!==JSON.stringify(l),y_=(o,l,s)=>{l.default_medium==="Twilio"&&!o.enabled?s.value.default_medium="Enable Twilio to set it as default medium":s.value.default_medium="",o.enabled&&(o.account_sid?s.value.accountSid="":s.value.accountSid="Account SID is required",o.auth_token?s.value.authToken="":s.value.authToken="Auth Token is required",l.twilio_number?nl(l.twilio_number)?s.value.number="":s.value.number="Please enter a valid phone number":s.value.number="Number is required")},b_=(o,l,s)=>{l.default_medium==="Exotel"&&!o.enabled?s.value.default_medium="Enable Exotel to set it as default medium":s.value.default_medium="",o.enabled&&(o.account_sid?s.value.accountSid="":s.value.accountSid="Account SID is required",o.webhook_verify_token?s.value.webhookVerifyToken="":s.value.webhookVerifyToken="Webhook Verify Token is required",o.subdomain?s.value.subdomain="":s.value.subdomain="Subdomain is required",o.api_key?s.value.apiKey="":s.value.apiKey="API Key is required",o.api_token?s.value.apiToken="":s.value.apiToken="API Token is required",l.exotel_number?nl(l.exotel_number)?s.value.number="":s.value.number="Please enter a valid phone number":s.value.number="Number is required",l.mobile_no?nl(l.mobile_no)?s.value.mobileNo="":s.value.mobileNo="Please enter a valid phone number":s.value.mobileNo="Personal number is required")},nl=o=>/^\+?\d{8,15}$/.test(o),k_={class:"flex items-center gap-2"},x_={class:"text-lg font-semibold text-ink-gray-8"},w_={class:"text-base font-semibold text-ink-gray-8"},C_={class:"text-p-xs text-ink-gray-6 mt-1"},$_={class:"grid grid-cols-2 gap-4 mt-4"},A_={class:"flex flex-col gap-1.5"},S_={key:0,class:"flex flex-col gap-1.5"},V_={key:1,class:"flex flex-col gap-1.5"},D_={key:2,class:"flex flex-col gap-1.5"},I_={key:0,class:"mt-6"},E_={class:"mt-4"},L_={class:"grid grid-cols-2 gap-4"},B_={key:0,class:"grid grid-cols-2 gap-4 mt-4"},T_={class:"flex flex-col gap-2"},M_={class:"flex flex-col gap-2"},U_={key:1,class:"mt-6"},R_={class:"mt-4"},N_={class:"grid grid-cols-2 gap-4"},j_={key:0,class:"grid grid-cols-2 gap-4 mt-4"},F_={class:"flex flex-col gap-2"},O_={class:"flex flex-col gap-2"},P_={class:"flex flex-col gap-2"},z_={class:"flex flex-col gap-2"},H_={class:"flex flex-col gap-2"},q_=O({__name:"Telephony",setup(o){const l=et(),s=gl(),r=V({twilio:!1,exotel:!1,telephonyAgent:!1}),n=V([]),u=V({accountSid:"",authToken:"",number:"",default_medium:""}),d=V({accountSid:"",webhookVerifyToken:"",subdomain:"",apiKey:"",apiToken:"",number:"",mobileNo:"",default_medium:""}),f=Et({doctype:"TP Twilio Settings",name:"TP Twilio Settings",cache:["tp_twilio_settings"],fields:["*"],auto:!0}),p=Et({doctype:"TP Exotel Settings",name:"TP Exotel Settings",cache:["tp_exotel_settings"],fields:["*"],auto:!0}),m=Et({doctype:"TP Telephony Agent",name:l.user,cache:["tp_telephony_agent"],fields:["*"],auto:!1,onError(y){var k;H.error(((k=y==null?void 0:y.messages)==null?void 0:k[0])||c("Failed to load telephony agent"))}}),_=K({url:"telephony.twilio.api.fetch_applications",onSuccess(){f.reload()}}),b=[{label:"",value:""},{label:"Twilio",value:"Twilio"},{label:"Exotel",value:"Exotel"}];async function g(){if(y_(f.doc,m.doc,u),b_(p.doc,m.doc,d),Object.values(u.value).some(D=>D)){H.error(c("Please fill all required fields for Twilio"));return}if(Object.values(d.value).some(D=>D)){H.error(c("Please fill all required fields for Exotel"));return}const y=[];r.value.twilio&&y.push(f.save.submit().catch(D=>{var L;const M=c("Twilio error: {0}",(L=D==null?void 0:D.messages)==null?void 0:L[0]);H.error(M||c("Failed to save Twilio settings"))})),r.value.exotel&&y.push(p.save.submit().catch(D=>{var L;const M=c("Exotel error: {0}",(L=D==null?void 0:D.messages)==null?void 0:L[0]);H.error(M||c("Failed to save Exotel settings"))})),r.value.telephonyAgent&&(m.doc.twilio_number?m.doc.twilio=!0:m.doc.twilio=!1,m.doc.exotel_number?m.doc.exotel=!0:m.doc.exotel=!1,y.push(m.save.submit())),(await Promise.all(y)).some(D=>D==null)||H.success(c("Telephony settings updated!")),await f.reload(),s.fetchCallIntegrationStatus()}function h(y){_.submit().then(()=>{y(),cl(()=>{y()})})}return K({url:"telephony.api.create_telephony_agent",auto:!0,onSuccess(){m.get.submit()}}),ce(()=>m.doc,y=>{r.value.telephonyAgent=Jt(y,m.originalDoc),r.value.telephonyAgent?ue.value=!0:ue.value=!1},{deep:!0}),ce(()=>f.doc,y=>{var k;r.value.twilio=Jt(y,f.originalDoc),n.value=((k=y.twilio_apps)==null?void 0:k.split(",").map(D=>({label:D,value:D})))||[],r.value.twilio?ue.value=!0:ue.value=!1},{deep:!0}),ce(()=>p.doc,y=>{r.value.exotel=Jt(y,p.originalDoc),r.value.exotel?ue.value=!0:ue.value=!1},{deep:!0}),(y,k)=>(a(),B(he,{description:e(c)("Configure your telephony settings.")},{title:C(()=>[t("div",k_,[t("h1",x_,w(e(c)("Telephony")),1),i(e(Xe),{class:X([r.value.twilio||r.value.exotel||r.value.telephonyAgent?"opacity-100":"opacity-0"]),label:e(c)("Unsaved"),theme:"orange",variant:"subtle"},null,8,["class","label"])])]),"header-actions":C(()=>[i(e(j),{label:e(c)("Save"),theme:"gray",variant:"solid",onClick:g,disabled:!r.value.twilio&&!r.value.exotel&&!r.value.telephonyAgent,loading:e(f).save.loading||e(p).save.loading||e(m).save.loading},null,8,["label","disabled","loading"])]),content:C(()=>{var D,M,L,T,x,I,A;return[t("div",null,[t("div",w_,w(e(c)("Agent settings")),1),t("div",C_,w(e(c)("Configure your agentâs telephony details.")),1),t("div",$_,[t("div",A_,[i(e(Ne),{label:"Default medium"}),e(m).doc?(a(),B(e(Pl),{key:0,options:b,modelValue:(D=e(m).doc)==null?void 0:D.default_medium,"onUpdate:modelValue":k[0]||(k[0]=$=>e(m).doc.default_medium=$)},null,8,["modelValue"])):S("",!0),i(e(pe),{message:u.value.default_medium||d.value.default_medium},null,8,["message"])]),e(m).doc&&((M=e(f).doc)!=null&&M.enabled)?(a(),v("div",S_,[i(e(ae),{label:"Twilio number",type:"text",required:"",modelValue:e(m).doc.twilio_number,"onUpdate:modelValue":k[1]||(k[1]=$=>e(m).doc.twilio_number=$)},null,8,["modelValue"]),i(e(pe),{message:u.value.number},null,8,["message"])])):S("",!0),e(m).doc&&((L=e(p).doc)!=null&&L.enabled)?(a(),v("div",V_,[i(e(ae),{label:"Exotel number",type:"text",required:"",modelValue:e(m).doc.exotel_number,"onUpdate:modelValue":k[2]||(k[2]=$=>e(m).doc.exotel_number=$)},null,8,["modelValue"]),i(e(pe),{message:d.value.number},null,8,["message"])])):S("",!0),e(m).doc&&((T=e(p).doc)!=null&&T.enabled)?(a(),v("div",D_,[i(e(ae),{label:e(c)("Personal mobile no"),type:"text",required:"",modelValue:e(m).doc.mobile_no,"onUpdate:modelValue":k[3]||(k[3]=$=>e(m).doc.mobile_no=$),description:e(c)("Required for exotel integration")},null,8,["label","modelValue","description"]),i(e(pe),{message:d.value.mobileNo},null,8,["message"])])):S("",!0)]),(x=e(f))!=null&&x.doc?(a(),v("div",I_,[k[23]||(k[23]=t("div",{class:"text-base font-semibold text-ink-gray-8"},"Twilio",-1)),t("div",E_,[t("div",L_,[i(e(Be),{label:e(c)("Enabled"),modelValue:e(f).doc.enabled,"onUpdate:modelValue":[k[4]||(k[4]=$=>e(f).doc.enabled=$),k[5]||(k[5]=$=>e(f).doc.enabled=$?1:0)]},null,8,["label","modelValue"]),e(f).doc.enabled?(a(),B(e(Be),{key:0,label:e(c)("Record Calls"),modelValue:e(f).doc.record_calls,"onUpdate:modelValue":[k[6]||(k[6]=$=>e(f).doc.record_calls=$),k[7]||(k[7]=$=>e(f).doc.record_calls=$?1:0)]},null,8,["label","modelValue"])):S("",!0)]),e(f).doc.enabled?(a(),v("div",B_,[t("div",T_,[i(e(ae),{label:"Account SID",required:"",modelValue:e(f).doc.account_sid,"onUpdate:modelValue":k[8]||(k[8]=$=>e(f).doc.account_sid=$),placeholder:"Account SID"},null,8,["modelValue"]),i(e(pe),{message:u.value.accountSid},null,8,["message"])]),t("div",M_,[i(Tt,{label:"Auth Token",required:"",modelValue:e(f).doc.auth_token,"onUpdate:modelValue":k[9]||(k[9]=$=>e(f).doc.auth_token=$),placeholder:"Auth Token"},null,8,["modelValue"]),i(e(pe),{message:u.value.authToken},null,8,["message"])]),e(f).doc.api_key?(a(),B(e(ae),{key:0,label:"API Key",modelValue:e(f).doc.api_key,"onUpdate:modelValue":k[10]||(k[10]=$=>e(f).doc.api_key=$),disabled:""},null,8,["modelValue"])):S("",!0),e(f).doc.api_secret?(a(),B(Tt,{key:1,label:"API Secret",modelValue:e(f).doc.api_secret,"onUpdate:modelValue":k[11]||(k[11]=$=>e(f).doc.api_secret=$),disabled:""},null,8,["modelValue"])):S("",!0),(I=e(f).originalDoc)!=null&&I.account_sid&&n.value.length>0?(a(),B(e(jl),{key:2,label:"TwiML App Name","model-value":e(f).doc.app_name,"onUpdate:modelValue":k[12]||(k[12]=$=>e(f).doc.app_name=$.value),options:n.value},{footer:C(({togglePopover:$})=>[i(e(j),{label:e(c)("Refresh Apps"),theme:"gray",variant:"subtle",class:"w-full","icon-left":"refresh-cw",onClick:E=>h($),loading:e(_).loading},null,8,["label","onClick","loading"])]),_:1},8,["model-value","options"])):S("",!0),e(f).doc.twiml_sid?(a(),B(e(ae),{key:3,label:"TwiML App SID",modelValue:e(f).doc.twiml_sid,"onUpdate:modelValue":k[13]||(k[13]=$=>e(f).doc.twiml_sid=$),disabled:""},null,8,["modelValue"])):S("",!0)])):S("",!0)])])):S("",!0),(A=e(p))!=null&&A.doc?(a(),v("div",U_,[k[24]||(k[24]=t("div",{class:"text-base font-semibold text-ink-gray-8"},"Exotel",-1)),t("div",R_,[t("div",N_,[i(e(Be),{label:e(c)("Enabled"),modelValue:e(p).doc.enabled,"onUpdate:modelValue":[k[14]||(k[14]=$=>e(p).doc.enabled=$),k[15]||(k[15]=$=>e(p).doc.enabled=$?1:0)]},null,8,["label","modelValue"]),e(p).doc.enabled?(a(),B(e(Be),{key:0,label:e(c)("Record Calls"),modelValue:e(p).doc.record_call,"onUpdate:modelValue":[k[16]||(k[16]=$=>e(p).doc.record_call=$),k[17]||(k[17]=$=>e(p).doc.record_call=$?1:0)]},null,8,["label","modelValue"])):S("",!0)]),e(p).doc.enabled?(a(),v("div",j_,[t("div",F_,[i(e(ae),{label:"Account SID",required:"",modelValue:e(p).doc.account_sid,"onUpdate:modelValue":k[18]||(k[18]=$=>e(p).doc.account_sid=$),placeholder:"Account SID"},null,8,["modelValue"]),i(e(pe),{message:d.value.accountSid},null,8,["message"])]),t("div",O_,[i(e(ae),{label:"Webhook Verify Token",required:"",modelValue:e(p).doc.webhook_verify_token,"onUpdate:modelValue":k[19]||(k[19]=$=>e(p).doc.webhook_verify_token=$),placeholder:"Webhook Verify Token"},null,8,["modelValue"]),i(e(pe),{message:d.value.webhookVerifyToken},null,8,["message"])]),t("div",P_,[i(e(ae),{label:"API Key",required:"",modelValue:e(p).doc.api_key,"onUpdate:modelValue":k[20]||(k[20]=$=>e(p).doc.api_key=$),placeholder:"API Key"},null,8,["modelValue"]),i(e(pe),{message:d.value.apiKey},null,8,["message"])]),t("div",z_,[i(Tt,{label:"API Token",required:"",modelValue:e(p).doc.api_token,"onUpdate:modelValue":k[21]||(k[21]=$=>e(p).doc.api_token=$),placeholder:"API Token"},null,8,["modelValue"]),i(e(pe),{message:d.value.apiToken},null,8,["message"])]),t("div",H_,[i(e(ae),{label:"Subdomain",required:"",modelValue:e(p).doc.subdomain,"onUpdate:modelValue":k[22]||(k[22]=$=>e(p).doc.subdomain=$),placeholder:"Subdomain"},null,8,["modelValue"]),i(e(pe),{message:d.value.subdomain},null,8,["message"])])])):S("",!0)])])):S("",!0)])]}),_:1},8,["description"]))}}),Q_={class:"isolate -ml-3"},J_={class:"flex flex-col gap-1"},G_={class:"text-base font-medium text-ink-gray-7 relative z-10 pointer-events-none"},W_={class:"text-sm text-ink-gray-5 truncate relative z-10 pointer-events-none"},Z_=["onClick"],Y_={class:"sr-only"},K_=O({__name:"NotificationList",props:{onSelect:{type:Function}},setup(o){const l=o,s=[{name:"share_feedback",label:c("Share feedback"),description:c("Sent to the user who has raised the ticket after the ticket is closed or resolved")},{name:"acknowledgement",label:c("Acknowledgement"),description:c("Sent to the user right after creating an email ticket")},{name:"reply_to_agents",label:c("Reply from contact"),description:c("Sent to all of the assigned agents after a reply from one of the contacts")},{name:"reply_via_agent",label:c("Reply from agent"),description:c("Sent to all of the recipients associated with an agent's reply")}];return(r,n)=>{const u=q("FeatherIcon");return a(),B(he,{title:e(c)("Email Notifications"),description:e(c)("Customize your email notification preferences to stay informed about important updates and activities.")},{content:C(()=>[t("ul",Q_,[(a(),v(N,null,W(s,d=>t("li",{key:d.name,class:"flex items-center justify-between p-3 rounded relative"},[t("div",J_,[t("h2",G_,w(d.label),1),t("p",W_,w(d.description),1)]),i(u,{name:"chevron-right",class:"text-ink-gray-7 size-4 relative z-10 pointer-events-none"}),t("button",{type:"button",class:"w-full h-full absolute top-0 left-0 hover:bg-gray-50 rounded-[inherit]",onClick:()=>{l.onSelect(d)}},[t("span",Y_,w(e(c)("customize {0}",d.name)),1)],8,Z_)])),64))])]),_:1},8,["title","description"])}}}),X_={class:"flex items-center"},eh={class:"pl-5 pr-2 relative text-ink-gray-7 hover:opacity-70 min-h-8 flex items-center"},th={class:"sr-only"},lh={class:"font-semibold text-xl"},sh=["inert"],nh={class:"flex flex-col gap-2"},ah={class:"flex gap-x-1 items-start justify-between"},oh={class:"text-sm text-gray-700 leading-5"},ih=["href"],zt=O({__name:"Notification",props:Ve({title:{},description:{},documentationLink:{},defaultContent:{},onBack:{type:Function},onSubmit:{type:Function},onGetDataSuccess:{type:Function},submitting:{type:Boolean},name:{}},{content:{required:!0},contentModifiers:{},enabled:{type:Boolean,required:!0},enabledModifiers:{}}),emits:["update:content","update:enabled"],setup(o,{expose:l}){const s=o,r=_e(o,"content"),n=_e(o,"enabled"),u=V(!1),d=V(!1),f=V(!1),p=K({url:"helpdesk.api.settings.email_notifications.get_data",method:"GET",params:{notification:s.name},auto:!0,onSuccess:s.onGetDataSuccess});function m(){u.value=!0}function _(){u.value=!1}function b(){r.value=s.defaultContent,m()}function g(){r.value!==s.defaultContent&&(f.value=!0)}function h(){if(u.value){d.value=!0;return}ue.value=!1,s.onBack()}return ce(()=>u.value,y=>{ue.value=y}),l({setUnsavedChanges:m,resetUnsavedChanges:_}),(y,k)=>{const D=Mn,M=q("Badge"),L=q("Button"),T=q("FormControl");return a(),v(N,null,[i(he,null,{title:C(()=>[t("div",X_,[t("div",eh,[t("button",{type:"button",onClick:h,class:"absolute top-0 -left-[0.375rem] w-full h-full"},[t("span",th,w(y.__("back to email event list")),1),i(D,{class:"w-4.5 h-4.5"})]),t("h1",lh,w(s.title),1)]),u.value?(a(),B(M,{key:0,variant:"subtle",theme:"orange",size:"sm",label:y.__("Unsaved")},null,8,["label"])):S("",!0)])]),"header-actions":C(()=>[t("div",{inert:e(p).loading,class:X(["flex items-center gap-x-4 pt-[0.125rem]",{invisible:e(p).loading}])},[i(e(Ee),{size:"sm",label:y.__("Enabled"),modelValue:n.value,"onUpdate:modelValue":[k[0]||(k[0]=x=>n.value=x),m],style:{background:"transparent",padding:"0px"},class:"flex-row-reverse gap-x-2 pl-0"},null,8,["label","modelValue"]),i(L,{type:"button",label:y.__("Save"),theme:"gray",variant:"solid",disabled:!u.value,loading:s.submitting,onClick:s.onSubmit},null,8,["label","disabled","loading","onClick"])],10,sh)]),content:C(()=>[t("div",{class:X(["flex flex-col gap-8 flex-grow pb-8",{"items-center justify-center":e(p).loading}])},[e(p).loading?(a(),B(e(Ze),{key:1,class:"w-4"})):(a(),v(N,{key:0},[Ce(y.$slots,"formFields"),t("div",nh,[i(T,{type:"textarea",size:"sm",label:y.__("Email Content"),required:!0,rows:10,modelValue:r.value,"onUpdate:modelValue":k[1]||(k[1]=x=>r.value=x),oninput:m},null,8,["label","modelValue"]),t("div",ah,[t("p",oh,[oe(w(y.__("Find out all of the variables that can be used in the content"))+" ",1),t("a",{href:s.documentationLink,target:"_blank",class:"underline font-semibold"},w(y.__("here")),9,ih)]),i(L,{disabled:r.value===o.defaultContent,type:"button",size:"sm",variant:"subtle",onClick:g,class:"w-fit"},{default:C(()=>[oe(w(y.__("Reset Content")),1)]),_:1},8,["disabled"])])])],64))],2)]),_:3}),i(We,{modelValue:d.value,"onUpdate:modelValue":k[2]||(k[2]=x=>d.value=x),title:y.__("Unsaved changes"),message:y.__("Are you sure you want to go back? Unsaved changes will be lost."),onConfirm:()=>{ue.value=!1,s.onBack()}},null,8,["modelValue","title","message","onConfirm"]),i(We,{modelValue:f.value,"onUpdate:modelValue":k[3]||(k[3]=x=>f.value=x),title:y.__("Reset content"),message:y.__("Are you sure you want to reset the content? Current content will be overridden."),onConfirm:()=>{b(),f.value=!1}},null,8,["modelValue","title","message","onConfirm"])],64)}}}),rh=O({__name:"Acknowledgement",props:{onBack:{type:Function},notification:{}},setup(o){const l=o,s=V(""),r=V(""),n=V(!1),u=V(),d=K({url:"helpdesk.api.settings.email_notifications.update_acknowledgement",method:"PUT",auto:!1,onSuccess(m){n.value=m.enabled,s.value=m.content,u.value.resetUnsavedChanges()}});function f(){return d.submit({enabled:n.value,content:s.value})}function p(m){n.value=m.enabled,s.value=m.content,r.value=m.default_content}return(m,_)=>(a(),B(zt,{content:s.value,"onUpdate:content":_[0]||(_[0]=b=>s.value=b),defaultContent:r.value,enabled:n.value,"onUpdate:enabled":_[1]||(_[1]=b=>n.value=b),documentationLink:"https://docs.frappe.io/helpdesk/email-notifications#available-variables-acknowledgement",ref_key:"compRef",ref:u,name:"acknowledgement",title:l.notification.label,description:l.notification.description,submitting:e(d).loading,onBack:l.onBack,onSubmit:f,onGetDataSuccess:p},null,8,["content","defaultContent","enabled","title","description","submitting","onBack"]))}}),uh=O({__name:"ReplyViaAgent",props:{onBack:{type:Function},notification:{}},setup(o){const l=o,s=V(""),r=V(""),n=V(!1),u=V(),d=K({url:"helpdesk.api.settings.email_notifications.update_reply_via_agent",method:"PUT",auto:!1,onSuccess(m){n.value=m.enabled,s.value=m.content,u.value.resetUnsavedChanges()}});function f(){return d.submit({enabled:n.value,content:s.value})}function p(m){n.value=m.enabled,s.value=m.content,r.value=m.default_content}return(m,_)=>(a(),B(zt,{content:s.value,"onUpdate:content":_[0]||(_[0]=b=>s.value=b),defaultContent:r.value,enabled:n.value,"onUpdate:enabled":_[1]||(_[1]=b=>n.value=b),documentationLink:"https://docs.frappe.io/helpdesk/email-notifications#available-variables-reply-from-agent",ref_key:"compRef",ref:u,name:"reply_via_agent",title:l.notification.label,description:l.notification.description,submitting:e(d).loading,onBack:l.onBack,onSubmit:f,onGetDataSuccess:p},null,8,["content","defaultContent","enabled","title","description","submitting","onBack"]))}}),dh=O({__name:"ShareFeedback",props:{onBack:{type:Function},notification:{}},setup(o){const l=o,s=V(""),r=V(""),n=V(!1),u=V(),{statuses:d}=hl(),f=G(()=>d.data.filter(g=>g.category==="Resolved").map(g=>({label:c(g.label_agent),value:g.label_agent}))),p=V(null),m=K({url:"helpdesk.api.settings.email_notifications.update_share_feedback",method:"PUT",auto:!1,onSuccess(g){u.value.resetUnsavedChanges()}});function _(){return m.submit({ticket_status:p.value,enabled:n.value,content:s.value})}function b(g){p.value={label:c(g.ticket_status.label),value:g.ticket_status.value},n.value=g.enabled,s.value=g.content,r.value=g.default_content}return(g,h)=>{const y=q("FormControl");return a(),B(zt,{ref_key:"compRef",ref:u,name:"share_feedback",title:l.notification.label,description:l.notification.description,content:s.value,"onUpdate:content":h[1]||(h[1]=k=>s.value=k),defaultContent:r.value,enabled:n.value,"onUpdate:enabled":h[2]||(h[2]=k=>n.value=k),documentationLink:"https://docs.frappe.io/helpdesk/email-notifications#available-variables-share-feedback",onBack:l.onBack,onSubmit:_,onGetDataSuccess:b,submitting:e(m).loading},{formFields:C(()=>[i(y,{type:"autocomplete",size:"sm",label:e(c)("On Ticket Status"),options:f.value,required:!0,"model-value":p.value,"onUpdate:modelValue":h[0]||(h[0]=k=>{p.value=k,u.value.setUnsavedChanges()})},null,8,["label","options","model-value"])]),_:1},8,["title","description","content","defaultContent","enabled","onBack","submitting"])}}}),ch=O({__name:"ReplyToAgents",props:{onBack:{type:Function},notification:{}},setup(o){const l=o,s=V(""),r=V(""),n=V(!1),u=V(),d=K({url:"helpdesk.api.settings.email_notifications.update_reply_to_agents",method:"PUT",auto:!1,onSuccess(m){n.value=m.enabled,s.value=m.content,u.value.resetUnsavedChanges()}});function f(){return d.submit({enabled:n.value,content:s.value})}function p(m){n.value=m.enabled,s.value=m.content,r.value=m.default_content}return(m,_)=>(a(),B(zt,{content:s.value,"onUpdate:content":_[0]||(_[0]=b=>s.value=b),defaultContent:r.value,enabled:n.value,"onUpdate:enabled":_[1]||(_[1]=b=>n.value=b),documentationLink:"https://docs.frappe.io/helpdesk/email-notifications#available-variables-reply-from-contact",ref_key:"compRef",ref:u,name:"reply_to_agents",title:l.notification.label,description:l.notification.description,submitting:e(d).loading,onBack:l.onBack,onSubmit:f,onGetDataSuccess:p},null,8,["content","defaultContent","enabled","title","description","submitting","onBack"]))}}),mh={class:"h-full overflow-y-auto flex flex-col isolate"},ph=O({__name:"EmailNotifications",setup(o){const l=V(null),s={share_feedback:Z(dh),acknowledgement:Z(rh),reply_to_agents:Z(ch),reply_via_agent:Z(uh)};function r(){l.value=null}function n(u){l.value=u}return(u,d)=>(a(),v("div",mh,[l.value===null?(a(),B(K_,{key:0,onSelect:n})):(a(),B(Ue(s[l.value.name]),{key:1,onBack:r,notification:l.value},null,40,["notification"]))]))}}),fh={class:"lucide lucide-camera",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function vh(o,l){return a(),v("svg",fh,[...l[0]||(l[0]=[t("path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"},null,-1),t("circle",{cx:"12",cy:"13",r:"3"},null,-1)])])}const gh=Z({name:"lucide-camera",render:vh}),_h={class:"lucide lucide-lock-keyhole",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function hh(o,l){return a(),v("svg",_h,[...l[0]||(l[0]=[t("circle",{cx:"12",cy:"16",r:"1"},null,-1),t("rect",{x:"3",y:"10",width:"18",height:"12",rx:"2"},null,-1),t("path",{d:"M7 10V7a5 5 0 0 1 10 0v3"},null,-1)])])}const Ml=Z({name:"lucide-lock-keyhole",render:hh}),yh={class:"flex flex-col gap-4"},bh={class:"flex justify-between items-center"},kh=O({__name:"ChangePasswordModal",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:["update:modelValue"],setup(o){const l=_e(o,"modelValue"),s=et(),r=V(""),n=V(""),u=V(""),d=K({url:"frappe.client.set_value",makeParams(){return{doctype:"User",name:s==null?void 0:s.user,fieldname:"new_password",value:r.value}},onSuccess:()=>{H.success(c("Password updated successfully")),l.value=!1,r.value="",n.value="",u.value=""}});function f(p){return/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z\d\s]).{8,}$/.test(p)}return ce([r,n],()=>{if(u.value="",r.value.length<8){u.value=c("Password must be at least 8 characters");return}else if(!f(r.value)){u.value=c("Password must contain lowercase, uppercase, number, and symbol");return}n.value.length&&r.value!==n.value?u.value=c("Passwords do not match"):r.value===n.value&&r.value.length&&n.value.length&&(u.value=c("Passwords match"))}),(p,m)=>{const _=Tt,b=q("Button");return a(),B(e(Te),{modelValue:l.value,"onUpdate:modelValue":m[3]||(m[3]=g=>l.value=g),options:{title:e(c)("Change Password")}},{"body-content":C(()=>[t("div",yh,[t("div",null,[i(_,{modelValue:r.value,"onUpdate:modelValue":m[0]||(m[0]=g=>r.value=g),placeholder:e(c)("New Password"),maxLength:"50"},{prefix:C(()=>[i(e(Ml),{class:"size-4 text-ink-gray-4"})]),_:1},8,["modelValue","placeholder"])]),t("div",null,[i(_,{modelValue:n.value,"onUpdate:modelValue":m[1]||(m[1]=g=>n.value=g),placeholder:e(c)("Confirm Password"),maxLength:"50"},{prefix:C(()=>[i(e(Ml),{class:"size-4 text-ink-gray-4"})]),_:1},8,["modelValue","placeholder"])])])]),actions:C(()=>[t("div",bh,[t("div",null,[u.value?(a(),v("p",{key:0,class:X(["text-sm text-ink-gray-5",u.value===e(c)("Passwords match")?"text-ink-green-3":"text-ink-red-3"])},w(u.value),3)):S("",!0)]),i(b,{variant:"solid",label:e(c)("Update"),disabled:!r.value||!n.value||r.value!==n.value||!f(r.value),loading:e(d).loading,onClick:m[2]||(m[2]=g=>e(d).submit())},null,8,["label","disabled","loading"])])]),_:1},8,["modelValue","options"])}}}),xh={class:"flex items-center justify-between gap-2"},wh={class:"flex items-center justify-center gap-2"},Ch={class:"group relative !size-14"},$h={class:"z-1 absolute top-0 left-0 flex h-9 cursor-pointer items-center justify-center rounded-full bg-black bg-opacity-40 opacity-0 duration-300 ease-in-out group-hover:opacity-100 !size-14"},Ah={key:0,class:"w-full h-full top-0 left-0 absolute bg-black bg-opacity-20 rounded-full flex items-center justify-center"},Sh={class:"flex flex-col gap-1"},Vh={class:"flex flex-col"},Dh={class:"text-lg sm:text-xl !font-semibold text-ink-gray-8"},Ih={class:"text-p-sm text-ink-gray-6"},Eh={class:"flex items-center justify-between"},Lh={class:"flex gap-2 items-center"},Bh={class:"text-base font-semibold text-ink-gray-9"},Th={class:"grid grid-cols-1 md:grid-cols-2 gap-5 mt-6"},Mh={class:"flex items-center justify-between mt-6"},Uh={class:"flex flex-col gap-1"},Rh={class:"text-base font-medium text-ink-gray-8"},Nh={class:"text-p-sm text-ink-gray-6"},jh={class:"flex items-center justify-between mt-6"},Fh={class:"flex flex-col gap-1"},Oh={class:"text-base font-medium text-ink-gray-8"},Ph={class:"text-p-sm text-ink-gray-6"},zh=O({__name:"Profile",setup(o){const l=et(),s=V({fullName:l.userName,userImage:l.userImage,firstName:l.userFirstName,lastName:l.userLastName}),r=V(!1),n=V(l.language),u=G(()=>n.value!==(l==null?void 0:l.language)),d=G(()=>{var y,k;const g=(k=(y=f.data)==null?void 0:y.agent_name)==null?void 0:k.split(" ");if(!g)return!1;const h=s.value.firstName!==g[0]||s.value.lastName!==(g[1]||"");return h?ue.value=!0:ue.value=!1,h}),f=K({url:"helpdesk.helpdesk.doctype.hd_agent.hd_agent.get_agent",auto:!0,onSuccess:g=>{const h=g.agent_name.split(" ");s.value={fullName:g.agent_name,firstName:h[0],lastName:h[1]||"",userImage:g.user_image}}}),p=K({url:"frappe.client.set_value",validate:()=>{if(!s.value.firstName.trim())return c("Please enter first name at least")},makeParams(){var g;return{doctype:"HD Agent",name:(g=f.data)==null?void 0:g.name,fieldname:{agent_name:`${s.value.firstName} ${s.value.lastName}`,user_image:s.value.userImage}}},onSuccess:()=>{l.reloadUser(),f.reload(),H.success(c("Profile updated"))}}),m=K({url:"frappe.client.set_value",makeParams(){return{doctype:"User",name:l.userId,fieldname:{language:n.value}}},onSuccess(){H.success(c("Language updated")),window.location.reload()}}),_=()=>{d.value&&p.submit(),u.value&&m.submit()},b=g=>{s.value.userImage=g,p.submit()};return(g,h)=>{const y=q("ErrorMessage"),k=q("FormControl");return a(),v(N,null,[i(he,{title:e(c)("Profile"),description:e(c)("Manage your profile information.")},{content:C(()=>[t("div",xh,[i(e(ts),{fileTypes:["image/*"],onSuccess:h[0]||(h[0]=D=>{b(D.file_url)})},{default:C(({openFileSelector:D,error:M,uploading:L})=>{var T,x;return[t("div",wh,[t("div",Ch,[i(e(lt),{class:"!size-14",image:s.value.userImage,label:s.value.fullName},null,8,["image","label"]),(a(),B(Ue(s.value.userImage?e(be):"div"),Yt(Kt(s.value.userImage?{options:[{icon:"upload",label:s.value.userImage?e(c)("Change image"):e(c)("Upload image"),onClick:D},{icon:"trash-2",label:e(c)("Remove image"),onClick:()=>b(null)}]}:{onClick:D})),{default:C(()=>[t("div",$h,[i(e(gh),{class:"size-4 cursor-pointer text-white"})])]),_:1},16)),L?(a(),v("div",Ah,[i(e(Ze),{class:"size-4"})])):S("",!0)]),t("div",Sh,[t("div",Vh,[t("span",Dh,w((T=e(l))==null?void 0:T.userName),1),t("span",Ih,w((x=e(l))==null?void 0:x.user),1)]),i(y,{message:e(c)(M)},null,8,["message"])])])]}),_:1})]),h[6]||(h[6]=t("hr",{class:"my-6"},null,-1)),t("div",null,[t("div",Eh,[t("div",Lh,[t("div",Bh,w(e(c)("Account info & security")),1),d.value||u.value?(a(),B(e(Xe),{key:0,variant:"subtle",theme:"orange",size:"sm",label:e(c)("Unsaved")},null,8,["label"])):S("",!0)]),i(e(j),{label:e(c)("Save"),onClick:_,loading:e(p).loading||e(m).loading,disabled:!d.value&&!u.value},null,8,["label","loading","disabled"])]),t("div",Th,[i(k,{class:"w-full",label:e(c)("First Name"),maxlength:"40",modelValue:s.value.firstName,"onUpdate:modelValue":h[1]||(h[1]=D=>s.value.firstName=D)},null,8,["label","modelValue"]),i(k,{class:"w-full",label:e(c)("Last Name"),maxlength:"40",modelValue:s.value.lastName,"onUpdate:modelValue":h[2]||(h[2]=D=>s.value.lastName=D)},null,8,["label","modelValue"])]),t("div",Mh,[t("div",Uh,[t("span",Rh,w(e(c)("Password")),1),t("span",Nh,w(e(c)("Change your account password for security.")),1)]),i(e(j),{"icon-left":"lock",label:e(c)("Change Password"),onClick:h[3]||(h[3]=D=>r.value=!0)},null,8,["label"])]),t("div",jh,[t("div",Fh,[t("span",Oh,w(e(c)("Language")),1),t("span",Ph,w(e(c)("Change language of the application.")),1)]),i(Xl,{"model-value":n.value,"onUpdate:modelValue":h[4]||(h[4]=D=>n.value=D||e(l).language),doctype:"Language",class:"w-40"},null,8,["model-value"])])])]),_:1},8,["title","description"]),r.value?(a(),B(kh,{key:0,modelValue:r.value,"onUpdate:modelValue":h[5]||(h[5]=D=>r.value=D)},null,8,["modelValue"])):S("",!0)],64)}}}),Hh={class:"lucide lucide-image-up",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function qh(o,l){return a(),v("svg",Hh,[...l[0]||(l[0]=[t("path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10l-3.1-3.1a2 2 0 0 0-2.814.014L6 21"},null,-1),t("path",{d:"m14 19.5 3-3 3 3"},null,-1),t("path",{d:"M17 22v-5.5"},null,-1),t("circle",{cx:"9",cy:"9",r:"2"},null,-1)])])}const Qh=Z({name:"lucide-image-up",render:qh}),Jh={class:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4 w-full"},Gh={class:"flex flex-col sm:flex-row items-center gap-3.5"},Wh={class:"flex items-center justify-center min-w-16 min-h-16 rounded-lg overflow-hidden border border-gray-100"},Zh={class:"flex flex-col gap-1 max-w-sm items-start"},Yh={class:"text-base font-medium text-ink-gray-8"},Kh={class:"text-p-sm text-ink-gray-6"},Xh={class:"flex items-end space-x-2"},Ul=O({__name:"LogoUpload",props:{title:{type:String,required:!0},description:{type:String,required:!0},image:{type:String,required:!0},isLoading:{type:Boolean,required:!0}},emits:["onUpload","onRemove"],setup(o,{emit:l}){const s=l,r=o;return(n,u)=>(a(),v("div",Jh,[t("div",Gh,[t("div",Wh,[r.image?(a(),B(e(lt),{key:0,size:"3xl",image:r.image,label:r.title},null,8,["image","label"])):(a(),B(e(Ie),{key:1,name:"image",class:"size-6 text-ink-gray-4"}))]),t("div",Zh,[t("span",Yh,w(o.title),1),t("span",Kh,w(o.description),1)])]),t("div",null,[i(e(ts),{fileTypes:["image/*"],onSuccess:u[1]||(u[1]=d=>{s("onUpload",d.file_url)})},{default:C(({progress:d,uploading:f,openFileSelector:p})=>[t("div",Xh,[i(e(j),{onClick:p,iconLeft:e(Qh),label:f?n.__("Uploading {0}%",d):r.image?n.__("Change"):n.__("Upload"),loading:o.isLoading},null,8,["onClick","iconLeft","label","loading"]),r.image?(a(),B(e(j),{key:0,iconLeft:"trash-2",label:n.__("Remove"),onClick:u[0]||(u[0]=m=>s("onRemove")),loading:o.isLoading},null,8,["label","loading"])):S("",!0)])]),_:1})])]))}}),ey={key:0},ty={class:"text-base font-semibold text-gray-900"},ly=O({__name:"Branding",setup(o){var _,b;const l=Nl(),s=fe(Pt),r=V(!1),n=V((_=s.value)==null?void 0:_.brandLogo),u=V((b=s.value)==null?void 0:b.favicon),d=V({show:!1,title:"",message:"",onConfirm:()=>{}}),f=K({url:"frappe.client.set_value",onSuccess(g){n.value=g.brand_logo,u.value=g.favicon,r.value=!1,l.configResource.reload(),H.success(c("Updated successfully"))},onError(){r.value=!1}});function p(g,h,y){r.value=!0,f.submit({doctype:h,name:h,fieldname:y,value:g})}const m=(g,h)=>{d.value={show:!0,title:c("Remove Logo"),message:c("Are you sure you want to remove the logo?"),onConfirm:()=>{p("",g,h),d.value.show=!1}}};return ce(s,g=>{n.value=g.brandLogo,u.value=g.favicon}),(g,h)=>{const y=q("FormControl"),k=We;return a(),v(N,null,[e(s)?(a(),v("div",ey,[t("div",ty,w(e(c)("Branding")),1),i(y,{type:"text",class:"w-full md:w-1/2 mt-6",modelValue:e(s).brandName,"onUpdate:modelValue":h[0]||(h[0]=D=>e(s).brandName=D),label:e(c)("Brand name"),placeholder:e(c)("Enter brand name"),maxlength:"30"},null,8,["modelValue","label","placeholder"]),i(Ul,{title:e(c)("Logo"),description:e(c)("Appears in the left sidebar. Recommended size is minimum 32x32 px in PNG or SVG"),image:n.value,onOnUpload:h[1]||(h[1]=D=>p(D,"HD Settings","brand_logo")),onOnRemove:h[2]||(h[2]=D=>m("HD Settings","brand_logo")),isLoading:r.value},null,8,["title","description","image","isLoading"]),i(Ul,{title:e(c)("Favicon"),description:e(c)("Appears next to the title in your browser tab. Recommended size is minimum 32x32 px in PNG or ICO"),image:u.value,onOnUpload:h[3]||(h[3]=D=>p(D,"HD Settings","favicon")),onOnRemove:h[4]||(h[4]=D=>m("HD Settings","favicon")),isLoading:r.value},null,8,["title","description","image","isLoading"])])):S("",!0),i(k,{modelValue:d.value.show,"onUpdate:modelValue":h[5]||(h[5]=D=>d.value.show=D),title:d.value.title,message:d.value.message,onConfirm:d.value.onConfirm,onCancel:()=>d.value.show=!1},null,8,["modelValue","title","message","onConfirm","onCancel"])],64)}}}),sy={class:"w-full truncate"},ny={class:"max-h-52 overflow-y-auto"},ay=["onClick"],oy={class:"w-full truncate"},Gt=O({__name:"SelectDropdown",props:Ve({options:{},targetClass:{},bodyClass:{},placement:{default:"bottom-start"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const l=_e(o,"modelValue"),s=o,r=u=>{l.value=null,u()},n=u=>{l.value=u};return(u,d)=>(a(),B(e(Re),{placement:s.placement},{target:C(({togglePopover:f})=>[i(e(j),{class:X(["flex items-center justify-between min-w-36",o.targetClass]),onClick:p=>f(),"icon-right":"chevron-down"},{default:C(()=>{var p,m;return[t("div",sy,w(((m=(p=o.options)==null?void 0:p.find(_=>_.value==l.value))==null?void 0:m.label)||"Select"),1)]}),_:1},8,["onClick","class"])]),body:C(({togglePopover:f})=>[t("div",{class:X(["p-1 text-ink-gray-6 top-1 absolute w-[--reka-popper-anchor-width] bg-white shadow-2xl rounded",o.bodyClass])},[t("div",ny,[(a(!0),v(N,null,W(o.options,p=>(a(),v("div",{key:p.value,class:"p-2 cursor-pointer hover:bg-surface-gray-3 text-base flex items-center justify-between rounded",onClick:()=>{n(p.value),f()}},[t("div",oy,w(p.label),1),l.value==p.value?(a(),B(e(Ie),{key:0,name:"check",class:"size-4 ml-2"})):S("",!0)],8,ay))),128))]),d[0]||(d[0]=t("hr",{class:"my-1"},null,-1)),i(e(j),{variant:"ghost",label:u.__("Reset"),"icon-left":"refresh-ccw",class:"w-full focus-visible:ring-0",onClick:p=>r(f)},null,8,["label","onClick"])],2)]),_:1},8,["placement"]))}}),iy={class:"text-base font-semibold text-gray-900"},ry={class:"mt-6 flex flex-col gap-6"},uy={class:"flex items-center justify-between"},dy={class:"flex flex-col gap-1"},cy={class:"text-base font-medium text-ink-gray-8"},my={class:"text-p-sm text-ink-gray-6"},py={class:"flex items-center justify-between"},fy={class:"flex flex-col gap-1"},vy={class:"text-base font-medium text-ink-gray-8"},gy={class:"text-p-sm text-ink-gray-6"},_y={key:0,class:"grid grid-cols-2 gap-4 mt-3"},hy={class:"flex items-center justify-between"},yy={class:"flex flex-col gap-1"},by={class:"text-base font-medium text-ink-gray-8"},ky={class:"text-p-sm text-ink-gray-6"},xy={class:"flex items-center justify-between"},wy={class:"flex flex-col gap-1"},Cy={class:"text-base font-medium text-ink-gray-8"},$y={class:"text-p-sm text-ink-gray-6"},Ay={class:"flex items-center justify-between"},Sy={class:"flex flex-col gap-1"},Vy={class:"text-base font-medium text-ink-gray-8"},Dy={class:"text-p-sm text-ink-gray-6"},Iy={class:"flex flex-col gap-1"},Ey={class:"text-base font-medium text-ink-gray-8"},Ly={class:"text-p-sm text-ink-gray-6"},By={class:"grid grid-cols-2 gap-4 mt-3"},Ty={class:"flex flex-col gap-1.5"},My={class:"flex flex-col gap-1.5"},Uy=O({__name:"TicketSettings",setup(o){const l=fe(Pt),{statuses:s}=hl(),r=tt({doctype:"HD Ticket Type",name:"HD Ticket Type",auto:!0,transform:d=>d.map(f=>({label:f.name,value:f.name}))}),n=G(()=>{var d;return((d=s.data)==null?void 0:d.map(f=>({label:f.label_agent,value:f.label_agent})))||[]}),u=G(()=>{var d,f;return((f=(d=s.data)==null?void 0:d.filter(p=>p.category==="Resolved"||p.category==="Paused"))==null?void 0:f.map(p=>({label:p.label_agent,value:p.label_agent})))||[]});return(d,f)=>(a(),v("div",null,[t("div",iy,w(d.__("Ticket settings")),1),t("div",ry,[t("div",uy,[t("div",dy,[t("span",cy,w(d.__("Make feedback mandatory")),1),t("span",my,w(d.__("The feedback dialog will be shown, when a user tries to close a ticket from the customer portal.")),1)]),i(e(Ee),{modelValue:e(l).isFeedbackMandatory,"onUpdate:modelValue":f[0]||(f[0]=p=>e(l).isFeedbackMandatory=p)},null,8,["modelValue"])]),t("div",null,[t("div",py,[t("div",fy,[t("span",vy,w(d.__("Restrict tickets by team")),1),t("span",gy,w(d.__("Restrict tickets to be viewed and managed by team members only.")),1)]),i(e(Ee),{modelValue:e(l).restrictTicketsByAgentGroup,"onUpdate:modelValue":f[1]||(f[1]=p=>e(l).restrictTicketsByAgentGroup=p)},null,8,["modelValue"])]),e(l).restrictTicketsByAgentGroup?(a(),v("div",_y,[i(e(Be),{size:"sm",modelValue:e(l).doNotRestrictTicketsWithoutAnAgentGroup,"onUpdate:modelValue":f[2]||(f[2]=p=>e(l).doNotRestrictTicketsWithoutAnAgentGroup=p),label:d.__("Do not restrict tickets without a team")},null,8,["modelValue","label"]),i(e(Be),{size:"sm",modelValue:e(l).assignWithinTeam,"onUpdate:modelValue":f[3]||(f[3]=p=>e(l).assignWithinTeam=p),label:d.__("Restrict agent assignment to selected team")},null,8,["modelValue","label"])])):S("",!0)]),t("div",hy,[t("div",yy,[t("span",by,w(d.__("Auto update status")),1),t("span",ky,w(d.__("The ticket status will automatically change whenever the agent respond to a ticket.")),1)]),i(Gt,{options:n.value,"model-value":e(l).updateStatusTo,"onUpdate:modelValue":f[4]||(f[4]=p=>{p?(e(l).updateStatusTo=p,e(l).autoUpdateStatus=!0):(e(l).updateStatusTo=null,e(l).autoUpdateStatus=!1)}),"target-class":"max-w-40",placement:"bottom-start"},null,8,["options","model-value"])]),t("div",xy,[t("div",wy,[t("span",Cy,w(d.__("Allow anyone to create tickets")),1),t("span",$y,w(d.__("Anyone will be able to create tickets without any permission. e.g. from webform.")),1)]),i(e(Ee),{"model-value":e(l).allowAnyoneToCreateTickets,"onUpdate:modelValue":f[5]||(f[5]=p=>e(l).allowAnyoneToCreateTickets=p)},null,8,["model-value"])]),t("div",Ay,[t("div",Sy,[t("span",Vy,w(d.__("Default ticket type")),1),t("span",Dy,w(d.__("Select what type all tickets get by default.")),1)]),i(Gt,{options:e(r).data,modelValue:e(l).defaultTicketType,"onUpdate:modelValue":f[6]||(f[6]=p=>e(l).defaultTicketType=p),"target-class":"max-w-40",placement:"bottom-start"},null,8,["options","modelValue"])]),t("div",null,[t("div",Iy,[t("span",Ey,w(d.__("Automatically close stale tickets")),1),t("span",Ly,w(d.__("Auto-close tickets that remain in a status for the specified number of days.")),1)]),t("div",By,[t("div",Ty,[i(e(Ne),{label:d.__("Ticket status")},null,8,["label"]),i(Gt,{options:u.value,"model-value":e(l).autoCloseStatus,"onUpdate:modelValue":f[7]||(f[7]=p=>{p?(e(l).autoCloseStatus=p,e(l).autoCloseTickets=!0):(e(l).autoCloseStatus=null,e(l).autoCloseTickets=!1)}),"target-class":"w-full",placement:"bottom-start"},null,8,["options","model-value"])]),t("div",My,[i(e(ae),{label:d.__("Auto-close after (Days)"),placeholder:"e.g. 30",modelValue:e(l).autoCloseAfterDays,"onUpdate:modelValue":f[8]||(f[8]=p=>e(l).autoCloseAfterDays=p),type:"number",debounce:300,disabled:!e(l).autoCloseStatus},null,8,["label","modelValue","disabled"]),i(e(pe),{message:e(l).autoCloseStatus&&e(l).autoCloseAfterDays<1?d.__("The number of days must be 1 or more"):""},null,8,["message"])])])])])]))}}),Ry={class:"text-base font-semibold text-gray-900"},Ny={class:"mt-6 flex flex-col gap-6"},jy={class:"flex items-center justify-between"},Fy={class:"flex flex-col gap-1"},Oy={class:"text-base font-medium text-ink-gray-8"},Py={class:"text-p-sm text-ink-gray-6"},zy={class:"flex items-center justify-between"},Hy={class:"flex flex-col gap-1"},qy={class:"text-base font-medium text-ink-gray-8"},Qy={class:"text-p-sm text-ink-gray-6"},Jy=O({__name:"WorkflowKnowledgebaseSettings",setup(o){const l=fe(Pt);return(s,r)=>(a(),v("div",null,[t("div",Ry,w(s.__("Workflow & knowledge base settings")),1),t("div",Ny,[t("div",jy,[t("div",Fy,[t("span",Oy,w(s.__("Prefer knowledge base")),1),t("span",Py,w(s.__("Guide users to articles before tickets.")),1)]),i(e(Ee),{"model-value":e(l).preferKnowledgeBase,"onUpdate:modelValue":r[0]||(r[0]=n=>e(l).preferKnowledgeBase=n)},null,8,["model-value"])]),t("div",zy,[t("div",Hy,[t("span",qy,w(s.__("Skip email workflow")),1),t("span",Qy,w(s.__("Disables all email notifications for the ticket - including creation, updates, and alerts.")),1)]),i(e(Ee),{"model-value":e(l).skipEmailWorkflow,"onUpdate:modelValue":r[1]||(r[1]=n=>e(l).skipEmailWorkflow=n)},null,8,["model-value"])])])]))}}),Gy={class:"flex items-center gap-2"},Wy={class:"text-lg font-semibold text-ink-gray-8"},Zy={key:0,class:"flex items-center justify-center mt-12"},Yy={key:1},Ky={class:"text-base font-semibold text-gray-900"},Xy={class:"flex items-center justify-between mt-6"},eb={class:"flex flex-col gap-1"},tb={class:"text-base font-medium text-ink-gray-8"},lb={class:"text-p-sm text-ink-gray-6"},sb=O({__name:"General",setup(o){const l=V(!1),s=V(null),r=V({brandName:"",brandLogo:"",favicon:"",autoCloseAfterDays:"",autoCloseStatus:"",autoCloseTickets:"",assignWithinTeam:!1,doNotRestrictTicketsWithoutAnAgentGroup:!1,restrictTicketsByAgentGroup:!1,updateStatusTo:"",autoUpdateStatus:!1,isFeedbackMandatory:!1,allowAnyoneToCreateTickets:!1,defaultTicketType:"",preferKnowledgeBase:!1,skipEmailWorkflow:!1}),n=V(!1);Oe(Pt,r);const u=K({url:"frappe.client.get",params:{doctype:"HD Settings",name:"HD Settings"},auto:!0,onSuccess(g){r.value=p(g),s.value=JSON.stringify(r.value)}}),d=G(()=>{var g;return n.value!==!!((g=m.data)!=null&&g.disable_signup)}),f=K({url:"frappe.client.set_value",makeParams(){return{doctype:"HD Settings",name:"HD Settings",fieldname:{brand_name:r.value.brandName,auto_close_after_days:Number(r.value.autoCloseAfterDays),auto_close_status:r.value.autoCloseStatus,auto_close_tickets:r.value.autoCloseTickets,assign_within_team:r.value.assignWithinTeam,do_not_restrict_tickets_without_an_agent_group:r.value.doNotRestrictTicketsWithoutAnAgentGroup,restrict_tickets_by_agent_group:r.value.restrictTicketsByAgentGroup,update_status_to:r.value.updateStatusTo,auto_update_status:r.value.autoUpdateStatus,is_feedback_mandatory:r.value.isFeedbackMandatory,allow_anyone_to_create_tickets:r.value.allowAnyoneToCreateTickets,default_ticket_type:r.value.defaultTicketType,prefer_knowledge_base:r.value.preferKnowledgeBase,skip_email_workflow:r.value.skipEmailWorkflow}}},onSuccess(g){r.value=p(g),s.value=JSON.stringify(r.value)}}),p=g=>({brandName:g.brand_name,brandLogo:g.brand_logo,favicon:g.favicon,autoCloseAfterDays:g.auto_close_after_days,autoCloseStatus:g.auto_close_status,autoCloseTickets:g.auto_close_tickets,assignWithinTeam:!!g.assign_within_team,doNotRestrictTicketsWithoutAnAgentGroup:!!g.do_not_restrict_tickets_without_an_agent_group,restrictTicketsByAgentGroup:!!g.restrict_tickets_by_agent_group,updateStatusTo:g.update_status_to,autoUpdateStatus:g.auto_update_status,isFeedbackMandatory:!!g.is_feedback_mandatory,allowAnyoneToCreateTickets:!!g.allow_anyone_to_create_tickets,defaultTicketType:g.default_ticket_type,preferKnowledgeBase:!!g.prefer_knowledge_base,skipEmailWorkflow:!!g.skip_email_workflow}),m=K({url:"frappe.client.get",params:{doctype:"Website Settings",name:"Website Settings",fields:["disable_signup"]},auto:!0,onSuccess(g){n.value=!!g.disable_signup}}),_=K({url:"frappe.client.set_value",makeParams(){return{doctype:"Website Settings",name:"Website Settings",fieldname:{disable_signup:n.value}}},onSuccess(){m.reload()}}),b=async()=>{const g=[];l.value&&g.push(f.submit()),d.value&&g.push(_.submit()),await Promise.allSettled(g).then(()=>{H.success(c("Settings updated"))})};return ce(r,g=>{s.value&&(l.value=JSON.stringify(g)!==s.value,l.value?ue.value=!0:ue.value=!1)},{deep:!0}),(g,h)=>(a(),B(he,{description:e(c)("Manage general settings of your app.")},{title:C(()=>[t("div",Gy,[t("h1",Wy,w(e(c)("General")),1),l.value||d.value?(a(),B(e(Xe),{key:0,variant:"subtle",theme:"orange",size:"sm",label:e(c)("Unsaved")},null,8,["label"])):S("",!0)])]),"header-actions":C(()=>[i(e(j),{label:e(c)("Save"),variant:"solid",onClick:b,loading:e(f).loading||e(_).loading,disabled:!l.value&&!d.value},null,8,["label","loading","disabled"])]),content:C(()=>[e(u).loading&&!e(u).data?(a(),v("div",Zy,[i(e(Ze),{class:"w-4"})])):(a(),v("div",Yy,[i(ly),h[1]||(h[1]=t("hr",{class:"my-8"},null,-1)),i(Uy),h[2]||(h[2]=t("hr",{class:"my-8"},null,-1)),i(Jy),h[3]||(h[3]=t("hr",{class:"my-8"},null,-1)),t("div",null,[t("div",Ky,w(e(c)("User signup")),1),t("div",Xy,[t("div",eb,[t("span",tb,w(e(c)("Disable signup")),1),t("span",lb,w(e(c)("New users will have to be manually registered by system managers.")),1)]),i(e(Ee),{modelValue:n.value,"onUpdate:modelValue":h[0]||(h[0]=y=>n.value=y)},null,8,["modelValue"])])])]))]),_:1},8,["description"]))}}),nb={class:"lucide lucide-settings",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function ab(o,l){return a(),v("svg",nb,[...l[0]||(l[0]=[t("path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915"},null,-1),t("circle",{cx:"12",cy:"12",r:"3"},null,-1)])])}const ob=Z({name:"lucide-settings",render:ab}),st=et(),Nt=G(()=>[{label:c("User Settings"),hideLabel:!0,items:[{label:c("Profile"),icon:ne(lt,{image:st.userImage,label:st.userName,size:"xs"}),component:Z(zh)}]},{label:c("Email Settings"),condition:()=>st.isAdmin||st.isManager,items:[{label:c("Email Accounts"),icon:Z(es),component:Z(wr)},{label:c("Email Notifications"),icon:Z(Es),component:Z(ph)}]},{label:c("App Settings"),condition:()=>st.isAdmin||st.isManager,items:[{label:c("General"),icon:Z(ob),component:Z(sb),condition:()=>st.isAdmin},{label:c("Agents"),icon:Z(Yl),component:Z(Ii)},{label:c("Invite Agents"),icon:Z(Ls),component:Z(wg)},{label:c("Teams"),icon:Z($n),component:Z(Bu)},{label:c("SLA Policies"),icon:Z($s),component:Z(Im)},{label:c("Business Holidays"),icon:Z(As),component:Z(Ef)},{label:c("Assignment Rules"),icon:Z(ne(kl,{class:"rotate-90"})),component:Z(g_)},{label:c("Field Dependencies"),icon:Z(ns),component:Z(_g)}]},{label:c("Integrations"),items:[{label:c("Telephony"),icon:Z(Tn),component:Z(q_)}]}].filter(l=>l.condition&&!l.condition()?!1:(l.items&&(l.items=l.items.filter(s=>!(s.condition&&!s.condition()))),!0))),ct=V(Nt.value[0].items[0]),gt=V(null),ue=V(!1),Pe=o=>{ct.value=o&&Nt.value.map(l=>l.items).flat().find(l=>l.label==c(o))||Nt.value[0].items[0]},ib={class:"flex z-50",style:{height:"calc(100vh - 8rem)"}},rb={class:"flex w-52 shrink-0 flex-col bg-gray-50 p-2 overflow-y-auto hide-scrollbar"},ub={class:"px-2 pt-2 text-lg font-semibold mb-2"},db={key:0,class:"mb-2 mt-3 flex gap-1.5 px-1 text-base font-medium text-ink-gray-5"},cb={class:"space-y-1"},mb=["onClick"],pb={class:"text-base text-gray-800"},fb={class:"flex flex-1 flex-col bg-surface-modal"},vb=O({__name:"SettingsModal",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o){const l=_e(o,"modelValue"),s=V(!1);function r(n){if(!ue.value){ct.value=n;return}gt.value=n,s.value=!0}return(n,u)=>(a(),v(N,null,[i(e(Te),{modelValue:l.value,"onUpdate:modelValue":u[0]||(u[0]=d=>l.value=d),options:{size:"5xl"},disableOutsideClickToClose:e(ue)},{body:C(()=>[t("div",ib,[t("div",rb,[t("h1",ub,w(n.__("Settings")),1),(a(!0),v(N,null,W(e(Nt),d=>(a(),v("div",null,[d.hideLabel?S("",!0):(a(),v("div",db,[t("span",null,w(n.__(d.label)),1)])),t("nav",cb,[(a(!0),v(N,null,W(d.items,f=>{var p;return a(),v("button",{key:f.label,class:X(["flex h-7 w-full items-center gap-2 rounded px-2 py-1",[((p=e(ct))==null?void 0:p.label)==f.label?"bg-white shadow-sm":"hover:bg-gray-100"]]),onClick:()=>r(f)},[(a(),B(Ue(f.icon),{class:"h-4 w-4 text-gray-700"})),t("span",pb,w(f.label),1)],10,mb)}),128))])]))),256))]),t("div",fb,[e(ct)?(a(),B(Ue(e(ct).component),{key:0,class:"h-full flex flex-col w-full"})):S("",!0)])])]),_:1},8,["modelValue","disableOutsideClickToClose"]),i(We,{modelValue:s.value,"onUpdate:modelValue":u[1]||(u[1]=d=>s.value=d),title:n.__("Unsaved changes"),message:n.__("Are you sure you want to change tabs? Unsaved changes will be lost."),onConfirm:()=>{e(gt)!==null&&(ct.value=e(gt)),gt.value=null,s.value=!1,ue.value=!1},onCancel:()=>{gt.value=null}},null,8,["modelValue","title","message","onConfirm","onCancel"])],64))}}),Bs=V("https://frappecloud.com"),Ts=V(""),gb=K({url:"frappe.integrations.frappe_providers.frappecloud_billing.current_site_info",cache:"currentSiteInfo",onSuccess:o=>{Bs.value=o.base_url,Ts.value=o.site_name}}),_b=()=>{gb.fetch();const{$dialog:o}=cn();o({title:"Login to Frappe Cloud?",message:"Are you sure you want to login to your Frappe Cloud dashboard?",actions:[{label:"Confirm",variant:"solid",onClick(l){hb(),l()}}]})},hb=()=>{window.open(`${Bs.value}/dashboard/sites/${Ts.value}`,"_blank")},yb={class:"lucide lucide-arrow-left-from-line",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function bb(o,l){return a(),v("svg",yb,[...l[0]||(l[0]=[t("path",{d:"m9 6-6 6 6 6"},null,-1),t("path",{d:"M3 12h14"},null,-1),t("path",{d:"M21 19V5"},null,-1)])])}const kb=Z({name:"lucide-arrow-left-from-line",render:bb}),xb={class:"lucide lucide-arrow-right-from-line",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function wb(o,l){return a(),v("svg",xb,[...l[0]||(l[0]=[t("path",{d:"M3 5v14"},null,-1),t("path",{d:"M21 12H7"},null,-1),t("path",{d:"m15 18 6-6-6-6"},null,-1)])])}const Cb=Z({name:"lucide-arrow-right-from-line",render:wb}),$b={class:"lucide lucide-globe",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Ab(o,l){return a(),v("svg",$b,[...l[0]||(l[0]=[t("circle",{cx:"12",cy:"12",r:"10"},null,-1),t("path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"},null,-1),t("path",{d:"M2 12h20"},null,-1)])])}const Sb=Z({name:"lucide-globe",render:Ab}),Vb={class:"lucide lucide-message-circle",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Db(o,l){return a(),v("svg",Vb,[...l[0]||(l[0]=[t("path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z"},null,-1)])])}const Ib=Z({name:"lucide-message-circle",render:Db}),Eb={class:"lucide lucide-timer",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Lb(o,l){return a(),v("svg",Eb,[...l[0]||(l[0]=[t("line",{x1:"10",x2:"14",y1:"2",y2:"2"},null,-1),t("line",{x1:"12",x2:"15",y1:"14",y2:"11"},null,-1),t("circle",{cx:"12",cy:"14",r:"8"},null,-1)])])}const Bb=Z({name:"lucide-timer",render:Lb}),Tb={class:"lucide lucide-user-pen",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Mb(o,l){return a(),v("svg",Tb,[...l[0]||(l[0]=[t("path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2"},null,-1),t("path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z"},null,-1),t("circle",{cx:"10",cy:"7",r:"4"},null,-1)])])}const Ub=Z({name:"lucide-user-pen",render:Mb}),Rb={class:"lucide lucide-keyboard",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"};function Nb(o,l){return a(),v("svg",Rb,[...l[0]||(l[0]=[ul('<path d="M10 8h.01"></path><path d="M12 12h.01"></path><path d="M14 8h.01"></path><path d="M16 12h.01"></path><path d="M18 8h.01"></path><path d="M6 8h.01"></path><path d="M7 16h10"></path><path d="M8 12h.01"></path><rect width="20" height="16" x="2" y="4" rx="2"></rect>',9)])])}const jb=Z({name:"lucide-keyboard",render:Nb}),Fb={class:"flex items-center gap-0.5 font-medium text-gray-600"},Ob={key:2,class:"mb-4"},Pb={key:0,class:"absolute size-1.5 translate-x-6 translate-y-1 rounded-full bg-blue-400 left-1",theme:"gray",variant:"solid"},zb={class:"overflow-y-auto overflow-x-hidden"},Hb={key:0,class:"mx-2 my-2 h-1 border-b"},qb=["onClick"],Qb={class:"flex flex-col"},Jb={class:"flex flex-col gap-2"},Gb=O({__name:"Sidebar",setup(o){const{isMobileView:l}=an(),s=on(),r=Rl(),n=et(),u=Gl(),{isExpanded:d,width:f}=Wt(Wl()),p=fl(),m=gl(),{isCallingEnabled:_}=Wt(m),b=V(!1),g=V(!1),h=V(!1),{pinnedViews:y,publicViews:k}=mn(),D=V(window.is_fc_site),M=G(()=>{var $t,At;let de=De.value?_n:hn;_.value||(de=de.filter(me=>me.label!==c("Call Logs")));const ie=[{label:c("All Views"),hideLabel:!0,opened:!0,views:de}];return($t=k.value)!=null&&$t.length&&!De.value&&ie.push({label:c("Public Views"),opened:!0,hideLabel:!1,views:L(k.value)}),(At=y.value)!=null&&At.length&&ie.push({label:c("Private Views"),opened:!0,hideLabel:!1,views:L(y.value)}),ie});function L(de){return de.map(ie=>({label:ie.label,icon:ie.icon,to:{name:ie.route_name,query:{view:ie.name}},onClick:()=>{pn.value={label:ie.label,icon:ie.icon}}}))}const T=G(()=>[{label:c("Log out"),icon:"log-out",onClick:()=>n.logout()}]),x=G(()=>[{component:Z(yn)},{label:c("Customer portal"),icon:"users",onClick:()=>{const de=r.resolve({name:"TicketsCustomer"});window.open(de.href)}},{icon:"life-buoy",label:c("Support"),onClick:()=>window.open("https://t.me/frappedesk")},{icon:"book-open",label:c("Docs"),onClick:()=>window.open("https://docs.frappe.io/helpdesk")},{label:c("Login to Frappe Cloud"),icon:_o,onClick:()=>_b(),condition:()=>!l.value&&window.is_fc_site},{label:c("Shortcuts"),icon:ne(jb),onClick:()=>g.value=!0},{label:c("Settings"),icon:"settings",onClick:()=>b.value=!0},{group:c("Danger"),hideLabel:!0,items:[{label:c("Log out"),icon:"log-out",onClick:()=>n.logout()}]}]),I=G(()=>De.value?T.value:x.value);function A(de){var ie;return s.query.view?s.query.view==((ie=de==null?void 0:de.query)==null?void 0:ie.view):s.name===de}function $(){h.value=!0}const E=ne(bn,{class:"h-12 w-12"},null),Q=G(()=>!De.value&&!ee.value&&n.isManager),F=[{name:"setup_email_account",title:c("Connect your support email"),completed:!1,icon:Z(es),onClick:()=>{$e.value=!0,b.value=!0,Pe("Email Accounts")}},{name:"invite_agents",title:c("Invite agents"),completed:!1,icon:Z(Ls),onClick:()=>{$e.value=!0,b.value=!0,Pe("Invite Agents")}},{name:"setup_sla",title:c("Setup SLA"),completed:!1,icon:Z(Bb),onClick:()=>{Pe("SLA Policies"),b.value=!0,$e.value=!0}},{name:"create_first_ticket",title:c("Create a ticket"),completed:!1,icon:Z(Xt),onClick:()=>{r.push({name:"TicketAgentNew"}),$e.value=!0}},{name:"assign_to_agent",title:c("Assign a ticket to an agent"),completed:!1,icon:Z(Ub),onClick:async()=>{await Ht(),fn.value=!0,$e.value=!0}},{name:"reply_on_ticket",title:c("Reply on a ticket"),completed:!1,icon:Z(Es),onClick:async()=>{await Ht(),Sl.value=!0,Vl.value=!1,$e.value=!0}},{name:"comment_on_ticket",title:c("Add a comment on a ticket"),completed:!1,icon:Z(Ib),onClick:async()=>{await Ht(),Vl.value=!0,Sl.value=!1,$e.value=!0}},{name:"first_article",title:c("Create an article"),completed:!1,icon:Z(vn),onClick:async()=>{const de=await Us();r.push({name:"NewArticle",query:{title:c("General")},params:{id:de}}),$e.value=!0}},{name:"add_invite_contact",title:c("Create & invite a contact"),completed:!1,icon:Z(ko),onClick:()=>{$e.value=!0,U.value={title:c("Create & invite a contact"),buttonLabel:c("Create"),videoURL:"/assets/helpdesk/desk/videos/createInviteContact.mp4",onClick:async()=>{z.value=!1,r.push({name:"ContactList"}),Un.value=!0}},z.value=!0}},{name:"explore_customer_portal",title:c("Explore customer portal"),completed:!1,icon:Z(Sb),onClick:()=>{window.open("/helpdesk/my-tickets","_blank"),vt("explore_customer_portal"),$e.value=!0}}],Y=V([{title:"Introduction",opened:!1,subArticles:[{name:"introduction",title:"Introduction"},{name:"setting-up",title:"Setting up"}]},{title:"Getting Started",opened:!1,subArticles:[{name:"lesson-1-your-first-ticket",title:"Creating a ticket"},{name:"lesson-2understanding-ticket-view",title:"Understanding ticket view"},{name:"lesson-3-agents-teams",title:"Agents & Teams"},{name:"customers-contacts",title:"Customers & Contacts"},{name:"lesson-4-knowledge-base",title:"Knowledge Base"},{name:"customer-portal",title:"Customer Portal"}]},{title:"Masters",opened:!1,subArticles:[{name:"ticket",title:"Ticket"},{name:"agent",title:"Agent"},{name:"team",title:"Team"},{name:"contact",title:"Contact"},{name:"customer",title:"Customer"},{name:"knowledge-base",title:"Knowledge Base"},{name:"canned-response",title:"Canned Responses"},{name:"service-level-agreement",title:"Service Level Agreement"},{name:"ticket-type",title:"Ticket Type"},{name:"ticket-priority",title:"Ticket Priority"}]},{title:"Customizations",opened:!1,subArticles:[{name:"custom-actions",title:"Custom Actions"},{name:"field-dependency",title:"Field Dependency"},{name:"custom-views",title:"Custom Views"},{name:"settings",title:"Settings"}]},{title:"Frappe Helpdesk Mobile",opened:!1,subArticles:[{name:"pwa-installation",title:"Mobile App Installation"}]}]),z=V(!1),U=V({}),{isOnboardingStepsCompleted:ee,setUp:re,updateOnboardingStep:vt}=it("helpdesk");async function Ht(){const de=await Ms();de?r.push({name:"TicketAgent",params:{ticketId:de}}):r.push({name:"TicketAgentNew"})}async function Ms(){let de=localStorage.getItem("firstTicket");return de||await Je("helpdesk.api.onboarding.get_first_ticket")}async function Us(){let de=localStorage.getItem("generalCategoryId");if(!de){if(de=await Je("helpdesk.api.onboarding.get_general_category_id"),!de)return;localStorage.setItem("generalCategoryId",de)}return de}function Rs(){n.isManager&&(re(F),Ut({key:"h",meta:!0},()=>{ze.value=!ze.value}))}return Le(()=>{Rs(),!De.value&&Ut({key:",",meta:!0},()=>{b.value=!b.value})}),(de,ie)=>{const $t=q("Badge"),At=q("FeatherIcon");return a(),v("div",{class:"flex select-none flex-col border-r border-gray-200 bg-gray-50 p-2 text-base duration-300 ease-in-out",style:ft({"min-width":e(f),"max-width":e(f)})},[i(kn,{class:"mb-2",options:I.value},null,8,["options"]),e(De)?S("",!0):(a(),B(e(rt),{key:0,label:e(c)("Search"),class:"my-0.5",icon:e(vl),"on-click":()=>$(),"is-expanded":e(d)},{right:C(()=>[t("span",Fb,[(a(),B(Ue(e(p).modifierIcon),{class:"h-3 w-3"})),ie[7]||(ie[7]=t("span",null,"K",-1))])]),_:1},8,["label","icon","on-click","is-expanded"])),e(De)?S("",!0):(a(),B(e(rt),{key:1,class:"relative my-0.5 min-h-7",label:e(c)("Dashboard"),icon:e(xn),to:"Dashboard","is-active":A("Dashboard"),"is-expanded":e(d)},null,8,["label","icon","is-active","is-expanded"])),e(De)?S("",!0):(a(),v("div",Ob,[e(u).unread?(a(),v("div",Pb)):S("",!0),i(e(rt),{class:"relative my-0.5",label:e(c)("Notifications"),icon:e(ql),"on-click":()=>e(u).toggle(),"is-expanded":e(d)},{right:C(()=>[e(d)&&e(u).unread?(a(),B($t,{key:0,label:e(u).unread>9?"9+":e(u).unread,theme:"gray",variant:"subtle"},null,8,["label"])):S("",!0)]),_:1},8,["label","icon","on-click","is-expanded"])])),t("div",zb,[(a(!0),v(N,null,W(M.value,me=>{var Cl;return a(),v("div",{key:me.label},[!me.hideLabel&&!e(d)&&((Cl=me.views)!=null&&Cl.length)?(a(),v("div",Hb)):S("",!0),i(e(wn),{label:me.label,hideLabel:me.hideLabel,opened:me.opened},{header:C(({opened:Ye,hide:Ns,toggle:js})=>[Ns?S("",!0):(a(),v("div",{key:0,class:X(["flex cursor-pointer gap-1.5 px-1 text-base font-medium text-ink-gray-5 transition-all duration-300 ease-in-out",e(d)?"mt-4 h-7 w-auto opacity-100":"ml-0 h-0 overflow-hidden opacity-0"]),onClick:Yb=>js()},[i(At,{name:"chevron-right",class:X(["h-4 text-ink-gray-9 transition-all duration-300 ease-in-out",{"rotate-90":Ye}])},null,8,["class"]),t("span",null,w(me.label),1)],10,qb))]),default:C(()=>[t("nav",Qb,[(a(!0),v(N,null,W(me.views,Ye=>(a(),B(e(rt),{icon:Ye.icon,label:Ye.label,to:Ye.to,key:Ye.label,"is-expanded":e(d),"is-active":A(Ye.to),class:"my-0.5 emoji",onClick:Ye.onClick},null,8,["icon","label","to","is-expanded","is-active","onClick"]))),128))])]),_:2},1032,["label","hideLabel","opened"])])}),128))]),ie[8]||(ie[8]=t("div",{class:"grow"},null,-1)),t("div",Jb,[D.value&&!e(De)?(a(),B(e(Il),{key:0,isSidebarCollapsed:!e(d)},null,8,["isSidebarCollapsed"])):S("",!0),Q.value?(a(),B(e(Ha),{key:1,isSidebarCollapsed:!e(d),appName:"helpdesk"},null,8,["isSidebarCollapsed"])):S("",!0),e(ee)&&!e(De)?(a(),B(e(rt),{key:2,icon:e(ls),label:e(c)("Help"),"is-expanded":e(d),onClick:ie[0]||(ie[0]=()=>{ze.value=e($e)?!0:!e(ze),$e.value=!e(ze)})},null,8,["icon","label","is-expanded"])):S("",!0),i(e(rt),{icon:e(d)?e(kb):e(Cb),"is-active":!1,"is-expanded":e(d),label:e(d)?e(c)("Collapse"):e(c)("Expand"),"on-click":()=>d.value=!e(d)},null,8,["icon","is-expanded","label","on-click"])]),D.value&&!e(De)?(a(),B(e(Il),{key:3,isSidebarCollapsed:!e(d)},null,8,["isSidebarCollapsed"])):S("",!0),i(vb,{modelValue:b.value,"onUpdate:modelValue":ie[1]||(ie[1]=me=>b.value=me)},null,8,["modelValue"]),i(Ho,{modelValue:g.value,"onUpdate:modelValue":ie[2]||(ie[2]=me=>g.value=me)},null,8,["modelValue"]),e(ze)?(a(),B(e(Ma),{key:4,modelValue:e(ze),"onUpdate:modelValue":ie[3]||(ie[3]=me=>_t(ze)?ze.value=me:null),articles:Y.value,"onUpdate:articles":ie[4]||(ie[4]=me=>Y.value=me),appName:"helpdesk",title:"Frappe Helpdesk",logo:e(E),docsLink:"https://docs.frappe.io/helpdesk",afterSkip:me=>e(St)("onboarding_step_skipped_"+me),afterSkipAll:()=>e(St)("onboarding_steps_skipped"),afterReset:me=>e(St)("onboarding_step_reset_"+me),afterResetAll:()=>e(St)("onboarding_steps_reset")},null,8,["modelValue","articles","logo","afterSkip","afterSkipAll","afterReset","afterResetAll"])):S("",!0),i(e(Za),{modelValue:z.value,"onUpdate:modelValue":ie[5]||(ie[5]=me=>z.value=me),currentStep:U.value},null,8,["modelValue","currentStep"]),i(ss,{modelValue:h.value,"onUpdate:modelValue":ie[6]||(ie[6]=me=>h.value=me)},null,8,["modelValue"])],4)}}}),Wb={class:"flex h-screen w-screen"},Zb={class:"flex-1 flex flex-col h-full overflow-auto"},T0={__name:"DesktopLayout",setup(o){return(l,s)=>(a(),v("div",Wb,[i(Gb),t("div",Zb,[i(No),Ce(l.$slots,"default")]),i(e(Mo)),i(e(ss))]))}};export{T0 as default};
//# sourceMappingURL=DesktopLayout-43bc2137.js.map
