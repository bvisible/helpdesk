import{d as D,m as z,n as P,p as A,V as F,P as _,k as b,g as l,w as v,h as n,r as x,e as g,l as u,bf as U,y as R,H,c as k,at as L,f as N,t as q,x as E,z as y,J as T,R as J}from"./index-3194ec9b.js";import{L as O}from"./LayoutHeader-3eb7ac7a.js";import{_ as j}from"./ListViewBuilder.vue_vue_type_script_setup_true_lang-1a82bb67.js";import{_ as I}from"./Avatar.vue_vue_type_script_setup_true_lang-1b98856a.js";import{u as G}from"./pageMeta-9b603434.js";import{F as K}from"./FileUploader-0835fb8b.js";import"./Dropdown-c7dd9c29.js";import"./TabButtons-439c1e4c.js";import"./description-9202ef38.js";import"./TypingIndicator.vue_vue_type_style_index_0_scoped_3f215bd3_lang-a9d0f8af.js";import"./dayjs-f66c5460.js";import"./DateTimePicker-8cacf145.js";import"./useDatePicker-fa7d5592.js";import"./DateRangePicker.vue_vue_type_script_setup_true_lang-7827f28c.js";import"./Link-431cfb69.js";import"./StarRating.vue_vue_type_script_setup_true_lang-0c43ad36.js";import"./NestedPopover-37db8746.js";import"./portal-4ee54923.js";import"./MultipleAvatar.vue_vue_type_script_setup_true_lang-7025dfbf.js";import"./ticketStatus-895288f5.js";import"./EmptyState.vue_vue_type_script_setup_true_lang-946d36ad.js";const Q={class:"space-y-4"},W={class:"space-y-1"},X={class:"space-y-1"},Y={class:"float-right flex space-x-2"},Z=D({__name:"NewCustomerDialog",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:z(["customerCreated"],["update:modelValue"]),setup(C,{emit:m}){const r=m,i=P(C,"modelValue"),o=A({customer:"",domain:""}),s=F({url:"frappe.client.insert",method:"POST",data:{doc:{doctype:"HD Customer",customer_name:o.customer,domain:o.domain}},onSuccess:()=>{o.customer="",o.domain="",_.success("Customer created"),r("customerCreated")},onError:c=>{_.error(c.messages[0])}});function p(){if(!o.customer){_.error("Customer name is required");return}s.submit({doc:{doctype:"HD Customer",customer_name:o.customer,domain:o.domain}})}return(c,t)=>{const e=x("Button");return g(),b("div",null,[l(n(H),{modelValue:i.value,"onUpdate:modelValue":t[2]||(t[2]=a=>i.value=a),options:{title:"Add New Customer",size:"sm"}},{"body-content":v(()=>[u("div",Q,[u("div",W,[l(n(U),{modelValue:o.customer,"onUpdate:modelValue":t[0]||(t[0]=a=>o.customer=a),label:"Customer Name",type:"text",placeholder:"Tesla Inc."},null,8,["modelValue"])]),u("div",X,[l(n(U),{modelValue:o.domain,"onUpdate:modelValue":t[1]||(t[1]=a=>o.domain=a),label:"Domain",type:"text",placeholder:"eg: tesla.com, mycompany.com"},null,8,["modelValue"])]),u("div",Y,[l(e,{label:"Add",theme:"gray",variant:"solid",onClick:R(p,["prevent"])})])])]),_:1},8,["modelValue"])])}}}),ee={class:"flex flex-col items-center gap-4 p-6"},oe={class:"text-xl font-medium text-gray-900"},te={class:"flex gap-2"},se=D({__name:"CustomerDialog",props:{name:{type:String,required:!0}},emits:["customer-updated"],setup(C,{emit:m}){const r=C,i=m,o=k({get(){var e;return(e=s.doc)==null?void 0:e.domain},set(e){s.doc.domain=e}}),s=L({doctype:"HD Customer",name:r.name,auto:!0,setValue:{onSuccess(){_.success("Customer updated")},onError(){_.error("Error updating customer")}}}),p=k(()=>{var e;return{title:(e=s.doc)==null?void 0:e.name,actions:[{label:"Save",theme:"gray",variant:"solid",onClick:()=>c()}]}});async function c(){await s.setValue.submit({domain:o.value}),i("customer-updated")}function t(e){s.setValue.submit({image:(e==null?void 0:e.file_url)||null}),i("customer-updated")}return(e,a)=>{const V=x("Button"),d=x("Input");return g(),N(n(H),{options:p.value},{"body-main":v(()=>{var $,h,w,B;return[u("div",ee,[u("div",oe,q(($=n(s).doc)==null?void 0:$.name),1),l(n(I),{size:"lg",label:(h=n(s).doc)==null?void 0:h.name,image:(w=n(s).doc)==null?void 0:w.image,class:"cursor-pointer hover:opacity-80"},null,8,["label","image"]),u("div",te,[l(n(K),{onSuccess:a[0]||(a[0]=f=>t(f))},{default:v(({uploading:f,openFileSelector:M})=>{var S;return[l(V,{label:(S=n(s).doc)!=null&&S.image?"Change photo":"Upload photo",loading:f,onClick:M},null,8,["label","loading","onClick"])]}),_:1}),(B=n(s).doc)!=null&&B.image?(g(),N(V,{key:0,label:"Remove photo",onClick:a[1]||(a[1]=f=>t(null))})):E("",!0)]),u("form",{class:"w-full",onSubmit:R(c,["prevent"])},[l(d,{modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=f=>o.value=f),label:"Domain",placeholder:"example.com"},null,8,["modelValue"])],32)])]}),_:1},8,["options"])}}}),ae={class:"flex flex-col"},le={key:0},we=D({__name:"Customers",setup(C){const m=y(!1),r=y(!1),i=y(null),o=y(null);function s(t){i.value=t,r.value=!0}function p(t=!1){var e;t?r.value=!1:m.value=!1,(e=o.value)==null||e.reload()}const c=k(()=>({doctype:"HD Customer",selectable:!0,showSelectBanner:!0,columnConfig:{name:{prefix:({row:t})=>T(I,{shape:"circle",image:t.image,label:t.name,size:"sm"})}},emptyState:{title:"No Customers Found"}}));return G(()=>({title:"Customers"})),(t,e)=>{const a=J,V=x("Button");return g(),b("div",ae,[l(O,null,{"left-header":v(()=>[...e[5]||(e[5]=[u("div",{class:"text-lg font-medium text-gray-900"},"Customers",-1)])]),"right-header":v(()=>[l(V,{label:"New customer",theme:"gray",variant:"solid",onClick:e[0]||(e[0]=d=>m.value=!m.value)},{prefix:v(()=>[l(a,{class:"h-4 w-4"})]),_:1})]),_:1}),l(j,{ref_key:"listViewRef",ref:o,options:c.value,onRowClick:s,onEmptyStateAction:e[1]||(e[1]=d=>m.value=!0)},null,8,["options"]),l(Z,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=d=>m.value=d),onCustomerCreated:p},null,8,["modelValue"]),r.value?(g(),b("span",le,[l(se,{modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=d=>r.value=d),name:i.value,onCustomerUpdated:e[4]||(e[4]=d=>p(!0))},null,8,["modelValue","name"])])):E("",!0)])}}});export{we as default};
//# sourceMappingURL=Customers-c90b2620.js.map
