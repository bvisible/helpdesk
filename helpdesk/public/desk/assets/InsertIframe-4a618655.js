import{d as O,A as s,c as i,N as S,O as T,e as h,k as b,C as W,D as $,E as B,g as m,w as v,l as c,h as f,d5 as H,aF as z,v as L,y as F,a1 as V,t as D,I as G,am as K}from"./index-b4c863a6.js";import{v as C,A as R,p as _,d as M,c as j,g as q}from"./file-to-base64-e61fad39.js";import"./TypingIndicator.vue_vue_type_style_index_0_scoped_3f215bd3_lang-c8d975a4.js";import"./popper-0aa08b12.js";import"./chevron-left-d60af664.js";import"./chevron-right-cd59273c.js";import"./plus-3c348a65.js";const J={class:"space-y-4"},Q={key:0,class:"text-red-500 text-sm mt-1"},X={key:1,class:"text-ink-green-3 text-sm mt-1"},Y={class:"flex justify-end space-x-2"},ne=O({__name:"InsertIframe",props:{editor:{}},setup(E){const n=E,r=s(!1),a=s(""),o=s(""),I=s(""),k=s("center"),p=s(640),g=s(360),y=s(),l=i(()=>{if(!a.value)return!1;try{if(a.value.trim().startsWith("<iframe")){const e=a.value.match(/src=["']([^"']+)["']/);return e!=null&&e[1]?C(e[1],{allowedDomains:R,HTMLAttributes:{}}):!1}return C(a.value,{allowedDomains:R,HTMLAttributes:{}})}catch{return!1}}),u=i(()=>{if(!a.value)return"";if(a.value.trim().startsWith("<iframe")){const e=a.value.match(/src=["']([^"']+)["']/);return e!=null&&e[1]?_(e[1]):a.value}return _(a.value)}),A=i(()=>{if(!a.value||!l.value)return{platform:"Generic",aspectRatio:9/16};const e=M(u.value),t=j(u.value);return{platform:(e==null?void 0:e.name)||"Generic",aspectRatio:t.ratio}}),N=i(()=>!a.value||!l.value?{width:640,height:360}:q(u.value,800));function P(){o.value="",a.value&&(l.value||(o.value="Please enter a supported URL or iframe embed code"))}function w(){r.value=!0,a.value="",o.value="",I.value="",k.value="center",p.value=640,g.value=360,K(()=>{var e,t;(t=(e=y.value)==null?void 0:e.el)==null||t.focus()})}i(()=>{if(a.value&&l.value){const e=N.value;p.value=e.width,g.value=e.height}});function U(){if(!a.value||!l.value)return;n.editor.commands.setIframe({src:u.value,width:p.value,height:g.value,title:I.value,align:k.value})?(r.value=!1,n.editor.commands.focus()):o.value="Failed to insert embed. Please check the URL and try again."}function x(e){var t;((t=e.detail)==null?void 0:t.editor)===n.editor&&w()}return S(()=>{n.editor.view.dom.addEventListener("iframe:open-dialog",x)}),T(()=>{n.editor.view.dom.removeEventListener("iframe:open-dialog",x)}),(e,t)=>(h(),b("div",null,[W(e.$slots,"default",$(B({onClick:w}))),m(f(G),{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=d=>r.value=d),options:{title:"Insert Embed",size:"md"}},{"body-content":v(()=>[c("div",J,[c("div",null,[t[3]||(t[3]=c("label",{class:"block text-sm font-medium text-ink-gray-7 mb-2"}," URL or Embed Code ",-1)),m(f(H),{ref_key:"urlInput",ref:y,modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=d=>a.value=d),placeholder:"https://youtube.com/watch?v=... or <iframe src=...>",onKeydown:z(U,["enter"]),onInput:P},null,8,["modelValue"]),o.value?(h(),b("p",Q,L(o.value),1)):a.value&&l.value?(h(),b("p",X," âœ“ Valid "+L(A.value.platform)+" URL ",1)):F("",!0)])])]),actions:v(()=>[c("div",Y,[m(f(V),{variant:"subtle",onClick:t[1]||(t[1]=d=>r.value=!1)},{default:v(()=>[...t[4]||(t[4]=[D("Cancel",-1)])]),_:1}),m(f(V),{variant:"solid",disabled:!a.value||!l.value,onClick:U},{default:v(()=>[...t[5]||(t[5]=[D(" Insert Embed ",-1)])]),_:1},8,["disabled"])])]),_:1},8,["modelValue"])]))}});export{ne as default};
//# sourceMappingURL=InsertIframe-4a618655.js.map
