{"version":3,"file":"TicketAgent-27545814.js","sources":["../../../../desk/src/components/icons/CopyIcon.vue","../../../../desk/src/components/icons/ExternalLinkIcon.vue","../../../../desk/src/components/icons/GlobeIcon.vue","../../../../desk/src/components/Icon.vue","../../../../desk/src/components/ticket/TicketMergeModal.vue","../../../../desk/src/types.ts","../../../../desk/src/components/ticket-agent/TicketActivityPanel.vue","../../../../desk/src/composables/useTicketNavigation.ts","../../../../desk/src/components/ticket-agent/TicketNavigation.vue","../../../../desk/src/components/ticket-agent/TicketSLA.vue","../../../../desk/src/components/ticket-agent/TicketSubjectModal.vue","../../../../desk/src/components/ticket-agent/TicketHeader.vue","../../../../desk/src/components/Resizer.vue","../../../../desk/src/components/ticket-agent/TicketContactTab.vue","../../../../desk/src/components/ticket-agent/AssignToBody.vue","../../../../desk/src/components/ticket-agent/AssignTo.vue","../../../../desk/src/components/ticket-agent/TicketContact.vue","../../../../desk/src/components/ticket-agent/TicketDetailsTab.vue","../../../../desk/src/components/ticket-agent/TicketSidebar.vue","../../../../desk/src/composables/useTicket.ts","../../../../desk/src/pages/ticket/TicketAgent.vue"],"sourcesContent":["<template>\n  <svg\n    width=\"16\"\n    height=\"16\"\n    viewBox=\"0 0 16 16\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      fill-rule=\"evenodd\"\n      clip-rule=\"evenodd\"\n      d=\"M13.9996 3.54443V8.771C13.9994 9.32318 13.5518 9.771 12.9996 9.771H12.1802C11.9041 9.771 11.6802 9.99485 11.6802 10.271C11.6803 10.547 11.9042 10.771 12.1802 10.771H12.9996C14.104 10.771 14.9994 9.87546 14.9996 8.771V3.54443C14.9996 2.43986 14.1041 1.54443 12.9996 1.54443H6.72124C5.61667 1.54443 4.72124 2.43986 4.72124 3.54443V4.37158C4.72124 4.64772 4.94509 4.87158 5.22124 4.87158C5.49738 4.87158 5.72124 4.64772 5.72124 4.37158V3.54443C5.72124 2.99215 6.16895 2.54443 6.72124 2.54443H12.9996C13.5518 2.54443 13.9996 2.99215 13.9996 3.54443ZM9.27832 6.22928C9.8306 6.22928 10.2783 6.67699 10.2783 7.22928V12.4558C10.2782 13.008 9.83053 13.4558 9.27832 13.4558H3C2.44779 13.4558 2.00012 13.008 2 12.4558V7.22928C2 6.67699 2.44772 6.22928 3 6.22928H9.27832ZM9.27832 14.4558C10.3828 14.4558 11.2782 13.5603 11.2783 12.4558V7.22928C11.2783 6.12471 10.3829 5.22928 9.27832 5.22928H3C1.89543 5.22928 1 6.12471 1 7.22928V12.4558C1.00012 13.5603 1.89551 14.4558 3 14.4558H9.27832Z\"\n      fill=\"#525252\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    width=\"16\"\n    height=\"17\"\n    viewBox=\"0 0 16 17\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      d=\"M5.66406 2.25C5.94021 2.25 6.16406 2.47386 6.16406 2.75C6.16406 3.02614 5.94021 3.25 5.66406 3.25H4.25C3.42157 3.25 2.75 3.92157 2.75 4.75V12.25L2.75781 12.4033C2.83461 13.1597 3.47334 13.75 4.25 13.75H11.75C12.5784 13.75 13.25 13.0784 13.25 12.25V10.8359C13.25 10.5598 13.4739 10.3359 13.75 10.3359C14.0261 10.3359 14.25 10.5598 14.25 10.8359V12.25C14.25 13.6307 13.1307 14.75 11.75 14.75H4.25C2.95566 14.75 1.89082 13.7664 1.7627 12.5059L1.75 12.25V4.75C1.75 3.36929 2.86929 2.25 4.25 2.25H5.66406ZM13.75 2.25C13.7827 2.25 13.8155 2.25243 13.8477 2.25879C13.8574 2.26071 13.8665 2.2651 13.876 2.26758C13.9592 2.28923 14.0383 2.33126 14.1035 2.39648C14.2012 2.49413 14.25 2.62202 14.25 2.75V7.25C14.25 7.52608 14.0261 7.74994 13.75 7.75C13.4739 7.75 13.25 7.52611 13.25 7.25V3.95703L6.81152 10.3955C6.61626 10.5908 6.29975 10.5908 6.10449 10.3955C5.90923 10.2002 5.90923 9.88374 6.10449 9.68848L12.543 3.25H9.25C8.97388 3.25 8.75003 3.02611 8.75 2.75C8.75 2.47386 8.97386 2.25 9.25 2.25H13.75Z\"\n      fill=\"#525252\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    width=\"16\"\n    height=\"16\"\n    viewBox=\"0 0 16 16\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <g clip-path=\"url(#clip0_11163_86342)\">\n      <path\n        d=\"M8 0.75C12.0041 0.75 15.25 3.99594 15.25 8C15.25 12.0041 12.0041 15.25 8 15.25C3.99594 15.25 0.75 12.0041 0.75 8C0.75 3.99594 3.99594 0.75 8 0.75ZM9.83691 4.24902C9.83246 4.31586 9.82822 4.40482 9.80762 4.49316C9.79115 4.5636 9.76659 4.63202 9.73535 4.69727C9.69606 4.77931 9.64388 4.85125 9.60547 4.90625L9.57715 4.94727C9.53169 5.01237 9.47353 5.10016 9.39648 5.1748C9.33512 5.23421 9.26581 5.2852 9.19141 5.32715C9.09793 5.37982 8.99723 5.41143 8.92188 5.43652L7.01367 6.07227C6.96479 6.08854 6.93927 6.09602 6.92188 6.10254L6.9209 6.10449C6.90952 6.11925 6.89436 6.14042 6.86426 6.18262L6.30859 6.96094C6.25045 7.04245 6.17582 7.15257 6.07422 7.24023C5.99357 7.30979 5.9021 7.36646 5.80371 7.40723C5.67989 7.45842 5.54801 7.47592 5.44922 7.49121L5.38574 7.50098C5.29011 7.51579 5.16346 7.53843 5.03418 7.52832C4.93128 7.52017 4.82895 7.4961 4.7334 7.45703C4.61327 7.40776 4.51037 7.32967 4.43164 7.27344L2.19727 5.67773C1.90962 6.39582 1.75 7.17915 1.75 8C1.75 11.4518 4.54822 14.25 8 14.25C11.4518 14.25 14.25 11.4518 14.25 8C14.25 5.2413 12.4623 2.90124 9.98242 2.07227L9.83691 4.24902ZM7.12207 8.18945C7.27526 7.95989 7.58574 7.89776 7.81543 8.05078L10.6025 9.9082C10.7167 9.98443 10.7942 10.1049 10.8174 10.2402C10.8406 10.3756 10.8069 10.5151 10.7246 10.625L9.33203 12.4824C9.23768 12.6082 9.08888 12.6825 8.93164 12.6826H7.07422C6.83589 12.6826 6.63074 12.514 6.58398 12.2803L6.11914 9.95801C6.09321 9.82809 6.1199 9.69327 6.19336 9.58301L7.12207 8.18945ZM7.13965 9.96484L7.48438 11.6826H8.68164L9.60742 10.4463L7.67676 9.15918L7.13965 9.96484ZM8 1.75C5.72993 1.75 3.74217 2.96003 2.64746 4.77051L5.0127 6.45996C5.06466 6.49708 5.09177 6.51562 5.11133 6.52832L5.1123 6.5293H5.11426C5.13745 6.52677 5.16993 6.52251 5.2334 6.5127L5.2959 6.50293C5.3614 6.49279 5.39526 6.48721 5.41895 6.48242L5.41992 6.48145L5.42188 6.48047C5.4368 6.46146 5.45658 6.43391 5.49512 6.37988L6.0498 5.60156C6.09519 5.53793 6.15408 5.45185 6.23047 5.37891C6.29114 5.32101 6.35945 5.27146 6.43262 5.23047C6.52471 5.17891 6.6241 5.14773 6.69824 5.12305L8.60645 4.4873C8.65567 4.47091 8.68058 4.46266 8.69824 4.45605L8.7002 4.45508L8.70117 4.4541C8.71253 4.43905 8.72714 4.41753 8.75684 4.375L8.78613 4.33398C8.81121 4.29807 8.82337 4.27987 8.83203 4.2666V4.26465L8.83301 4.26367C8.83455 4.24789 8.83595 4.22533 8.83887 4.18164L8.99609 1.83008C8.67167 1.77811 8.33907 1.75 8 1.75Z\"\n        fill=\"#7C7C7C\"\n      />\n    </g>\n    <defs>\n      <clipPath id=\"clip0_11163_86342\">\n        <rect width=\"16\" height=\"16\" fill=\"white\" />\n      </clipPath>\n    </defs>\n  </svg>\n</template>\n","<template>\n  <div v-if=\"isEmoji(icon)\" v-bind=\"$attrs\">\n    {{ icon }}\n  </div>\n  <FeatherIcon\n    v-else-if=\"typeof icon == 'string'\"\n    :name=\"icon\"\n    v-bind=\"$attrs\"\n  />\n  <component v-else :is=\"icon\" v-bind=\"$attrs\" />\n</template>\n<script setup>\nimport { isEmoji } from \"@/utils\";\n\nconst props = defineProps({\n  icon: {\n    type: [String, Object],\n    required: true,\n  },\n});\n</script>\n","<template>\n  <Dialog\n    :options=\"{ title: `Merge with another ticket` }\"\n    v-model=\"showDialog\"\n  >\n    <template #body-content>\n      <div class=\"flex flex-col gap-4\">\n        <p class=\"text-p-base text-ink-gray-8\">\n          All comments and emails of the ticket\n          <span class=\"whitespace-nowrap font-semibold\"\n            >#{{ ticket.name }}</span\n          >\n          will be moved to the selected ticket.\n        </p>\n        <Link\n          class=\"form-control\"\n          doctype=\"HD Ticket\"\n          placeholder=\"Select Ticket\"\n          :filters=\"getDefaultFilters()\"\n          label=\"Ticket\"\n          :page-length=\"10\"\n          :value=\"targetTicket\"\n          :show-description=\"true\"\n          @change=\"targetTicket = String($event)\"\n        />\n        <FormControl\n          v-if=\"targetTicket\"\n          label=\"Ticket Subject\"\n          type=\"text\"\n          v-model=\"subject\"\n          :disabled=\"true\"\n        />\n        <!-- banner -->\n        <div\n          class=\"flex items-center gap-2 rounded-md p-2 ring-1 ring-gray-200\"\n        >\n          <TriangleAlert\n            class=\"h-6 w-5 w-min-5 w-max-5 min-h-5 max-w-5 text-yellow-500\"\n          />\n\n          <div class=\"text-wrap text-sm text-gray-700\">\n            This action is irreversible.\n          </div>\n        </div>\n      </div>\n    </template>\n    <template #actions>\n      <Button\n        class=\"w-full\"\n        variant=\"solid\"\n        :label=\"\n          targetTicket ? `Merge with ticket #${targetTicket} ` : 'Select Ticket'\n        \"\n        :loading=\"mergeTicket.loading\"\n        :icon-left=\"targetTicket && LucideMerge\"\n        @click=\"handleTicketMerge\"\n      />\n    </template>\n  </Dialog>\n</template>\n\n<script setup lang=\"ts\">\nimport { Link } from \"@/components\";\nimport { HDTicket } from \"@/types/doctypes\";\nimport { Dialog, createListResource, createResource, toast } from \"frappe-ui\";\nimport { ref, watch } from \"vue\";\nimport LucideMerge from \"~icons/lucide/merge\";\nimport TriangleAlert from \"~icons/lucide/triangle-alert\";\n// interface P\ninterface Props {\n  ticket: HDTicket;\n}\n\ninterface E {\n  (event: \"update\"): void;\n  //   (event: \"rowClick\", row: any): void;\n}\n\nconst props = defineProps<Props>();\nconst emit = defineEmits<E>();\nconst showDialog = defineModel<boolean>();\n\ninterface Filter {\n  status_category: [string, string[] | string];\n  is_merged: number;\n  name: string[];\n  customer?: any;\n  raised_by?: [string, string[] | string];\n}\n\nfunction getDefaultFilters() {\n  const filters: Filter = {\n    status_category: [\"in\", [\"Open\", \"Paused\"]],\n    is_merged: 0,\n    name: [\"!=\", props.ticket.name],\n  };\n  // if part of an organization show all tickets of the organization\n  if (props.ticket.customer) {\n    filters.customer = props.ticket.customer;\n  }\n  //  show all tickets of the person who raised the ticket\n  if (props.ticket.raised_by) {\n    filters.raised_by = [\"like\", `%${props.ticket.raised_by}%`];\n  }\n  return filters;\n}\n\nconst targetTicket = ref(null);\nconst subject = ref(null);\n\nconst mergeTicket = createResource({\n  url: \"helpdesk.helpdesk.doctype.hd_ticket.api.merge_ticket\",\n  makeParams({ source, target }) {\n    return {\n      source,\n      target,\n    };\n  },\n  validate({ source, target }) {\n    if (!source) throw { message: \"Category is required\" };\n    if (!target) throw { message: \"Ticket to merged with is required\" };\n  },\n  onSuccess: () => {\n    toast.success(\"Ticket merged successfully\");\n    emit(\"update\");\n\n    showDialog.value = false;\n    // open the target Ticket\n    window.open(\n      window.location.origin + \"/helpdesk/tickets/\" + targetTicket.value,\n      \"_blank\"\n    );\n    targetTicket.value = null;\n  },\n});\n\nconst getTicketSubject = createListResource({\n  doctype: \"HD Ticket\",\n  filters: {\n    name: [\"=\", targetTicket],\n  },\n  fields: [\"subject\"],\n  onSuccess: (data: any) => {\n    if (data.length > 0) {\n      subject.value = data[0].subject;\n    }\n  },\n});\n\nwatch(\n  () => targetTicket.value,\n  (newValue) => {\n    if (newValue) {\n      getTicketSubject.update({\n        filters: {\n          name: [\"=\", newValue],\n        },\n      });\n      getTicketSubject.reload();\n    }\n  }\n);\n\nfunction handleTicketMerge() {\n  mergeTicket.submit({\n    source: props.ticket.name,\n    target: targetTicket.value,\n  });\n}\n</script>\n\n<style scoped></style>\n","import { Dayjs } from \"dayjs\";\nimport { Component, ComputedRef, InjectionKey } from \"vue\";\nimport type { HDTicket } from \"./types/doctypes\";\n\nexport interface Resource<T = unknown> {\n  auto: boolean;\n  loading: boolean;\n  data: T;\n  pageLength: number;\n  totalCount: number;\n  hasNextPage: boolean;\n  promise: Promise<void> | null;\n  list: {\n    loading: boolean;\n  };\n  next: () => void;\n  reload: () => void;\n  update: (r: unknown) => void;\n}\n\nexport interface Error {\n  exc_type: string;\n  exc: string;\n  response: string;\n  status: string;\n  messages: string;\n  stack: string;\n  message: string;\n}\n\nexport interface Comment {\n  commented_by: string;\n  content: string;\n  is_pinned: boolean;\n  name: string;\n  creation: string;\n}\n\nexport interface Communication {\n  creation: string;\n  content: string;\n  name: string;\n  sender: string;\n  bcc?: string;\n  cc?: string;\n}\n\nexport interface Activity {\n  action: string;\n  name: string;\n  owner: string;\n  creation: string;\n}\n\nexport interface Contact {\n  full_name: string;\n  name: string;\n  company_name?: string;\n  email_id?: string;\n  image?: string;\n  mobile_no?: string;\n  phone?: string;\n}\n\nexport interface CustomField {\n  fieldname: string;\n  label: string;\n  value: string;\n  route: string;\n}\n\nexport interface ViewLog {\n  name: string;\n  viewed_by: string;\n  creation: string;\n}\n\nexport interface Ticket {\n  _assign: string;\n  assignee: UserInfo;\n  agent_group: string;\n  customer: string;\n  modified: string;\n  name: string;\n  priority: string;\n  raised_by: string;\n  resolution_by: string;\n  response_by: string;\n  first_responded_on: string;\n  resolution_date: string;\n  resolution_time: number;\n  status: string;\n  subject: string;\n  ticket_type: string;\n  via_customer_portal: string;\n  agreement_status: string;\n  creation: string;\n  feedback_rating?: number;\n  feedback_extra?: string;\n  contact: Contact;\n  comments: Comment[];\n  communications: Communication[];\n  history: Activity[];\n  template: Template;\n  views: ViewLog[];\n  _customActions: Function[];\n  is_merged?: boolean;\n  status_category: \"Open\" | \"Paused\" | \"Resolved\";\n}\n\nexport interface DocField {\n  fieldname: string;\n  fieldtype: string;\n  label: string;\n  name: string;\n  options: string;\n}\n\nexport interface Filter {\n  field?: DocField;\n  fieldname: string;\n  operator: string;\n  label: string;\n  value: boolean | number | string;\n}\n\nexport interface AutoCompleteItem {\n  label: string;\n  value: string;\n}\n\nexport interface Field {\n  fieldname: string;\n  fieldtype: string;\n  hide_from_customer?: 0 | 1;\n  label: string;\n  options: string;\n  required: 0 | 1;\n  description?: null;\n  url_method?: string;\n  link_filters?: string;\n  filters?: string;\n  display_via_depends_on?: string;\n  mandatory_via_depends_on?: string;\n  disabled?: boolean;\n  placeholder?: string | null;\n  readonly?: boolean;\n}\n\nexport type FieldValue = string | number | boolean | null | undefined | Dayjs;\n\nexport interface Template {\n  about: string;\n  fields: Field[];\n}\n\nexport type Column = {\n  key: string;\n  label: string;\n  icon?: string;\n  align?: string;\n  width?: string;\n  text?: string;\n};\n\nexport type File = {\n  file_name: string;\n  name: string;\n  file_url: string;\n  is_private: boolean;\n  attached_to_doctype?: string;\n  attached_to_field?: string;\n  attached_to_name?: string;\n};\n\nexport type Notification = {\n  creation: string;\n  name: string;\n  notification_type: string;\n  read: boolean;\n  reference_comment: string;\n  reference_ticket: string;\n  user_from: UserInfo;\n  user_to: UserInfo;\n};\n\nexport type UserInfo = {\n  email: string;\n  image: string;\n  name: string;\n};\n\nexport interface RenderField {\n  label: string;\n  name: string;\n  type: string;\n  placeholder?: string;\n  description?: string;\n}\n\nexport interface EmailService {\n  name: string;\n  icon: string;\n  info: string;\n  link: string;\n  custom: boolean;\n}\n\nexport type EmailStep = \"email-list\" | \"email-add\" | \"email-edit\";\n\nexport interface EmailAccount {\n  email_account_name: string;\n  email_id: string;\n  service: string;\n  api_key?: string;\n  api_secret?: string;\n  password?: string;\n  frappe_mail_site?: string;\n  enable_outgoing?: boolean;\n  enable_incoming?: boolean;\n  default_outgoing?: boolean;\n  default_incoming?: boolean;\n}\n\nexport type TicketTab = \"activity\" | \"email\" | \"comment\" | \"details\" | \"call\";\n\nexport interface TabObject {\n  name: TicketTab;\n  label: string;\n  icon: Component;\n  condition?: () => boolean;\n}\n\nexport interface RootCategory {\n  category_id: string;\n  category_name: string;\n}\n\nexport interface Article {\n  name: string;\n  title: string;\n  category_name: string;\n  category_id: string;\n  published_on: string;\n  author: Author;\n  subtitle: string;\n  article_image: string | null;\n  _user_tags: string | null;\n  status: string;\n  creation: string;\n  content: string;\n  modified: string;\n  feedback: FeedbackAction;\n}\n\nexport type FeedbackAction = 0 | 1 | 2; // 0: neutral, 1: like, 2: dislike\n\nexport interface Author {\n  name: string;\n  image: string | null;\n  email: string;\n}\n\nexport interface Category {\n  categoryName: string;\n  articles: Article[];\n  authors?: {\n    [key: string]: Author;\n  };\n  children?: Article[];\n}\n\nexport interface View {\n  filters: string;\n  order_by: string;\n  columns: string;\n  rows: string;\n  dt?: string;\n  type?: string;\n  route_name?: string;\n  user?: string;\n  icon?: string;\n  label?: string;\n  is_default?: boolean;\n  pinned?: boolean;\n  public?: boolean;\n  group_by_field?: string;\n  name?: string;\n  is_customer_portal?: boolean;\n}\n\nexport interface ViewType {\n  view_type: string;\n  group_by_field: string;\n  name: string;\n}\n\nexport interface Breadcrumb {\n  label: string;\n  route?: {\n    name: string;\n    params?: Record<string, string>;\n  };\n}\n\n// Activity Types\ninterface BaseActivity {\n  type: string;\n  key: string;\n  creation: string;\n  content: string;\n}\n\ninterface HistoryActivity extends BaseActivity {\n  type: \"history\";\n  user: string;\n  relatedActivities: HistoryActivity[];\n}\n\nexport interface EmailActivity extends BaseActivity {\n  type: \"email\";\n  attachments: FileAttachment;\n  bcc: string;\n  cc: string;\n  name: string;\n  sender: { full_name: string; name: string };\n  subject: string;\n  to: string;\n  isFirstEmail: boolean;\n}\n\nexport interface CommentActivity extends BaseActivity {\n  type: \"comment\";\n  name: string;\n  commenter: string;\n  commentedBy: string;\n  attachments: FileAttachment[];\n}\n\nexport interface CallActivity extends BaseActivity {\n  type: \"call\";\n  name: string;\n  caller: string;\n  calledBy: string;\n  attachments: FileAttachment[];\n  call_type: \"Incoming\" | \"Outgoing\";\n}\n\nexport interface FeedbackActivity {\n  type: \"feedback\";\n  feedback_rating: number;\n  feedback: string; // option seletor\n  feedback_extra?: string; // free flow text\n  sender: { name: string; full_name: string };\n  key: string;\n}\n\nexport type TicketActivity =\n  | HistoryActivity\n  | EmailActivity\n  | CommentActivity\n  | CallActivity\n  | FeedbackActivity;\n\ninterface FileAttachment {\n  name: string;\n  file_name: string;\n  file_url: string;\n}\n\nexport interface FieldCriteriaState {\n  selectedParentField: string;\n  selectedChildField: string;\n  childFields: any[];\n  parentFieldValues: any[];\n  childFieldValues: any[];\n  currentParentSelection: string;\n  childSelections: any;\n  initialChildSelections: any;\n  parentSearch: string;\n  childSearch: string;\n  enabled: boolean;\n}\n\ninterface ResourceBase {\n  data: any;\n  error: any;\n  fetched: boolean;\n  loading: boolean;\n  params: any;\n  previousData: any;\n  promise: Promise<any> | null;\n  submit: (params?: any) => void;\n}\n\ninterface DocumentResourceOptions<T = unknown> {\n  doctype: string;\n  name: string;\n  auto?: boolean;\n  whitelistedMethods?: Record<string, string>;\n  onError?: (error: any) => void;\n  onSuccess?: (data: T) => void;\n  transform?: (doc: T) => T;\n  delete?: {\n    onSuccess?: () => void;\n    onError?: (error: any) => void;\n  };\n  setValue?: {\n    onSuccess?: () => void;\n    onError?: (error: any) => void;\n  };\n}\n\nexport interface DocumentResource<T = unknown> {\n  // Configuration\n  auto: boolean;\n  doctype: string;\n  name: string;\n  isDirty: boolean;\n  promise: Promise<void> | null;\n\n  // Main document data\n  doc: T;\n  originalDoc: T;\n\n  // Core methods\n  reload(): void;\n  update(options: Partial<DocumentResourceOptions<T>>): void;\n\n  // Sub-resources\n  get: ResourceBase & {\n    data: T;\n    params: {\n      doctype: string;\n      name: string;\n    };\n  };\n\n  setValue: ResourceBase & {\n    submit: (\n      values: Partial<T>,\n      options?: { onSuccess?: () => void; onError?: (error: any) => void }\n    ) => void;\n  };\n\n  setValueDebounced: ResourceBase & {\n    submit: (values: Partial<T>) => void;\n  };\n\n  save: ResourceBase;\n  delete: ResourceBase;\n\n  // Dynamic whitelisted methods\n  [methodName: string]: any;\n}\n\nexport interface Customizations {\n  custom_fields: {\n    fieldname: string;\n    required: number;\n    placeholder: string;\n    url_method: string;\n  }[];\n  _form_script: string[];\n  _customActions?: any;\n  _customOnChange?: any;\n}\n\nexport interface TicketContact {\n  name: string;\n  email_id: string;\n  phone: string;\n  mobile_no: string;\n  image: string;\n}\n\nexport type RecentTicket = Record<\n  \"subject\" | \"status\" | \"priority\" | \"name\",\n  string | number\n>;\nexport type SimilarTicket = Record<\n  \"subject\" | \"status\" | \"priority\" | \"name\",\n  string | number\n>;\nexport interface RecentSimilarTicket {\n  recent_tickets: RecentTicket[];\n  similar_tickets: SimilarTicket[];\n}\n\nexport interface TicketActivities {\n  comments: Comment[];\n  communications: Communication[];\n  history: Activity[];\n  views: ViewLog[];\n}\n\n// symbols\nexport const TicketSymbol: InjectionKey<\n  ComputedRef<DocumentResource<HDTicket>>\n> = Symbol(\"ticket\");\nexport const AssigneeSymbol: InjectionKey<\n  ComputedRef<Resource<Record<\"name\", string>[]>>\n> = Symbol(\"assignees\");\n\nexport const CustomizationSymbol: InjectionKey<\n  ComputedRef<Resource<Customizations>>\n> = Symbol(\"customizations\");\n\nexport const TicketContactSymbol: InjectionKey<\n  ComputedRef<Resource<TicketContact>>\n> = Symbol(\"ticketContact\");\n\nexport const RecentSimilarTicketsSymbol: InjectionKey<\n  ComputedRef<Resource<RecentSimilarTicket>>\n> = Symbol(\"recentSimilarTickets\");\n\nexport const ActivitiesSymbol: InjectionKey<\n  ComputedRef<Resource<TicketActivities>>\n> = Symbol(\"activities\");\n\ndeclare global {\n  interface Window {\n    is_fc_site: boolean;\n    date_format: string;\n    time_format: string;\n    session_user: string;\n  }\n}\n","<template>\n  <Tabs :modelValue=\"tabIndex\" :tabs=\"tabs\" @update:modelValue=\"changeTabTo\">\n    <TabList />\n    <TabPanel v-slot=\"{ tab }\" class=\"flex-1\">\n      <TicketAgentActivities\n        v-if=\"Boolean(activities.data)\"\n        ref=\"ticketAgentActivitiesRef\"\n        :activities=\"filterActivities(tab.name as TicketTab)\"\n        :title=\"tab.label\"\n        :ticket-status=\"ticket.doc.status\"\n        @email:reply=\"\n          (e) => {\n            communicationAreaRef.replyToEmail(e);\n          }\n        \"\n        @update=\"\n          () => {\n            activities.reload();\n            ticketAgentActivitiesRef.scrollToLatestActivity();\n          }\n        \"\n      />\n      <div v-else class=\"flex items-center justify-center flex-col mt-20\">\n        <LoadingIndicator :scale=\"8\" class=\"text-ink-gray-5\" />\n        <p class=\"text-xl font-medium text-ink-gray-5 absolute top-[50%]\">\n          Loading...\n        </p>\n      </div>\n    </TabPanel>\n  </Tabs>\n  <!-- Comm Area -->\n  <CommunicationArea\n    ref=\"communicationAreaRef\"\n    :ticketId=\"String(ticket.doc?.name)\"\n    :to-emails=\"[ticket.doc?.raised_by]\"\n    :cc-emails=\"[]\"\n    :bcc-emails=\"[]\"\n    :key=\"ticket.doc?.name\"\n    @update=\"\n      () => {\n        activities.reload();\n        ticketAgentActivitiesRef.scrollToLatestActivity();\n      }\n    \"\n  />\n</template>\n\n<script setup lang=\"ts\">\nimport { CommunicationArea } from \"@/components\";\nimport {\n  ActivityIcon,\n  CommentIcon,\n  EmailIcon,\n  PhoneIcon,\n} from \"@/components/icons\";\nimport { useActiveTabManager } from \"@/composables/useActiveTabManager\";\nimport { useTelephonyStore } from \"@/stores/telephony\";\nimport {\n  ActivitiesSymbol,\n  FeedbackActivity,\n  TabObject,\n  TicketSymbol,\n  TicketTab,\n} from \"@/types\";\nimport { LoadingIndicator, TabList, TabPanel, Tabs } from \"frappe-ui\";\nimport { storeToRefs } from \"pinia\";\nimport { computed, ComputedRef, inject, ref } from \"vue\";\nimport TicketAgentActivities from \"../ticket/TicketAgentActivities.vue\";\n\nconst ticket = inject(TicketSymbol);\nconst activities = inject(ActivitiesSymbol);\n\nconst ticketAgentActivitiesRef = ref(null);\nconst communicationAreaRef = ref(null);\nconst telephonyStore = useTelephonyStore();\nconst { isCallingEnabled } = storeToRefs(telephonyStore);\n\nconst tabs: ComputedRef<TabObject[]> = computed(() => {\n  const _tabs: TabObject[] = [\n    {\n      name: \"activity\",\n      label: \"Activity\",\n      icon: ActivityIcon,\n    },\n    {\n      name: \"email\",\n      label: \"Emails\",\n      icon: EmailIcon,\n    },\n    {\n      name: \"comment\",\n      label: \"Comments\",\n      icon: CommentIcon,\n    },\n  ];\n\n  if (isCallingEnabled.value) {\n    _tabs.push({\n      name: \"call\",\n      label: \"Calls\",\n      icon: PhoneIcon,\n    });\n  }\n  return _tabs;\n});\n\nconst { tabIndex, changeTabTo } = useActiveTabManager(tabs);\n\n// TODO: refactor for pagination\n// can be done once we sort out the backend\nconst _activities = computed(() => {\n  if (!activities.value?.data) {\n    return [];\n  }\n\n  const emailProps = activities.value?.data?.communications.map(\n    (email, idx: number) => {\n      return {\n        subject: email.subject,\n        content: email.content,\n        sender: { name: email.user.email, full_name: email.user.name },\n        to: email.recipients,\n        type: \"email\",\n        key: email.creation,\n        cc: email.cc,\n        bcc: email.bcc,\n        creation: email.communication_date || email.creation,\n        attachments: email.attachments,\n        name: email.name,\n        deliveryStatus: email.delivery_status,\n        isFirstEmail: idx === 0,\n      };\n    }\n  );\n\n  const commentProps = activities.value.data.comments.map((comment) => {\n    return {\n      name: comment.name,\n      type: \"comment\",\n      key: comment.creation,\n      commentedBy: comment.commented_by,\n      commenter: comment.user.name,\n      creation: comment.creation,\n      content: comment.content,\n      attachments: comment.attachments,\n    };\n  });\n\n  const historyProps = [\n    ...activities.value.data.history,\n    ...activities.value.data.views,\n  ].map((h) => {\n    return {\n      type: \"history\",\n      key: h.creation,\n      content: h.action ? h.action : \"viewed this\",\n      creation: h.creation,\n      user: h.user.name + \" \",\n    };\n  });\n\n  const callProps = activities.value.data.calls.map((call) => {\n    return {\n      ...call,\n      type: \"call\",\n      name: call.name,\n      key: call.creation,\n      call_type: call.type,\n      content: `${call.caller || \"Unknown\"} made a call to ${\n        call.receiver || \"Unknown\"\n      }`,\n      duration: call.duration ? call.duration + \"s\" : \"0s\",\n    };\n  });\n\n  const sorted = [\n    ...emailProps,\n    ...commentProps,\n    ...historyProps,\n    ...callProps,\n  ].sort((a, b) => new Date(a.creation) - new Date(b.creation));\n  const data = [];\n  let i = 0;\n\n  while (i < sorted.length) {\n    const currentActivity = sorted[i];\n\n    if (currentActivity.type === \"history\") {\n      currentActivity.relatedActivities = [currentActivity];\n      for (let j = i + 1; j < sorted.length + 1; j++) {\n        const nextActivity = sorted[j];\n\n        if (\n          nextActivity &&\n          nextActivity.user === currentActivity.user &&\n          nextActivity.content !== \"viewed this\" &&\n          !nextActivity.content.includes(\"assigned\") &&\n          !nextActivity.content.includes(\"unassigned\")\n        ) {\n          currentActivity.relatedActivities.push(nextActivity);\n        } else {\n          data.push(currentActivity);\n          i = j - 1;\n          break;\n        }\n      }\n    } else {\n      data.push(currentActivity);\n    }\n    i++;\n  }\n  // add feedback data at the last always\n  // name is email\n  // full_name is name\n\n  if (ticket.value.doc.feedback_rating === 0) {\n    return data;\n  }\n  let feedbackActivity: FeedbackActivity[] = [\n    {\n      type: \"feedback\",\n      key: \"feedback-activity\",\n      feedback_rating: ticket.value?.doc.feedback_rating,\n      feedback_extra: ticket.value?.doc.feedback_extra,\n      feedback: ticket.value?.doc.feedback,\n      sender: {\n        name: ticket.value?.doc.raised_by,\n        full_name: ticket.value?.doc.contact,\n      },\n    },\n  ];\n  data.push(...feedbackActivity);\n\n  return data;\n});\n\nfunction filterActivities(eventType: TicketTab) {\n  if (eventType === \"activity\") {\n    return _activities.value;\n  }\n  return _activities.value.filter((activity) => activity.type === eventType);\n}\n</script>\n\n<style scoped></style>\n","import { createResource } from \"frappe-ui\";\nimport { ref } from \"vue\";\nimport { useRoute, useRouter } from \"vue-router\";\n\nexport const currentTicketIndex = ref(0);\n\nexport const ticketsToNavigate = createResource({\n  url: \"helpdesk.helpdesk.doctype.hd_ticket.api.get_navigation_tickets\",\n  cache: [\"ticketsToNavigate\"],\n});\n\nexport function useTicketNavigation() {\n  const router = useRouter();\n  const route = useRoute();\n\n  function goToNextTicket() {\n    if (currentTicketIndex.value < ticketsToNavigate.data.length - 1) {\n      currentTicketIndex.value += 1;\n      const nextTicketId = ticketsToNavigate.data[currentTicketIndex.value];\n      navigateToTicket(nextTicketId);\n      return nextTicketId;\n    }\n    return null;\n  }\n\n  function goToPreviousTicket() {\n    if (currentTicketIndex.value > 0) {\n      currentTicketIndex.value -= 1;\n      const prevTicketId = ticketsToNavigate.data[currentTicketIndex.value];\n      navigateToTicket(prevTicketId);\n      return prevTicketId;\n    }\n    return null;\n  }\n\n  function getCurrentTicket() {\n    return ticketsToNavigate.data[currentTicketIndex.value];\n  }\n\n  function getNextTicket() {\n    if (!ticketsToNavigate.data) return null;\n    if (currentTicketIndex.value < ticketsToNavigate.data.length - 1) {\n      return ticketsToNavigate.data[currentTicketIndex.value + 1];\n    }\n    return null;\n  }\n\n  function getPreviousTicket() {\n    if (!ticketsToNavigate.data) return null;\n    if (currentTicketIndex.value > 0) {\n      return ticketsToNavigate.data[currentTicketIndex.value - 1];\n    }\n    return null;\n  }\n\n  function navigateToTicket(ticketId: string) {\n    let view = route.query.view as string;\n    let routeToNavigate: any = {\n      name: \"TicketAgent\",\n      params: { ticketId },\n      hash: \"\",\n    };\n    if (view) {\n      routeToNavigate[\"query\"] = { view };\n    }\n    router.push(routeToNavigate);\n  }\n\n  // Remove the watcher that was causing conflicts\n\n  return {\n    currentTicketIndex,\n    ticketsToNavigate,\n    goToNextTicket,\n    goToPreviousTicket,\n    getCurrentTicket,\n    getNextTicket,\n    getPreviousTicket,\n    navigateToTicket,\n  };\n}\n","<template>\n  <div class=\"flex gap-1\">\n    <Tooltip\n      :text=\"\n        getPreviousTicket()\n          ? `Go to previous ticket: #${getPreviousTicket()}`\n          : 'No previous ticket'\n      \"\n      :disabled=\"disableLeftCondition\"\n    >\n      <Button\n        :icon=\"LucideChevronLeft\"\n        variant=\"ghost\"\n        :disabled=\"disableLeftCondition\"\n        @click=\"goToPreviousTicket()\"\n      />\n    </Tooltip>\n    <Tooltip\n      :text=\"\n        getNextTicket()\n          ? `Go to next ticket: #${getNextTicket()}`\n          : 'No next ticket'\n      \"\n      :disabled=\"disableRightCondition\"\n    >\n      <Button\n        :icon=\"LucideChevronRight\"\n        variant=\"ghost\"\n        :disabled=\"disableRightCondition\"\n        @click=\"goToNextTicket()\"\n      />\n    </Tooltip>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { useShortcut } from \"@/composables/shortcuts\";\nimport {\n  ticketsToNavigate,\n  useTicketNavigation,\n} from \"@/composables/useTicketNavigation\";\nimport { computed, onMounted, ref } from \"vue\";\nimport LucideChevronLeft from \"~icons/lucide/chevron-left\";\nimport LucideChevronRight from \"~icons/lucide/chevron-right\";\n\nconst {\n  currentTicketIndex,\n  goToNextTicket,\n  goToPreviousTicket,\n  getNextTicket,\n  getPreviousTicket,\n} = useTicketNavigation();\n\nconst leftArrowRef = ref(null);\nconst rightArrowRef = ref(null);\n\nconst disableLeftCondition = computed(() => {\n  if (ticketsToNavigate.loading || !ticketsToNavigate.data?.length) return true;\n\n  return currentTicketIndex.value == 0;\n});\n\nconst disableRightCondition = computed(() => {\n  if (ticketsToNavigate.loading || !ticketsToNavigate.data?.length) return true;\n  if (ticketsToNavigate.data.length <= 1) return true;\n  return currentTicketIndex.value >= ticketsToNavigate.data.length - 1;\n});\n\nonMounted(() => {\n  // Register shortcuts and store cleanup functions\n  useShortcut({ key: \">\", shift: true }, () => {\n    if (!disableRightCondition.value) {\n      goToNextTicket();\n    }\n  });\n\n  useShortcut({ key: \"<\", shift: true }, () => {\n    if (!disableLeftCondition.value) {\n      goToPreviousTicket();\n    }\n  });\n});\n</script>\n","<template>\n  <!-- Teleport to App Header -->\n  <teleport to=\"#app-header\">\n    <div\n      class=\"flex items-center mx-5 md:mr-0 text-p-sm gap-3 text-[14px] mb-[13px]\"\n    >\n      <!-- Source -->\n      <div class=\"flex items-center gap-1\">\n        <p\n          @click=\"\n            copyToClipboard(\n              ticket.doc.name,\n              `Ticket #${ticket.doc.name} copied to clipboard`\n            )\n          \"\n          class=\"cursor-copy\"\n        >\n          #{{ ticket.doc.name }}\n        </p>\n        <!-- Via Email -->\n        <div\n          v-if=\"!ticket.doc.via_customer_portal\"\n          class=\"text-ink-gray-4 flex items-center\"\n        >\n          <span class=\"text-ink-gray-4 mr-[6px]\">via</span>\n          <EmailIcon class=\"size-4 inline-block mr-1\" />\n          <span class=\"\">Email</span>\n        </div>\n        <!-- Via Portal -->\n        <div v-else class=\"text-ink-gray-4 flex items-center\">\n          <span class=\"text-ink-gray-4 mr-[6px]\">via</span>\n          <GlobeIcon class=\"size-4 inline-block mr-1\" />\n          <span class=\"font-medium\">Portal</span>\n        </div>\n      </div>\n      <!-- divider -->\n      <div class=\"border-l border-outline-gray-2 h-[13px]\" />\n      <!-- First Response -->\n      <div class=\"flex items-center gap-1\">\n        <span>First Response</span>\n        <Badge\n          :label=\"firstResponse.label\"\n          variant=\"subtle\"\n          :theme=\"firstResponse.color\"\n        />\n      </div>\n      <!-- divider -->\n      <div class=\"border-l border-outline-gray-2 h-[13px]\" />\n      <!-- Resolution by -->\n      <div class=\"flex items-center gap-1\">\n        <span>Resolution </span>\n        <Badge\n          v-if=\"resolutionBy\"\n          :label=\"resolutionBy.label\"\n          variant=\"subtle\"\n          :theme=\"resolutionBy.color !== 'purple' && resolutionBy.color\"\n          :class=\"\n            resolutionBy.color === 'purple' && '!text-[#6B46C1] !bg-[#F3E8FF]'\n          \"\n        />\n      </div>\n    </div>\n  </teleport>\n</template>\n\n<script setup lang=\"ts\">\nimport { useShortcut } from \"@/composables/shortcuts\";\nimport { TicketSymbol } from \"@/types\";\nimport { copyToClipboard } from \"@/utils\";\nimport { dayjs } from \"frappe-ui\";\nimport Badge from \"frappe-ui/src/components/Badge/Badge.vue\";\nimport { computed, inject } from \"vue\";\n\nconst ticket = inject(TicketSymbol);\n\nconst firstResponse = computed(() => {\n  if (ticket.value?.get?.loading) return { label: \"\", color: \"\" };\n  if (\n    !ticket.value.doc.first_responded_on &&\n    dayjs().isBefore(dayjs(ticket.value.doc.response_by))\n  ) {\n    let responseBy = formatTimeShort(ticket.value.doc.response_by);\n    return {\n      label: `Due in ${responseBy}`,\n      color: \"orange\",\n    };\n  } else if (\n    dayjs(ticket.value.doc.first_responded_on).isBefore(\n      dayjs(ticket.value.doc.response_by)\n    )\n  ) {\n    let responseBy = formatTimeShort(\n      ticket.value.doc.first_responded_on,\n      ticket.value.doc.creation\n    );\n    return {\n      label: `Fulfilled in ${responseBy}`,\n      color: \"green\",\n    };\n  } else {\n    let responseBy = formatTimeShort(\n      String(new Date()),\n      ticket.value.doc.response_by\n    );\n    return {\n      label: `Failed by ${responseBy}`,\n      color: \"red\",\n    };\n  }\n});\n\nconst resolutionBy = computed(() => {\n  if (ticket.value?.get?.loading) return { label: \"\", color: \"\" };\n\n  if (\n    ticket.value.doc?.status_category === \"Paused\" &&\n    ticket.value.doc?.on_hold_since &&\n    dayjs(ticket.value.doc?.resolution_by).isAfter(\n      dayjs(ticket.value.doc?.on_hold_since)\n    )\n  ) {\n    return {\n      label: `On Hold`,\n      color: \"blue\",\n    };\n  } else if (\n    !ticket.value.doc?.resolution_date &&\n    dayjs().isBefore(dayjs(ticket.value.doc?.resolution_by))\n  ) {\n    let resolutionBy = formatTimeShort(ticket.value.doc?.resolution_by);\n    return {\n      label: `Due in ${resolutionBy}`,\n      color: \"purple\",\n    };\n  } else if (\n    dayjs(ticket.value.doc?.resolution_date).isBefore(\n      dayjs(ticket.value.doc?.resolution_by)\n    )\n  ) {\n    let resolutionBy = formatTimeShort(\n      ticket.value.doc?.resolution_date,\n      ticket.value.doc?.creation\n    );\n    return {\n      label: `Fulfilled in ${resolutionBy}`,\n      color: \"green\",\n    };\n  } else {\n    let resolutionBy = formatTimeShort(\n      String(new Date()),\n      ticket.value.doc?.resolution_by\n    );\n    return {\n      label: `Failed by ${resolutionBy}`,\n      color: \"red\",\n    };\n  }\n});\n\nfunction formatTimeShort(date: string, end?: string): string {\n  if (!end) {\n    end = dayjs().toString();\n  }\n  let _date = dayjs(date);\n  let duration = dayjs.duration(_date.diff(dayjs(end)));\n\n  let days = duration.days();\n  let hours = duration.hours();\n  let minutes = duration.minutes();\n\n  if (days > 0) {\n    return `${days}d ${hours}h`;\n  } else if (hours > 0) {\n    return `${hours}h ${minutes}m`;\n  } else {\n    return `${minutes}m`;\n  }\n}\n\nuseShortcut({ meta: true, shift: true, key: \".\" }, () => {\n  copyToClipboard(window.location.href, `Ticket URL copied to clipboard`);\n});\n\nuseShortcut({ meta: true, key: \".\" }, () => {\n  copyToClipboard(\n    ticket.value.doc.name,\n    `Ticket #${ticket.value.doc.name} copied to clipboard`\n  );\n});\n</script>\n","<template>\n  <Dialog v-model=\"showSubjectDialog\" :options=\"{ title: 'Rename Subject' }\">\n    <template #body-content>\n      <div class=\"flex flex-col flex-1 gap-3\">\n        <FormControl\n          v-model=\"renameSubject\"\n          type=\"textarea\"\n          size=\"sm\"\n          variant=\"subtle\"\n          :disabled=\"false\"\n        />\n        <Button\n          variant=\"solid\"\n          :loading=\"isLoading\"\n          label=\"Rename\"\n          @click=\"handleRename\"\n        />\n      </div>\n    </template>\n  </Dialog>\n</template>\n\n<script setup lang=\"ts\">\nimport { TicketSymbol } from \"@/types\";\nimport { inject, ref } from \"vue\";\n\nconst ticket = inject(TicketSymbol);\nconst showSubjectDialog = defineModel();\nconst renameSubject = ref(ticket.value?.doc?.subject || \"\");\nconst isLoading = ref(false);\n\nfunction handleRename() {\n  isLoading.value = true;\n  ticket.value.setValue.submit(\n    {\n      subject: renameSubject.value,\n    },\n    {\n      onSuccess() {\n        isLoading.value = false;\n        showSubjectDialog.value = false;\n      },\n    }\n  );\n}\n</script>\n\n<style scoped></style>\n","<template>\n  <LayoutHeader>\n    <template #left-header>\n      <div class=\"flex flex-col truncate\">\n        <Breadcrumbs :items=\"breadcrumbs\" class=\"breadcrumbs\">\n          <template #prefix=\"{ item }\">\n            <Icon\n              v-if=\"item.icon\"\n              :icon=\"item.icon\"\n              class=\"mr-1 h-4 flex items-center justify-center self-center\"\n            />\n          </template>\n        </Breadcrumbs>\n        <TicketSLA />\n      </div>\n    </template>\n    <template #right-header>\n      <div class=\"flex gap-2 items-center\">\n        <MultipleAvatar\n          :avatars=\"JSON.stringify(viewers)\"\n          size=\"md\"\n          :hide-name=\"true\"\n        />\n        <!-- Navigation -->\n        <TicketNavigation :key=\"ticket.name\" />\n        <!-- Custom Actions -->\n        <div v-if=\"normalActions.length\" class=\"flex gap-2\">\n          <Button\n            v-for=\"action in normalActions\"\n            :key=\"action.label\"\n            :label=\"action.label\"\n            @click=\"action.onClick()\"\n          >\n            <template v-if=\"action.icon\" #prefix>\n              <FeatherIcon :name=\"action.icon\" class=\"h-4 w-4\" />\n            </template>\n          </Button>\n        </div>\n        <div v-if=\"groupedWithLabelActions.length\">\n          <div v-for=\"g in groupedWithLabelActions\" :key=\"g.label\">\n            <Dropdown v-slot=\"{ open }\" :options=\"g.action\">\n              <Button :label=\"g.label\">\n                <template #suffix>\n                  <FeatherIcon\n                    :name=\"open ? 'chevron-up' : 'chevron-down'\"\n                    class=\"h-4\"\n                  />\n                </template>\n              </Button>\n            </Dropdown>\n          </div>\n        </div>\n        <!-- Status -->\n        <Dropdown :options=\"statusDropdown\" placement=\"right\">\n          <template #default=\"{ open }\">\n            <Button :label=\"ticket.doc.status\" ref=\"statusRef\">\n              <template #prefix>\n                <IndicatorIcon\n                  :class=\"\n                    ticketStatusStore.getStatus(ticket.doc.status)?.parsed_color\n                  \"\n                />\n              </template>\n            </Button>\n          </template>\n        </Dropdown>\n        <!-- Core Actions + Custom Actions -->\n        <Dropdown\n          v-if=\"groupedActions.length\"\n          :options=\"groupedActions\"\n          placement=\"right\"\n        >\n          <Button icon=\"more-horizontal\" />\n        </Dropdown>\n      </div>\n    </template>\n  </LayoutHeader>\n  <TicketMergeModal\n    :ticket=\"ticket.doc\"\n    v-if=\"showMergeModal\"\n    v-model=\"showMergeModal\"\n    @update=\"ticket.reload()\"\n  />\n  <TicketSubjectModal v-if=\"showSubjectDialog\" v-model=\"showSubjectDialog\" />\n</template>\n\n<script setup lang=\"ts\">\nimport { MultipleAvatar } from \"@/components\";\nimport LayoutHeader from \"@/components/LayoutHeader.vue\";\nimport TicketMergeModal from \"@/components/ticket/TicketMergeModal.vue\";\nimport { setupCustomizations } from \"@/composables/formCustomisation\";\nimport { useNotifyTicketUpdate } from \"@/composables/realtime\";\nimport { useShortcut } from \"@/composables/shortcuts\";\nimport { useView } from \"@/composables/useView\";\nimport { globalStore } from \"@/stores/globalStore\";\nimport { useTicketStatusStore } from \"@/stores/ticketStatus\";\nimport {\n  ActivitiesSymbol,\n  CustomizationSymbol,\n  TicketSymbol,\n  View,\n} from \"@/types\";\nimport { HDTicketStatus } from \"@/types/doctypes\";\nimport { getIcon } from \"@/utils\";\nimport { Breadcrumbs, call, Dropdown, toast } from \"frappe-ui\";\nimport {\n  computed,\n  ComputedRef,\n  h,\n  inject,\n  onMounted,\n  PropType,\n  ref,\n  useTemplateRef,\n  watchEffect,\n} from \"vue\";\nimport { useRoute, useRouter } from \"vue-router\";\nimport LucideMerge from \"~icons/lucide/merge\";\nimport { IndicatorIcon } from \"../icons\";\nimport TicketNavigation from \"./TicketNavigation.vue\";\nimport TicketSLA from \"./TicketSLA.vue\";\nimport TicketSubjectModal from \"./TicketSubjectModal.vue\";\n\ndefineProps({\n  viewers: {\n    type: Array as PropType<string[]>,\n    required: true,\n  },\n});\n\nconst route = useRoute();\nconst router = useRouter();\nconst { findView } = useView(\"HD Ticket\");\nconst ticketStatusStore = useTicketStatusStore();\n\nconst ticket = inject(TicketSymbol);\nconst customizations = inject(CustomizationSymbol);\nconst activities = inject(ActivitiesSymbol);\n\nconst showSubjectDialog = ref(false);\n\nconst { notifyTicketUpdate } = useNotifyTicketUpdate(ticket.value?.name);\nconst statusDropdown = computed(() => {\n  const statuses =\n    ticketStatusStore.statuses.data?.filter((s) => s.enabled) || [];\n  return statuses.map((o: HDTicketStatus) => ({\n    label: o.label_agent,\n    value: o.label_agent,\n    onClick: () => {\n      notifyTicketUpdate(\"Status\", o.label_agent);\n      if (ticket.value.doc.status === o.label_agent) return;\n      ticket.value.setValue.submit(\n        { status: o.label_agent },\n        {\n          onSuccess() {\n            activities.value.reload();\n          },\n        }\n      );\n    },\n    icon: () =>\n      h(IndicatorIcon, {\n        class: o.parsed_color,\n      }),\n  }));\n});\nconst breadcrumbs = computed(() => {\n  let items = [{ label: \"Tickets\", route: { name: \"TicketsAgent\" } }];\n  if (route.query.view) {\n    const currView: ComputedRef<View> = findView(route.query.view as string);\n    if (currView) {\n      items.push({\n        label: currView.value?.label,\n        icon: getIcon(currView.value?.icon),\n        route: { name: \"TicketsAgent\", query: { view: currView.value?.name } },\n      });\n    }\n  }\n  items.push({\n    label: ticket.value.doc?.subject,\n    onClick: () => {\n      showSubjectDialog.value = true;\n    },\n  });\n  return items;\n});\n\nfunction updateField(fieldname: string, value: string, callback = () => {}) {\n  const doc = ticket.value;\n  doc.setValue.submit({\n    [fieldname]: value,\n  });\n  callback();\n}\n\nconst showMergeModal = ref(false);\nconst showMergeOption = computed(() => {\n  return (\n    !ticket.value.doc.is_merged &&\n    [\"Open\", \"Paused\"].includes(ticket.value.doc.status_category)\n  );\n});\nconst defaultActions = computed(() => {\n  let items = [];\n\n  if (showMergeOption.value) {\n    items.push({\n      label: \"Merge Ticket\",\n      icon: LucideMerge,\n      condition: () => !ticket.value.doc.is_merged,\n      onClick: () => (showMergeModal.value = true),\n    });\n  }\n  return [\n    {\n      group: \"Default actions\",\n      hideLabel: true,\n      items,\n    },\n  ];\n});\nconst actions = ref([]);\nconst normalActions = computed(() => {\n  return actions.value.filter((action) => !action.group);\n});\n\nconst groupedWithLabelActions = computed(() => {\n  let _actions = [];\n\n  actions.value\n    .filter((action) => action.buttonLabel && action.group)\n    .forEach((action) => {\n      let groupIndex = _actions.findIndex(\n        (a) => a.label === action.buttonLabel\n      );\n      if (groupIndex > -1) {\n        _actions[groupIndex].action.push(action);\n      } else {\n        _actions.push({\n          label: action.buttonLabel,\n          action: [action],\n        });\n      }\n    });\n  return _actions;\n});\n\nconst groupedActions = computed(() => {\n  let _actions = [];\n  _actions = _actions.concat(\n    actions.value.filter((action) => action.group && !action.buttonLabel)\n  );\n  return _actions;\n});\n\nconst customizationCtx = computed(() => ({\n  doc: ticket?.value?.doc,\n  call,\n  router,\n  toast,\n  $dialog: globalStore().$dialog,\n  updateField,\n  createToast: toast.create,\n}));\n\n// to manage the correct  customization context for actions, happens because of navigation between tickets using buttons\nwatchEffect(async () => {\n  if (customizations.value?.data) {\n    await setupCustomizations(\n      customizations.value.data,\n      customizationCtx.value\n    );\n\n    actions.value = [\n      ...defaultActions.value,\n      ...(customizations.value?.data?._customActions || []),\n    ];\n  }\n});\n\nconst statusRef = useTemplateRef(\"statusRef\");\n\nonMounted(() => {\n  useShortcut(\"s\", () => {\n    statusRef.value?.$el?.nextElementSibling?.click();\n  });\n});\n</script>\n\n<style>\n.breadcrumbs button {\n  background-color: inherit !important;\n  &:hover,\n  &:focus {\n    background-color: inherit !important;\n  }\n}\n</style>\n","<template>\n  <div class=\"relative\" :style=\"{ width: `${sidebarWidth}px` }\">\n    <slot v-bind=\"{ sidebarResizing, sidebarWidth }\" />\n    <div\n      class=\"absolute z-1 h-full w-1 cursor-col-resize bg-surface-gray-4 opacity-0 transition-opacity hover:opacity-100\"\n      :class=\"{\n        'opacity-100': sidebarResizing,\n        'left-0': side == 'right',\n        'right-0': side == 'left',\n      }\"\n      @mousedown=\"startResize\"\n    />\n  </div>\n</template>\n<script setup>\nimport { ref } from \"vue\";\n\nconst props = defineProps({\n  defaultWidth: {\n    type: Number,\n    default: 352,\n  },\n  minWidth: {\n    type: Number,\n    default: 16 * 16,\n  },\n  maxWidth: {\n    type: Number,\n    default: 30 * 16,\n  },\n  side: {\n    type: String,\n    default: \"left\",\n  },\n  parent: {\n    type: Object,\n    default: null,\n  },\n});\n\nconst sidebarResizing = ref(false);\nconst sidebarWidth = ref(props.defaultWidth);\n\nfunction startResize() {\n  document.addEventListener(\"mousemove\", resize);\n  document.addEventListener(\"mouseup\", () => {\n    document.body.classList.remove(\"select-none\");\n    document.body.classList.remove(\"cursor-col-resize\");\n    document.querySelectorAll(\".select-text1\").forEach((el) => {\n      el.classList.remove(\"select-text1\");\n      el.classList.add(\"select-text\");\n    });\n    localStorage.setItem(\"sidebarWidth\", sidebarWidth.value);\n    sidebarResizing.value = false;\n    document.removeEventListener(\"mousemove\", resize);\n  });\n}\nfunction resize(e) {\n  sidebarResizing.value = true;\n  document.body.classList.add(\"select-none\");\n  document.body.classList.add(\"cursor-col-resize\");\n  document.querySelectorAll(\".select-text\").forEach((el) => {\n    el.classList.remove(\"select-text\");\n    el.classList.add(\"select-text1\");\n  });\n  sidebarWidth.value =\n    props.side == \"left\" ? e.clientX : window.innerWidth - e.clientX;\n\n  let gap = props.parent ? distance() : 0;\n  sidebarWidth.value = sidebarWidth.value - gap;\n\n  // snap to props.defaultWidth\n  let range = [props.defaultWidth - 10, props.defaultWidth + 10];\n  if (sidebarWidth.value > range[0] && sidebarWidth.value < range[1]) {\n    sidebarWidth.value = props.defaultWidth;\n  }\n\n  if (sidebarWidth.value < props.minWidth) {\n    sidebarWidth.value = props.minWidth;\n  }\n  if (sidebarWidth.value > props.maxWidth) {\n    sidebarWidth.value = props.maxWidth;\n  }\n}\nfunction distance() {\n  if (!props.parent) return 0;\n  const rect = props.parent.getBoundingClientRect();\n  return rect[props.side];\n}\n</script>\n","<template>\n  <!-- TODO: handle ellipsis -->\n  <div>\n    <!-- Contact -->\n    <div v-if=\"!contact.loading\">\n      <div class=\"flex gap-3 items-center px-5 py-2.5\">\n        <Avatar\n          :label=\"contact.data.name\"\n          :image=\"contact.data.image\"\n          size=\"2xl\"\n        />\n        <p class=\"text-ink-gray-8 font-medium text-xl max-w-full truncate\">\n          {{ contact.data.name }}\n        </p>\n      </div>\n      <div class=\"px-5 text-ink-gray-5 pb-2\">\n        <!-- Email Id -->\n        <div class=\"flex gap-2 items-center p-1.5\">\n          <EmailIcon class=\"size-4\" />\n          <p class=\"text-p-sm text-ink-gray-6 hover:underline cursor-pointer\">\n            {{ contact.data.email_id }}\n          </p>\n          <CopyIcon\n            class=\"size-4 cursor-pointer\"\n            @click=\"\n              copyToClipboard(\n                contact.data.email_id,\n                `'${contact.data.email_id}' copied to clipboard`\n              )\n            \"\n          />\n        </div>\n        <!-- Mobile Number -->\n        <div\n          class=\"flex gap-2 items-center p-1.5\"\n          v-if=\"\n            isCallingEnabled && (contact.data.mobile_no || contact.data.phone)\n          \"\n        >\n          <PhoneIcon class=\"size-4\" />\n          <p class=\"text-p-sm text-ink-gray-6 hover:underline cursor-pointer\">\n            {{ contact.data.mobile_no || contact.data.phone }}\n          </p>\n          <CopyIcon\n            class=\"size-4 cursor-pointer\"\n            v-if=\"contact.data.mobile_no || contact.data.phone\"\n            @click=\"\n              copyToClipboard(\n                contact.data.mobile_no || contact.data.phone,\n                `'${\n                  contact.data.mobile_no || contact.data.phone\n                }' copied to clipboard`\n              )\n            \"\n          />\n        </div>\n      </div>\n    </div>\n\n    <!-- Recent / Similar Tickets -->\n    <template v-if=\"!recentSimilarTickets.loading\">\n      <div class=\"px-5 border-t pb-2.5\" v-for=\"section in sections\">\n        <Section\n          :key=\"section.label\"\n          :label=\"section.label\"\n          :hideLabel=\"section.hideLabel\"\n          :opened=\"section.opened\"\n        >\n          <template #header=\"{ opened, hide, toggle }\">\n            <div class=\"flex gap-2.5 items-center py-[13px] justify-between\">\n              <Tooltip :text=\"section.tooltipMessage\">\n                <span\n                  class=\"text-ink-gray-8 font-medium text-base cursor-pointer select-none\"\n                  @click=\"toggle\"\n                >\n                  {{ section.label }}\n                </span>\n              </Tooltip>\n              <LucideChevronDown\n                class=\"size-4 text-ink-gray-6 cursor-pointer\"\n                :class=\"{ 'rotate-180': opened }\"\n                @click=\"toggle\"\n              />\n            </div>\n          </template>\n          <ul>\n            <li\n              v-for=\"ticket in section.tickets\"\n              :key=\"ticket.name\"\n              class=\"py-2.5 cursor-pointer\"\n              @click=\"openTicket(ticket.name)\"\n            >\n              <p class=\"text-base text-ink-gray-8 max-w-[60%] truncate\">\n                {{ ticket.subject }}\n              </p>\n              <div class=\"flex items-end justify-between\">\n                <p class=\"text-base text-ink-gray-5\">\n                  {{ formatDate(ticket.creation) + \" &#183; \" }}\n                  <span class=\"transition duration-400 hover:underline\">\n                    {{ \"#\" + ticket.name }}\n                  </span>\n                </p>\n                <p\n                  class=\"px-1.5 py-[3px] text-sm rounded-sm max-w-[80px] text-center truncate h-5\"\n                  :class=\"getStatusColor(ticket.status)\"\n                >\n                  {{ ticket.status }}\n                </p>\n              </div>\n            </li>\n          </ul>\n        </Section>\n      </div>\n    </template>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { useTelephonyStore } from \"@/stores/telephony\";\nimport { useTicketStatusStore } from \"@/stores/ticketStatus\";\nimport { RecentSimilarTicketsSymbol, TicketContactSymbol } from \"@/types\";\nimport { copyToClipboard } from \"@/utils\";\nimport dayjs from \"dayjs\";\nimport { Avatar, Tooltip } from \"frappe-ui\";\nimport { storeToRefs } from \"pinia\";\nimport { computed, inject } from \"vue\";\nimport { CopyIcon } from \"../icons\";\nimport EmailIcon from \"../icons/EmailIcon.vue\";\nimport PhoneIcon from \"../icons/PhoneIcon.vue\";\nimport Section from \"../Section.vue\";\nconst telephonyStore = useTelephonyStore();\nconst { isCallingEnabled } = storeToRefs(telephonyStore);\n\nconst contact = inject(TicketContactSymbol);\nconst recentSimilarTickets = inject(RecentSimilarTicketsSymbol);\nconst dateFormat = window.date_format;\n\nconst { getStatus, colorMap } = useTicketStatusStore();\n\nfunction getStatusColor(status: string) {\n  let { color } = getStatus(status);\n\n  if (colorMap[color]) {\n    return colorMap[color];\n  } else {\n    return colorMap[\"Default\"];\n  }\n}\n\nconst sections = computed(() => {\n  if (recentSimilarTickets.value.loading || !recentSimilarTickets.value.data) {\n    return [];\n  }\n  const recentTickets = recentSimilarTickets.value?.data?.recent_tickets || [];\n  const similarTickets =\n    recentSimilarTickets.value?.data?.similar_tickets || [];\n  const _sections = [];\n  if (recentTickets.length) {\n    _sections.push({\n      label: \"Recent Tickets\",\n      tooltipMessage: \"Tickets recently raised by this contact/customer\",\n      hideLabel: false,\n      opened: true,\n      tickets: recentTickets,\n    });\n  }\n  if (similarTickets.length) {\n    _sections.push({\n      label: \"Similar Tickets\",\n      tooltipMessage: \"Tickets with similar queries\",\n      hideLabel: false,\n      opened: true,\n      tickets: similarTickets,\n    });\n  }\n  return _sections;\n});\n\nfunction formatDate(date: string) {\n  return dayjs(date).format(dateFormat.toUpperCase());\n}\n\nfunction openTicket(name: string) {\n  let url = window.location.origin + \"/helpdesk/tickets/\" + name;\n\n  window.open(url, \"_blank\");\n}\n// v-if=\"(false && contact.data.mobile_no) || contact.data.phone\"\n</script>\n\n<style scoped></style>\n","<template>\n  <div\n    class=\"flex flex-col gap-2 my-2 w-[470px] rounded-lg bg-surface-modal shadow-2xl ring-1 ring-black p-3 ring-opacity-5 focus:outline-none\"\n  >\n    <div class=\"text-base text-ink-gray-5\">{{ __(\"Assign to\") }}</div>\n    <Link\n      class=\"form-control\"\n      value=\"\"\n      doctype=\"HD Agent\"\n      @change=\"(option) => addValue(option) && ($refs.input.value = '')\"\n      :placeholder=\"__('John Doe')\"\n      :filters=\"{\n        is_active: true,\n        name: ['not in', assignees.map((a) => a.name)],\n      }\"\n      :hideMe=\"true\"\n    >\n      <template #target=\"{ togglePopover }\">\n        <div\n          class=\"w-full min-h-12 flex flex-wrap items-center gap-1.5 p-1.5 pb-5 rounded-lg bg-surface-gray-2 cursor-text\"\n          @click.stop=\"togglePopover\"\n          ref=\"input\"\n        >\n          <Tooltip\n            :text=\"assignee.name\"\n            v-for=\"assignee in assignees\"\n            :key=\"assignee.name\"\n            @click.stop\n          >\n            <div\n              class=\"flex items-center text-sm p-0.5 text-ink-gray-6 border border-outline-gray-1 bg-surface-modal rounded-full cursor-pointer\"\n              @click.stop\n            >\n              <UserAvatar :name=\"assignee.name\" size=\"sm\" />\n              <div class=\"ml-1\">{{ getUser(assignee.name).full_name }}</div>\n              <Button\n                variant=\"ghost\"\n                class=\"rounded-full !size-4 m-1\"\n                @click.stop=\"removeValue(assignee.name)\"\n              >\n                <template #icon>\n                  <FeatherIcon name=\"x\" class=\"h-3 w-3 text-ink-gray-6\" />\n                </template>\n              </Button>\n            </div>\n          </Tooltip>\n        </div>\n      </template>\n      <template #item-prefix=\"{ option }\">\n        <UserAvatar class=\"mr-2\" :name=\"option.value\" size=\"sm\" />\n      </template>\n      <template #item-label=\"{ option }\">\n        <Tooltip :text=\"option.value\">\n          <div class=\"cursor-pointer text-ink-gray-9\">\n            {{ getUser(option.value).full_name }}\n          </div>\n        </Tooltip>\n      </template>\n    </Link>\n    <div class=\"flex items-center justify-between gap-2\">\n      <div\n        class=\"text-base text-ink-gray-5 cursor-pointer select-none\"\n        @click=\"assignToMe = !assignToMe\"\n      >\n        {{ __(\"Assign to me\") }}\n      </div>\n      <Switch v-model=\"assignToMe\" @click.stop />\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport UserAvatar from \"@/components/UserAvatar.vue\";\nimport Link from \"@/components/frappe-ui/Link.vue\";\nimport { useUserStore } from \"@/stores/user\";\nimport { capture } from \"@/telemetry\";\nimport { Tooltip, Switch, createResource, call } from \"frappe-ui\";\nimport { ref, watch, useTemplateRef, nextTick } from \"vue\";\n\nconst props = defineProps({\n  doctype: {\n    type: String,\n    default: \"\",\n  },\n  docname: {\n    type: String,\n    default: null,\n  },\n  open: {\n    type: Boolean,\n    default: false,\n  },\n  onUpdate: {\n    type: Function,\n    default: null,\n  },\n});\n\nconst assignees = defineModel();\nconst oldAssignees = ref([]);\nconst assignToMe = ref(false);\n\nconst error = ref(\"\");\n\nconst { users, getUser } = useUserStore();\n\nconst removeValue = (value) => {\n  if (value === getUser(\"\").name) {\n    assignToMe.value = false;\n  }\n\n  assignees.value = assignees.value.filter(\n    (assignee) => assignee.name !== value\n  );\n};\n\nconst addValue = (value) => {\n  if (!value) return;\n\n  if (value === getUser(\"\").name) {\n    assignToMe.value = true;\n  }\n\n  error.value = \"\";\n  let obj = {\n    name: value,\n    image: getUser(value).user_image,\n    label: getUser(value).full_name,\n  };\n  if (!assignees.value.find((assignee) => assignee.name === value)) {\n    assignees.value.push(obj);\n  }\n};\n\nwatch(assignToMe, (val) => {\n  let user = getUser(\"\");\n  if (val) {\n    addValue(user.name);\n  } else {\n    removeValue(user.name);\n  }\n});\n\nwatch(\n  () => props.open,\n  (val) => {\n    if (val) {\n      oldAssignees.value = [...(assignees.value || [])];\n      assignToMe.value = assignees.value.some(\n        (assignee) => assignee.name === getUser(\"\").name\n      );\n    } else {\n      updateAssignees();\n    }\n  },\n  { immediate: true }\n);\n\nasync function updateAssignees() {\n  const _assignees = assignees.value.map((a) => a.name);\n  const _oldAssignees = oldAssignees.value.map((a) => a.name);\n  if (JSON.stringify(_oldAssignees) === JSON.stringify(_assignees)) return;\n\n  const removedAssignees = oldAssignees.value\n    .filter(\n      (assignee) => !assignees.value.find((a) => a.name === assignee.name)\n    )\n    .map((assignee) => assignee.name);\n\n  const addedAssignees = assignees.value\n    .filter(\n      (assignee) => !oldAssignees.value.find((a) => a.name === assignee.name)\n    )\n    .map((assignee) => assignee.name);\n\n  if (addedAssignees.length || removedAssignees.length) {\n    let logMessage = `${\n      addedAssignees.length ? `assigned ${addedAssignees.join(\", \")}` : \"\"\n    } ${addedAssignees.length && removedAssignees.length ? \" & \" : \"\"} ${\n      removedAssignees.length ? `unassigned ${removedAssignees.join(\", \")}` : \"\"\n    }`;\n    call(\"frappe.client.insert\", {\n      doc: {\n        doctype: \"HD Ticket Activity\",\n        ticket: props.docname,\n        action: logMessage,\n      },\n    });\n  }\n  if (props.onUpdate) {\n    props.onUpdate(\n      addedAssignees,\n      removedAssignees,\n      addAssignees,\n      removeAssignees\n    );\n  } else {\n    if (removedAssignees.length) {\n      await removeAssignees.submit(removedAssignees);\n    }\n    if (addedAssignees.length) {\n      await addAssignees.submit(addedAssignees);\n    }\n  }\n}\n\nconst addAssignees = createResource({\n  url: \"frappe.desk.form.assign_to.add\",\n  makeParams: (addedAssignees) => ({\n    doctype: props.doctype,\n    name: props.docname,\n    assign_to: addedAssignees,\n  }),\n  onSuccess: () => {\n    capture(\"assign_to\", { doctype: props.doctype });\n  },\n});\n\nconst removeAssignees = createResource({\n  url: \"helpdesk.api.doc.remove_assignments\",\n  makeParams: (removedAssignees) => ({\n    doctype: props.doctype,\n    name: props.docname,\n    assignees: removedAssignees,\n  }),\n});\n\nconst targetRef = useTemplateRef(\"input\");\nnextTick(() => {\n  targetRef.value.click();\n});\n</script>\n","<template>\n  <Popover class=\"flex w-full\" placement=\"bottom-end\">\n    <template #target=\"{ open, close, togglePopover }\">\n      <div class=\"flex flex-col gap-1.5 w-full\">\n        <span class=\"block text-xs text-gray-600\">Assignee</span>\n        <Button\n          variant=\"outline\"\n          class=\"!flex !justify-start w-full active:!bg-inherit hover:shadow-sm\"\n          ref=\"assigneeButton\"\n          @click=\"togglePopover()\"\n        >\n          <p v-if=\"assignees.loading || assignees.data?.length === 0\">\n            {{ __(\"No assignees\") }}\n          </p>\n          <div\n            v-else-if=\"assignees.data?.length >= 1\"\n            class=\"flex gap-1.5 items-center\"\n          >\n            <MultipleAvatar\n              :avatars=\"assignees.data.map((a) => a.name)\"\n              size=\"sm\"\n            />\n            <p\n              v-if=\"assignees.data?.length > 1\"\n              class=\"ml-2 text-sm text-ink-gray-8\"\n            >\n              {{ assignees.data?.length }} assignees\n            </p>\n          </div>\n          <template #suffix>\n            <Icon\n              :icon=\"LucideChevronDown\"\n              class=\"h-4 w-4 ml-auto text-ink-gray-5\"\n            />\n          </template>\n        </Button>\n      </div>\n    </template>\n    <template #body=\"{ isOpen }\">\n      <AssignToBody\n        v-show=\"isOpen\"\n        v-model=\"assignees.data\"\n        doctype=\"HD Ticket\"\n        :docname=\"ticket.name\"\n        :open=\"isOpen\"\n        :onUpdate=\"saveAssignees\"\n      />\n    </template>\n  </Popover>\n</template>\n\n<script setup lang=\"ts\">\nimport { useShortcut } from \"@/composables/shortcuts\";\nimport { ActivitiesSymbol, AssigneeSymbol, TicketSymbol } from \"@/types\";\nimport { Popover } from \"frappe-ui\";\nimport { inject, useTemplateRef } from \"vue\";\nimport LucideChevronDown from \"~icons/lucide/chevron-down\";\nimport MultipleAvatar from \"../MultipleAvatar.vue\";\nimport AssignToBody from \"./AssignToBody.vue\";\nconst ticket = inject(TicketSymbol);\nconst assignees = inject(AssigneeSymbol);\nconst activities = inject(ActivitiesSymbol);\nasync function saveAssignees(\n  addedAssignees,\n  removedAssignees,\n  addAssignees,\n  removeAssignees\n) {\n  removedAssignees.length && (await removeAssignees.submit(removedAssignees));\n  addedAssignees.length && (await addAssignees.submit(addedAssignees));\n  activities.value.reload();\n}\n\nconst assignToRef = useTemplateRef(\"assigneeButton\");\n\nuseShortcut(\"a\", () => {\n  (assignToRef.value?.$el as HTMLElement)?.nextElementSibling?.click();\n});\n</script>\n","<template>\n  <div\n    v-if=\"!contact.loading\"\n    class=\"my-4 flex items-center justify-start gap-5\"\n  >\n    <Avatar :label=\"contact.data.name\" :image=\"contactImage\" size=\"2xl\" />\n    <div class=\"flex flex-col gap-1.5\">\n      <Tooltip :text=\"contact.data.name || contact.data.email_id\">\n        <div class=\"flex gap-2.5 items-center\">\n          <p class=\"text-ink-gray-8 font-medium text-xl max-w-[170px] truncate\">\n            {{ contact.data.name || contact.data.email_id }}\n          </p>\n          <ExternalLinkIcon\n            class=\"size-4 text-ink-gray-6 cursor-pointer\"\n            @click=\"openContact(contact.data.name)\"\n          />\n        </div>\n      </Tooltip>\n      <div class=\"flex gap-1.5\">\n        <Tooltip :text=\"contact.data.email_id\">\n          <!-- Email Button -->\n          <Button size=\"sm\" @click=\"toggleEmailBox()\">\n            <template #icon>\n              <EmailIcon class=\"size-4\" />\n            </template>\n          </Button>\n          <!-- Call Button -->\n          <Button size=\"sm\" v-if=\"isCallingEnabled\" @click=\"callContact\">\n            <template #icon>\n              <PhoneIcon class=\"size-4\" />\n            </template>\n          </Button>\n        </Tooltip>\n      </div>\n    </div>\n    <SetContactPhoneModal\n      v-model=\"showPhoneModal\"\n      :name=\"contact.data.name\"\n      @onUpdate=\"contact.reload\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { toggleEmailBox } from \"@/pages/ticket/modalStates\";\nimport { useTelephonyStore } from \"@/stores/telephony\";\nimport { useUserStore } from \"@/stores/user\";\nimport { TicketContactSymbol, TicketSymbol } from \"@/types\";\nimport { Avatar, Button, Tooltip } from \"frappe-ui\";\nimport { storeToRefs } from \"pinia\";\nimport { computed, inject, ref } from \"vue\";\nimport { ExternalLinkIcon } from \"../icons\";\nimport EmailIcon from \"../icons/EmailIcon.vue\";\nimport PhoneIcon from \"../icons/PhoneIcon.vue\";\nimport SetContactPhoneModal from \"../ticket/SetContactPhoneModal.vue\";\n\nconst telephonyStore = useTelephonyStore();\nconst { getUser } = useUserStore();\nconst { isCallingEnabled } = storeToRefs(telephonyStore);\nconst showPhoneModal = ref(false);\n\nconst ticket = inject(TicketSymbol);\n\nconst contact = inject(TicketContactSymbol);\nconst contactImage = computed(() => {\n  return (\n    contact.value?.data?.image ||\n    getUser(contact.value?.data?.email_id)?.user_image ||\n    null\n  );\n});\n\nfunction openContact(name: string) {\n  let url = window.location.origin + \"/app/contact/\" + name;\n  window.open(url, \"_blank\");\n}\n\nconst callContact = () => {\n  if (!contact.value.data.mobile_no && !contact.value.data.phone) {\n    showPhoneModal.value = true;\n    return;\n  }\n  telephonyStore.makeCall({\n    number: contact.value.data.mobile_no || contact.value.data.phone,\n    doctype: \"HD Ticket\",\n    docname: ticket.value.name,\n  });\n};\n</script>\n\n<style scoped></style>\n","<template>\n  <div\n    class=\"h-full overflow-y-hidden flex flex-1 flex-col justify-between overflow-hidden max-h-full\"\n  >\n    <div class=\"px-5 pb-4 flex flex-col\">\n      <!-- User avatar with buttons -->\n      <TicketContact />\n      <!-- Core Fields -->\n      <div>\n        <div\n          v-for=\"(section, index) in coreFields\"\n          :key=\"index\"\n          :class=\"\n            section.group ? 'flex gap-2 items-center w-full mb-3' : 'mb-3'\n          \"\n        >\n          <template v-for=\"field in section.fields\">\n            <Link\n              v-if=\"field.visible\"\n              :key=\"field.fieldname\"\n              :ref=\"(el) => setFieldRef(field.fieldname, el)\"\n              class=\"form-control-core\"\n              :id=\"field.fieldname\"\n              :class=\"section.group ? 'flex-1' : 'w-full'\"\n              :page-length=\"10\"\n              :label=\"field.label\"\n              :placeholder=\"field.placeholder\"\n              :doctype=\"field.doctype\"\n              :modelValue=\"field.value\"\n              :required=\"field.required\"\n              @update:model-value=\"\n              (val:string) => handleFieldUpdate(field.fieldname, val,true)\n            \"\n            />\n          </template>\n        </div>\n\n        <!-- Assignee component -->\n        <AssignTo />\n      </div>\n    </div>\n\n    <!-- Additional Fields -->\n    <div class=\"border-t flex flex-col flex-1 h-full pb-3 overflow-y-hidden\">\n      <!-- TODO: Hack of 80 % for now, will refactor -->\n      <div class=\"overflow-y-scroll max-h-[80%]\">\n        <template v-for=\"field in customFields\">\n          <TicketField\n            v-if=\"field.visible\"\n            :key=\"field.fieldname\"\n            :field=\"field\"\n            :value=\"field.value\"\n            @change=\"\n              ({ fieldname, value }) => handleFieldUpdate(fieldname, value)\n            \"\n          />\n        </template>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Link } from \"@/components\";\nimport { parseField } from \"@/composables/formCustomisation\";\nimport { useNotifyTicketUpdate } from \"@/composables/realtime\";\nimport { useShortcut } from \"@/composables/shortcuts\";\nimport { getMeta } from \"@/stores/meta\";\nimport {\n  ActivitiesSymbol,\n  AssigneeSymbol,\n  CustomizationSymbol,\n  FieldValue,\n  TicketSymbol,\n} from \"@/types\";\nimport { computed, inject, ref } from \"vue\";\nimport TicketField from \"../TicketField.vue\";\nimport AssignTo from \"./AssignTo.vue\";\nimport TicketContact from \"./TicketContact.vue\";\n\nconst ticket = inject(TicketSymbol);\nconst assignees = inject(AssigneeSymbol);\nconst customizations = inject(CustomizationSymbol);\nconst activities = inject(ActivitiesSymbol);\nconst { getFields, getField } = getMeta(\"HD Ticket\");\nconst { notifyTicketUpdate } = useNotifyTicketUpdate(ticket.value?.name);\n\n// ticket_type, priority, customer, agent_group\nconst coreFields = computed(() => {\n  // TODO: to confirm whether customizations should apply to core fields as well\n  const fieldsMeta = getFields();\n  if (!fieldsMeta || fieldsMeta.length === 0) {\n    return [];\n  }\n  const _coreFields = [\n    { group: true, fields: [getField(\"ticket_type\"), getField(\"priority\")] },\n    { group: false, fields: [getField(\"customer\")] },\n    { group: true, fields: [getField(\"agent_group\")] },\n  ];\n\n  _coreFields.forEach((section) => {\n    section.fields = section.fields.map((f) => {\n      f = parseField(f, ticket.value.doc);\n\n      // cant handle required depends on as we directly set the value in DB on change\n      f[\"required\"] = f.reqd;\n      f[\"ref\"] = f.fieldname;\n\n      f = getFieldInFormat(f, f);\n      f[\"visible\"] = true;\n      return f;\n    });\n  });\n  return _coreFields;\n});\n\nconst customFields = computed(() => {\n  const fieldsMeta = getFields();\n  if (!fieldsMeta || fieldsMeta.length === 0) {\n    return [];\n  }\n\n  if (!customizations.value.data || customizations.value.loading) return [];\n  let customFields = customizations.value.data?.custom_fields || [];\n  const _coreFields = [\n    \"ticket_type\",\n    \"priority\",\n    \"customer\",\n    \"agent_group\",\n    \"subject\",\n    \"status\",\n  ];\n  customFields = customFields.filter((f) => !_coreFields.includes(f.fieldname));\n  let _customFields = customFields.map((f) => {\n    let fieldMeta = getField(f.fieldname);\n\n    fieldMeta = parseField(fieldMeta, ticket.value.doc);\n    // cant handle required depends on as we directly set the value in DB\n    fieldMeta[\"required\"] = fieldMeta.reqd || f.required;\n\n    return getFieldInFormat(f, fieldMeta);\n  });\n  return _customFields;\n});\n\nfunction getFieldInFormat(fieldTemplate, fieldMeta) {\n  return {\n    label: fieldMeta?.label || fieldTemplate.fieldname,\n    value: ticket.value.doc[fieldTemplate.fieldname],\n    fieldtype: fieldMeta?.fieldtype,\n    doctype: fieldMeta?.options || \"\",\n    options: fieldMeta?.options || \"\",\n    placeholder:\n      fieldTemplate.placeholder ||\n      `Enter ${fieldMeta?.label || fieldTemplate.fieldname}`,\n    readonly: Boolean(fieldMeta.read_only),\n    disabled: Boolean(fieldMeta.read_only),\n    url_method: fieldTemplate.url_method || \"\",\n    fieldname: fieldTemplate.fieldname,\n    required: fieldTemplate.required || fieldMeta?.required || false,\n    visible: fieldMeta.display_via_depends_on && !fieldMeta.hidden,\n  };\n}\n\nfunction handleFieldUpdate(\n  fieldname: string,\n  value: FieldValue,\n  isCoreFieldUpdated = false\n) {\n  if (ticket.value.doc[fieldname] == value) return;\n  if (isCoreFieldUpdated) {\n    const label = getField(fieldname)?.label || fieldname;\n    notifyTicketUpdate(label, value as string);\n  }\n  ticket.value.setValue.submit(\n    { [fieldname]: value },\n    {\n      onSuccess: () => {\n        // TODO: emit the event for notification to listeners\n        if (fieldname === \"agent_group\") {\n          assignees.value.reload();\n        }\n        activities.value.reload();\n      },\n    }\n\n    //show error toast\n  );\n}\n\nconst fieldRefs = ref<Record<string, any>>({});\n\nconst setFieldRef = (fieldname: string, el: any) => {\n  if (el) {\n    fieldRefs.value[fieldname] = el;\n  }\n};\n\nuseShortcut(\"t\", () => {\n  fieldRefs.value?.ticket_type?.$el?.querySelector(\"button\")?.click();\n});\n\nuseShortcut(\"p\", () => {\n  fieldRefs.value?.priority?.$el?.querySelector(\"button\")?.click();\n});\n\nuseShortcut({ key: \"t\", shift: true }, () => {\n  fieldRefs.value?.agent_group?.$el?.querySelector(\"button\")?.click();\n});\n</script>\n\n<style scoped>\n:deep(.form-control-core button) {\n  @apply text-base rounded h-7 py-1.5 border border-outline-gray-2 bg-surface-white placeholder-ink-gray-4 hover:border-outline-gray-3 hover:shadow-sm focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-0 text-ink-gray-8 transition-colors w-full dark:[color-scheme:dark];\n}\n:deep(.form-control-core button > div) {\n  @apply truncate;\n}\n\n:deep(.form-control-core div) {\n  width: 100%;\n  display: flex;\n}\n</style>\n","<template>\n  <Resizer class=\"flex flex-col justify-between border-l\" side=\"right\">\n    <TabButtons\n      :buttons=\"tabs\"\n      v-model=\"currentTab\"\n      class=\"tab-buttons mb-1 px-5 mt-3.5\"\n    />\n    <div class=\"flex-1 max-h-full\">\n      <TicketDetailsTab v-if=\"currentTab === 'details'\" />\n      <TicketContactTab v-else />\n    </div>\n  </Resizer>\n</template>\n\n<script setup lang=\"ts\">\nimport { TabButtons } from \"frappe-ui\";\nimport { ref } from \"vue\";\nimport Resizer from \"../Resizer.vue\";\nimport TicketContactTab from \"./TicketContactTab.vue\";\nimport TicketDetailsTab from \"./TicketDetailsTab.vue\";\n\nconst currentTab = ref(\"details\");\nconst tabs = [\n  {\n    label: \"Details\",\n    value: \"details\",\n  },\n  {\n    label: \"Contact\",\n    value: \"contact\",\n  },\n];\n</script>\n\n<style>\n.tab-buttons div,\n.tab-buttons button {\n  width: 100%;\n  flex: 1;\n}\n</style>\n","import type {\n  DocumentResource,\n  RecentSimilarTicket,\n  Resource,\n  TicketActivities,\n  TicketContact,\n} from \"@/types\";\nimport type { HDTicket } from \"@/types/doctypes\";\nimport { createDocumentResource, createResource, toast } from \"frappe-ui\";\nimport { reactive } from \"vue\";\n\ninterface MapValue {\n  ticket: DocumentResource<HDTicket>;\n  assignees: Resource<Record<\"name\", string>[]>;\n  contact: Resource<TicketContact>;\n  recentSimilarTickets: Resource<RecentSimilarTicket>;\n  activities: Resource<TicketActivities>;\n}\n\nconst ticketMap: Record<string, MapValue> = reactive({});\n\nexport const useTicket = (ticketId: string): MapValue => {\n  let err = false;\n  if (!ticketMap[ticketId]) {\n    ticketMap[ticketId] = {\n      ticket: createDocumentResource<HDTicket>({\n        doctype: \"HD Ticket\",\n        name: ticketId,\n        whitelistedMethods: {\n          markSeen: \"mark_seen\",\n        },\n        setValue: {\n          onSuccess: () => {\n            toast.success(__(\"Ticket updated\"));\n            err = false;\n          },\n          onError: (error) => {\n            if (err) return;\n            err = true;\n            const msg = error.exc_type\n              ? (error.messages || error.message || []).join(\", \")\n              : error.message;\n            toast.error(msg);\n          },\n        },\n      }),\n      assignees: createResource({\n        url: \"helpdesk.helpdesk.doctype.hd_ticket.api.get_ticket_assignees\",\n        params: { ticket: ticketId },\n        auto: true,\n        transform: (data: string) => {\n          return JSON.parse(data).map((name: string) => ({ name })) as Record<\n            \"name\",\n            string\n          >[];\n        },\n      }),\n      contact: createResource({\n        url: \"helpdesk.helpdesk.doctype.hd_ticket.api.get_ticket_contact\",\n        params: { ticket: ticketId },\n        auto: true,\n      }),\n      recentSimilarTickets: createResource({\n        url: \"helpdesk.helpdesk.doctype.hd_ticket.api.get_recent_similar_tickets\",\n        params: { ticket: ticketId },\n        auto: true,\n      }),\n      activities: createResource({\n        url: \"helpdesk.helpdesk.doctype.hd_ticket.api.get_ticket_activities\",\n        params: { ticket: ticketId },\n        auto: true,\n      }),\n    };\n  }\n\n  return ticketMap[ticketId];\n};\n","<template>\n  <div v-if=\"ticket.doc?.name\" class=\"flex-1\">\n    <TicketHeader :viewers=\"viewers\" />\n    <div class=\"h-full flex overflow-hidden\">\n      <div class=\"flex-1 flex flex-col overflow-hidden\">\n        <!-- Tabs & Communication Area -->\n        <TicketActivityPanel />\n      </div>\n\n      <!-- Sidepanel with Resizer -->\n      <TicketSidebar />\n    </div>\n    <SetContactPhoneModal\n      v-model=\"showPhoneModal\"\n      :name=\"ticket.data?.contact?.name\"\n      @onUpdate=\"ticket.reload\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport TicketActivityPanel from \"@/components/ticket-agent/TicketActivityPanel.vue\";\nimport TicketHeader from \"@/components/ticket-agent/TicketHeader.vue\";\nimport TicketSidebar from \"@/components/ticket-agent/TicketSidebar.vue\";\nimport SetContactPhoneModal from \"@/components/ticket/SetContactPhoneModal.vue\";\nimport { useActiveViewers } from \"@/composables/realtime\";\nimport { useTicket } from \"@/composables/useTicket\";\nimport { ticketsToNavigate } from \"@/composables/useTicketNavigation\";\nimport { globalStore } from \"@/stores/globalStore\";\nimport { useTelephonyStore } from \"@/stores/telephony\";\nimport {\n  ActivitiesSymbol,\n  AssigneeSymbol,\n  Customizations,\n  CustomizationSymbol,\n  RecentSimilarTicketsSymbol,\n  Resource,\n  TicketContactSymbol,\n  TicketSymbol,\n} from \"@/types\";\nimport { createResource, toast, usePageMeta } from \"frappe-ui\";\nimport { computed, onBeforeUnmount, onMounted, provide, ref, watch } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport { showCommentBox, showEmailBox } from \"./modalStates\";\nconst telephonyStore = useTelephonyStore();\n\nconst { $socket } = globalStore();\n\nconst props = defineProps({\n  ticketId: {\n    type: String,\n    required: true,\n  },\n});\nconst route = useRoute();\nconst showPhoneModal = ref(false);\n\nconst ticketComposable = computed(() => useTicket(props.ticketId));\nconst ticket = computed(() => ticketComposable.value.ticket);\nconst customizations: Resource<Customizations> = createResource({\n  url: \"helpdesk.helpdesk.doctype.hd_ticket.api.get_ticket_customizations\",\n  cache: [\"HD Ticket\", \"customizations\"],\n  auto: true,\n});\n\nprovide(TicketSymbol, ticket);\n\nprovide(\n  AssigneeSymbol,\n  computed(() => ticketComposable.value.assignees)\n);\nprovide(\n  TicketContactSymbol,\n  computed(() => ticketComposable.value.contact)\n);\nprovide(\n  CustomizationSymbol,\n  computed(() => customizations)\n);\nprovide(\n  RecentSimilarTicketsSymbol,\n  computed(() => ticketComposable.value.recentSimilarTickets)\n);\nprovide(\n  ActivitiesSymbol,\n  computed(() => ticketComposable.value.activities)\n);\nprovide(\"makeCall\", () => {\n  if (\n    !ticketComposable.value.contact.data?.mobile_no &&\n    !ticketComposable.value.contact.data?.phone\n  ) {\n    showPhoneModal.value = true;\n    return;\n  }\n  telephonyStore.makeCall({\n    number:\n      ticketComposable.value.contact.data?.phone ||\n      ticketComposable.value.contact.data?.mobile_no,\n    doctype: \"HD Ticket\",\n    docname: props.ticketId,\n  });\n});\nconst viewerComposable = computed(() => useActiveViewers(ticket.value.name));\nconst viewers = computed(\n  () => viewerComposable.value.currentViewers[props.ticketId] || []\n);\nconst { startViewing, stopViewing } = viewerComposable.value;\n\n// handling for faster navigation between tickets\nwatch(\n  () => route.params.ticketId,\n  (newTicketId, oldTicketId) => {\n    if (newTicketId === oldTicketId) return;\n\n    if (oldTicketId) stopViewing(oldTicketId as string);\n    startViewing(newTicketId as string);\n  },\n  { immediate: true }\n);\n\ntype TicketUpdateData = {\n  ticket_id: string;\n  user: string;\n  field: string;\n  value: string;\n};\n\nonMounted(() => {\n  ticketsToNavigate.update({\n    params: {\n      ticket: props.ticketId,\n      current_view: route.query.view as string,\n    },\n  });\n  ticketsToNavigate.reload();\n  ticket.value.markSeen.reload();\n\n  $socket.on(\"ticket_update\", (data: TicketUpdateData) => {\n    if (data.ticket_id === ticket.value?.name) {\n      // Notify the user about the update\n      toast.info(`User ${data.user} updated ${data.field} to ${data.value}`);\n    }\n  });\n});\n\nonBeforeUnmount(() => {\n  stopViewing(props.ticketId);\n  showEmailBox.value = false;\n  showCommentBox.value = false;\n});\n\nusePageMeta(() => {\n  return {\n    title: props.ticketId,\n  };\n});\n</script>\n\n<style>\n.breadcrumbs button {\n  background-color: inherit !important;\n  &:hover,\n  &:focus {\n    background-color: inherit !important;\n  }\n}\n</style>\n"],"names":["_hoisted_1","_sfc_render","_ctx","_cache","_openBlock","_createElementBlock","_createElementVNode","_unref","isEmoji","__props","_normalizeProps","_mergeProps","$attrs","_toDisplayString","_createBlock","_component_FeatherIcon","_resolveDynamicComponent","props","emit","__emit","showDialog","_useModel","getDefaultFilters","filters","targetTicket","ref","subject","mergeTicket","createResource","source","target","toast","getTicketSubject","createListResource","data","watch","newValue","handleTicketMerge","Dialog","$event","_hoisted_2","_hoisted_3","ticket","_createVNode","Link","_component_FormControl","_hoisted_4","TriangleAlert","_component_Button","LucideMerge","TicketSymbol","AssigneeSymbol","CustomizationSymbol","TicketContactSymbol","RecentSimilarTicketsSymbol","ActivitiesSymbol","inject","activities","ticketAgentActivitiesRef","communicationAreaRef","telephonyStore","useTelephonyStore","isCallingEnabled","storeToRefs","tabs","computed","_tabs","ActivityIcon","EmailIcon","CommentIcon","PhoneIcon","tabIndex","changeTabTo","useActiveTabManager","_activities","_a","emailProps","_c","_b","email","idx","commentProps","comment","historyProps","h","callProps","call","sorted","a","b","i","currentActivity","j","nextActivity","feedbackActivity","_d","_e","_f","_g","_h","filterActivities","eventType","activity","Tabs","TabList","TabPanel","_withCtx","tab","TicketAgentActivities","e","LoadingIndicator","CommunicationArea","currentTicketIndex","ticketsToNavigate","useTicketNavigation","router","useRouter","route","useRoute","goToNextTicket","nextTicketId","navigateToTicket","goToPreviousTicket","prevTicketId","getCurrentTicket","getNextTicket","getPreviousTicket","ticketId","view","routeToNavigate","disableLeftCondition","disableRightCondition","onMounted","useShortcut","_component_Tooltip","LucideChevronLeft","LucideChevronRight","firstResponse","dayjs","formatTimeShort","resolutionBy","_i","_j","_k","_l","_m","_n","date","end","_date","duration","days","hours","minutes","copyToClipboard","_Teleport","_component_GlobeIcon","_component_EmailIcon","_hoisted_5","Badge","_hoisted_6","_normalizeClass","showSubjectDialog","renameSubject","isLoading","handleRename","_component_Dialog","findView","useView","ticketStatusStore","useTicketStatusStore","customizations","notifyTicketUpdate","useNotifyTicketUpdate","statusDropdown","s","o","IndicatorIcon","breadcrumbs","items","currView","getIcon","updateField","fieldname","value","callback","showMergeModal","showMergeOption","defaultActions","actions","normalActions","action","groupedWithLabelActions","_actions","groupIndex","groupedActions","customizationCtx","globalStore","watchEffect","setupCustomizations","statusRef","useTemplateRef","LayoutHeader","Breadcrumbs","item","_component_Icon","TicketSLA","MultipleAvatar","TicketNavigation","_Fragment","_renderList","g","Dropdown","open","TicketMergeModal","TicketSubjectModal","sidebarResizing","sidebarWidth","startResize","resize","el","gap","distance","range","_renderSlot","_guardReactiveProps","contact","recentSimilarTickets","dateFormat","getStatus","colorMap","getStatusColor","status","color","sections","recentTickets","similarTickets","_sections","formatDate","openTicket","name","url","Avatar","CopyIcon","_hoisted_7","_hoisted_8","section","_hoisted_9","Section","opened","hide","toggle","_hoisted_10","Tooltip","_hoisted_11","_component_LucideChevronDown","_hoisted_13","_hoisted_14","_hoisted_15","_createTextVNode","_hoisted_16","assignees","oldAssignees","assignToMe","error","users","getUser","useUserStore","removeValue","assignee","addValue","obj","val","user","updateAssignees","_assignees","_oldAssignees","removedAssignees","addedAssignees","logMessage","addAssignees","removeAssignees","capture","targetRef","nextTick","__","option","$refs","togglePopover","UserAvatar","_withModifiers","Switch","saveAssignees","assignToRef","Popover","close","LucideChevronDown","isOpen","AssignToBody","showPhoneModal","contactImage","openContact","callContact","ExternalLinkIcon","Button","toggleEmailBox","SetContactPhoneModal","getFields","getField","getMeta","coreFields","fieldsMeta","_coreFields","f","parseField","getFieldInFormat","customFields","fieldMeta","fieldTemplate","handleFieldUpdate","isCoreFieldUpdated","label","fieldRefs","setFieldRef","TicketContact","index","field","AssignTo","TicketField","currentTab","Resizer","TabButtons","TicketDetailsTab","TicketContactTab","ticketMap","reactive","useTicket","err","createDocumentResource","msg","$socket","ticketComposable","provide","viewerComposable","useActiveViewers","viewers","startViewing","stopViewing","newTicketId","oldTicketId","onBeforeUnmount","showEmailBox","showCommentBox","usePageMeta","TicketHeader","TicketActivityPanel","TicketSidebar"],"mappings":"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"}