import{m as G,n as X,A as y,Z as Ae,N as pe,O as Oe,c as L,a4 as J,am as Y,r as U,e as g,f as j,w as $,g as n,k as V,F as q,G as W,l as o,v as ee,h as t,y as N,j as ve,d as Q,a as ge,bo as ye,aO as te,ar as ie,b6 as xe,aZ as be,aN as he,W as ue,z as K,a$ as Ce,b as je,b1 as me,a8 as z,an as se,ao as oe,aF as Z,cZ as ae,S as Ke,ba as Ne,H as Pe,aS as ze,aT as He,aV as Ze,aU as qe,U as Ge,K as F,x as Je}from"./index-b4c863a6.js";import{s as T,r as re,P as ke,m as We,a as fe,e as R}from"./TypingIndicator.vue_vue_type_style_index_0_scoped_3f215bd3_lang-c8d975a4.js";import"./dayjs-95f8111d.js";import"./knowledgeBase-2d00b929.js";import{_ as _e}from"./AttachmentItem.vue_vue_type_script_setup_true_lang-b54cd9d5.js";import{u as Qe}from"./agent-b7600b38.js";import{u as we}from"./onboarding-89cf30fe.js";import{_ as ce,T as $e}from"./file-to-base64-e61fad39.js";import{F as Ie}from"./FileUploader-44680597.js";import{C as Xe}from"./useActiveTabManager-f5a47eda.js";import{_ as Se}from"./EmailIcon-c867fb48.js";import{_ as Ee}from"./UserAvatar.vue_vue_type_script_setup_true_lang-e554c997.js";const Ye={key:0,class:"mt-2 grid max-h-[560px] grid-cols-1 md:grid-cols-3 gap-2 overflow-y-auto"},et=["onClick"],tt={class:"border-b pb-2 text-base font-semibold"},lt={key:1,class:"mt-2"},at={class:"flex justify-end mt-4"},nt={__name:"CannedResponseSelectorModal",props:G({doctype:{type:String,default:""}},{modelValue:{},modelModifiers:{}}),emits:G(["apply"],["update:modelValue"]),setup(a,{emit:M}){const I=a,d=X(a,"modelValue"),m=y(""),x=M,f=y(""),r=Ae({type:"list",doctype:"HD Canned Response",cache:["cannedResponses",I.doctype],fields:["title","message","modified"],orderBy:"modified desc",pageLength:99999});pe(()=>{r.data==null&&r.fetch()}),Oe(()=>{T.value=!0});const s=L(()=>{var _;return((_=r.data)==null?void 0:_.filter(h=>h.title.toLowerCase().includes(f.value.toLowerCase())))??[]});return J(d,_=>_&&Y(()=>{var h,k;return(k=(h=m.value)==null?void 0:h.el)==null?void 0:k.focus()})),(_,h)=>{const k=U("FeatherIcon"),D=U("TextInput"),w=U("Button"),A=U("Dialog");return g(),j(A,{modelValue:d.value,"onUpdate:modelValue":h[2]||(h[2]=C=>d.value=C),options:{title:"Canned Responses",size:"4xl"}},{"body-content":$(()=>[n(D,{ref_key:"searchInput",ref:m,modelValue:f.value,"onUpdate:modelValue":h[0]||(h[0]=C=>f.value=C),type:"text",placeholder:"Site Down"},{prefix:$(()=>[n(k,{name:"search",class:"h-4 w-4 text-gray-500"})]),_:1},8,["modelValue"]),s.value.length?(g(),V("div",Ye,[(g(!0),V(q,null,W(s.value,C=>(g(),V("div",{key:C.name,class:"flex h-56 cursor-pointer flex-col gap-2 rounded-lg border p-3 hover:bg-gray-100",onClick:B=>x("apply",C)},[o("div",tt,ee(C.title),1),C.message?(g(),j(t(ce),{key:0,content:C.message,editable:!1,"editor-class":"!prose-sm max-w-none !text-sm text-gray-600 focus:outline-none",class:"flex-1 overflow-hidden"},null,8,["content"])):N("",!0)],8,et))),128))])):(g(),V("div",lt,[...h[3]||(h[3]=[o("div",{class:"flex h-56 flex-col items-center justify-center"},[o("div",{class:"text-lg text-gray-500"},ee("No templates found"))],-1)])])),o("div",at,[n(w,{label:"New Canned Response",onClick:h[1]||(h[1]=()=>{_.$router.push("/canned-responses#new"),t(r).data=null})})])]),_:1},8,["modelValue"])}}},st={},ot={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function it(a,M){return g(),V("svg",ot,[...M[0]||(M[0]=[o("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12.5684 2.50774C11.5403 1.49742 9.95026 1.49742 8.92215 2.50774L3.62404 7.71417C2.12532 9.18695 2.12532 11.669 3.62404 13.1418C5.12762 14.6194 7.66861 14.6194 9.17219 13.1418L12.1609 10.2049C12.3578 10.0113 12.6744 10.0141 12.8679 10.211C13.0615 10.408 13.0587 10.7246 12.8618 10.9181L9.8731 13.8551C7.98045 15.715 4.81578 15.715 2.92313 13.8551C1.02562 11.9904 1.02562 8.86558 2.92313 7.00091L8.22124 1.79449C9.63842 0.401838 11.8521 0.401838 13.2693 1.79449C14.6914 3.19191 14.6914 5.38225 13.2693 6.77968L13.2668 6.78213L13.2668 6.78212L8.37876 11.5189C8.37834 11.5193 8.37793 11.5197 8.37752 11.5201C7.51767 12.3638 6.11144 12.3939 5.29119 11.5097C4.43611 10.6596 4.40778 9.26893 5.30922 8.46081L7.33823 6.46692C7.53518 6.27337 7.85175 6.27613 8.04531 6.47309C8.23886 6.67005 8.23609 6.98662 8.03913 7.18017L6.0014 9.18264L5.99203 9.19185L5.98219 9.20055C5.5391 9.59243 5.5104 10.3231 6.0014 10.8056L6.01078 10.8148L6.01967 10.8245C6.42299 11.2649 7.18224 11.2926 7.67785 10.8056L7.68034 10.8032L7.68035 10.8032L12.5684 6.06643C12.5688 6.06604 12.5692 6.06565 12.5696 6.06526C13.5917 5.05969 13.5913 3.51289 12.5684 2.50774Z",fill:"currentColor"},null,-1)])])}const Ve=ve(st,[["render",it]]),ut={key:0,class:"flex flex-col gap-2 px-6 md:pl-10 md:pr-9"},rt={class:"flex flex-wrap gap-2"},ct={class:"flex justify-between overflow-hidden border-t py-2.5"},dt={class:"flex items-center overflow-x-auto w-[60%]"},mt={class:"flex items-center justify-end space-x-2 w-[40%]"},ft=Q({__name:"CommentTextEditor",props:{ticketId:{type:String,default:null},placeholder:{type:String,default:null},label:{type:String,default:"Comment"},editable:{type:Boolean,default:!0},doctype:{type:String,default:"HD Ticket"}},emits:["submit","discard"],setup(a,{expose:M,emit:I}){const{updateOnboardingStep:d}=we("helpdesk"),{agents:m}=Qe(),{isManager:x}=ge();pe(()=>{var l;m.loading||(l=m.data)!=null&&l.length||m.list.promise||m.fetch()});const f=a,r=I,s=ye("commentBoxContent"+f.ticketId,null),{onUserType:_,cleanup:h}=re(f.ticketId),k=y([]),D=L(()=>te(s.value)),w=y(!1);J(s,(l,v)=>{l!==v&&l&&_()}),ie(()=>{h()});const A=L(()=>w.value?"Sending...":f.label),C=L(()=>{var l;return((l=m.data)==null?void 0:l.map(v=>({label:v.agent_name.trimEnd(),value:v.name})))||[]});function B(l){k.value=k.value.filter(v=>v!==l),Ce(l.name)}async function p(){if(te(s.value))return!1;ue({url:"run_doc_method",makeParams:()=>({dt:f.doctype,dn:f.ticketId,method:"new_comment",args:{content:s.value,attachments:k.value}}),onSuccess:()=>{x&&d("comment_on_ticket"),r("submit"),w.value=!1,k.value=[],s.value=null},onError:()=>{w.value=!1}}).submit()}const e=y(null),u=L(()=>{var l;return(l=e.value)==null?void 0:l.editor});return M({submitComment:p,editor:u}),(l,v)=>{const H=U("FeatherIcon"),E=U("Button");return t(m).data?(g(),j(t(ce),{key:0,ref_key:"editorRef",ref:e,"editor-class":["prose-sm max-w-none",a.editable&&"min-h-[7rem] mx-6 md:ml-10 md:mr-9 max-h-[50vh] overflow-y-auto border-t py-3",t(be)(t(s))],content:t(s),"starterkit-options":{heading:{levels:[2,3,4,5,6]}},placeholder:a.placeholder,editable:a.editable,mentions:C.value,onChange:v[3]||(v[3]=b=>a.editable?s.value=b:null),extensions:[t(ke)],uploadFunction:b=>t(he)(b,a.doctype,a.ticketId)},{bottom:$(()=>[a.editable?(g(),V("div",ut,[o("div",rt,[(g(!0),V(q,null,W(k.value,b=>(g(),j(t(_e),{key:b.file_url,label:b.file_name,url:["MOV","MP4"].includes(b.file_type)?null:b.file_url},{suffix:$(()=>[n(H,{class:"h-3.5",name:"x",onClick:K(P=>B(b),["stop"])},null,8,["onClick"])]),_:2},1032,["label","url"]))),128))]),o("div",ct,[o("div",dt,[n(t($e),{class:"-ml-1",buttons:t(xe)},null,8,["buttons"]),n(t(Ie),{"upload-args":{doctype:a.doctype,docname:a.ticketId,private:!0},onSuccess:v[0]||(v[0]=b=>k.value.push(b))},{default:$(({openFileSelector:b})=>[n(E,{theme:"gray",variant:"ghost",onClick:P=>b()},{icon:$(()=>[n(t(Ve),{class:"h-4",style:{color:"#000000","stroke-width":"1.5 !important"}})]),_:1},8,["onClick"])]),_:1},8,["upload-args"])]),o("div",mt,[n(E,{label:"Discard",onClick:v[1]||(v[1]=()=>{s.value="",k.value=[],r("discard")})}),n(E,{variant:"solid",label:A.value,disabled:D.value,loading:w.value,onClick:v[2]||(v[2]=()=>{w.value=!0,p(),s.value=""})},null,8,["label","disabled","loading"])])])])):N("",!0)]),_:1},8,["editor-class","content","placeholder","editable","mentions","extensions","uploadFunction"])):N("",!0)}}}),pt={class:"comm-area"},vt={class:"flex justify-between gap-3 border-t px-6 md:px-10 py-4 md:py-2.5"},gt={class:"flex gap-1.5 items-center"},yt=["onKeydownCapture"],xt=["onKeydownCapture"],Jt=Q({__name:"CommunicationArea",props:G({doctype:{type:String,default:"HD Ticket"},ticketId:{type:String,default:null},toEmails:{type:Array,default:()=>[]},ccEmails:{type:Array,default:()=>[]},bccEmails:{type:Array,default:()=>[]}},{content:{},contentModifiers:{},modelValue:{},modelModifiers:{}}),emits:G(["update"],["update:content","update:modelValue"]),setup(a,{expose:M,emit:I}){const d=I,m=X(a,"content"),{isMac:x}=We(),{isMobileView:f}=je();X(a,"modelValue");const r=y(null),s=y(null),_=y(null),h=y(null);function k(){R.value&&(R.value=!1),T.value=!T.value}function D(){T.value&&(T.value=!1),R.value=!R.value}function w(){r.value.submitMail()&&d("update")}function A(){s.value.submitComment()&&d("update")}function C(p){return typeof p=="string"?p.split(","):p}function B(p){T.value=!0,r.value.addToReply(p.content,C(p.to),C(p.cc),C(p.bcc))}return J(()=>T.value,p=>{var e,u,l;p&&((l=(u=(e=r.value)==null?void 0:e.editor)==null?void 0:u.commands)==null||l.focus())}),J(()=>R.value,p=>{var e,u,l;p&&((l=(u=(e=s.value)==null?void 0:e.editor)==null?void 0:u.commands)==null||l.focus())}),fe("r",()=>{k()}),fe("c",()=>{D()}),M({replyToEmail:B,toggleEmailBox:k,toggleCommentBox:D,editor:r}),me(_,()=>{T.value&&(T.value=!1)},{ignore:[".tippy-box",".tippy-content"]}),me(h,()=>{R.value&&(R.value=!1)},{ignore:[".tippy-box",".tippy-content"]}),(p,e)=>{const u=U("Button");return g(),V("div",pt,[o("div",vt,[o("div",gt,[n(u,{ref:"sendEmailRef",variant:"ghost",label:"Reply",class:z([t(T)?"!bg-gray-300 hover:!bg-gray-200":""]),onClick:e[0]||(e[0]=l=>k())},{prefix:$(()=>[n(t(Se),{class:"h-4"})]),_:1},8,["class"]),n(u,{variant:"ghost",label:"Comment",class:z([t(R)?"!bg-gray-300 hover:!bg-gray-200":""]),onClick:e[1]||(e[1]=l=>D())},{prefix:$(()=>[n(t(Xe),{class:"h-4"})]),_:1},8,["class"]),n(t(Ut),{ticketId:a.ticketId},null,8,["ticketId"])])]),se(o("div",{ref_key:"emailBoxRef",ref:_,class:"flex gap-1.5 flex-1",onKeydownCapture:[Z(K(w,["ctrl","stop"]),["enter"]),Z(K(w,["meta","stop"]),["enter"])]},[n(t($t),{ref_key:"emailEditorRef",ref:r,label:t(f)?"Send":t(x)?"Send (⌘ + ⏎)":"Send (Ctrl + ⏎)",content:m.value,"onUpdate:content":e[2]||(e[2]=l=>m.value=l),placeholder:"Hi John, we are looking into this issue.",ticketId:a.ticketId,"to-emails":a.toEmails,"cc-emails":a.ccEmails,"bcc-emails":a.bccEmails,onSubmit:e[3]||(e[3]=()=>{T.value=!1,d("update")}),onDiscard:e[4]||(e[4]=()=>{T.value=!1})},null,8,["label","content","ticketId","to-emails","cc-emails","bcc-emails"])],40,yt),[[oe,t(T)]]),se(o("div",{ref_key:"commentBoxRef",ref:h,onKeydownCapture:[Z(K(A,["ctrl","stop"]),["enter"]),Z(K(A,["meta","stop"]),["enter"])]},[n(t(ft),{ref_key:"commentTextEditorRef",ref:s,label:t(f)?"Comment":t(x)?"Comment (⌘ + ⏎)":"Comment (Ctrl + ⏎)",ticketId:a.ticketId,editable:t(R),doctype:a.doctype,placeholder:"@John could you please look into this?",onSubmit:e[5]||(e[5]=()=>{R.value=!1,d("update")}),onDiscard:e[6]||(e[6]=()=>{R.value=!1})},null,8,["label","ticketId","editable","doctype"])],40,xt),[[oe,t(R)]])])}}}),bt={class:"mx-6 md:mx-10 flex items-center gap-2 border-y py-2.5"},ht={class:"flex flex-wrap gap-2 px-10"},Ct={class:"flex justify-between overflow-scroll pl-10 py-2.5 items-center"},kt={class:"flex items-center overflow-x-auto w-[60%]"},_t={class:"flex gap-1"},wt={class:"flex items-center justify-end space-x-2 sm:mt-0 w-[40%] mr-9"},$t=Q({__name:"EmailEditor",props:{ticketId:{type:String,default:null},placeholder:{type:String,default:null},label:{type:String,default:"Send"},editable:{type:Boolean,default:!0},doctype:{type:String,default:"HD Ticket"},toEmails:{type:Array,default:()=>[]},ccEmails:{type:Array,default:()=>[]},bccEmails:{type:Array,default:()=>[]}},emits:["submit","discard"],setup(a,{expose:M,emit:I}){const d=y(null),m=y(!1),x=a,f=L(()=>P.loading?"Sending...":x.label),r=I,s=ye("emailBoxContent"+x.ticketId,null),{updateOnboardingStep:_}=we("helpdesk"),{isManager:h}=ge(),{onUserType:k,cleanup:D}=re(x.ticketId),w=y([]),A=L(()=>te(s.value));J(s,(S,i)=>{S!==i&&S&&k()}),ie(()=>{D()});const C=y([...x.toEmails]),B=y([...x.ccEmails]),p=y([...x.bccEmails]),e=y(!1),u=y(!1),l=L(()=>{var S;return!!((S=B.value)!=null&&S.length)}),v=L(()=>{var S;return!!((S=p.value)!=null&&S.length)}),H=y(null),E=y(null);function b(S){s.value=S.message,m.value=!1}const P=ue({url:"run_doc_method",makeParams:()=>{var S,i;return{dt:x.doctype,dn:x.ticketId,method:"reply_via_agent",args:{attachments:w.value.map(O=>O.name),to:C.value.join(","),cc:(S=B.value)==null?void 0:S.join(","),bcc:(i=p.value)==null?void 0:i.join(","),message:s.value}}},onSuccess:()=>{Le(),r("submit"),h&&_("reply_on_ticket")},debounce:300});function de(){if(te(s.value))return!1;if(!C.value.length)return Ke.warning("Email has no recipients. Please add at least one email address in the 'TO' field."),!1;P.submit()}function Be(){e.value=!e.value,e.value&&Y(()=>{H.value.setFocus()})}function Me(){u.value=!u.value,u.value&&Y(()=>{E.value.setFocus()})}async function Fe(S){w.value=w.value.filter(i=>i!==S),await Ce(S.name)}function Te(S,i,O,le){C.value=i,B.value=O,p.value=le,d.value.editor.chain().clearContent().insertContent(S).focus("all").setBlockquote().insertContentAt(0,{type:"paragraph"}).focus("start").run()}function Le(){s.value=null,w.value=[]}function Re(){w.value=[],s.value=null,B.value=[],p.value=[],B.value=[],e.value=!1,u.value=!1,r("discard")}const Ue=L(()=>d.value.editor);return M({addToReply:Te,editor:Ue,submitMail:de}),(S,i)=>{const O=U("Button"),le=U("FeatherIcon");return g(),V(q,null,[n(t(ce),{ref_key:"editorRef",ref:d,"editor-class":["prose-sm max-w-full mx-6 md:mx-10 max-h-[50vh] py-3","min-h-[7rem]",t(be)(t(s)),a.editable&&"!max-h-[35vh] overflow-y-auto"],content:t(s),"starterkit-options":{heading:{levels:[2,3,4,5,6]}},placeholder:a.placeholder,editable:a.editable,onChange:i[8]||(i[8]=c=>a.editable?s.value=c:null),extensions:[t(ke)],uploadFunction:c=>t(he)(c,a.doctype,a.ticketId)},{top:$(()=>[o("div",bt,[i[10]||(i[10]=o("span",{class:"text-xs text-gray-500"},"TO:",-1)),n(t(ne),{modelValue:C.value,"onUpdate:modelValue":i[0]||(i[0]=c=>C.value=c),class:"flex-1",validate:t(ae),"error-message":c=>`${c} is an invalid email address`},null,8,["modelValue","validate","error-message"]),n(O,{label:"CC",class:z([l.value?"bg-gray-300 hover:bg-gray-200":""]),onClick:i[1]||(i[1]=c=>Be())},null,8,["class"]),n(O,{label:"BCC",class:z([v.value?"bg-gray-300 hover:bg-gray-200":""]),onClick:i[2]||(i[2]=c=>Me())},null,8,["class"])]),e.value||l.value?(g(),V("div",{key:0,class:z(["mx-10 flex items-center gap-2 py-2.5",l.value||e.value?"border-b":""])},[i[11]||(i[11]=o("span",{class:"text-xs text-gray-500"},"CC:",-1)),n(t(ne),{ref_key:"ccInput",ref:H,modelValue:B.value,"onUpdate:modelValue":i[3]||(i[3]=c=>B.value=c),class:"flex-1",validate:t(ae),"error-message":c=>`${c} is an invalid email address`},null,8,["modelValue","validate","error-message"])],2)):N("",!0),u.value||v.value?(g(),V("div",{key:1,class:z(["mx-10 flex items-center gap-2 py-2.5",v.value||u.value?"border-b":""])},[i[12]||(i[12]=o("span",{class:"text-xs text-gray-500"},"BCC:",-1)),n(t(ne),{ref_key:"bccInput",ref:E,modelValue:p.value,"onUpdate:modelValue":i[4]||(i[4]=c=>p.value=c),class:"flex-1",validate:t(ae),"error-message":c=>`${c} is an invalid email address`},null,8,["modelValue","validate","error-message"])],2)):N("",!0)]),bottom:$(()=>[o("div",ht,[(g(!0),V(q,null,W(w.value,c=>(g(),j(t(_e),{key:c.file_url,label:c.file_name,url:["MOV","MP4"].includes(c.file_type)?null:c.file_url},{suffix:$(()=>[n(le,{class:"h-3.5",name:"x",onClick:K(De=>Fe(c),["self","stop"])},null,8,["onClick"])]),_:2},1032,["label","url"]))),128))]),o("div",Ct,[o("div",kt,[o("div",_t,[n(t(Ie),{"upload-args":{doctype:a.doctype,docname:a.ticketId,private:!0},onSuccess:i[5]||(i[5]=c=>{w.value.push(c)})},{default:$(({openFileSelector:c})=>[n(O,{variant:"ghost",onClick:De=>c()},{icon:$(()=>[n(t(Ve),{class:"h-4",style:{color:"#000000","stroke-width":"1.5 !important"}})]),_:1},8,["onClick"])]),_:1},8,["upload-args"]),n(O,{variant:"ghost",onClick:i[6]||(i[6]=c=>m.value=!0)},{icon:$(()=>[n(t(Se),{class:"h-4",style:{color:"#000000","stroke-width":"1.2"}})]),_:1})]),n(t($e),{class:"ml-1",buttons:t(xe)},null,8,["buttons"])]),o("div",wt,[n(O,{label:"Discard",onClick:Re}),n(O,{variant:"solid",disabled:A.value,loading:t(P).loading,label:f.value,onClick:i[7]||(i[7]=()=>{de()})},null,8,["disabled","loading","label"])])])]),_:1},8,["editor-class","content","placeholder","editable","extensions","uploadFunction"]),m.value?(g(),j(t(nt),{key:0,modelValue:m.value,"onUpdate:modelValue":i[9]||(i[9]=c=>m.value=c),doctype:a.doctype,onApply:b},null,8,["modelValue","doctype"])):N("",!0)],64)}}}),It={class:"flex flex-wrap gap-1"},St={class:"flex-1"},Et={class:"mt-1 rounded-lg bg-white py-1 text-base shadow-2xl"},Vt={class:"flex flex-col gap-1 p-1 text-gray-800"},Bt={class:"text-base font-medium"},Mt={class:"text-sm text-gray-600"},ne=Q({__name:"MultiSelectInput",props:G({validate:{type:Function,default:null},errorMessage:{type:Function,default:a=>`${a} is an Invalid value`}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(a,{expose:M}){const I=a,d=X(a,"modelValue"),m=y([]),x=y(null),f=y(null),r=y(""),s=y(""),_=y(!1),h=L({get:()=>r.value||"",set:e=>{r.value="",e&&(_.value=!1),e!=null&&e.value&&A(e.value)}});Ne(r,e=>{e=e||"",s.value!==e&&(s.value=e,w(e))},{debounce:300,immediate:!0});const k=ue({url:"helpdesk.api.contact.search_contacts",method:"GET",cache:["Contact",s.value],params:{txt:s.value},transform:e=>e.map(({full_name:u,email_id:l,name:v})=>({label:u||v||l,value:l}))}),D=L(()=>{let e=k.data||[];return!e.length&&r.value&&e.push({label:r.value,value:r.value}),e});function w(e){k.update({params:{txt:e}}),k.reload()}const A=e=>{f.value=null,e&&(e.split(",").forEach(l=>{var v;if(l=l.trim(),l&&!((v=d.value)!=null&&v.includes(l))){if(l&&I.validate&&!I.validate(l)){f.value=I.errorMessage(l);return}d.value?d.value.push(l):d.value=[l],l=l.replace(l,"")}}),!f.value&&(e=""))},C=e=>{d.value=d.value.filter(u=>u!==e)},B=()=>{var u;if(r.value)return;let e=(u=m.value[m.value.length-1])==null?void 0:u.$el;document.activeElement===e?(d.value.pop(),Y(()=>{d.value.length?(e=m.value[m.value.length-1].$el,e==null||e.focus()):p()})):e==null||e.focus()};function p(){x.value.$el.focus()}return M({setFocus:p}),(e,u)=>{const l=U("FeatherIcon"),v=U("Button"),H=U("ErrorMessage");return g(),V("div",null,[o("div",It,[(g(!0),V(q,null,W(d.value,E=>(g(),j(v,{ref_for:!0,ref_key:"emails",ref:m,key:E,label:E,theme:"gray",variant:"subtle",class:"rounded-full",onKeydownCapture:Z(K(B,["stop"]),["delete"])},{suffix:$(()=>[n(l,{class:"h-3.5",name:"x",onClick:K(b=>C(E),["stop"])},null,8,["onClick"])]),_:2},1032,["label","onKeydownCapture"]))),128)),o("div",St,[n(t(Ze),{modelValue:h.value,"onUpdate:modelValue":u[2]||(u[2]=E=>h.value=E),nullable:""},{default:$(()=>[n(t(Pe),{show:_.value,"onUpdate:show":u[1]||(u[1]=E=>_.value=E),class:"w-full"},{target:$(({togglePopover:E})=>[n(t(ze),{ref_key:"search",ref:x,class:"search-input form-input w-full border-none bg-white hover:bg-white focus:border-none focus:!shadow-none focus-visible:!ring-0",type:"text",value:r.value,autocomplete:"off",onChange:u[0]||(u[0]=b=>{r.value=b.target.value,_.value=!0}),onFocus:()=>E(),onKeydownCapture:Z(K(B,["stop"]),["delete"])},null,8,["value","onFocus","onKeydownCapture"])]),body:$(({isOpen:E})=>[se(o("div",null,[o("div",Et,[n(t(He),{class:"my-1 max-h-[12rem] overflow-y-auto px-1.5",static:""},{default:$(()=>[(g(!0),V(q,null,W(D.value,b=>(g(),j(t(qe),{key:b.value,value:b},{default:$(({active:P})=>[o("li",{class:z(["flex cursor-pointer items-center rounded px-2 py-1 text-base",{"bg-gray-100":P}])},[n(t(Ee),{class:"mr-2",name:b.value,size:"lg"},null,8,["name"]),o("div",Vt,[o("div",Bt,ee(b.label),1),o("div",Mt,ee(b.value),1)])],2)]),_:2},1032,["value"]))),128))]),_:1})])],512),[[oe,E]])]),_:1},8,["show"])]),_:1},8,["modelValue"])])]),f.value?(g(),j(H,{key:0,class:"mt-2 pl-2",message:f.value},null,8,["message"])):N("",!0)])}}}),Ft={key:0,class:"pl-2"},Tt={class:"flex items-center gap-2 text-sm text-gray-600"},Lt={class:"flex items-center gap-1.5"},Rt=Q({__name:"TypingIndicator",props:{ticketId:{type:String,required:!0}},setup(a){const M=a,{typingUsers:I,cleanup:d}=re(M.ticketId),m=L(()=>{var s,_;const x=I.length;if(x===0)return null;const{getUser:f}=Ge();let r=((s=f(I[0]))==null?void 0:s.full_name)||I[0];return console.log(r),console.log(I),x===1?F("div",{class:"flex items-center gap-1"},[F(Ee,{name:I[0],size:"sm"}),F("span",{class:"text-ink-gray-6 font-medium"},r),F("span",{class:"text-ink-gray-5"}," is typing")]):x===2?F("div",{class:"flex items-center gap-1"},[F("span",{class:"text-ink-gray-6 font-medium"},r),F("span",{class:"text-ink-gray-5"}," and "),F("span",{class:"text-ink-gray-6 font-medium"},(_=f(I[1]))==null?void 0:_.full_name),F("span",{class:"text-ink-gray-5"}," are typing")]):F("div",{class:"flex items-center gap-1"},[F("span",{class:"text-ink-gray-6 font-medium"},r),F("span",{class:"text-ink-gray-5"}," and "),F("span",{class:"text-ink-gray-6 font-medium"},`${x-1} others`),F("span",{class:"text-ink-gray-5"}," are typing")])});return ie(()=>{d()}),(x,f)=>t(I).length>0?(g(),V("div",Ft,[o("div",Tt,[o("div",Lt,[(g(),j(Je(m.value))),f[0]||(f[0]=o("div",{class:"typing-dots"},[o("span"),o("span"),o("span")],-1))])])])):N("",!0)}}),Ut=ve(Rt,[["__scopeId","data-v-3f215bd3"]]);export{Jt as _};
//# sourceMappingURL=TypingIndicator-460dd024.js.map
