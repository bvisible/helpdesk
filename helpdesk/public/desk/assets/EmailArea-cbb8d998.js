import{_ as Q}from"./EmailContent.vue_vue_type_script_setup_true_lang-df9fb311.js";import{j as U,e as t,k as o,l as s,d as Z,m as O,n as X,A as P,W as Y,S as ee,r as S,f as C,w as y,t as R,g as d,h as e,I as te,$ as se,a as oe,b as le,c as ne,a8 as ae,v as p,aI as q,a3 as z,a6 as E,y as r,F as H,G as ie,ab as re}from"./index-b4c863a6.js";import{_ as ce}from"./AttachmentItem.vue_vue_type_script_setup_true_lang-b54cd9d5.js";import{T as de,q as G}from"./TypingIndicator.vue_vue_type_style_index_0_scoped_3f215bd3_lang-c8d975a4.js";import"./dayjs-95f8111d.js";import"./knowledgeBase-2d00b929.js";import{D as ue}from"./Dropdown-f79f7542.js";const me={},pe={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function _e(g,_){return t(),o("svg",pe,[..._[0]||(_[0]=[s("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.85355 3.14645C5.65829 2.95118 5.34171 2.95118 5.14645 3.14645L1.14645 7.14645C0.951184 7.34171 0.951184 7.65829 1.14645 7.85355L5.14645 11.8536C5.34171 12.0488 5.65829 12.0488 5.85355 11.8536C6.04882 11.6583 6.04882 11.3417 5.85355 11.1464L2.20711 7.5L5.85355 3.85355C6.04882 3.65829 6.04882 3.34171 5.85355 3.14645ZM10 8C11.933 8 13.5 9.567 13.5 11.5V12C13.5 12.2761 13.7239 12.5 14 12.5C14.2761 12.5 14.5 12.2761 14.5 12V11.5C14.5 9.01472 12.4853 7 10 7H6.6728L9.81924 3.85355C10.0145 3.65829 10.0145 3.34171 9.81924 3.14645C9.62398 2.95118 9.3074 2.95118 9.11214 3.14645L5.11214 7.14645C4.91688 7.34171 4.91688 7.65829 5.11214 7.85355L9.11214 11.8536C9.3074 12.0488 9.62398 12.0488 9.81924 11.8536C10.0145 11.6583 10.0145 11.3417 9.81924 11.1464L6.6728 8H10Z",fill:"currentColor"},null,-1)])])}const fe=U(me,[["render",_e]]),ge={},xe={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function he(g,_){return t(),o("svg",xe,[..._[0]||(_[0]=[s("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.64645 3.14645C5.84171 2.95118 6.15829 2.95118 6.35355 3.14645C6.54882 3.34171 6.54882 3.65829 6.35355 3.85355L3.20711 7H10C12.4853 7 14.5 9.01472 14.5 11.5V12C14.5 12.2761 14.2761 12.5 14 12.5C13.7239 12.5 13.5 12.2761 13.5 12V11.5C13.5 9.567 11.933 8 10 8H3.20711L6.35355 11.1464C6.54882 11.3417 6.54882 11.6583 6.35355 11.8536C6.15829 12.0488 5.84171 12.0488 5.64645 11.8536L1.64645 7.85355C1.45118 7.65829 1.45118 7.34171 1.64645 7.14645L5.64645 3.14645Z",fill:"currentColor"},null,-1)])])}const ye=U(ge,[["render",he]]),ve={class:"flex flex-col gap-4"},we={class:"flex items-center gap-2 rounded-md p-2 ring-1 ring-gray-200"},ke=Z({__name:"TicketSplitModal",props:O({ticket_id:{},communication_id:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:O(["update"],["update:modelValue"]),setup(g,{emit:_}){const T=g,l=X(g,"modelValue"),u=P(null),f=Y({url:"helpdesk.helpdesk.doctype.hd_ticket.api.split_ticket",makeParams({subject:c,communication_id:a}){return{subject:c,communication_id:a}},validate({subject:c,communication_id:a}){if(!c)throw{message:"Subject is required"};if(!a)throw{message:"Communication ID is required"}},onSuccess:c=>{ee.success("Ticket split successfully"),l.value=!1,window.open(window.location.origin+"/helpdesk/tickets/"+c,"_blank"),window.location.reload()}});function x(){f.submit({subject:u.value,communication_id:T.communication_id})}return(c,a)=>{const L=S("FormControl"),w=S("Button");return t(),C(e(te),{options:{title:"Split ticket"},modelValue:l.value,"onUpdate:modelValue":a[1]||(a[1]=h=>l.value=h)},{"body-content":y(()=>[s("div",ve,[a[3]||(a[3]=s("p",{class:"text-p-base text-ink-gray-8"},[R(" All "),s("span",{class:"underline"},"emails/ comments"),R(" from this email onwards will be moved to new ticket. ")],-1)),d(L,{label:"New Ticket Subject",type:"text",modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=h=>u.value=h),placeholder:"Add a subject for the new ticket"},null,8,["modelValue"]),s("div",we,[d(e(de),{class:"h-6 w-5 w-min-5 w-max-5 min-h-5 max-w-5 text-yellow-500"}),a[2]||(a[2]=s("div",{class:"text-wrap text-sm text-gray-700"}," This action is irreversible. ",-1))])])]),actions:y(()=>[d(w,{class:"w-full",variant:"solid",label:"Split into new ticket",loading:e(f).loading,"icon-left":e(G),onClick:x},null,8,["loading","icon-left"])]),_:1},8,["modelValue"])}}}),be=["id"],Ce={key:0,class:"flex items-center gap-2 text-sm"},Se={class:"leading-tight"},Ve={class:"text-xs md:text-sm text-gray-600"},Be={key:0,class:"sm:flex hidden text-sm text-gray-600"},Te={key:1,class:"flex items-center gap-1"},Le={key:0,class:"sm:flex hidden text-sm text-gray-600"},je={class:"flex gap-0.5 items-center"},$e={class:"text-xs md:text-sm text-gray-600"},Ae={class:"text-sm leading-5 text-gray-600"},Me={key:0,class:"text-2xs mr-1 font-bold text-gray-500"},Fe={key:1},Ne={key:2},De={key:3,class:"text-2xs mr-1 font-bold text-gray-500"},Ie={key:4},Oe={key:5},Re={key:6,class:"text-2xs mr-1 font-bold text-gray-500"},qe={key:7},ze={class:"flex flex-wrap gap-2"},Je=Z({__name:"EmailArea",props:{activity:{type:Object,required:!0},showSplitOption:{type:Boolean,default:!1}},emits:["reply"],setup(g,{emit:_}){const T=g,{sender:l,to:u,cc:f,bcc:x,creation:c,subject:a,attachments:L,content:w,name:h,deliveryStatus:W}=T.activity,D=_,I=se(oe()),{isMobileView:j}=le(),$=P(!1),A=ne(()=>{let i=W,n="red";return["Sent","Clicked"].includes(i)?n="green":["Sending","Scheduled"].includes(i)?n="orange":["Opened","Read"].includes(i)?n="blue":i=="Error"&&(n="red"),{label:i,color:n}}),J=()=>{const i=I.user.value;D("reply",{content:w,to:i===l.name?u:l.name})},K=()=>{const i=I.user.value,n=F=>{let N;return typeof F=="string"?N=F.split(",").map(B=>B.trim()):N=F||[],N.filter(B=>B!==i&&B!==l.name)},k=n(u),V=n(f),v=n(x);let b,m,M;i===l.name?(b=k.join(", "),m=V,M=v):(b=l.name,m=[...k,...V],M=v),D("reply",{content:w,to:b,cc:m.filter(Boolean),bcc:M.filter(Boolean)})};return(i,n)=>{const k=S("Tooltip"),V=S("Badge"),v=S("Button"),b=Q;return t(),o(H,null,[s("div",re({id:`communication-${e(h)}`},i.$attrs,{class:"grow cursor-pointer border-transparent bg-white rounded-md shadow text-base leading-6 transition-all duration-300 ease-in-out"}),[s("div",{class:ae(["flex items-center justify-between gap-2",e(j)&&"items-start"])},[e(j)?(t(),o("div",Ce,[s("div",Se,[s("p",null,p(e(l).full_name||"No name found"),1),d(k,{text:e(z)(e(c),e(E))},{default:y(()=>[s("p",Ve,p(e(q)(e(c))),1)]),_:1},8,["text"]),e(l).name?(t(),o("p",Be,p("<"+e(l).name+">"),1)):r("",!0)])])):(t(),o("div",Te,[s("span",null,p(e(l).full_name||"No name found"),1),e(l).name?(t(),o("span",Le,p("<"+e(l).name+">"),1)):r("",!0)])),s("div",je,[A.value.label?(t(),C(V,{key:0,label:i.__(A.value.label),variant:"subtle",theme:A.value.color,class:"mr-1.5"},null,8,["label","theme"])):r("",!0),e(j)?r("",!0):(t(),C(k,{key:1,text:e(z)(e(c),e(E))},{default:y(()=>[s("p",$e,p(e(q)(e(c))),1)]),_:1},8,["text"])),d(v,{variant:"ghost",class:"text-gray-700",onClick:J},{default:y(()=>[d(e(ye),{class:"h-4 w-4"})]),_:1}),d(v,{variant:"ghost",class:"text-gray-700",onClick:K},{default:y(()=>[d(e(fe),{class:"h-4 w-4"})]),_:1}),g.showSplitOption?(t(),C(e(ue),{key:2,placement:"right",options:[{label:"Split Ticket",icon:e(G),onClick:()=>$.value=!0}]},{default:y(()=>[d(v,{icon:"more-horizontal",class:"text-gray-600",variant:"ghost"})]),_:1},8,["options"])):r("",!0)])],2),s("div",Ae,[e(u)?(t(),o("span",Me,"TO:")):r("",!0),e(u)?(t(),o("span",Fe,p(e(u)),1)):r("",!0),e(f)?(t(),o("span",Ne,", ")):r("",!0),e(f)?(t(),o("span",De," CC: ")):r("",!0),e(f)?(t(),o("span",Ie,p(e(f)),1)):r("",!0),e(x)?(t(),o("span",Oe,", ")):r("",!0),e(x)?(t(),o("span",Re," BCC: ")):r("",!0),e(x)?(t(),o("span",qe,p(e(x)),1)):r("",!0)]),n[1]||(n[1]=s("div",{class:"border-0 border-t my-3 border-outline-gray-modals"},null,-1)),d(b,{content:e(w)},null,8,["content"]),s("div",ze,[(t(!0),o(H,null,ie(e(L),m=>(t(),C(e(ce),{key:m.file_url,label:m.file_name,url:m.file_url},null,8,["label","url"]))),128))])],16,be),d(ke,{modelValue:$.value,"onUpdate:modelValue":n[0]||(n[0]=m=>$.value=m),ticket_id:e(h),communication_id:e(h)},null,8,["modelValue","ticket_id","communication_id"])],64)}}});export{Je as default};
//# sourceMappingURL=EmailArea-cbb8d998.js.map
