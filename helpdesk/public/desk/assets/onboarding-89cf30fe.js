import{A as S,p as E,c as a,W as w,X as G}from"./index-b4c863a6.js";import{a as b}from"./index-6b12b9aa.js";const M=S(!1),P=S(!1);function R(){let s=new URLSearchParams(document.cookie.split("; ").join("&")).get("user_id");return s==="Guest"&&(s=null),s}const u=E({}),i=b("onboardingStatus",{});function H(n){const s=R();if(!s||s==="Guest")return;const r=b("isOnboardingStepsCompleted"+n+s,!1),o=a(()=>{var e,t;return((t=(e=i.value)==null?void 0:e[s])==null?void 0:t[n+"_onboarding_status"])||[]});!o.value.length&&!r.value&&w({url:"frappe.onboarding.get_onboarding_status",cache:"onboarding_status",auto:!0,onSuccess:e=>{i.value[s]=e,d()}});const m=a(()=>{var e;return((e=u[n])==null?void 0:e.filter(t=>t.completed).length)||0}),_=a(()=>{var e;return((e=u[n])==null?void 0:e.length)||0}),O=a(()=>Math.floor(m.value/_.value*100));function U(e,t=null){f(e,!0,!0,t)}function A(e=null){p(!0,e)}function x(e,t=null){f(e,!1,!1,t)}function y(e=null){p(!1,e)}function f(e,t=!0,l=!1,c=null){if(r.value)return;o.value.length||(i.value[s]||(i.value[s]={}),i.value[s][n+"_onboarding_status"]=u[n].map(v=>({name:v.name,completed:!1})));let g=o.value.findIndex(v=>v.name===e);g!==-1&&(o.value[g].completed=t,u[n][g].completed=t),h(o.value),c==null||c(e,l),P.value=!1}function p(e,t=null){r.value&&e||(o.value.length?o.value.forEach(l=>{l.completed=e}):(i.value[s]||(i.value[s]={}),i.value[s][n+"_onboarding_status"]=u[n].map(l=>({name:l.name,completed:e}))),u[n].forEach(l=>{l.completed=e}),h(o.value),t==null||t(e))}function h(e){G("frappe.onboarding.update_user_onboarding_status",{steps:JSON.stringify(e),appName:n})}function d(){if(!r.value)if(o.value.length){let e=o.value;e.forEach((t,l)=>{u[n][l].completed=t.completed}),r.value=e.every(t=>t.completed)}else r.value=!1}function C(e){M.value=!r.value,!u[n]&&(u[n]=e,d())}return{steps:u[n],stepsCompleted:m,totalSteps:_,completedPercentage:O,isOnboardingStepsCompleted:r,updateOnboardingStep:f,skip:U,skipAll:A,reset:x,resetAll:y,setUp:C,syncStatus:d}}export{P as m,M as s,H as u};
//# sourceMappingURL=onboarding-89cf30fe.js.map
