import{z as O,b4 as Z,b5 as J,c as C,a3 as F,ap as K,e as d,f as E,w as f,g as b,h as r,G as ee,B as _,C as q,D as N,l as g,a8 as M,k as c,t as V,Q as I,aq as R,aX as te,aY as ae,F as G,E as H,x as P,aZ as se,ab as Q,s as le,ar as W,a_ as re,aW as X,V as oe,r as Y,ak as ue}from"./index-3194ec9b.js";const ne={class:"w-full"},ie=["onClick"],de={class:"flex items-center"},ce={key:0,class:"overflow-hidden text-ellipsis whitespace-nowrap text-base leading-5"},fe={key:1,class:"text-base leading-5 text-gray-500"},pe={class:"mt-1 rounded-lg bg-white py-1 text-base shadow-2xl"},me={class:"relative px-1.5 pt-0.5"},ge={key:0,class:"px-2.5 py-1.5 text-sm font-medium text-gray-500"},he={key:0,class:"mt-1.5 rounded-md px-2.5 py-1.5 text-base text-gray-600"},ye={key:0,class:"border-t p-1.5 pb-0.5"},be={__name:"Autocomplete",props:{modelValue:{type:[String,Object],default:""},options:{type:Array,default:()=>[]},size:{type:String,default:"md"},variant:{type:String,default:"subtle"},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0}},emits:["update:modelValue","update:query","change"],setup($,{expose:j,emit:s}){const o=$,n=s,p=O(""),v=O(!1),S=O(null),w=Z(),h=J(),z=C(()=>"value"in w),k=C({get(){return z.value?w.value:o.modelValue},set(e){p.value="",e&&(v.value=!1),n(z.value?"change":"update:modelValue",e)}});function T(){v.value=!1}const t=C(()=>{var a;return!o.options||o.options.length==0?[]:((a=o.options[0])!=null&&a.group?o.options:[{group:"",items:o.options}]).map((u,i)=>({key:i,group:u.group,hideLabel:u.hideLabel||!1,items:o.filterable?y(u.items):u.items})).filter(u=>u.items.length>0)});function y(e){return p.value?e.filter(a=>[a.label,a.value].some(i=>(i||"").toString().toLowerCase().includes(p.value.toLowerCase()))):e}function l(e){if(typeof e=="string"){let u=t.value.flatMap(i=>i.items).find(i=>i.value===e);return(u==null?void 0:u.label)||e}return e==null?void 0:e.label}F(p,e=>{n("update:query",e)}),F(v,e=>{e&&K(()=>{S.value.el.focus()})});const B=C(()=>o.disabled?"text-gray-600":"text-gray-800"),m=C(()=>{let e={sm:"text-base rounded h-7",md:"text-base rounded h-8",lg:"text-lg rounded-md h-10",xl:"text-xl rounded-md h-10"}[o.size],a={sm:"py-1.5 px-2",md:"py-1.5 px-2.5",lg:"py-1.5 px-3",xl:"py-1.5 px-3"}[o.size],u=o.disabled?"disabled":o.variant,i={subtle:"border border-gray-100 bg-gray-100 placeholder-gray-500 hover:border-gray-200 hover:bg-gray-200 focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",outline:"border border-gray-300 bg-white placeholder-gray-500 hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",disabled:["border bg-gray-50 placeholder-gray-400",o.variant==="outline"?"border-gray-300":"border-transparent"]}[u];return[e,a,i,B.value,"transition-colors w-full"]});return j({query:p}),(e,a)=>(d(),E(r(re),{modelValue:k.value,"onUpdate:modelValue":a[3]||(a[3]=u=>k.value=u),nullable:""},{default:f(({open:u})=>[b(r(ee),{class:"w-full",show:v.value,"onUpdate:show":a[2]||(a[2]=i=>v.value=i)},{target:f(({open:i,togglePopover:L})=>[_(e.$slots,"target",q(N({open:i,togglePopover:L,isOpen:v.value,selectedValue:k.value,displayValue:l})),()=>[g("div",ne,[g("button",{class:M(["flex w-full items-center justify-between focus:outline-none",m.value]),onClick:()=>!$.disabled&&L()},[g("div",de,[_(e.$slots,"prefix"),k.value?(d(),c("span",ce,V(l(k.value)),1)):(d(),c("span",fe,V($.placeholder||""),1))]),b(r(I),{name:"chevron-down",class:"h-4 w-4 text-gray-600","aria-hidden":"true"})],10,ie)])])]),body:f(({isOpen:i})=>{var L;return[R(g("div",null,[g("div",pe,[g("div",me,[b(r(te),{ref_key:"search",ref:S,class:"form-input w-full",type:"text",onChange:a[0]||(a[0]=x=>{p.value=x.target.value}),value:p.value,autocomplete:"off",placeholder:"Search"},null,8,["value"]),g("button",{class:"absolute right-1.5 inline-flex h-7 w-7 items-center justify-center",onClick:a[1]||(a[1]=x=>k.value=null)},[b(r(I),{name:"x",class:"w-4"})])]),b(r(ae),{class:"my-1 max-h-[12rem] overflow-y-auto px-1.5",static:""},{default:f(()=>[(d(!0),c(G,null,H(t.value,x=>R((d(),c("div",{class:"mt-1.5",key:x.key},[x.group&&!x.hideLabel?(d(),c("div",ge,V(x.group),1)):P("",!0),(d(!0),c(G,null,H(x.items,D=>(d(),E(r(se),{as:"template",key:D.value,value:D},{default:f(({active:A,selected:U})=>[g("li",{class:M(["flex items-center rounded px-2.5 py-1.5 text-base",{"bg-gray-100":A}])},[_(e.$slots,"item-prefix",Q({ref_for:!0},{active:A,selected:U,option:D})),_(e.$slots,"item-label",Q({ref_for:!0},{active:A,selected:U,option:D}),()=>[le(V(D.label),1)])],2)]),_:2},1032,["value"]))),128))])),[[W,x.items.length>0]])),128)),t.value.length==0?(d(),c("li",he," No results found ")):P("",!0)]),_:3}),r(h).footer?(d(),c("div",ye,[_(e.$slots,"footer",q(N({value:(L=S.value)==null?void 0:L.el._value,close:T})))])):P("",!0)])],512),[[W,i]])]}),_:3},8,["show"])]),_:3},8,["modelValue"]))}},ve={class:"space-y-1.5"},xe={key:0,class:"flex flex-col gap-1"},_e={class:"flex-1 font-semibold truncate text-ink-gray-7"},we={class:"flex-1 text-sm truncate text-ink-gray-5"},ke={key:1,class:"flex-1 truncate text-ink-gray-7"},Ce={key:0},$e={__name:"Link",props:{doctype:{type:String,required:!0},filters:{type:Object,default:null},modelValue:{type:String,default:""},hideMe:{type:Boolean,default:!1},pageLength:{type:Number,default:10},hideClearButton:{type:Boolean,default:!1},showDescription:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup($,{emit:j}){const s=$,o=j,n=Z(),p=C(()=>"value"in n),v=C({get:()=>p.value?n.value:s.modelValue,set:t=>(t==null?void 0:t.value)&&o(p.value?"change":"update:modelValue",t==null?void 0:t.value)}),S=O(null),w=O("");X(()=>{var t;return(t=S.value)==null?void 0:t.query},t=>{t=t||"",w.value!==t&&(w.value=t,z(t))},{debounce:300,immediate:!0}),X(()=>s.doctype,()=>z(""),{debounce:300,immediate:!0}),F(()=>s==null?void 0:s.filters,t=>{h.update({params:{txt:w.value,doctype:s.doctype,filters:t,page_length:s.pageLength}}),h.reload()},{deep:!0});const h=oe({url:"frappe.desk.search.search_link",cache:[s.doctype,w.value,s.hideMe],method:"POST",params:{txt:w.value,doctype:s.doctype,filters:s.filters,page_length:s.pageLength},transform:t=>{let y=t.map(l=>({value:l.value,label:(l==null?void 0:l.label)||l.value,description:l==null?void 0:l.description}));return!s.hideMe&&(s.doctype=="User"||s.doctype=="HD Agent")&&y.unshift({label:"@me",value:"@me"}),y}});function z(t){var y,l,B;(y=h.data)!=null&&y.length&&t===((l=h.params)==null?void 0:l.txt)&&s.doctype===((B=h.params)==null?void 0:B.doctype)||(h.update({params:{txt:t,doctype:s.doctype,filters:s.filters,page_length:s.pageLength}}),h.reload())}function k(t){o(p.value?"change":"update:modelValue",""),t()}const T=C(()=>[{sm:"text-xs",md:"text-base"}[n.size||"sm"],"text-gray-600",...n.required?["after:content-['*']","after:ml-0.5","after:text-red-500"]:[]]);return(t,y)=>{const l=Y("FeatherIcon"),B=Y("Button");return d(),c("div",ve,[r(n).label?(d(),c("label",{key:0,class:M(["block",T.value])},V(r(n).label),3)):P("",!0),b(be,{ref_key:"autocomplete",ref:S,options:r(h).data,modelValue:v.value,"onUpdate:modelValue":y[0]||(y[0]=m=>v.value=m),size:r(n).size||"sm",variant:r(n).variant,placeholder:r(n).placeholder,filterable:!1,disabled:r(n).disabled},ue({target:f(({open:m,togglePopover:e})=>[_(t.$slots,"target",q(N({open:m,togglePopover:e})))]),prefix:f(()=>[_(t.$slots,"prefix")]),"item-prefix":f(({active:m,selected:e,option:a})=>[_(t.$slots,"item-prefix",q(N({active:m,selected:e,option:a})))]),"item-label":f(({active:m,selected:e,option:a})=>[_(t.$slots,"item-label",q(N({active:m,selected:e,option:a})),()=>[a.description&&$.showDescription?(d(),c("div",xe,[g("div",_e,V(a.label),1),g("div",we,V(a.description),1)])):(d(),c("div",ke,V(a.label),1))])]),_:2},[$.hideClearButton?void 0:{name:"footer",fn:f(({value:m,close:e})=>[r(n).onCreate?(d(),c("div",Ce,[b(B,{variant:"ghost",class:"w-full !justify-start",label:"Create New",onClick:a=>r(n).onCreate(m,e)},{prefix:f(()=>[b(l,{name:"plus",class:"h-4"})]),_:1},8,["onClick"])])):P("",!0),g("div",null,[b(B,{variant:"ghost",class:"w-full !justify-start",label:"Clear",onClick:()=>k(e)},{prefix:f(()=>[b(l,{name:"x",class:"h-4"})]),_:1},8,["onClick"])])]),key:"0"}]),1032,["options","modelValue","size","variant","placeholder","disabled"])])}}};export{be as _,$e as a};
//# sourceMappingURL=Link-431cfb69.js.map
