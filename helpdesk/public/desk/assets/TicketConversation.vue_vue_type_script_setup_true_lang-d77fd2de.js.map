{"version":3,"file":"TicketConversation.vue_vue_type_script_setup_true_lang-d77fd2de.js","sources":["../../../../desk/src/pages/ticket/TicketConversation.vue"],"sourcesContent":["<template>\n  <div\n    class=\"mx-6 md:mx-10 md:my-2 flex items-center justify-between text-lg font-medium mb-4 !mt-8 md:h-8 md:text-xl md:font-semibold md:text-gray-800\"\n  >\n    Activity\n  </div>\n  <div class=\"overflow-auto px-6 md:px-10 grow\">\n    <div\n      v-for=\"(c, i) in communications\"\n      :id=\"c.name\"\n      :key=\"c.name\"\n      class=\"flex items-between justify-center gap-4 relative\"\n      :class=\"i === 0 && 'mt-4'\"\n    >\n      <div\n        class=\"w-full activity grid grid-cols-[30px_minmax(auto,_1fr)] gap-2 sm:gap-4 h-full\"\n      >\n        <div\n          class=\"relative flex justify-center after:absolute after:left-[50%] after:top-3 after:-z-10 after:border-l after:border-gray-200\"\n          :class=\"[\n            i != communications.length - 1 ? 'after:h-full' : 'after:h-5',\n          ]\"\n        >\n          <Avatar\n            size=\"lg\"\n            :label=\"c.user.name\"\n            :image=\"c.user.image\"\n            class=\"mt-1.5 relative\"\n          />\n        </div>\n        <TicketCommunication\n          :content=\"c.content\"\n          :date=\"c.creation\"\n          :user=\"c.user\"\n          :sender-image=\"c.sender\"\n          :cc=\"c.cc || ''\"\n          :bcc=\"c.bcc || ''\"\n          :attachments=\"c.attachments\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { isElementInViewport } from \"@/utils\";\nimport { Avatar } from \"frappe-ui\";\nimport { computed, inject, nextTick, watch } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport TicketCommunication from \"./TicketCommunication.vue\";\nimport { ITicket } from \"./symbols\";\n\ninterface P {\n  focus?: string;\n}\n\nconst props = withDefaults(defineProps<P>(), {\n  focus: \"\",\n});\nconst route = useRoute();\nconst ticket = inject(ITicket);\nconst communications = computed(() => {\n  const _communications = ticket.data.communications || [];\n  return _communications.sort(\n    (a, b) => new Date(a.creation) - new Date(b.creation)\n  );\n});\n\nfunction scroll(id: string) {\n  const e = document.getElementById(id);\n  if (!isElementInViewport(e)) {\n    e.scrollIntoViewIfNeeded();\n  }\n}\n\nwatch(\n  () => props.focus,\n  (id: string) => scroll(id)\n);\nnextTick(() => {\n  const hash = route.hash.slice(1);\n  const id = hash || communications.value.slice(-1).pop()?.name;\n  if (id) setTimeout(() => scroll(id), 1000);\n});\n</script>\n"],"names":["props","__props","route","useRoute","ticket","inject","ITicket","communications","computed","a","b","scroll","id","e","isElementInViewport","watch","nextTick","_a","_cache","_createElementVNode","_hoisted_1","_openBlock","_createElementBlock","_Fragment","_renderList","c","i","_normalizeClass","_hoisted_3","_createVNode","_unref","Avatar","TicketCommunication"],"mappings":"2jBAwDA,MAAMA,EAAQC,EAGRC,EAAQC,IACRC,EAASC,EAAOC,CAAO,EACvBC,EAAiBC,EAAS,KACNJ,EAAO,KAAK,gBAAkB,CAAA,GAC/B,KACrB,CAACK,EAAGC,IAAM,IAAI,KAAKD,EAAE,QAAQ,EAAI,IAAI,KAAKC,EAAE,QAAQ,CAAA,CAEvD,EAED,SAASC,EAAOC,EAAY,CACpB,MAAAC,EAAI,SAAS,eAAeD,CAAE,EAC/BE,EAAoBD,CAAC,GACxBA,EAAE,uBAAuB,CAE7B,CAEA,OAAAE,EACE,IAAMf,EAAM,MACXY,GAAeD,EAAOC,CAAE,CAAA,EAE3BI,EAAS,IAAM,OAEP,MAAAJ,EADOV,EAAM,KAAK,MAAM,CAAC,KACZe,EAAAV,EAAe,MAAM,MAAM,EAAE,EAAE,IAAO,IAAtC,YAAAU,EAAsC,MACrDL,GAAI,WAAW,IAAMD,EAAOC,CAAE,EAAG,GAAI,CAAA,CAC1C,wBAlFCM,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,EAIM,MAHJ,CAAA,MAAM,8IACP,aAED,EAAA,GACAA,EAmCM,MAnCNC,EAmCM,EAlCJC,EAAA,EAAA,EAAAC,EAiCMC,EAhCa,KAAAC,EAAAjB,EAAA,MAAT,CAAAkB,EAAGC,SADbJ,EAiCM,MAAA,CA/BH,GAAIG,EAAE,KACN,IAAKA,EAAE,KACR,MAAKE,EAAA,CAAC,mDACED,IAAC,GAAA,MAAA,CAAA,CAAA,GAETP,EAyBM,MAzBNS,EAyBM,CAtBJT,EAYM,MAAA,CAXJ,SAAM,4HAA2H,CAC3GO,GAAKnB,EAAc,MAAC,OAAM,EAAA,eAAA,WAAA,MAIhDsB,EAKEC,EAAAC,CAAA,EAAA,CAJA,KAAK,KACJ,MAAON,EAAE,KAAK,KACd,MAAOA,EAAE,KAAK,MACf,MAAM,iDAGVI,EAQEG,EAAA,CAPC,QAASP,EAAE,QACX,KAAMA,EAAE,SACR,KAAMA,EAAE,KACR,eAAcA,EAAE,OAChB,GAAIA,EAAE,IAAE,GACR,IAAKA,EAAE,KAAG,GACV,YAAaA,EAAE"}