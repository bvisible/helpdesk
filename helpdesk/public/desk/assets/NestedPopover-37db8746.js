import{d as H,z as y,c as E,aI as U,ay as a,db as V,aE as _,a7 as oe,cj as de,cf as M,ai as J,cg as fe,cl as be,cm as Pe,J as B,az as W,F as Q,aB as G,M as ne,a5 as ue,aC as me,aw as z,av as R,aJ as N,aK as I,ce as Se,aD as Z,$ as X,aF as x,aG as q,au as ge,e as ye,f as he,w as K,g as ee,h as A,B as te,C as le,D as ae,aq as we,l as $e,ar as Ee,ap as Fe,c3 as ke}from"./index-3194ec9b.js";import{q as Ie,N as Ce,E as Be,n as re,d as C}from"./portal-4ee54923.js";var xe=(r=>(r[r.Open=0]="Open",r[r.Closed=1]="Closed",r))(xe||{});let se=Symbol("PopoverContext");function Y(r){let b=X(se,null);if(b===null){let f=new Error(`<${r} /> is missing a parent <${ve.name} /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(f,Y),f}return b}let Ne=Symbol("PopoverGroupContext");function ie(){return X(Ne,null)}let pe=Symbol("PopoverPanelContext");function Oe(){return X(pe,null)}let ve=H({name:"Popover",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(r,{slots:b,attrs:f,expose:F}){var P;let m=y(null);F({el:m,$el:m});let l=y(1),e=y(null),w=y(null),S=y(null),v=y(null),c=E(()=>U(m)),h=E(()=>{var t,n;if(!a(e)||!a(v))return!1;for(let L of document.querySelectorAll("body > *"))if(Number(L==null?void 0:L.contains(a(e)))^Number(L==null?void 0:L.contains(a(v))))return!0;let o=V(),p=o.indexOf(a(e)),$=(p+o.length-1)%o.length,k=(p+1)%o.length,j=o[$],ce=o[k];return!((t=a(v))!=null&&t.contains(j))&&!((n=a(v))!=null&&n.contains(ce))}),d={popoverState:l,buttonId:y(null),panelId:y(null),panel:v,button:e,isPortalled:h,beforePanelSentinel:w,afterPanelSentinel:S,togglePopover(){l.value=_(l.value,{0:1,1:0})},closePopover(){l.value!==1&&(l.value=1)},close(t){d.closePopover();let n=(()=>t?t instanceof HTMLElement?t:t.value instanceof HTMLElement?a(t):a(d.button):a(d.button))();n==null||n.focus()}};oe(se,d),de(E(()=>_(l.value,{0:M.Open,1:M.Closed})));let O={buttonId:d.buttonId,panelId:d.panelId,close(){d.closePopover()}},g=ie(),T=g==null?void 0:g.registerPopover,[D,s]=Ie(),i=Ce({mainTreeNodeRef:g==null?void 0:g.mainTreeNodeRef,portals:D,defaultContainers:[e,v]});function u(){var t,n,o,p;return(p=g==null?void 0:g.isFocusWithinPopoverGroup())!=null?p:((t=c.value)==null?void 0:t.activeElement)&&(((n=a(e))==null?void 0:n.contains(c.value.activeElement))||((o=a(v))==null?void 0:o.contains(c.value.activeElement)))}return J(()=>T==null?void 0:T(O)),Be((P=c.value)==null?void 0:P.defaultView,"focus",t=>{var n,o;t.target!==window&&t.target instanceof HTMLElement&&l.value===0&&(u()||e&&v&&(i.contains(t.target)||(n=a(d.beforePanelSentinel))!=null&&n.contains(t.target)||(o=a(d.afterPanelSentinel))!=null&&o.contains(t.target)||d.closePopover()))},!0),fe(i.resolveContainers,(t,n)=>{var o;d.closePopover(),be(n,Pe.Loose)||(t.preventDefault(),(o=a(e))==null||o.focus())},E(()=>l.value===0)),()=>{let t={open:l.value===0,close:d.close};return B(Q,[B(s,{},()=>W({theirProps:{...r,...f},ourProps:{ref:m},slot:t,slots:b,attrs:f,name:"Popover"})),B(i.MainTreeNode)])}}}),Te=H({name:"PopoverButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(r,{attrs:b,slots:f,expose:F}){var P;let m=(P=r.id)!=null?P:`headlessui-popover-button-${G()}`,l=Y("PopoverButton"),e=E(()=>U(l.button));F({el:l.button,$el:l.button}),ne(()=>{l.buttonId.value=m}),ue(()=>{l.buttonId.value=null});let w=ie(),S=w==null?void 0:w.closeOthers,v=Oe(),c=E(()=>v===null?!1:v.value===l.panelId.value),h=y(null),d=`headlessui-focus-sentinel-${G()}`;c.value||J(()=>{l.button.value=a(h)});let O=me(E(()=>({as:r.as,type:b.type})),h);function g(t){var n,o,p,$,k;if(c.value){if(l.popoverState.value===1)return;switch(t.key){case x.Space:case x.Enter:t.preventDefault(),(o=(n=t.target).click)==null||o.call(n),l.closePopover(),(p=a(l.button))==null||p.focus();break}}else switch(t.key){case x.Space:case x.Enter:t.preventDefault(),t.stopPropagation(),l.popoverState.value===1&&(S==null||S(l.buttonId.value)),l.togglePopover();break;case x.Escape:if(l.popoverState.value!==0)return S==null?void 0:S(l.buttonId.value);if(!a(l.button)||($=e.value)!=null&&$.activeElement&&!((k=a(l.button))!=null&&k.contains(e.value.activeElement)))return;t.preventDefault(),t.stopPropagation(),l.closePopover();break}}function T(t){c.value||t.key===x.Space&&t.preventDefault()}function D(t){var n,o;r.disabled||(c.value?(l.closePopover(),(n=a(l.button))==null||n.focus()):(t.preventDefault(),t.stopPropagation(),l.popoverState.value===1&&(S==null||S(l.buttonId.value)),l.togglePopover(),(o=a(l.button))==null||o.focus()))}function s(t){t.preventDefault(),t.stopPropagation()}let i=re();function u(){let t=a(l.panel);if(!t)return;function n(){_(i.value,{[C.Forwards]:()=>N(t,I.First),[C.Backwards]:()=>N(t,I.Last)})===q.Error&&N(V().filter(o=>o.dataset.headlessuiFocusGuard!=="true"),_(i.value,{[C.Forwards]:I.Next,[C.Backwards]:I.Previous}),{relativeTo:a(l.button)})}n()}return()=>{let t=l.popoverState.value===0,n={open:t},{...o}=r,p=c.value?{ref:h,type:O.value,onKeydown:g,onClick:D}:{ref:h,id:m,type:O.value,"aria-expanded":l.popoverState.value===0,"aria-controls":a(l.panel)?l.panelId.value:void 0,disabled:r.disabled?!0:void 0,onKeydown:g,onKeyup:T,onClick:D,onMousedown:s};return B(Q,[W({ourProps:p,theirProps:{...b,...o},slot:n,attrs:b,slots:f,name:"PopoverButton"}),t&&!c.value&&l.isPortalled.value&&B(z,{id:d,features:R.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:u})])}}}),De=H({name:"PopoverPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},focus:{type:Boolean,default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(r,{attrs:b,slots:f,expose:F}){var P;let m=(P=r.id)!=null?P:`headlessui-popover-panel-${G()}`,{focus:l}=r,e=Y("PopoverPanel"),w=E(()=>U(e.panel)),S=`headlessui-focus-sentinel-before-${G()}`,v=`headlessui-focus-sentinel-after-${G()}`;F({el:e.panel,$el:e.panel}),ne(()=>{e.panelId.value=m}),ue(()=>{e.panelId.value=null}),oe(pe,e.panelId),J(()=>{var s,i;if(!l||e.popoverState.value!==0||!e.panel)return;let u=(s=w.value)==null?void 0:s.activeElement;(i=a(e.panel))!=null&&i.contains(u)||N(a(e.panel),I.First)});let c=Se(),h=E(()=>c!==null?(c.value&M.Open)===M.Open:e.popoverState.value===0);function d(s){var i,u;switch(s.key){case x.Escape:if(e.popoverState.value!==0||!a(e.panel)||w.value&&!((i=a(e.panel))!=null&&i.contains(w.value.activeElement)))return;s.preventDefault(),s.stopPropagation(),e.closePopover(),(u=a(e.button))==null||u.focus();break}}function O(s){var i,u,t,n,o;let p=s.relatedTarget;p&&a(e.panel)&&((i=a(e.panel))!=null&&i.contains(p)||(e.closePopover(),((t=(u=a(e.beforePanelSentinel))==null?void 0:u.contains)!=null&&t.call(u,p)||(o=(n=a(e.afterPanelSentinel))==null?void 0:n.contains)!=null&&o.call(n,p))&&p.focus({preventScroll:!0})))}let g=re();function T(){let s=a(e.panel);if(!s)return;function i(){_(g.value,{[C.Forwards]:()=>{var u;N(s,I.First)===q.Error&&((u=a(e.afterPanelSentinel))==null||u.focus())},[C.Backwards]:()=>{var u;(u=a(e.button))==null||u.focus({preventScroll:!0})}})}i()}function D(){let s=a(e.panel);if(!s)return;function i(){_(g.value,{[C.Forwards]:()=>{let u=a(e.button),t=a(e.panel);if(!u)return;let n=V(),o=n.indexOf(u),p=n.slice(0,o+1),$=[...n.slice(o+1),...p];for(let k of $.slice())if(k.dataset.headlessuiFocusGuard==="true"||t!=null&&t.contains(k)){let j=$.indexOf(k);j!==-1&&$.splice(j,1)}N($,I.First,{sorted:!1})},[C.Backwards]:()=>{var u;N(s,I.Previous)===q.Error&&((u=a(e.button))==null||u.focus())}})}i()}return()=>{let s={open:e.popoverState.value===0,close:e.close},{focus:i,...u}=r,t={ref:e.panel,id:m,onKeydown:d,onFocusout:l&&e.popoverState.value===0?O:void 0,tabIndex:-1};return W({ourProps:t,theirProps:{...b,...u},attrs:b,slot:s,slots:{...f,default:(...n)=>{var o;return[B(Q,[h.value&&e.isPortalled.value&&B(z,{id:S,ref:e.beforePanelSentinel,features:R.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:T}),(o=f.default)==null?void 0:o.call(f,...n),h.value&&e.isPortalled.value&&B(z,{id:v,ref:e.afterPanelSentinel,features:R.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:D})])]}},features:Z.RenderStrategy|Z.Static,visible:h.value,name:"PopoverPanel"})}}});const je={__name:"NestedPopover",props:{placement:{type:String,default:"bottom-start"}},setup(r){const b=r,f=y(null),F=y(null);let P=y(null);function m(){P.value?P.value.update():P.value=ke(f.value.el,F.value.el,{placement:b.placement})}function l(){Fe(()=>m())}return ge(()=>{var e;(e=P.value)==null||e.destroy()}),(e,w)=>(ye(),he(A(ve),null,{default:K(({open:S})=>[ee(A(Te),{as:"div",ref_key:"reference",ref:f,onClick:l,onFocusin:l,onKeydown:l},{default:K(({open:v})=>[te(e.$slots,"target",le(ae({open:v})))]),_:2},1536),we($e("div",null,[ee(A(De),{ref_key:"popover",ref:F,static:"",class:"z-[100]"},{default:K(({open:v,close:c})=>[te(e.$slots,"body",le(ae({open:v,close:c})))]),_:2},1536)],512),[[Ee,S]])]),_:3}))}};export{Te as G,je as _,De as j,ve as y};
//# sourceMappingURL=NestedPopover-37db8746.js.map
