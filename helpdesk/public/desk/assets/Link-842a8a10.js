import{A as O,aQ as X,aR as Y,c as C,a4 as F,am as Z,e as d,f as I,w as f,g as b,h as r,H as ee,C as _,D as N,E as P,l as h,a8 as U,k as c,v as V,Q as R,an as E,aS as te,aT as ae,F as H,G as Q,y as j,aU as se,ab as G,t as le,ao as W,aV as re,ba as J,W as oe,r as K,ah as ne}from"./index-b4c863a6.js";const ue={class:"w-full"},ie=["onClick"],de={class:"flex items-center"},ce={key:0,class:"overflow-hidden text-ellipsis whitespace-nowrap text-base leading-5"},fe={key:1,class:"text-base leading-5 text-gray-500"},pe={class:"mt-1 rounded-lg bg-white py-1 text-base shadow-2xl"},me={class:"relative px-1.5 pt-0.5"},he={key:0,class:"px-2.5 py-1.5 text-sm font-medium text-gray-500"},ge={key:0,class:"mt-1.5 rounded-md px-2.5 py-1.5 text-base text-gray-600"},ye={key:0,class:"border-t p-1.5 pb-0.5"},be={__name:"Autocomplete",props:{modelValue:{type:[String,Object],default:""},options:{type:Array,default:()=>[]},size:{type:String,default:"md"},variant:{type:String,default:"subtle"},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0}},emits:["update:modelValue","update:query","change"],setup($,{expose:q,emit:s}){const o=$,u=s,p=O(""),v=O(!1),B=O(null),w=X(),g=Y(),L=C(()=>"value"in w),k=C({get(){return L.value?w.value:o.modelValue},set(e){p.value="",e&&(v.value=!1),u(L.value?"change":"update:modelValue",e)}});function T(){v.value=!1}const t=C(()=>{var a;return!o.options||o.options.length==0?[]:((a=o.options[0])!=null&&a.group?o.options:[{group:"",items:o.options}]).map((n,i)=>({key:i,group:n.group,hideLabel:n.hideLabel||!1,items:o.filterable?y(n.items):n.items})).filter(n=>n.items.length>0)});function y(e){return p.value?e.filter(a=>[a.label,a.value].some(i=>(i||"").toString().toLowerCase().includes(p.value.toLowerCase()))):e}function l(e){if(typeof e=="string"){let n=t.value.flatMap(i=>i.items).find(i=>i.value===e);return(n==null?void 0:n.label)||e}return e==null?void 0:e.label}F(p,e=>{u("update:query",e)}),F(v,e=>{e&&Z(()=>{B.value.el.focus()})});const S=C(()=>o.disabled?"text-gray-600":"text-gray-800"),m=C(()=>{let e={sm:"text-base rounded h-7",md:"text-base rounded h-8",lg:"text-lg rounded-md h-10",xl:"text-xl rounded-md h-10"}[o.size],a={sm:"py-1.5 px-2",md:"py-1.5 px-2.5",lg:"py-1.5 px-3",xl:"py-1.5 px-3"}[o.size],n=o.disabled?"disabled":o.variant,i={subtle:"border border-gray-100 bg-gray-100 placeholder-gray-500 hover:border-gray-200 hover:bg-gray-200 focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",outline:"border border-gray-300 bg-white placeholder-gray-500 hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",disabled:["border bg-gray-50 placeholder-gray-400",o.variant==="outline"?"border-gray-300":"border-transparent"]}[n];return[e,a,i,S.value,"transition-colors w-full"]});return q({query:p}),(e,a)=>(d(),I(r(re),{modelValue:k.value,"onUpdate:modelValue":a[3]||(a[3]=n=>k.value=n),nullable:""},{default:f(({open:n})=>[b(r(ee),{class:"w-full",show:v.value,"onUpdate:show":a[2]||(a[2]=i=>v.value=i)},{target:f(({open:i,togglePopover:z})=>[_(e.$slots,"target",N(P({open:i,togglePopover:z,isOpen:v.value,selectedValue:k.value,displayValue:l})),()=>[h("div",ue,[h("button",{class:U(["flex w-full items-center justify-between focus:outline-none",m.value]),onClick:()=>!$.disabled&&z()},[h("div",de,[_(e.$slots,"prefix"),k.value?(d(),c("span",ce,V(l(k.value)),1)):(d(),c("span",fe,V($.placeholder||""),1))]),b(r(R),{name:"chevron-down",class:"h-4 w-4 text-gray-600","aria-hidden":"true"})],10,ie)])])]),body:f(({isOpen:i})=>{var z;return[E(h("div",null,[h("div",pe,[h("div",me,[b(r(te),{ref_key:"search",ref:B,class:"form-input w-full",type:"text",onChange:a[0]||(a[0]=x=>{p.value=x.target.value}),value:p.value,autocomplete:"off",placeholder:"Search"},null,8,["value"]),h("button",{class:"absolute right-1.5 inline-flex h-7 w-7 items-center justify-center",onClick:a[1]||(a[1]=x=>k.value=null)},[b(r(R),{name:"x",class:"w-4"})])]),b(r(ae),{class:"my-1 max-h-[12rem] overflow-y-auto px-1.5",static:""},{default:f(()=>[(d(!0),c(H,null,Q(t.value,x=>E((d(),c("div",{class:"mt-1.5",key:x.key},[x.group&&!x.hideLabel?(d(),c("div",he,V(x.group),1)):j("",!0),(d(!0),c(H,null,Q(x.items,D=>(d(),I(r(se),{as:"template",key:D.value,value:D},{default:f(({active:A,selected:M})=>[h("li",{class:U(["flex items-center rounded px-2.5 py-1.5 text-base",{"bg-gray-100":A}])},[_(e.$slots,"item-prefix",G({ref_for:!0},{active:A,selected:M,option:D})),_(e.$slots,"item-label",G({ref_for:!0},{active:A,selected:M,option:D}),()=>[le(V(D.label),1)])],2)]),_:2},1032,["value"]))),128))])),[[W,x.items.length>0]])),128)),t.value.length==0?(d(),c("li",ge," No results found ")):j("",!0)]),_:3}),r(g).footer?(d(),c("div",ye,[_(e.$slots,"footer",N(P({value:(z=B.value)==null?void 0:z.el._value,close:T})))])):j("",!0)])],512),[[W,i]])]}),_:3},8,["show"])]),_:3},8,["modelValue"]))}},ve={class:"space-y-1.5"},xe={key:0,class:"flex flex-col gap-1"},_e={class:"flex-1 font-semibold truncate text-ink-gray-7"},we={class:"flex-1 text-sm truncate text-ink-gray-5"},ke={key:1,class:"flex-1 truncate text-ink-gray-7"},Ce={key:0},$e={__name:"Link",props:{doctype:{type:String,required:!0},filters:{type:Object,default:null},modelValue:{type:String,default:""},hideMe:{type:Boolean,default:!1},pageLength:{type:Number,default:10},hideClearButton:{type:Boolean,default:!1},showDescription:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup($,{emit:q}){const s=$,o=q,u=X(),p=C(()=>"value"in u),v=C({get:()=>p.value?u.value:s.modelValue,set:t=>(t==null?void 0:t.value)&&o(p.value?"change":"update:modelValue",t==null?void 0:t.value)}),B=O(null),w=O("");J(()=>{var t;return(t=B.value)==null?void 0:t.query},t=>{t=t||"",w.value!==t&&(w.value=t,L(t))},{debounce:300,immediate:!0}),J(()=>s.doctype,()=>L(""),{debounce:300,immediate:!0}),F(()=>s==null?void 0:s.filters,t=>{g.update({params:{txt:w.value,doctype:s.doctype,filters:t,page_length:s.pageLength}}),g.reload()},{deep:!0});const g=oe({url:"frappe.desk.search.search_link",cache:[s.doctype,w.value,s.hideMe],method:"POST",params:{txt:w.value,doctype:s.doctype,filters:s.filters,page_length:s.pageLength},transform:t=>{let y=t.map(l=>({value:l.value,label:(l==null?void 0:l.label)||l.value,description:l==null?void 0:l.description}));return!s.hideMe&&(s.doctype=="User"||s.doctype=="HD Agent")&&y.unshift({label:"@me",value:"@me"}),y}});function L(t){var y,l,S;(y=g.data)!=null&&y.length&&t===((l=g.params)==null?void 0:l.txt)&&s.doctype===((S=g.params)==null?void 0:S.doctype)||(g.update({params:{txt:t,doctype:s.doctype,filters:s.filters,page_length:s.pageLength}}),g.reload())}function k(t){o(p.value?"change":"update:modelValue",""),t()}const T=C(()=>[{sm:"text-xs",md:"text-base"}[u.size||"sm"],"text-gray-600",...u.required?["after:content-['*']","after:ml-0.5","after:text-red-500"]:[]]);return(t,y)=>{const l=K("FeatherIcon"),S=K("Button");return d(),c("div",ve,[r(u).label?(d(),c("label",{key:0,class:U(["block",T.value])},V(r(u).label),3)):j("",!0),b(be,{ref_key:"autocomplete",ref:B,options:r(g).data,modelValue:v.value,"onUpdate:modelValue":y[0]||(y[0]=m=>v.value=m),size:r(u).size||"sm",variant:r(u).variant,placeholder:r(u).placeholder,filterable:!1,disabled:r(u).disabled},ne({target:f(({open:m,togglePopover:e})=>[_(t.$slots,"target",N(P({open:m,togglePopover:e})))]),prefix:f(()=>[_(t.$slots,"prefix")]),"item-prefix":f(({active:m,selected:e,option:a})=>[_(t.$slots,"item-prefix",N(P({active:m,selected:e,option:a})))]),"item-label":f(({active:m,selected:e,option:a})=>[_(t.$slots,"item-label",N(P({active:m,selected:e,option:a})),()=>[a.description&&$.showDescription?(d(),c("div",xe,[h("div",_e,V(a.label),1),h("div",we,V(a.description),1)])):(d(),c("div",ke,V(a.label),1))])]),_:2},[$.hideClearButton?void 0:{name:"footer",fn:f(({value:m,close:e})=>[r(u).onCreate?(d(),c("div",Ce,[b(S,{variant:"ghost",class:"w-full !justify-start",label:"Create New",onClick:a=>r(u).onCreate(m,e)},{prefix:f(()=>[b(l,{name:"plus",class:"h-4"})]),_:1},8,["onClick"])])):j("",!0),h("div",null,[b(S,{variant:"ghost",class:"w-full !justify-start",label:"Clear",onClick:()=>k(e)},{prefix:f(()=>[b(l,{name:"x",class:"h-4"})]),_:1},8,["onClick"])])]),key:"0"}]),1032,["options","modelValue","size","variant","placeholder","disabled"])])}}};export{be as _,$e as a};
//# sourceMappingURL=Link-842a8a10.js.map
